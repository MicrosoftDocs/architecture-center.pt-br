---
title: "Recuperação de dados corrompidos ou exclusão acidental"
description: "Artigo com noções básicas sobre como recuperar dados corrompidos ou de exclusão acidental e como criar aplicativos resilientes, altamente disponíveis, com tolerância a falhas, bem como planejamento de recuperação de desastres"
author: adamglick
ms.date: 08/18/2016
ms.openlocfilehash: b75c774f85c42f64472167897f08a7302ab50a3f
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/14/2017
---
[!INCLUDE [header](../_includes/header.md)]
# <a name="azure-resiliency-technical-guidance-recovery-from-data-corruption-or-accidental-deletion"></a><span data-ttu-id="76fdb-103">Orientações técnicas de resiliência do Azure: recuperação de dados corrompidos ou exclusão acidental</span><span class="sxs-lookup"><span data-stu-id="76fdb-103">Azure resiliency technical guidance: recovery from data corruption or accidental deletion</span></span>
<span data-ttu-id="76fdb-104">Parte de um plano robusto da continuidade de negócios é ter um plano, caso os dados sejam corrompidos ou excluídos acidentalmente.</span><span class="sxs-lookup"><span data-stu-id="76fdb-104">Part of a robust business continuity plan is having a plan if your data gets corrupted or accidentally deleted.</span></span> <span data-ttu-id="76fdb-105">Veja a seguir informações sobre recuperação depois que dados forem corrompidos ou excluídos acidentalmente devido a erros do aplicativo ou do operador.</span><span class="sxs-lookup"><span data-stu-id="76fdb-105">The following is information about recovery after data has been corrupted or accidentally deleted, due to application errors or operator error.</span></span>

## <a name="virtual-machines"></a><span data-ttu-id="76fdb-106">Máquinas Virtuais</span><span class="sxs-lookup"><span data-stu-id="76fdb-106">Virtual Machines</span></span>
<span data-ttu-id="76fdb-107">Para proteger as Máquinas Virtuais do Azure (às vezes chamadas de VM de infraestrutura como serviço) de erros de aplicativo ou exclusão acidental, use o [Backup do Azure](https://azure.microsoft.com/services/backup/).</span><span class="sxs-lookup"><span data-stu-id="76fdb-107">To protect your Azure Virtual Machines (sometimes called infrastructure-as-a-service VMs) from application errors or accidental deletion, use [Azure Backup](https://azure.microsoft.com/services/backup/).</span></span> <span data-ttu-id="76fdb-108">O Backup do Azure permite a criação de backups que são consistentes em vários discos de VM.</span><span class="sxs-lookup"><span data-stu-id="76fdb-108">Azure Backup enables the creation of backups that are consistent across multiple VM disks.</span></span> <span data-ttu-id="76fdb-109">Além disso, o Cofre de Backup pode ser replicado entre regiões para fornecer recuperação de perda de região.</span><span class="sxs-lookup"><span data-stu-id="76fdb-109">In addition, the Backup Vault can be replicated across regions to provide recovery from region loss.</span></span>

## <a name="storage"></a><span data-ttu-id="76fdb-110">Armazenamento</span><span class="sxs-lookup"><span data-stu-id="76fdb-110">Storage</span></span>
<span data-ttu-id="76fdb-111">Observe que, enquanto o armazenamento do Azure fornece resiliência de dados por meio de réplicas automáticas, isso não impede que o código do aplicativo (ou desenvolvedores/usuários) corrompa dados por meio de exclusão acidental ou involuntária, atualização e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="76fdb-111">Note that while Azure Storage provides data resiliency through automated replicas, this does not prevent your application code (or developers/users) from corrupting data through accidental or unintended deletion, update, and so on.</span></span> <span data-ttu-id="76fdb-112">Manter a fidelidade dos dados no caso de erro do usuário ou aplicativo requer técnicas mais avançadas, como copiar os dados para um local de armazenamento secundário com um log de auditoria.</span><span class="sxs-lookup"><span data-stu-id="76fdb-112">Maintaining data fidelity in the face of application or user error requires more advanced techniques, such as copying the data to a secondary storage location with an audit log.</span></span> <span data-ttu-id="76fdb-113">Os desenvolvedores podem aproveitar a [capacidade de instantâneo](https://msdn.microsoft.com/library/azure/ee691971.aspx)do blob, que pode criar instantâneos pontuais somente leitura de conteúdos de blob.</span><span class="sxs-lookup"><span data-stu-id="76fdb-113">Developers can take advantage of the blob [snapshot capability](https://msdn.microsoft.com/library/azure/ee691971.aspx), which can create read-only point-in-time snapshots of blob contents.</span></span> <span data-ttu-id="76fdb-114">Isso pode ser usado como a base de uma solução de fidelidade de dados para blobs de armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="76fdb-114">This can be used as the basis of a data-fidelity solution for Azure Storage blobs.</span></span>

### <a name="blob-and-table-storage-backup"></a><span data-ttu-id="76fdb-115">Backup de armazenamento de tabela e de blob</span><span class="sxs-lookup"><span data-stu-id="76fdb-115">Blob and Table Storage Backup</span></span>
<span data-ttu-id="76fdb-116">Embora blobs e tabelas sejam altamente duráveis, sempre representam o estado atual dos dados.</span><span class="sxs-lookup"><span data-stu-id="76fdb-116">While blobs and tables are highly durable, they always represent the current state of the data.</span></span> <span data-ttu-id="76fdb-117">A recuperação de modificação indesejada ou exclusão de dados pode exigir a restauração dos dados para um estado anterior.</span><span class="sxs-lookup"><span data-stu-id="76fdb-117">Recovery from unwanted modification or deletion of data may require restoring data to a previous state.</span></span> <span data-ttu-id="76fdb-118">Isso pode ser obtido aproveitando as capacidades fornecidas pelo Azure para armazenar e manter cópias pontuais.</span><span class="sxs-lookup"><span data-stu-id="76fdb-118">This can be achieved by taking advantage of the capabilities provided by Azure to store and retain point-in-time copies.</span></span>

<span data-ttu-id="76fdb-119">Para Blobs do Azure, você pode executar backups pontuais usando o [recurso de instantâneo de blob](https://msdn.microsoft.com/library/ee691971.aspx).</span><span class="sxs-lookup"><span data-stu-id="76fdb-119">For Azure Blobs, you can perform point-in-time backups using the [blob snapshot feature](https://msdn.microsoft.com/library/ee691971.aspx).</span></span> <span data-ttu-id="76fdb-120">Para cada instantâneo, você é cobrado apenas pelo armazenamento necessário para armazenar as diferenças no blob desde o último estado do instantâneo.</span><span class="sxs-lookup"><span data-stu-id="76fdb-120">For each snapshot, you are only charged for the storage required to store the differences within the blob since the last snapshot state.</span></span> <span data-ttu-id="76fdb-121">Os instantâneos são dependentes da existência do blob original nos quais se baseiam, portanto, uma operação de cópia para outro blob ou até mesmo outra conta de armazenamento é aconselhável.</span><span class="sxs-lookup"><span data-stu-id="76fdb-121">The snapshots are dependent on the existence of the original blob they are based on, so a copy operation to another blob or even another storage account is advisable.</span></span> <span data-ttu-id="76fdb-122">Isso garante que os dados de backup estejam adequadamente protegidos contra exclusão acidental.</span><span class="sxs-lookup"><span data-stu-id="76fdb-122">This ensures that backup data is properly protected against accidental deletion.</span></span> <span data-ttu-id="76fdb-123">Para tabelas do Azure, você pode fazer cópias pontuais em uma tabela diferente ou nos Blobs do Azure.</span><span class="sxs-lookup"><span data-stu-id="76fdb-123">For Azure Tables, you can make point-in-time copies to a different table or to Azure Blobs.</span></span> <span data-ttu-id="76fdb-124">Diretrizes e exemplos mais detalhados de como efetuar backups de aplicativo de tabelas e blobs podem ser encontrados aqui:</span><span class="sxs-lookup"><span data-stu-id="76fdb-124">More detailed guidance and examples of performing application-level backups of tables and blobs can be found here:</span></span>

* [<span data-ttu-id="76fdb-125">Protegendo suas tabelas contra erros de aplicativo</span><span class="sxs-lookup"><span data-stu-id="76fdb-125">Protecting Your Tables Against Application Errors</span></span>](https://blogs.msdn.microsoft.com/windowsazurestorage/2010/05/03/protecting-your-tables-against-application-errors/)
* [<span data-ttu-id="76fdb-126">Protegendo seus blobs contra erros de aplicativo</span><span class="sxs-lookup"><span data-stu-id="76fdb-126">Protecting Your Blobs Against Application Errors</span></span>](https://blogs.msdn.microsoft.com/windowsazurestorage/2010/04/29/protecting-your-blobs-against-application-errors/)

## <a name="database"></a><span data-ttu-id="76fdb-127">Banco de dados</span><span class="sxs-lookup"><span data-stu-id="76fdb-127">Database</span></span>
<span data-ttu-id="76fdb-128">Há várias opções de [continuidade de negócios](/azure/sql-database/sql-database-business-continuity/) (backup, restauração) disponíveis para o banco de dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="76fdb-128">There are several [business continuity](/azure/sql-database/sql-database-business-continuity/) (backup, restore) options available for Azure SQL Database.</span></span> <span data-ttu-id="76fdb-129">Os bancos de dados podem ser copiados usando a funcionalidade de [Cópia de Banco de Dados](/azure/sql-database/sql-database-copy/) ou [exportando](/azure/sql-database/sql-database-export/) e [importando](https://msdn.microsoft.com/library/hh710052.aspx) um arquivo bacpac do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="76fdb-129">Databases can be copied by using the [Database Copy](/azure/sql-database/sql-database-copy/) functionality, or by  [exporting](/azure/sql-database/sql-database-export/) and [importing](https://msdn.microsoft.com/library/hh710052.aspx) a SQL Server bacpac file.</span></span> <span data-ttu-id="76fdb-130">A Cópia de Banco de Dados fornece resultados transacionalmente consistentes, enquanto um bacpac (por meio do serviço de importação/exportação), não.</span><span class="sxs-lookup"><span data-stu-id="76fdb-130">Database Copy provides transactionally consistent results, while a bacpac (through the import/export service) does not.</span></span> <span data-ttu-id="76fdb-131">Essas duas opções são executadas como serviços baseados em fila no datacenter e atualmente não fornecem um SLA de tempo de conclusão.</span><span class="sxs-lookup"><span data-stu-id="76fdb-131">Both of these options run as queue-based services within the data center, and they do not currently provide a time-to-completion SLA.</span></span>

> [!NOTE]
> <span data-ttu-id="76fdb-132">As opções de importação/exportação e cópia de banco de dados impõem um grau significativo de carga no banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="76fdb-132">The database copy and import/export options place a significant degree of load on the source database.</span></span> <span data-ttu-id="76fdb-133">Elas podem disparar a contenção de recursos ou eventos de limitação.</span><span class="sxs-lookup"><span data-stu-id="76fdb-133">They can trigger resource contention or throttling events.</span></span>
> 
> 

### <a name="sql-database-backup"></a><span data-ttu-id="76fdb-134">Backup do banco de dados SQL</span><span class="sxs-lookup"><span data-stu-id="76fdb-134">SQL Database Backup</span></span>
<span data-ttu-id="76fdb-135">Backups pontuais para o Banco de Dados SQL do Microsoft Azure são obtidos ao [Copiar seu banco de dados SQL do Azure](/azure/sql-database/sql-database-copy/).</span><span class="sxs-lookup"><span data-stu-id="76fdb-135">Point-in-time backups for Microsoft Azure SQL Database are achieved by [copying your Azure SQL database](/azure/sql-database/sql-database-copy/).</span></span> <span data-ttu-id="76fdb-136">Você pode usar esse comando para criar uma cópia transacionalmente consistente de um banco de dados no mesmo servidor de banco de dados lógico ou em um servidor diferente.</span><span class="sxs-lookup"><span data-stu-id="76fdb-136">You can use this command to create a transactionally consistent copy of a database on the same logical database server or to a different server.</span></span> <span data-ttu-id="76fdb-137">Em ambos os casos, a cópia do banco de dados é totalmente funcional e completamente independente do banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="76fdb-137">In either case, the database copy is fully functional and completely independent of the source database.</span></span> <span data-ttu-id="76fdb-138">Cada cópia que você cria representa uma opção de recuperação pontual.</span><span class="sxs-lookup"><span data-stu-id="76fdb-138">Each copy you create represents a point-in-time recovery option.</span></span> <span data-ttu-id="76fdb-139">Você pode recuperar o estado do banco de dados completamente renomeando o novo banco de dados com o nome do banco de dados de origem.</span><span class="sxs-lookup"><span data-stu-id="76fdb-139">You can recover the database state completely by renaming the new database with the source database name.</span></span> <span data-ttu-id="76fdb-140">Como alternativa, você pode recuperar um subconjunto específico de dados do novo banco de dados usando consultas Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="76fdb-140">Alternatively, you can recover a specific subset of data from the new database by using Transact-SQL queries.</span></span> <span data-ttu-id="76fdb-141">Para obter detalhes adicionais sobre Banco de Dados SQL, consulte [Visão geral da continuidade de negócios com o Banco de Dados SQL](/azure/sql-database/sql-database-business-continuity/).</span><span class="sxs-lookup"><span data-stu-id="76fdb-141">For additional details about SQL Database, see [Overview of business continuity with Azure SQL Database](/azure/sql-database/sql-database-business-continuity/).</span></span>

### <a name="sql-server-on-virtual-machines-backup"></a><span data-ttu-id="76fdb-142">SQL Server em backup de máquinas virtuais</span><span class="sxs-lookup"><span data-stu-id="76fdb-142">SQL Server on Virtual Machines Backup</span></span>
<span data-ttu-id="76fdb-143">Para o SQL Server usado com as máquinas virtuais de infraestrutura como serviço do Azure (geralmente chamadas de IaaS ou VMs de IaaS), há duas opções: backups tradicionais e envio de logs.</span><span class="sxs-lookup"><span data-stu-id="76fdb-143">For SQL Server used with Azure infrastructure as a service virtual machines (often called IaaS or IaaS VMs), there are two options: traditional backups and log shipping.</span></span> <span data-ttu-id="76fdb-144">O uso de backups tradicionais permite restaurar para um ponto específico no tempo, mas o processo de recuperação é lento.</span><span class="sxs-lookup"><span data-stu-id="76fdb-144">Using traditional backups enables you to restore to a specific point in time, but the recovery process is slow.</span></span> <span data-ttu-id="76fdb-145">A restauração de backups tradicionais exige começar com um backup inicial completo e aplicar quaisquer backups feitos depois disso.</span><span class="sxs-lookup"><span data-stu-id="76fdb-145">Restoring traditional backups requires starting with an initial full backup, and then applying any backups taken after that.</span></span> <span data-ttu-id="76fdb-146">A segunda opção é configurar uma sessão de envio de logs para atrasar a restauração de backups de log (por exemplo, por duas horas).</span><span class="sxs-lookup"><span data-stu-id="76fdb-146">The second option is to configure a log shipping session to delay the restore of log backups (for example, by two hours).</span></span> <span data-ttu-id="76fdb-147">Isso fornece uma janela para recuperação de erros feitos no primário.</span><span class="sxs-lookup"><span data-stu-id="76fdb-147">This provides a window to recover from errors made on the primary.</span></span>

## <a name="other-azure-platform-services"></a><span data-ttu-id="76fdb-148">Outros serviços da plataforma Azure</span><span class="sxs-lookup"><span data-stu-id="76fdb-148">Other Azure platform services</span></span>
<span data-ttu-id="76fdb-149">Alguns serviços da plataforma Azure armazenam informações em uma conta de armazenamento controlada pelo usuário ou banco de dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="76fdb-149">Some Azure platform services store information in a user-controlled storage account or Azure SQL Database.</span></span> <span data-ttu-id="76fdb-150">Se o recurso de conta ou armazenamento for excluído ou corrompido, isso poderá causar erros graves no serviço.</span><span class="sxs-lookup"><span data-stu-id="76fdb-150">If the account or storage resource is deleted or corrupted, this could cause serious errors with the service.</span></span> <span data-ttu-id="76fdb-151">Nesses casos, é importante manter os backups que permitiriam recriar esses recursos caso eles sejam excluídos ou corrompidos.</span><span class="sxs-lookup"><span data-stu-id="76fdb-151">In these cases, it is important to maintain backups that would enable you to re-create these resources if they were deleted or corrupted.</span></span>

<span data-ttu-id="76fdb-152">Para sites do Azure e Serviços Móveis do Azure, você deve fazer o backup e a manutenção dos bancos de dados associados.</span><span class="sxs-lookup"><span data-stu-id="76fdb-152">For Azure Web Sites and Azure Mobile Services, you must backup and maintain the associated databases.</span></span> <span data-ttu-id="76fdb-153">Para o serviço de mídia do Azure e máquinas virtuais, você deve manter a conta de armazenamento do Azure associada e todos os recursos dessa conta.</span><span class="sxs-lookup"><span data-stu-id="76fdb-153">For Azure Media Service and Virtual Machines, you must maintain the associated Azure Storage account and all resources in that account.</span></span> <span data-ttu-id="76fdb-154">Por exemplo, para Máquinas Virtuais, você deve fazer backup e gerenciar os discos de VM no armazenamento de blobs do Azure.</span><span class="sxs-lookup"><span data-stu-id="76fdb-154">For example, for Virtual Machines, you must back up and manage the VM disks in Azure blob storage.</span></span>

## <a name="checklists-for-data-corruption-or-accidental-deletion"></a><span data-ttu-id="76fdb-155">Listas de verificação de dados corrompidos ou exclusão acidental</span><span class="sxs-lookup"><span data-stu-id="76fdb-155">Checklists for data corruption or accidental deletion</span></span>
## <a name="virtual-machines-checklist"></a><span data-ttu-id="76fdb-156">Lista de verificação de Máquinas Virtuais</span><span class="sxs-lookup"><span data-stu-id="76fdb-156">Virtual Machines checklist</span></span>
1. <span data-ttu-id="76fdb-157">Confira a seção Máquinas Virtuais deste documento.</span><span class="sxs-lookup"><span data-stu-id="76fdb-157">Review the Virtual Machines section of this document.</span></span>
2. <span data-ttu-id="76fdb-158">Faça backup e manutenção dos discos de VM com o Backup do Azure (ou seu próprio sistema de backup usando o armazenamento de blobs do Azure e instantâneos de VHD).</span><span class="sxs-lookup"><span data-stu-id="76fdb-158">Back up and maintain the VM disks with Azure Backup (or your own backup system by using Azure blob storage and VHD snapshots).</span></span>

## <a name="storage-checklist"></a><span data-ttu-id="76fdb-159">Lista de verificação de armazenamento</span><span class="sxs-lookup"><span data-stu-id="76fdb-159">Storage checklist</span></span>
1. <span data-ttu-id="76fdb-160">Examine a seção Armazenamento deste documento.</span><span class="sxs-lookup"><span data-stu-id="76fdb-160">Review the Storage section of this document.</span></span>
2. <span data-ttu-id="76fdb-161">Faça backups regulares dos recursos de armazenamento críticos.</span><span class="sxs-lookup"><span data-stu-id="76fdb-161">Regularly back up critical storage resources.</span></span>
3. <span data-ttu-id="76fdb-162">Considere o uso do recurso de instantâneo para blobs.</span><span class="sxs-lookup"><span data-stu-id="76fdb-162">Consider using the snapshot feature for blobs.</span></span>

## <a name="database-checklist"></a><span data-ttu-id="76fdb-163">Lista de verificação de banco de dados</span><span class="sxs-lookup"><span data-stu-id="76fdb-163">Database checklist</span></span>
1. <span data-ttu-id="76fdb-164">Examine a seção Banco de dados deste documento.</span><span class="sxs-lookup"><span data-stu-id="76fdb-164">Review the Database section of this document.</span></span>
2. <span data-ttu-id="76fdb-165">Crie backups pontuais usando o comando Cópia de Banco de Dados.</span><span class="sxs-lookup"><span data-stu-id="76fdb-165">Create point-in-time backups by using the Database Copy command.</span></span>

## <a name="sql-server-on-virtual-machines-backup-checklist"></a><span data-ttu-id="76fdb-166">Lista de verificação do SQL Server em backup de máquinas virtuais</span><span class="sxs-lookup"><span data-stu-id="76fdb-166">SQL Server on Virtual Machines Backup checklist</span></span>
1. <span data-ttu-id="76fdb-167">Leia a seção SQL Server em backup de máquinas virtuais deste documento.</span><span class="sxs-lookup"><span data-stu-id="76fdb-167">Review the SQL Server on Virtual Machines Backup section of this document.</span></span>
2. <span data-ttu-id="76fdb-168">Use técnicas tradicionais de backup e restauração.</span><span class="sxs-lookup"><span data-stu-id="76fdb-168">Use traditional backup and restore techniques.</span></span>
3. <span data-ttu-id="76fdb-169">Crie uma sessão de envio de logs em atraso.</span><span class="sxs-lookup"><span data-stu-id="76fdb-169">Create a delayed log shipping session.</span></span>

## <a name="web-apps-checklist"></a><span data-ttu-id="76fdb-170">Lista de verificação de aplicativos Web</span><span class="sxs-lookup"><span data-stu-id="76fdb-170">Web Apps checklist</span></span>
1. <span data-ttu-id="76fdb-171">Faça backup e manutenção do banco de dados associado, se houver.</span><span class="sxs-lookup"><span data-stu-id="76fdb-171">Back up and maintain the associated database, if any.</span></span>

## <a name="media-services-checklist"></a><span data-ttu-id="76fdb-172">Lista de verificação dos Serviços de Mídia</span><span class="sxs-lookup"><span data-stu-id="76fdb-172">Media Services checklist</span></span>
1. <span data-ttu-id="76fdb-173">Faça backup e manutenção dos recursos de armazenamento associados.</span><span class="sxs-lookup"><span data-stu-id="76fdb-173">Back up and maintain the associated storage resources.</span></span>

## <a name="more-information"></a><span data-ttu-id="76fdb-174">Mais informações</span><span class="sxs-lookup"><span data-stu-id="76fdb-174">More information</span></span>
<span data-ttu-id="76fdb-175">Para saber mais sobre recursos de backup e restauração no Azure, confira [Cenários de armazenamento, backup e recuperação](https://azure.microsoft.com/documentation/scenarios/storage-backup-recovery/).</span><span class="sxs-lookup"><span data-stu-id="76fdb-175">For more information about backup and restore features in Azure, see [Storage, backup and recovery scenarios](https://azure.microsoft.com/documentation/scenarios/storage-backup-recovery/).</span></span>


