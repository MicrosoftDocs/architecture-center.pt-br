---
title: Proteger aplicativo Web do Windows para setores regulamentados
description: Crie um aplicativo Web seguro e de várias camadas com o Windows Server no Azure usando conjuntos de dimensionamento, o Gateway de Aplicativo e balanceadores de carga.
author: iainfoulds
ms.date: 07/11/2018
ms.openlocfilehash: 584b5891f9b3d8e174c3eb29835a525ae4a4f156
ms.sourcegitcommit: b2a4eb132857afa70201e28d662f18458865a48e
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/05/2018
ms.locfileid: "48818999"
---
# <a name="secure-windows-web-application-for-regulated-industries"></a><span data-ttu-id="4ec37-103">Proteger aplicativo Web do Windows para setores regulamentados</span><span class="sxs-lookup"><span data-stu-id="4ec37-103">Secure Windows web application for regulated industries</span></span>

<span data-ttu-id="4ec37-104">Este exemplo de cenário é aplicável para setores regulamentados que têm uma necessidade de proteger aplicativos de várias camadas.</span><span class="sxs-lookup"><span data-stu-id="4ec37-104">This example scenario is applicable to regulated industries that have a need to secure multi-tier applications.</span></span> <span data-ttu-id="4ec37-105">Nesse cenário, um aplicativo ASP.NET de front-end se conecta de forma segura a um cluster de Microsoft SQL Server de back-end protegido.</span><span class="sxs-lookup"><span data-stu-id="4ec37-105">In this scenario, a front-end ASP.NET application securely connects to a protected back-end Microsoft SQL Server cluster.</span></span>

<span data-ttu-id="4ec37-106">Os cenários de aplicativo de exemplo incluem a execução de aplicativos de sala de operações, horas marcadas de pacientes e manutenção de registros ou renovação e pedidos de receitas médicas.</span><span class="sxs-lookup"><span data-stu-id="4ec37-106">Example application scenarios include running operating room applications, patient appointments and records keeping, or prescription refills and ordering.</span></span> <span data-ttu-id="4ec37-107">Tradicionalmente, as organizações tinham que manter os aplicativos locais herdados e os serviços para esses cenários.</span><span class="sxs-lookup"><span data-stu-id="4ec37-107">Traditionally, organizations had to maintain legacy on-premises applications and services for these scenarios.</span></span> <span data-ttu-id="4ec37-108">Com uma maneira segura de forma e escalonável para implantar esses aplicativos do Windows Server no Azure, as organizações podem modernizar sua implantações e reduzir seus custos operacionais locais e despesas gerais de manutenção.</span><span class="sxs-lookup"><span data-stu-id="4ec37-108">With a secure way and scalable way to deploy these Windows Server applications in Azure, organizations can modernize their deployments are reduce their on-premises operating costs and management overhead.</span></span>

## <a name="relevant-use-cases"></a><span data-ttu-id="4ec37-109">Casos de uso relevantes</span><span class="sxs-lookup"><span data-stu-id="4ec37-109">Relevant use cases</span></span>

<span data-ttu-id="4ec37-110">Considere este cenário para os casos de uso a seguir:</span><span class="sxs-lookup"><span data-stu-id="4ec37-110">Consider this scenario for the following use cases:</span></span>

* <span data-ttu-id="4ec37-111">Modernizar as implantações de aplicativo em um ambiente de nuvem seguro.</span><span class="sxs-lookup"><span data-stu-id="4ec37-111">Modernizing application deployments in a secure cloud environment.</span></span>
* <span data-ttu-id="4ec37-112">Reduzir o gerenciamento de serviços e aplicativos locais herdados.</span><span class="sxs-lookup"><span data-stu-id="4ec37-112">Reducing legacy on-premises application and service management.</span></span>
* <span data-ttu-id="4ec37-113">Melhorar a saúde e experiência de pacientes com novas plataformas de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4ec37-113">Improving patient healthcare and experience with new application platforms.</span></span>

## <a name="architecture"></a><span data-ttu-id="4ec37-114">Arquitetura</span><span class="sxs-lookup"><span data-stu-id="4ec37-114">Architecture</span></span>

![Visão geral da arquitetura dos componentes do Azure envolvidos no aplicativo do Windows Server de várias camadas para setores regulamentados][architecture]

<span data-ttu-id="4ec37-116">Este cenário aborda um aplicativo de setores regulamentados de várias camadas que usa o ASP.NET e o Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4ec37-116">This scenario covers a multi-tier regulated industries application that uses ASP.NET and Microsoft SQL Server.</span></span> <span data-ttu-id="4ec37-117">O fluxo de dados neste cenário ocorre da seguinte forma:</span><span class="sxs-lookup"><span data-stu-id="4ec37-117">The data flows through the scenario as follows:</span></span>

1. <span data-ttu-id="4ec37-118">Os usuários acessam o aplicativo front-end de setores regulamentados do ASP.NET por meio de um Gateway de Aplicativo do Azure.</span><span class="sxs-lookup"><span data-stu-id="4ec37-118">Users access the front-end ASP.NET regulated industries application through an Azure Application Gateway.</span></span>
2. <span data-ttu-id="4ec37-119">O Gateway de Aplicativo distribui o tráfego para instâncias de VM dentro de um conjunto de dimensionamento de máquina virtual do Azure.</span><span class="sxs-lookup"><span data-stu-id="4ec37-119">The Application Gateway distributes traffic to VM instances within an Azure virtual machine scale set.</span></span>
3. <span data-ttu-id="4ec37-120">O aplicativo ASP.NET conecta-se ao cluster do Microsoft SQL Server em uma camada de back-end por meio de um balanceador de carga do Azure.</span><span class="sxs-lookup"><span data-stu-id="4ec37-120">The ASP.NET application connects to Microsoft SQL Server cluster in a back-end tier via an Azure load balancer.</span></span> <span data-ttu-id="4ec37-121">Essas instâncias do SQL Server de back-end estão em uma rede virtual separada do Azure, protegida pelas regras do grupo de segurança de rede que limitam o fluxo de tráfego.</span><span class="sxs-lookup"><span data-stu-id="4ec37-121">These back-end SQL Server instances are in a separate Azure virtual network, secured by network security group rules that limit traffic flow.</span></span>
4. <span data-ttu-id="4ec37-122">O balanceador de carga distribui o tráfego do SQL Server para instâncias de VM em outro conjunto de dimensionamento de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="4ec37-122">The load balancer distributes SQL Server traffic to VM instances in another virtual machine scale set.</span></span>
5. <span data-ttu-id="4ec37-123">O Armazenamento de Blobs do Azure atua como uma Testemunha de Nuvem para o cluster do SQL Server na camada de back-end.</span><span class="sxs-lookup"><span data-stu-id="4ec37-123">Azure Blob Storage acts as a Cloud Witness for the SQL Server cluster in the back-end tier.</span></span> <span data-ttu-id="4ec37-124">A conexão de dentro da VNet é habilitado com um ponto de extremidade de serviço de rede virtual para o Armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="4ec37-124">The connection from within the VNet is enabled with a VNet Service Endpoint for Azure Storage.</span></span>

### <a name="components"></a><span data-ttu-id="4ec37-125">Componentes</span><span class="sxs-lookup"><span data-stu-id="4ec37-125">Components</span></span>

* <span data-ttu-id="4ec37-126">O [Gateway de Aplicativo do Azure][appgateway-docs] é um balanceador de carga de tráfego da Web do protocolo Layer 7 que reconhece aplicativos e pode distribuir o tráfego com base em regras de roteamento específicas.</span><span class="sxs-lookup"><span data-stu-id="4ec37-126">[Azure Application Gateway][appgateway-docs] is a layer 7 web traffic load balancer that is application-aware and can distribute traffic based on specific routing rules.</span></span> <span data-ttu-id="4ec37-127">Gateway de aplicativo também pode lidar com o descarregamento de SSL para um desempenho de servidor Web aprimorado.</span><span class="sxs-lookup"><span data-stu-id="4ec37-127">App Gateway can also handle SSL offloading for improved web server performance.</span></span>
* <span data-ttu-id="4ec37-128">A [Rede Virtual do Azure][vnet-docs] permite vários tipos de recursos, como VMs do Azure, a fim de se comunicar de forma segura com a Internet, com as redes locais e com outras VMs.</span><span class="sxs-lookup"><span data-stu-id="4ec37-128">[Azure Virtual Network][vnet-docs] allows resources such as VMs to securely communicate with each other, the Internet, and on-premises networks.</span></span> <span data-ttu-id="4ec37-129">Redes virtuais fornecem isolamento e segmentação, filtram e roteiam o tráfego e permitem a conexão entre locais.</span><span class="sxs-lookup"><span data-stu-id="4ec37-129">Virtual networks provide isolation and segmentation, filter and route traffic, and allow connection between locations.</span></span> <span data-ttu-id="4ec37-130">Duas redes virtuais combinadas com os NSGs apropriados são usadas neste cenário para fornecer uma [zona desmilitarizada][dmz] (DMZ) e o isolamento dos componentes do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4ec37-130">Two virtual networks combined with the appropriate NSGs are used in this scenario to provide a [demilitarized zone][dmz] (DMZ) and isolation of the application components.</span></span> <span data-ttu-id="4ec37-131">O emparelhamento de rede virtual conecta as duas redes.</span><span class="sxs-lookup"><span data-stu-id="4ec37-131">Virtual network peering connects the two networks together.</span></span>
* <span data-ttu-id="4ec37-132">O [conjunto de dimensionamento de máquinas virtuais do Azure][scaleset-docs] permite criar e gerenciar um grupo de VMs idênticas e com balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="4ec37-132">[Azure virtual machine scale set][scaleset-docs] lets you create and manager a group of identical, load balanced, VMs.</span></span> <span data-ttu-id="4ec37-133">O número de instâncias de VM pode aumentar ou diminuir automaticamente em resposta à demanda ou a um agendamento definido.</span><span class="sxs-lookup"><span data-stu-id="4ec37-133">The number of VM instances can automatically increase or decrease in response to demand or a defined schedule.</span></span> <span data-ttu-id="4ec37-134">Dois conjuntos de dimensionamento de máquina virtual separados são usados nesse cenário: um para as instâncias de aplicativos ASP.NET front-end e outro para as instâncias de VM do cluster de SQL Server de back-end.</span><span class="sxs-lookup"><span data-stu-id="4ec37-134">Two separate virtual machine scale sets are used in this scenario - one for the front-end ASP.NET application instances, and one for the back-end SQL Server cluster VM instances.</span></span> <span data-ttu-id="4ec37-135">A configuração de estado desejado (DSC) do PowerShell ou a extensão de script personalizado do Azure pode ser usada para provisionar as instâncias de VM com o software e as definições de configuração necessárias.</span><span class="sxs-lookup"><span data-stu-id="4ec37-135">PowerShell desired state configuration (DSC) or the Azure custom script extension can be used to provision the VM instances with the required software and configuration settings.</span></span>
* <span data-ttu-id="4ec37-136">[Grupos de segurança de rede do Azure][nsg-docs] contêm uma lista de regras de segurança que permitem ou negam o tráfego de rede de entrada ou saída com base no endereço IP de origem ou destino, na porta e no protocolo.</span><span class="sxs-lookup"><span data-stu-id="4ec37-136">[Azure network security groups][nsg-docs] contain a list of security rules that allow or deny inbound or outbound network traffic based on source or destination IP address, port, and protocol.</span></span> <span data-ttu-id="4ec37-137">As redes virtuais neste cenário são protegidas com regras de grupo de segurança de rede que restringem o fluxo de tráfego entre os componentes do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4ec37-137">The virtual networks in this scenario are secured with network security group rules that restrict the flow of traffic between the application components.</span></span>
* <span data-ttu-id="4ec37-138">O [balanceador de carga do Azure][loadbalancer-docs] distribui o tráfego de entrada de acordo com regras e investigações de integridade.</span><span class="sxs-lookup"><span data-stu-id="4ec37-138">[Azure load balancer][loadbalancer-docs] distributes inbound traffic according to rules and health probes.</span></span> <span data-ttu-id="4ec37-139">O balanceador de carga fornece baixa latência e alta taxa de transferência e pode ser escalado verticalmente em milhões de fluxos para aplicativos TCP e UDP.</span><span class="sxs-lookup"><span data-stu-id="4ec37-139">A load balancer provides low latency and high throughput, and scales up to millions of flows for all TCP and UDP applications.</span></span> <span data-ttu-id="4ec37-140">Um balanceador de carga interno é usado neste cenário para distribuir o tráfego da camada de aplicativo front-end para o cluster do SQL Server de back-end.</span><span class="sxs-lookup"><span data-stu-id="4ec37-140">An internal load balancer is used in this scenario to distribute traffic from the front-end application tier to the back-end SQL Server cluster.</span></span>
* <span data-ttu-id="4ec37-141">O [Armazenamento de Blobs][cloudwitness-docs] do Azure atua como uma testemunha de nuvem para o cluster do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4ec37-141">[Azure Blob Storage][cloudwitness-docs] acts a Cloud Witness location for the SQL Server cluster.</span></span> <span data-ttu-id="4ec37-142">Este testemunha é usada para operações de cluster e as decisões que exigem um voto adicional para decidir o quorum.</span><span class="sxs-lookup"><span data-stu-id="4ec37-142">This witness is used for cluster operations and decisions that require an additional vote to decide quorum.</span></span> <span data-ttu-id="4ec37-143">Usar testemunha de nuvem elimina a necessidade de uma VM adicional atuar como uma testemunha de compartilhamento de arquivos tradicional.</span><span class="sxs-lookup"><span data-stu-id="4ec37-143">Using Cloud Witness removes the need for an additional VM to act as a traditional File Share Witness.</span></span>

### <a name="alternatives"></a><span data-ttu-id="4ec37-144">Alternativas</span><span class="sxs-lookup"><span data-stu-id="4ec37-144">Alternatives</span></span>

* <span data-ttu-id="4ec37-145">\*O Nix, no Windows, pode ser facilmente substituído por vários outros sistemas operacionais como se nada na infraestrutura dependesse do sistema operacional.</span><span class="sxs-lookup"><span data-stu-id="4ec37-145">\*nix, windows can easily be replaced by a variety of other operating systems as nothing in the infrastructure depends on the operating system.</span></span>

* <span data-ttu-id="4ec37-146">[SQL Server para Linux][sql-linux] pode substituir o armazenamento de dados de back-end.</span><span class="sxs-lookup"><span data-stu-id="4ec37-146">[SQL Server for Linux][sql-linux] can replace the back-end data store.</span></span>

* <span data-ttu-id="4ec37-147">O [Cosmos DB](/azure/cosmos-db/introduction) é outra alternativa para o armazenamento de dados.</span><span class="sxs-lookup"><span data-stu-id="4ec37-147">[Cosmos DB](/azure/cosmos-db/introduction) is another alternative for the data store.</span></span>

## <a name="considerations"></a><span data-ttu-id="4ec37-148">Considerações</span><span class="sxs-lookup"><span data-stu-id="4ec37-148">Considerations</span></span>

### <a name="availability"></a><span data-ttu-id="4ec37-149">Disponibilidade</span><span class="sxs-lookup"><span data-stu-id="4ec37-149">Availability</span></span>

<span data-ttu-id="4ec37-150">Nesse cenário, as instâncias de VM são implantadas em Zonas de Disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="4ec37-150">The VM instances in this scenario are deployed across Availability Zones.</span></span> <span data-ttu-id="4ec37-151">Cada zona é composta por um ou mais datacenters equipados com energia, resfriamento e rede independentes.</span><span class="sxs-lookup"><span data-stu-id="4ec37-151">Each zone is made up of one or more datacenters equipped with independent power, cooling, and networking.</span></span> <span data-ttu-id="4ec37-152">Um mínimo de três zonas estão disponíveis em todas as regiões habilitadas.</span><span class="sxs-lookup"><span data-stu-id="4ec37-152">A minimum of three zones are available in all enabled regions.</span></span> <span data-ttu-id="4ec37-153">Essa distribuição de instâncias de VM em zonas fornece alta disponibilidade para as camadas de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4ec37-153">This distribution of VM instances across zones provides high availability to the application tiers.</span></span> <span data-ttu-id="4ec37-154">Para obter mais informações, consulte [o que são Zonas de Disponibilidade no Azure?][azureaz-docs]</span><span class="sxs-lookup"><span data-stu-id="4ec37-154">For more information, see [what are Availability Zones in Azure?][azureaz-docs]</span></span>

<span data-ttu-id="4ec37-155">A camada de banco de dados pode ser configurada para usar grupos de disponibilidade Always On.</span><span class="sxs-lookup"><span data-stu-id="4ec37-155">The database tier can be configured to use Always On availability groups.</span></span> <span data-ttu-id="4ec37-156">Com essa configuração do SQL Server, um banco de dados primário em um cluster é configurado com até oito bancos de dados secundários.</span><span class="sxs-lookup"><span data-stu-id="4ec37-156">With this SQL Server configuration, one primary database within a cluster is configured with up to eight secondary databases.</span></span> <span data-ttu-id="4ec37-157">Se ocorrer um problema com o banco de dados primário, o cluster faz o failover para um banco de dados secundários, permitindo que o aplicativo continue disponível.</span><span class="sxs-lookup"><span data-stu-id="4ec37-157">If an issue occurs with the primary database, the cluster fails over to one of the secondary databases, which allows the application to continue to be available.</span></span> <span data-ttu-id="4ec37-158">Para saber mais informações, confira [Visão geral dos grupos de disponibilidade Always On para SQL Server][sqlalwayson-docs].</span><span class="sxs-lookup"><span data-stu-id="4ec37-158">For more information, see [Overview of Always On availability groups for SQL Server][sqlalwayson-docs].</span></span>

<span data-ttu-id="4ec37-159">Para ver outros tópicos sobre disponibilidade, consulte a [lista de verificação de disponibilidade][availability] no Azure Architecture Center.</span><span class="sxs-lookup"><span data-stu-id="4ec37-159">For other availability topics, see the [availability checklist][availability] in the Azure Architecture Center.</span></span>

### <a name="scalability"></a><span data-ttu-id="4ec37-160">Escalabilidade</span><span class="sxs-lookup"><span data-stu-id="4ec37-160">Scalability</span></span>

<span data-ttu-id="4ec37-161">Esse cenário usa conjuntos de dimensionamento de máquina virtual para os componentes front-end e back-end.</span><span class="sxs-lookup"><span data-stu-id="4ec37-161">This scenario uses virtual machine scale sets for the front-end and back-end components.</span></span> <span data-ttu-id="4ec37-162">Com conjuntos de dimensionamento, o número de instâncias VM que executam a camada de aplicativo front-end pode dimensionar automaticamente em resposta à demanda do cliente ou com base em um agendamento definido.</span><span class="sxs-lookup"><span data-stu-id="4ec37-162">With scale sets, the number of VM instances that run the front-end application tier can automatically scale in response to customer demand, or based on a defined schedule.</span></span> <span data-ttu-id="4ec37-163">Para saber mais, veja [Visão geral sobre dimensionamento automático com conjuntos de dimensionamento de máquinas virtuais][vmssautoscale-docs].</span><span class="sxs-lookup"><span data-stu-id="4ec37-163">For more information, see [Overview of autoscale with virtual machine scale sets][vmssautoscale-docs].</span></span>

<span data-ttu-id="4ec37-164">Para outros tópicos de escalabilidade, confira a [lista de verificação de escalabilidade] [ scalability] no Azure Architecture Center.</span><span class="sxs-lookup"><span data-stu-id="4ec37-164">For other scalability topics, see the [scalability checklist][scalability] in the Azure Architecture Center.</span></span>

### <a name="security"></a><span data-ttu-id="4ec37-165">Segurança</span><span class="sxs-lookup"><span data-stu-id="4ec37-165">Security</span></span>

<span data-ttu-id="4ec37-166">Todo o tráfego de rede virtual para a camada de aplicativo front-end é protegido por grupos de segurança de rede.</span><span class="sxs-lookup"><span data-stu-id="4ec37-166">All the virtual network traffic into the front-end application tier and protected by network security groups.</span></span> <span data-ttu-id="4ec37-167">As regras limitam o fluxo de tráfego para que somente as instâncias de VM da camada de aplicativo front-end possam acessar a camada de banco de dados de back-end.</span><span class="sxs-lookup"><span data-stu-id="4ec37-167">Rules limit the flow of traffic so that only the front-end application tier VM instances can access the back-end database tier.</span></span> <span data-ttu-id="4ec37-168">Nenhum tráfego de Internet de saída é permitido da camada de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="4ec37-168">No outbound Internet traffic is allowed from the database tier.</span></span> <span data-ttu-id="4ec37-169">Para reduzir a superfície de ataque, nenhuma porta de gerenciamento remoto direto fica aberta.</span><span class="sxs-lookup"><span data-stu-id="4ec37-169">To reduce the attack footprint, no direct remote management ports are open.</span></span> <span data-ttu-id="4ec37-170">Para saber mais, confira [Grupos de segurança de rede do Azure][nsg-docs].</span><span class="sxs-lookup"><span data-stu-id="4ec37-170">For more information, see [Azure network security groups][nsg-docs].</span></span>

<span data-ttu-id="4ec37-171">Para exibir as diretrizes sobre como implantar a [infraestrutura compatível com][pci-dss] Payment Card Industry Data Security Standards (PCI DSS 3.2).</span><span class="sxs-lookup"><span data-stu-id="4ec37-171">To view guidance on deploying Payment Card Industry Data Security Standards (PCI DSS 3.2) [compliant infrastructure][pci-dss].</span></span> <span data-ttu-id="4ec37-172">Para obter orientação geral sobre como criar soluções seguras, confira a [Documentação de segurança do Azure][security].</span><span class="sxs-lookup"><span data-stu-id="4ec37-172">For general guidance on designing secure scenarios, see the [Azure Security Documentation][security].</span></span>

### <a name="resiliency"></a><span data-ttu-id="4ec37-173">Resiliência</span><span class="sxs-lookup"><span data-stu-id="4ec37-173">Resiliency</span></span>

<span data-ttu-id="4ec37-174">Em combinação com o uso de Zonas de Disponibilidade e conjuntos de dimensionamento de máquina virtual, esse cenário usa o Gateway de Aplicativo do Azure e o balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="4ec37-174">In combination with the use of Availability Zones and virtual machine scale sets, this scenario uses Azure Application Gateway and load balancer.</span></span> <span data-ttu-id="4ec37-175">Esses dois componentes de rede distribuem o tráfego para as instâncias de VM conectadas e incluem as investigações de integridade que garantem que o tráfego é distribuído apenas para VMs íntegras.</span><span class="sxs-lookup"><span data-stu-id="4ec37-175">These two networking components distribute traffic to the connected VM instances, and include health probes that ensure traffic is only distributed to healthy VMs.</span></span> <span data-ttu-id="4ec37-176">Duas instâncias de Gateway de Aplicativo são configuradas em uma configuração ativo-passivo, e um balanceador de carga com redundância de zona é usado.</span><span class="sxs-lookup"><span data-stu-id="4ec37-176">Two Application Gateway instances are configured in an active-passive configuration, and a zone-redundant load balancer is used.</span></span> <span data-ttu-id="4ec37-177">Essa configuração torna os recursos de rede e aplicativo resilientes a problemas que, de outra forma, interromperiam o tráfego e impactariam o acesso do usuário final.</span><span class="sxs-lookup"><span data-stu-id="4ec37-177">This configuration makes the networking resources and application resilient to issues that would otherwise disrupt traffic and impact end-user access.</span></span>

<span data-ttu-id="4ec37-178">Para obter diretrizes gerais sobre como criar cenários resilientes, confira [Projetando aplicativos resilientes para o Azure][resiliency].</span><span class="sxs-lookup"><span data-stu-id="4ec37-178">For general guidance on designing resilient scenarios, see [Designing resilient applications for Azure][resiliency].</span></span>

## <a name="deploy-the-scenario"></a><span data-ttu-id="4ec37-179">Implantar o cenário</span><span class="sxs-lookup"><span data-stu-id="4ec37-179">Deploy the scenario</span></span>

<span data-ttu-id="4ec37-180">**Pré-requisitos.**</span><span class="sxs-lookup"><span data-stu-id="4ec37-180">**Prerequisites.**</span></span>

* <span data-ttu-id="4ec37-181">Você deve ter uma conta do Azure já criada.</span><span class="sxs-lookup"><span data-stu-id="4ec37-181">You must have an existing Azure account.</span></span> <span data-ttu-id="4ec37-182">Se você não tiver uma assinatura do Azure, crie uma [conta gratuita](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) antes de começar.</span><span class="sxs-lookup"><span data-stu-id="4ec37-182">If you don't have an Azure subscription, create a [free account](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) before you begin.</span></span>
* <span data-ttu-id="4ec37-183">Para implantar um cluster do SQL Server no conjunto de dimensionamento de back-end, você precisaria de um domínio nos Azure Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="4ec37-183">To deploy a SQL Server cluster into the back-end scale set, you would need a domain in Azure Active Directory (AD) Domain Services.</span></span>

<span data-ttu-id="4ec37-184">Para implantar a infraestrutura básica para esse cenário com um modelo do Azure Resource Manager, execute as etapas a seguir.</span><span class="sxs-lookup"><span data-stu-id="4ec37-184">To deploy the core infrastructure for this scenario with an Azure Resource Manager template, perform the following steps.</span></span>

1. <span data-ttu-id="4ec37-185">Selecione o botão **Implantar no Azure**:</span><span class="sxs-lookup"><span data-stu-id="4ec37-185">Select the **Deploy to Azure** button:</span></span><br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Fsolution-architectures%2Fmaster%2Finfrastructure%2Fregulated-multitier-app%2Fazuredeploy.json" target="_blank"><img src="https://azuredeploy.net/deploybutton.png"/></a>
2. <span data-ttu-id="4ec37-186">Aguarde até que a implantação de modelo seja aberta no portal do Azure e conclua as seguintes etapas:</span><span class="sxs-lookup"><span data-stu-id="4ec37-186">Wait for the template deployment to open in the Azure portal, then complete the following steps:</span></span>
   * <span data-ttu-id="4ec37-187">Escolha **Criar novo** grupo de recursos e insira um nome como *myWindowsscenario* na caixa de texto.</span><span class="sxs-lookup"><span data-stu-id="4ec37-187">Choose to **Create new** resource group, then provide a name such as *myWindowsscenario* in the text box.</span></span>
   * <span data-ttu-id="4ec37-188">Selecione uma região na caixa suspensa **Local**.</span><span class="sxs-lookup"><span data-stu-id="4ec37-188">Select a region from the **Location** drop-down box.</span></span>
   * <span data-ttu-id="4ec37-189">Forneça um nome de usuário e uma senha segura para as instâncias do conjunto de dimensionamento da máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="4ec37-189">Provide a username and secure password for the virtual machine scale set instances.</span></span>
   * <span data-ttu-id="4ec37-190">Analise os termos e condições e marque a opção **Concordo com os termos e condições declarados acima**.</span><span class="sxs-lookup"><span data-stu-id="4ec37-190">Review the terms and conditions, then check **I agree to the terms and conditions stated above**.</span></span>
   * <span data-ttu-id="4ec37-191">Selecione o botão **Comprar**.</span><span class="sxs-lookup"><span data-stu-id="4ec37-191">Select the **Purchase** button.</span></span>

<span data-ttu-id="4ec37-192">Pode levar 15 a 20 minutos para a implantação ser concluída.</span><span class="sxs-lookup"><span data-stu-id="4ec37-192">It can take 15-20 minutes for the deployment to complete.</span></span>

## <a name="pricing"></a><span data-ttu-id="4ec37-193">Preços</span><span class="sxs-lookup"><span data-stu-id="4ec37-193">Pricing</span></span>

<span data-ttu-id="4ec37-194">Para explorar o custo de executar esse cenário, todos os serviços são pré-configurados na calculadora de custos.</span><span class="sxs-lookup"><span data-stu-id="4ec37-194">To explore the cost of running this scenario, all of the services are pre-configured in the cost calculator.</span></span> <span data-ttu-id="4ec37-195">Para ver como o preço seria alterado em seu caso de uso específico, altere as variáveis apropriadas de acordo com o tráfego esperado.</span><span class="sxs-lookup"><span data-stu-id="4ec37-195">To see how the pricing would change for your particular use case, change the appropriate variables to match your expected traffic.</span></span>

<span data-ttu-id="4ec37-196">Nós fornecemos três perfis de custo de exemplo com base no número de instâncias de VM do conjunto de dimensionamento que executam seus aplicativos.</span><span class="sxs-lookup"><span data-stu-id="4ec37-196">We have provided three sample cost profiles based on the number of scale set VM instances that run your applications.</span></span>

* <span data-ttu-id="4ec37-197">[Pequeno][small-pricing]: esse exemplo de preço refere-se a duas instâncias de VM de front-end e duas de back-end.</span><span class="sxs-lookup"><span data-stu-id="4ec37-197">[Small][small-pricing]: this pricing example correlates to two front-end and two back-end VM instances.</span></span>
* <span data-ttu-id="4ec37-198">[Médio][medium-pricing]: esse exemplo de preço refere-se a 20 instâncias de VM de front-end e cinco de back-end.</span><span class="sxs-lookup"><span data-stu-id="4ec37-198">[Medium][medium-pricing]: this pricing example correlates to 20 front-end and 5 back-end VM instances.</span></span>
* <span data-ttu-id="4ec37-199">[Grande][large-pricing]: esse exemplo de preço refere-se a 100 instâncias de VM de front-end e 10 de back-end.</span><span class="sxs-lookup"><span data-stu-id="4ec37-199">[Large][large-pricing]: this pricing example correlates to 100 front-end and 10 back-end VM instances.</span></span>

## <a name="related-resources"></a><span data-ttu-id="4ec37-200">Recursos relacionados</span><span class="sxs-lookup"><span data-stu-id="4ec37-200">Related resources</span></span>

<span data-ttu-id="4ec37-201">Esse cenário usou um conjunto de dimensionamento de máquina virtual de back-end que executa um cluster do Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4ec37-201">This scenario used a back-end virtual machine scale set that runs a Microsoft SQL Server cluster.</span></span> <span data-ttu-id="4ec37-202">O Cosmos DB também pode ser usado como uma camada de banco de dados escalonável e segura para os dados de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="4ec37-202">Cosmos DB could also be used as a scalable and secure database tier for the application data.</span></span> <span data-ttu-id="4ec37-203">Um [ponto de extremidade de serviço da rede virtual do Azure][vnetendpoint-docs] permite que você possa proteger os recursos essenciais do serviço do Azure somente para suas redes virtuais.</span><span class="sxs-lookup"><span data-stu-id="4ec37-203">An [Azure virtual network service endpoint][vnetendpoint-docs] allows you to secure your critical Azure service resources to only your virtual networks.</span></span> <span data-ttu-id="4ec37-204">Nesse cenário, os pontos de extremidade de rede virtual permitem proteger o tráfego entre a camada de aplicativo front-end e o Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="4ec37-204">In this scenario, VNet endpoints allow you to secure traffic between the front-end application tier and Cosmos DB.</span></span> <span data-ttu-id="4ec37-205">Para saber mais, confira a [Visão geral do Azure Cosmos DB][docs-cosmos-db](/azure/cosmos-db/introduction).</span><span class="sxs-lookup"><span data-stu-id="4ec37-205">For more information, see the [Azure Cosmos DB overview][docs-cosmos-db](/azure/cosmos-db/introduction).</span></span>

<span data-ttu-id="4ec37-206">Você também pode exibir uma [arquitetura detalhada de referência para um aplicativo de N camadas genérico usando o SQL Server][ntiersql-ra].</span><span class="sxs-lookup"><span data-stu-id="4ec37-206">You can also view a detailed [reference architecture for a generic N-tier application using SQL Server][ntiersql-ra].</span></span>

<!-- links -->
[appgateway-docs]: /azure/application-gateway/overview
[architecture]: ./media/architecture-regulated-multitier-app.png
[autoscaling]: /azure/architecture/best-practices/auto-scaling
[availability]: ../../checklist/availability.md
[azureaz-docs]: /azure/availability-zones/az-overview
[cloudwitness-docs]: /windows-server/failover-clustering/deploy-cloud-witness
[loadbalancer-docs]: /azure/load-balancer/load-balancer-overview
[nsg-docs]: /azure/virtual-network/security-overview
[ntiersql-ra]: /azure/architecture/reference-architectures/n-tier/n-tier-sql-server
[resiliency]: /azure/architecture/resiliency/ 
[security]: /azure/security/
[scalability]: /azure/architecture/checklist/scalability 
[scaleset-docs]: /azure/virtual-machine-scale-sets/overview
[sqlalwayson-docs]: /sql/database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server
[vmssautoscale-docs]: /azure/virtual-machine-scale-sets/virtual-machine-scale-sets-autoscale-overview
[vnet-docs]: /azure/virtual-network/virtual-networks-overview
[vnetendpoint-docs]: /azure/virtual-network/virtual-network-service-endpoints-overview
[pci-dss]: /azure/security/blueprints/pcidss-iaaswa-overview
[dmz]: /azure/virtual-network/virtual-networks-dmz-nsg
[sql-linux]: /sql/linux/sql-server-linux-overview?view=sql-server-linux-2017

[small-pricing]: https://azure.com/e/711bbfcbbc884ef8aa91cdf0f2caff72
[medium-pricing]: https://azure.com/e/b622d82d79b34b8398c4bce35477856f
[large-pricing]: https://azure.com/e/1d99d8b92f90496787abecffa1473a93
