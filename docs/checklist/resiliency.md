---
title: "Lista de verificação de resiliência"
description: "Lista de verificação que fornece orientação para questões de resiliência durante a criação."
author: petertaylor9999
ms.date: 01/10/2018
ms.custom: resiliency, checklist
ms.openlocfilehash: 51f807715d0ac929806b9a5a13da4efa00566592
ms.sourcegitcommit: a7aae13569e165d4e768ce0aaaac154ba612934f
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/30/2018
---
# <a name="resiliency-checklist"></a><span data-ttu-id="f9f12-103">Lista de verificação de resiliência</span><span class="sxs-lookup"><span data-stu-id="f9f12-103">Resiliency checklist</span></span>

<span data-ttu-id="f9f12-104">Resiliência é a capacidade de um sistema de se recuperar de falhas e continuar funcionando, além de ser um dos [pilares da qualidade de software](../guide/pillars.md).</span><span class="sxs-lookup"><span data-stu-id="f9f12-104">Resiliency is the ability of a system to recover from failures and continue to function, and is one of the [pillars of software quality](../guide/pillars.md).</span></span> <span data-ttu-id="f9f12-105">Projetar seu aplicativo para garantir a resiliência requer planejamento e redução de uma variedade de modos de falha que podem ocorrer.</span><span class="sxs-lookup"><span data-stu-id="f9f12-105">Designing your application for resiliency requires planning for and mitigating a variety of failure modes that could occur.</span></span> <span data-ttu-id="f9f12-106">Use essa lista de verificação para examinar a arquitetura do aplicativo sob um ponto de vista de resiliência.</span><span class="sxs-lookup"><span data-stu-id="f9f12-106">Use this checklist to review your application architecture from a resiliency standpoint.</span></span> 

## <a name="requirements"></a><span data-ttu-id="f9f12-107">Requisitos</span><span class="sxs-lookup"><span data-stu-id="f9f12-107">Requirements</span></span>

<span data-ttu-id="f9f12-108">**Defina os requisitos de disponibilidade do seu cliente.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-108">**Define your customer's availability requirements.**</span></span> <span data-ttu-id="f9f12-109">O cliente terá requisitos de disponibilidade para os componentes em seu aplicativo e isso afetará o design do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-109">Your customer will have availability requirements for the components in your application and this will affect your application's design.</span></span> <span data-ttu-id="f9f12-110">Obtenha o contrato do cliente para os destinos de disponibilidade de cada parte do seu aplicativo, caso contrário, seu design poderá não atender às expectativas do cliente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-110">Get agreement from your customer for the availability targets of each piece of your application, otherwise your design may not meet the customer's expectations.</span></span> <span data-ttu-id="f9f12-111">Para obter mais informações, consulte [Definição dos seus requisitos de resiliência](../resiliency/index.md#defining-your-resiliency-requirements).</span><span class="sxs-lookup"><span data-stu-id="f9f12-111">For more information, see [Defining your resiliency requirements](../resiliency/index.md#defining-your-resiliency-requirements).</span></span>

## <a name="application-design"></a><span data-ttu-id="f9f12-112">Design do aplicativo</span><span class="sxs-lookup"><span data-stu-id="f9f12-112">Application Design</span></span>

<span data-ttu-id="f9f12-113">**Execute uma FMA (Análise do modo de falha) para seu aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-113">**Perform a failure mode analysis (FMA) for your application.**</span></span> <span data-ttu-id="f9f12-114">A FMA é um processo de criação de resiliência em um aplicativo no início do estágio de design.</span><span class="sxs-lookup"><span data-stu-id="f9f12-114">FMA is a process for building resiliency into an application early in the design stage.</span></span> <span data-ttu-id="f9f12-115">Para obter mais informações, consulte [Análise do modo de falha][fma].</span><span class="sxs-lookup"><span data-stu-id="f9f12-115">For more information, see [Failure mode analysis][fma].</span></span> <span data-ttu-id="f9f12-116">As metas de uma FMA incluem:</span><span class="sxs-lookup"><span data-stu-id="f9f12-116">The goals of an FMA include:</span></span>  

* <span data-ttu-id="f9f12-117">Identificar quais tipos de falhas um aplicativo pode experimentar.</span><span class="sxs-lookup"><span data-stu-id="f9f12-117">Identify what types of failures an application might experience.</span></span>
* <span data-ttu-id="f9f12-118">Capturar os possíveis efeitos e o impacto de cada tipo de falha no aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-118">Capture the potential effects and impact of each type of failure on the application.</span></span>
* <span data-ttu-id="f9f12-119">Identificar estratégias de recuperação.</span><span class="sxs-lookup"><span data-stu-id="f9f12-119">Identify recovery strategies.</span></span>
  

<span data-ttu-id="f9f12-120">**Implante várias instâncias de serviços.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-120">**Deploy multiple instances of services.**</span></span> <span data-ttu-id="f9f12-121">Se seu aplicativo depender de uma única instância de um serviço, ele criará um único ponto de falha.</span><span class="sxs-lookup"><span data-stu-id="f9f12-121">If your application depends on a single instance of a service, it creates a single point of failure.</span></span> <span data-ttu-id="f9f12-122">O provisionamento de várias instâncias melhora a resiliência e a escalabilidade.</span><span class="sxs-lookup"><span data-stu-id="f9f12-122">Provisioning multiple instances improves both resiliency and scalability.</span></span> <span data-ttu-id="f9f12-123">Para o [Serviço de Aplicativo do Azure](/azure/app-service/app-service-value-prop-what-is/), selecione um [Plano do Serviço de Aplicativo](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/) que oferece várias instâncias.</span><span class="sxs-lookup"><span data-stu-id="f9f12-123">For [Azure App Service](/azure/app-service/app-service-value-prop-what-is/), select an [App Service Plan](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/) that offers multiple instances.</span></span> <span data-ttu-id="f9f12-124">Para Serviços de Nuvem do Azure, configure cada uma das suas funções para usar [várias instâncias](/azure/cloud-services/cloud-services-choose-me/#scaling-and-management).</span><span class="sxs-lookup"><span data-stu-id="f9f12-124">For Azure Cloud Services, configure each of your roles to use [multiple instances](/azure/cloud-services/cloud-services-choose-me/#scaling-and-management).</span></span> <span data-ttu-id="f9f12-125">Para [VMs (Máquinas Virtuais) do Azure](/azure/virtual-machines/virtual-machines-windows-about/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), verifique se sua arquitetura de VM inclui mais de uma VM e se cada VM está incluída em um [conjunto de disponibilidade][availability-sets].</span><span class="sxs-lookup"><span data-stu-id="f9f12-125">For [Azure Virtual Machines (VMs)](/azure/virtual-machines/virtual-machines-windows-about/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), ensure that your VM architecture includes more than one VM and that each VM is included in an [availability set][availability-sets].</span></span>   

<span data-ttu-id="f9f12-126">**Use o dimensionamento automático para responder a aumentos de carga.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-126">**Use autoscaling to respond to increases in load.**</span></span> <span data-ttu-id="f9f12-127">Se seu aplicativo não estiver configurado para expandir automaticamente conforme a carga aumenta, os serviços do aplicativo poderão falhar se ficarem saturados com solicitações de usuário.</span><span class="sxs-lookup"><span data-stu-id="f9f12-127">If your application is not configured to scale out automatically as load increases, it's possible that your application's services will fail if they become saturated with user requests.</span></span> <span data-ttu-id="f9f12-128">Para obter mais detalhes, consulte o seguinte:</span><span class="sxs-lookup"><span data-stu-id="f9f12-128">For more details, see the following:</span></span>

* <span data-ttu-id="f9f12-129">Geral: [Lista de verificação de escalabilidade](./scalability.md)</span><span class="sxs-lookup"><span data-stu-id="f9f12-129">General: [Scalability checklist](./scalability.md)</span></span>
* <span data-ttu-id="f9f12-130">Serviço de Aplicativo do Azure: [Dimensionar a contagem de instâncias manual ou automaticamente][app-service-autoscale]</span><span class="sxs-lookup"><span data-stu-id="f9f12-130">Azure App Service: [Scale instance count manually or automatically][app-service-autoscale]</span></span>
* <span data-ttu-id="f9f12-131">Serviços de Nuvem: [Como dimensionar automaticamente um serviço de nuvem][cloud-service-autoscale]</span><span class="sxs-lookup"><span data-stu-id="f9f12-131">Cloud Services: [How to auto scale a cloud service][cloud-service-autoscale]</span></span>
* <span data-ttu-id="f9f12-132">Máquinas Virtuais: [Dimensionamento automático e conjuntos de dimensionamento de máquinas virtuais][vmss-autoscale]</span><span class="sxs-lookup"><span data-stu-id="f9f12-132">Virtual Machines: [Automatic scaling and virtual machine scale sets][vmss-autoscale]</span></span>

<span data-ttu-id="f9f12-133">**Use o balanceamento de carga para distribuir solicitações.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-133">**Use load balancing to distribute requests.**</span></span> <span data-ttu-id="f9f12-134">O balanceamento de carga distribui as solicitações do aplicativo para instâncias de serviço íntegras removendo instâncias não íntegras da rotação.</span><span class="sxs-lookup"><span data-stu-id="f9f12-134">Load balancing distributes your application's requests to healthy service instances by removing unhealthy instances from rotation.</span></span> <span data-ttu-id="f9f12-135">Se o seu serviço usa o Serviço de Aplicativo do Azure ou os Serviços de Nuvem do Azure, o balanceamento de carga dele já foi realizado para você.</span><span class="sxs-lookup"><span data-stu-id="f9f12-135">If your service uses Azure App Service or Azure Cloud Services, it is already load balanced for you.</span></span> <span data-ttu-id="f9f12-136">No entanto, se seu aplicativo usar as VMs do Azure, você precisará provisionar um balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="f9f12-136">However, if your application uses Azure VMs, you will need to provision a load balancer.</span></span> <span data-ttu-id="f9f12-137">Para obter mais detalhes, veja [Visão geral do Azure Load Balancer](/azure/load-balancer/load-balancer-overview/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-137">See the [Azure Load Balancer](/azure/load-balancer/load-balancer-overview/) overview for more details.</span></span>

<span data-ttu-id="f9f12-138">**Configure os Gateways de Aplicativo do Azure para usar várias instâncias.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-138">**Configure Azure Application Gateways to use multiple instances.**</span></span> <span data-ttu-id="f9f12-139">Dependendo dos requisitos do seu aplicativo, um [Gateway de Aplicativo do Azure](/azure/application-gateway/application-gateway-introduction/) pode ser mais conveniente para distribuir solicitações para os serviços do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-139">Depending on your application's requirements, an [Azure Application Gateway](/azure/application-gateway/application-gateway-introduction/) may be better suited to distributing requests to your application's services.</span></span> <span data-ttu-id="f9f12-140">No entanto, instâncias únicas do serviço de Gateway de Aplicativo não garantidas por um SLA, então é possível que seu aplicativo falhe se a instância do Gateway de Aplicativo falhar.</span><span class="sxs-lookup"><span data-stu-id="f9f12-140">However, single instances of the Application Gateway service are not guaranteed by an SLA so it's possible that your application could fail if the Application Gateway instance fails.</span></span> <span data-ttu-id="f9f12-141">Provisione mais de uma instância média ou maior do Gateway de Aplicativo para garantir a disponibilidade do serviço sob os termos do [SLA](https://azure.microsoft.com/support/legal/sla/application-gateway/v1_0/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-141">Provision more than one medium or larger Application Gateway instance to guarantee availability of the service under the terms of the [SLA](https://azure.microsoft.com/support/legal/sla/application-gateway/v1_0/).</span></span>

<span data-ttu-id="f9f12-142">**Use Conjuntos de Disponibilidade do Azure para cada camada de aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-142">**Use Availability Sets for each application tier.**</span></span> <span data-ttu-id="f9f12-143">Colocar suas instâncias em um [conjunto de disponibilidade][availability-sets] proporciona um [SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/) de nível mais elevado.</span><span class="sxs-lookup"><span data-stu-id="f9f12-143">Placing your instances in an [availability set][availability-sets] provides a higher [SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/).</span></span> 

<span data-ttu-id="f9f12-144">**Considere implantar o aplicativo entre várias regiões.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-144">**Consider deploying your application across multiple regions.**</span></span> <span data-ttu-id="f9f12-145">Se seu aplicativo é implantado em uma única região, no caso raro de toda a região ficar não disponível, o aplicativo também fica não disponível.</span><span class="sxs-lookup"><span data-stu-id="f9f12-145">If your application is deployed to a single region, in the rare event the entire region becomes unavailable, your application will also be unavailable.</span></span> <span data-ttu-id="f9f12-146">Isso pode ser inaceitável segundo os termos do SLA do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-146">This may be unacceptable under the terms of your application's SLA.</span></span> <span data-ttu-id="f9f12-147">Nesse caso, considere implantar o aplicativo e os respectivos serviços entre várias regiões.</span><span class="sxs-lookup"><span data-stu-id="f9f12-147">If so, consider deploying your application and its services across multiple regions.</span></span> <span data-ttu-id="f9f12-148">Uma implantação de várias regiões pode usar um padrão ativo-ativo (distribuindo solicitações entre várias instâncias ativas) ou um padrão ativo-passivo (mantendo uma instância "passiva" em reserva, no caso de falha da instância primária).</span><span class="sxs-lookup"><span data-stu-id="f9f12-148">A multi-region deployment can use an active-active pattern (distributing requests across multiple active instances) or an active-passive pattern (keeping a "warm" instance in reserve, in case the primary instance fails).</span></span> <span data-ttu-id="f9f12-149">É recomendável que você implante várias instâncias dos serviços do aplicativo entre pares regionais.</span><span class="sxs-lookup"><span data-stu-id="f9f12-149">We recommend that you deploy multiple instances of your application's services across regional pairs.</span></span> <span data-ttu-id="f9f12-150">Para obter mais informações, consulte [Continuidade dos negócios e recuperação de desastres (BCDR): Regiões Emparelhadas do Azure](/azure/best-practices-availability-paired-regions).</span><span class="sxs-lookup"><span data-stu-id="f9f12-150">For more information, see [Business continuity and disaster recovery (BCDR): Azure Paired Regions](/azure/best-practices-availability-paired-regions).</span></span>

<span data-ttu-id="f9f12-151">**Use o Gerenciador de Tráfego do Azure para rotear o tráfego do seu aplicativo para regiões diferentes.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-151">**Use Azure Traffic Manager to route your application's traffic to different regions.**</span></span>  <span data-ttu-id="f9f12-152">[O Gerenciador de Tráfego do Azure][traffic-manager] executa balanceamento de carga no nível de DNS e roteará o tráfego para regiões diferentes com base no método de [roteamento de tráfego][traffic-manager-routing] especificado por você e na integridade dos pontos de extremidade do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-152">[Azure Traffic Manager][traffic-manager] performs load balancing at the DNS level and will route traffic to different regions based on the [traffic routing][traffic-manager-routing] method you specify and the health of your application's endpoints.</span></span> <span data-ttu-id="f9f12-153">Sem o Gerenciador de Tráfego, você está limitado a implantar uma única região, o que limita a escala, aumenta a latência para alguns usuários e resulta em tempo de inatividade do aplicativo no caso de uma interrupção do serviço em toda a região.</span><span class="sxs-lookup"><span data-stu-id="f9f12-153">Without Traffic Manager, you are limited to a single region for your deployment, which limits scale, increases latency for some users, and causes application downtime in the case of a region-wide service disruption.</span></span>

<span data-ttu-id="f9f12-154">**Configure e teste investigações de integridade para balanceadores de carga e gerenciadores de tráfego.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-154">**Configure and test health probes for your load balancers and traffic managers.**</span></span> <span data-ttu-id="f9f12-155">Verifique se a lógica de integridade verifica as partes críticas do sistema e responde apropriadamente a investigações de integridade.</span><span class="sxs-lookup"><span data-stu-id="f9f12-155">Ensure that your health logic checks the critical parts of the system and responds appropriately to health probes.</span></span>

* <span data-ttu-id="f9f12-156">As investigações de integridade para o [Gerenciador de Tráfego do Azure][traffic-manager] e o [Azure Load Balancer][load-balancer] cumprem uma função específica.</span><span class="sxs-lookup"><span data-stu-id="f9f12-156">The health probes for [Azure Traffic Manager][traffic-manager] and [Azure Load Balancer][load-balancer] serve a specific function.</span></span> <span data-ttu-id="f9f12-157">Para o Gerenciador de Tráfego, a investigação de integridade determina se o failover para outra região deve ou não ser realizado.</span><span class="sxs-lookup"><span data-stu-id="f9f12-157">For Traffic Manager, the health probe determines whether to fail over to another region.</span></span> <span data-ttu-id="f9f12-158">Para um balanceador de carga, ela determina se uma VM deve ou não ser removida da rotação.</span><span class="sxs-lookup"><span data-stu-id="f9f12-158">For a load balancer, it determines whether to remove a VM from rotation.</span></span>      
* <span data-ttu-id="f9f12-159">Para uma investigação do Gerenciador de Tráfego, o ponto de extremidade de integridade deve verificar todas as dependências críticas que são implantados na mesma região e cuja falha deve disparar um failover para outra região.</span><span class="sxs-lookup"><span data-stu-id="f9f12-159">For a Traffic Manager probe, your health endpoint should check any critical dependencies that are deployed within the same region, and whose failure should trigger a failover to another region.</span></span>  
* <span data-ttu-id="f9f12-160">Para um balanceador de carga, o ponto de extremidade de integridade deve relatar a integridade da VM.</span><span class="sxs-lookup"><span data-stu-id="f9f12-160">For a load balancer, the health endpoint should report the health of the VM.</span></span> <span data-ttu-id="f9f12-161">Não inclua outras camadas ou serviços externos.</span><span class="sxs-lookup"><span data-stu-id="f9f12-161">Don't include other tiers or external services.</span></span> <span data-ttu-id="f9f12-162">Caso contrário, uma falha que ocorra fora da VM fará com que o balanceador de carga remova a VM da rotação.</span><span class="sxs-lookup"><span data-stu-id="f9f12-162">Otherwise, a failure that occurs outside the VM will cause the load balancer to remove the VM from rotation.</span></span>
* <span data-ttu-id="f9f12-163">Para diretrizes sobre como implementar a integridade de monitoramento em seu aplicativo, consulte [Padrão de monitoramento de ponto de extremidade de integridade](https://msdn.microsoft.com/library/dn589789.aspx).</span><span class="sxs-lookup"><span data-stu-id="f9f12-163">For guidance on implementing health monitoring in your application, see [Health Endpoint Monitoring Pattern](https://msdn.microsoft.com/library/dn589789.aspx).</span></span>

<span data-ttu-id="f9f12-164">**Monitore os serviços de terceiros.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-164">**Monitor third-party services.**</span></span> <span data-ttu-id="f9f12-165">Se seu aplicativo tem dependências de serviços de terceiros, identifique onde e como esses serviços de terceiros podem falhar e o efeito que essas falhas teriam sobre o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-165">If your application has dependencies on third-party services, identify where and how these third-party services can fail and what effect those failures will have on your application.</span></span> <span data-ttu-id="f9f12-166">Um serviço de terceiros pode não incluir monitoramento e diagnóstico, então é importante registrar em log as invocações deles feitas por você e correlacioná-las com o log de diagnósticos e a integridade do aplicativo usando um identificador exclusivo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-166">A third-party service may not include monitoring and diagnostics, so it's important to log your invocations of them and correlate them with your application's health and diagnostic logging using a unique identifier.</span></span> <span data-ttu-id="f9f12-167">Para obter mais informações sobre práticas comprovadas de monitoramento e diagnóstico, consulte [Diretrizes de monitoramento e diagnóstico][monitoring-and-diagnostics-guidance].</span><span class="sxs-lookup"><span data-stu-id="f9f12-167">For more information on proven practices for monitoring and diagnostics, see [Monitoring and Diagnostics guidance][monitoring-and-diagnostics-guidance].</span></span>

<span data-ttu-id="f9f12-168">**verifique se qualquer serviço de terceiros que você consome oferece um SLA.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-168">**Ensure that any third-party service you consume provides an SLA.**</span></span> <span data-ttu-id="f9f12-169">Se seu aplicativo depende de um serviço de terceiros mas o terceiro não fornece nenhuma garantia de disponibilidade na forma de um SLA, a disponibilidade do aplicativo também não pode ser garantida.</span><span class="sxs-lookup"><span data-stu-id="f9f12-169">If your application depends on a third-party service, but the third party provides no guarantee of availability in the form of an SLA, your application's availability also cannot be guaranteed.</span></span> <span data-ttu-id="f9f12-170">A qualidade do SLA é medida de acordo com o componente menos disponível do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-170">Your SLA is only as good as the least available component of your application.</span></span>

<span data-ttu-id="f9f12-171">**Implemente padrões de resiliência para operações remotas quando apropriado.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-171">**Implement resiliency patterns for remote operations where appropriate.**</span></span> <span data-ttu-id="f9f12-172">Se seu aplicativo depende da comunicação entre serviços remotos, siga os padrões de design para lidar com falhas transitórias, assim como [Padrão de Repetição][retry-pattern] e [Padrão de Disjuntor][circuit-breaker].</span><span class="sxs-lookup"><span data-stu-id="f9f12-172">If your application depends on communication between remote services, follow design patterns for dealing with transient failures, such as [Retry Pattern][retry-pattern], and [Circuit Breaker Pattern][circuit-breaker].</span></span> <span data-ttu-id="f9f12-173">Para obter mais informações, consulte [Estratégias de resiliência](../resiliency/index.md#resiliency-strategies).</span><span class="sxs-lookup"><span data-stu-id="f9f12-173">For more information, see [Resiliency strategies](../resiliency/index.md#resiliency-strategies).</span></span>

<span data-ttu-id="f9f12-174">**Implementar operações assíncronas sempre que possível.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-174">**Implement asynchronous operations whenever possible.**</span></span> <span data-ttu-id="f9f12-175">Operações síncronas podem monopolizar os recursos e bloquear outras operações enquanto o chamador aguarda a conclusão do processo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-175">Synchronous operations can monopolize resources and block other operations while the caller waits for the process to complete.</span></span> <span data-ttu-id="f9f12-176">Crie cada parte do seu aplicativo para permitir operações assíncronas sempre que possível.</span><span class="sxs-lookup"><span data-stu-id="f9f12-176">Design each part of your application to allow for asynchronous operations whenever possible.</span></span> <span data-ttu-id="f9f12-177">Para obter mais informações sobre como implementar a programação assíncrona em C#, consulte [Programação assíncrona com async e await][asynchronous-c-sharp].</span><span class="sxs-lookup"><span data-stu-id="f9f12-177">For more information on how to implement asynchronous programming in C#, see [Asynchronous Programming with async and await][asynchronous-c-sharp].</span></span>

## <a name="data-management"></a><span data-ttu-id="f9f12-178">Gerenciamento de dados</span><span class="sxs-lookup"><span data-stu-id="f9f12-178">Data management</span></span>

<span data-ttu-id="f9f12-179">**Entenda os métodos de replicação para as fontes de dados do aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-179">**Understand the replication methods for your application's data sources.**</span></span> <span data-ttu-id="f9f12-180">Os dados do aplicativo são armazenados em diferentes fontes de dados e têm requisitos de disponibilidade diferentes.</span><span class="sxs-lookup"><span data-stu-id="f9f12-180">Your application data will be stored in different data sources and have different availability requirements.</span></span> <span data-ttu-id="f9f12-181">Avalie os métodos de replicação para cada tipo de armazenamento de dados no Azure, incluindo [Replicação do Armazenamento do Azure](/azure/storage/storage-redundancy/) e [Replicação Geográfica Ativa do Banco de Dados SQL](/azure/sql-database/sql-database-geo-replication-overview/), para garantir que os requisitos de dados do aplicativo sejam atendidos.</span><span class="sxs-lookup"><span data-stu-id="f9f12-181">Evaluate the replication methods for each type of data storage in Azure, including [Azure Storage Replication](/azure/storage/storage-redundancy/) and [SQL Database Active Geo-Replication](/azure/sql-database/sql-database-geo-replication-overview/) to ensure that your application's data requirements are satisfied.</span></span>

<span data-ttu-id="f9f12-182">**Assegure que nenhuma conta de usuário individual tenha acesso aos dados de backup e de produção.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-182">**Ensure that no single user account has access to both production and backup data.**</span></span> <span data-ttu-id="f9f12-183">Os backups de dados são comprometidos se uma única conta de usuário tem permissão para gravar tanto para origens de gravação quanto de backup.</span><span class="sxs-lookup"><span data-stu-id="f9f12-183">Your data backups are compromised if one single user account has permission to write to both production and backup sources.</span></span> <span data-ttu-id="f9f12-184">Um usuário mal-intencionado pode excluir propositadamente todos os seus dados, enquanto um usuário normal pode excluí-los acidentalmente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-184">A malicious user could purposely delete all your data, while a regular user could accidentally delete it.</span></span> <span data-ttu-id="f9f12-185">Projete seu aplicativo para limitar as permissões de cada conta de usuário para que apenas os usuários que necessitam de acesso de gravação tenham esse acesso e que seja apenas para produção ou para backup, mas não ambos.</span><span class="sxs-lookup"><span data-stu-id="f9f12-185">Design your application to limit the permissions of each user account so that only the users that require write access have write access and it's only to either production or backup, but not both.</span></span>

<span data-ttu-id="f9f12-186">**Documente o processo de failover e failback de sua fonte de dados e teste-a.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-186">**Document your data source fail over and fail back process and test it.**</span></span> <span data-ttu-id="f9f12-187">Caso a fonte de dados falhe de modo catastrófico, será necessário que um operador humano siga um conjunto de instruções documentadas para fazer failover para uma nova fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="f9f12-187">In the case where your data source fails catastrophically, a human operator will have to follow a set of documented instructions to fail over to a new data source.</span></span> <span data-ttu-id="f9f12-188">Se as etapas documentadas tiverem erros, um operador não poderá segui-las e fazer o failover do recurso com êxito.</span><span class="sxs-lookup"><span data-stu-id="f9f12-188">If the documented steps have errors, an operator will not be able to successfully follow them and fail over the resource.</span></span> <span data-ttu-id="f9f12-189">Teste regularmente as etapas de instrução para verificar se um operador que as está seguindo é capaz de fazer failover e failback da fonte de dados com êxito.</span><span class="sxs-lookup"><span data-stu-id="f9f12-189">Regularly test the instruction steps to verify that an operator following them is able to successfully fail over and fail back the data source.</span></span>

<span data-ttu-id="f9f12-190">**Valide os backups de dados.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-190">**Validate your data backups.**</span></span> <span data-ttu-id="f9f12-191">Verifique regularmente que os dados de backup são o que você espera ao executar um script para validar o esquema, as consultas e a integridade dos dados.</span><span class="sxs-lookup"><span data-stu-id="f9f12-191">Regularly verify that your backup data is what you expect by running a script to validate data integrity, schema, and queries.</span></span> <span data-ttu-id="f9f12-192">Não há razão para ter um backup se ele não é útil para restaurar suas fontes de dados.</span><span class="sxs-lookup"><span data-stu-id="f9f12-192">There's no point having a backup if it's not useful to restore your data sources.</span></span> <span data-ttu-id="f9f12-193">Registre em log e relate as inconsistências de modo que o serviço de backup possa ser reparado.</span><span class="sxs-lookup"><span data-stu-id="f9f12-193">Log and report any inconsistencies so the backup service can be repaired.</span></span>

<span data-ttu-id="f9f12-194">**Considere o uso de um tipo de conta de armazenamento com redundância geográfica.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-194">**Consider using a storage account type that is geo-redundant.**</span></span> <span data-ttu-id="f9f12-195">Dados armazenados em uma Conta de Armazenamento do Azure são sempre replicados localmente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-195">Data stored in an Azure Storage account is always replicated locally.</span></span> <span data-ttu-id="f9f12-196">No entanto, há várias estratégias de replicação para escolher quando uma Conta de Armazenamento é provisionada.</span><span class="sxs-lookup"><span data-stu-id="f9f12-196">However, there are multiple replication strategies to choose from when a Storage Account is provisioned.</span></span> <span data-ttu-id="f9f12-197">Selecione [RA-GRS (armazenamento com redundância geográfica com acesso de leitura) do Azure](/azure/storage/storage-redundancy/#read-access-geo-redundant-storage) para proteger os dados do aplicativo no caso raro de uma região inteira ficar não disponível.</span><span class="sxs-lookup"><span data-stu-id="f9f12-197">Select [Azure Read-Access Geo Redundant Storage (RA-GRS)](/azure/storage/storage-redundancy/#read-access-geo-redundant-storage) to protect your application data against the rare case when an entire region becomes unavailable.</span></span>

> [!NOTE]
> <span data-ttu-id="f9f12-198">Para VMs, não dependa da replicação de RA-GRS para restaurar os discos de VM (arquivos VHD).</span><span class="sxs-lookup"><span data-stu-id="f9f12-198">For VMs, do not rely on RA-GRS replication to restore the VM disks (VHD files).</span></span> <span data-ttu-id="f9f12-199">Em vez disso, use o [Backup do Azure][azure-backup].</span><span class="sxs-lookup"><span data-stu-id="f9f12-199">Instead, use [Azure Backup][azure-backup].</span></span>   
>
>

## <a name="security"></a><span data-ttu-id="f9f12-200">Segurança</span><span class="sxs-lookup"><span data-stu-id="f9f12-200">Security</span></span>

<span data-ttu-id="f9f12-201">**Implemente a proteção em nível de aplicativo contra ataques DDoS (ataques de negação de serviço distribuídos).**</span><span class="sxs-lookup"><span data-stu-id="f9f12-201">**Implement application-level protection against distributed denial of service (DDoS) attacks.**</span></span> <span data-ttu-id="f9f12-202">Os serviços do Azure são protegidos contra ataques de DDoS na camada de rede.</span><span class="sxs-lookup"><span data-stu-id="f9f12-202">Azure services are protected against DDos attacks at the network layer.</span></span> <span data-ttu-id="f9f12-203">No entanto, o Azure não pode proteger contra ataques na camada de aplicativo, porque é difícil distinguir entre solicitações de usuários verdadeiros e solicitações de usuários mal-intencionados.</span><span class="sxs-lookup"><span data-stu-id="f9f12-203">However, Azure cannot protect against application-layer attacks, because it is difficult to distinguish between true user requests from malicious user requests.</span></span> <span data-ttu-id="f9f12-204">Para obter mais informações sobre como se proteger contra ataques de DDoS da camada de aplicativo, consulte a seção "Proteção contra DDoS" da [Segurança de Rede do Microsoft Azure](http://download.microsoft.com/download/C/A/3/CA3FC5C0-ECE0-4F87-BF4B-D74064A00846/AzureNetworkSecurity_v3_Feb2015.pdf) (download do PDF).</span><span class="sxs-lookup"><span data-stu-id="f9f12-204">For more information on how to protect against application-layer DDoS attacks, see the "Protecting against DDoS" section of [Microsoft Azure Network Security](http://download.microsoft.com/download/C/A/3/CA3FC5C0-ECE0-4F87-BF4B-D74064A00846/AzureNetworkSecurity_v3_Feb2015.pdf) (PDF download).</span></span>

<span data-ttu-id="f9f12-205">**Implemente o princípio de privilégios mínimos para acesso aos recursos do aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-205">**Implement the principle of least privilege for access to the application's resources.**</span></span> <span data-ttu-id="f9f12-206">O padrão para acesso aos recursos do aplicativo deve ser tão restritivo quanto possível.</span><span class="sxs-lookup"><span data-stu-id="f9f12-206">The default for access to the application's resources should be as restrictive as possible.</span></span> <span data-ttu-id="f9f12-207">Conceda permissões de nível superior em uma base de aprovação.</span><span class="sxs-lookup"><span data-stu-id="f9f12-207">Grant higher level permissions on an approval basis.</span></span> <span data-ttu-id="f9f12-208">Conceder acesso excessivamente permissivo a recursos do aplicativo por padrão pode resultar em exclusão intencional ou acidental de recursos por alguém.</span><span class="sxs-lookup"><span data-stu-id="f9f12-208">Granting overly permissive access to your application's resources by default can result in someone purposely or accidentally deleting resources.</span></span> <span data-ttu-id="f9f12-209">O Azure fornece [controle de acesso baseado em função](/azure/active-directory/role-based-access-built-in-roles/) gerenciar os privilégios de usuário, mas é importante verificar permissões com privilégios mínimos para outros recursos que têm seus próprios sistemas de permissões, tais como o SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f9f12-209">Azure provides [role-based access control](/azure/active-directory/role-based-access-built-in-roles/) to manage user privileges, but it's important to verify least privilege permissions for other resources that have their own permissions systems such as SQL Server.</span></span>

## <a name="testing"></a><span data-ttu-id="f9f12-210">Testando</span><span class="sxs-lookup"><span data-stu-id="f9f12-210">Testing</span></span>

<span data-ttu-id="f9f12-211">**Execute o teste de failover e de failback para o aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-211">**Perform failover and failback testing for your application.**</span></span> <span data-ttu-id="f9f12-212">Se você ainda não testou totalmente o failover e o failback, você não pode ter certeza de que os serviços dependentes em seu aplicativo voltam ao funcionamento de forma sincronizada durante uma recuperação de desastre.</span><span class="sxs-lookup"><span data-stu-id="f9f12-212">If you haven't fully tested failover and failback, you can't be certain that the dependent services in your application come back up in a synchronized manner during disaster recovery.</span></span> <span data-ttu-id="f9f12-213">Verifique se os serviços que dependem do seu aplicativo fazem failover e failback na ordem correta.</span><span class="sxs-lookup"><span data-stu-id="f9f12-213">Ensure that your application's dependent services failover and fail back in the correct order.</span></span>

<span data-ttu-id="f9f12-214">**Execute testes de injeção de falha em seu aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-214">**Perform fault-injection testing for your application.**</span></span> <span data-ttu-id="f9f12-215">Seu aplicativo pode falhar por vários motivos diferentes, como a expiração do certificado, o esgotamento de recursos do sistema em uma VM ou falhas de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="f9f12-215">Your application can fail for many different reasons, such as certificate expiration, exhaustion of system resources in a VM, or storage failures.</span></span> <span data-ttu-id="f9f12-216">Teste seu aplicativo em um ambiente que se assemelhe o máximo possível à produção, simulando ou disparando falhas reais.</span><span class="sxs-lookup"><span data-stu-id="f9f12-216">Test your application in an environment as close as possible to production, by simulating or triggering real failures.</span></span> <span data-ttu-id="f9f12-217">Por exemplo, exclua certificados, consuma artificialmente recursos do sistema ou exclua uma origem de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="f9f12-217">For example, delete certificates, artificially consume system resources, or delete a storage source.</span></span> <span data-ttu-id="f9f12-218">Verifique a capacidade do aplicativo de se recuperar de todos os tipos de falhas, isoladamente e em conjunto.</span><span class="sxs-lookup"><span data-stu-id="f9f12-218">Verify your application's ability to recover from all types of faults, alone and in combination.</span></span> <span data-ttu-id="f9f12-219">Verifique se as falhas não estão se propagando ou ocorrendo em cascata pelo sistema.</span><span class="sxs-lookup"><span data-stu-id="f9f12-219">Check that failures are not propagating or cascading through your system.</span></span>

<span data-ttu-id="f9f12-220">**Execute testes em produção usando tanto dados de usuário sintéticos quanto reais.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-220">**Run tests in production using both synthetic and real user data.**</span></span> <span data-ttu-id="f9f12-221">Teste e produção são raramente idênticos, portanto, é importante usar uma implantação canário ou azul/verde e testar seu aplicativo em produção.</span><span class="sxs-lookup"><span data-stu-id="f9f12-221">Test and production are rarely identical, so it's important to use blue/green or a canary deployment and test your application in production.</span></span> <span data-ttu-id="f9f12-222">Isso permite que você teste seu aplicativo em produção sob carga real e verifique se ele funciona conforme o esperado quando totalmente implantado.</span><span class="sxs-lookup"><span data-stu-id="f9f12-222">This allows you to test your application in production under real load and ensure it will function as expected when fully deployed.</span></span>

## <a name="deployment"></a><span data-ttu-id="f9f12-223">Implantação</span><span class="sxs-lookup"><span data-stu-id="f9f12-223">Deployment</span></span>

<span data-ttu-id="f9f12-224">**Documente o processo de lançamento para o seu aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-224">**Document the release process for your application.**</span></span> <span data-ttu-id="f9f12-225">Sem documentação detalhada do processo de lançamento, um operador pode implantar uma atualização inválida ou definir configurações incorretamente para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-225">Without detailed release process documentation, an operator might deploy a bad update or improperly configure settings for your application.</span></span> <span data-ttu-id="f9f12-226">Defina e documente claramente seu processo de lançamento e verifique se ele está disponível para toda a equipe de operações.</span><span class="sxs-lookup"><span data-stu-id="f9f12-226">Clearly define and document your release process, and ensure that it's available to the entire operations team.</span></span> 

<span data-ttu-id="f9f12-227">**Automatize o processo de implantação do aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-227">**Automate your application's deployment process.**</span></span> <span data-ttu-id="f9f12-228">Se é necessário que sua equipe de operações implante manualmente o seu aplicativo, erros humanos podem causar falha na implantação.</span><span class="sxs-lookup"><span data-stu-id="f9f12-228">If your operations staff is required to manually deploy your application, human error can cause the deployment to fail.</span></span> 

<span data-ttu-id="f9f12-229">**Projete seu processo de lançamento para maximizar a disponibilidade do aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-229">**Design your release process to maximize application availability.**</span></span> <span data-ttu-id="f9f12-230">Se o processo de lançamento exigir que os serviços fiquem offline durante a implantação, o aplicativo ficará não disponível até que eles fiquem online novamente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-230">If your release process requires services to go offline during deployment, your application will be unavailable until they come back online.</span></span> <span data-ttu-id="f9f12-231">Use a técnica de implantação de [lançamento canário](http://martinfowler.com/bliki/CanaryRelease.html) ou [azul/verde](http://martinfowler.com/bliki/BlueGreenDeployment.html) para implantar seu aplicativo para produção.</span><span class="sxs-lookup"><span data-stu-id="f9f12-231">Use the [blue/green](http://martinfowler.com/bliki/BlueGreenDeployment.html) or [canary release](http://martinfowler.com/bliki/CanaryRelease.html) deployment technique to deploy your application to production.</span></span> <span data-ttu-id="f9f12-232">Ambas as técnicas envolvem implantar seu código de lançamento junto com o código de produção para que os usuários do código de liberação possam ser redirecionados para o código de produção em caso de falha.</span><span class="sxs-lookup"><span data-stu-id="f9f12-232">Both of these techniques involve deploying your release code alongside production code so users of release code can be redirected to production code in the event of a failure.</span></span>

<span data-ttu-id="f9f12-233">**Registre as implantações do aplicativo em log e faça auditoria delas.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-233">**Log and audit your application's deployments.**</span></span> <span data-ttu-id="f9f12-234">Se você usar técnicas de implantação de teste como lançamento canário ou azul/verde, haverá mais de uma versão do aplicativo em execução na produção.</span><span class="sxs-lookup"><span data-stu-id="f9f12-234">If you use staged deployment techniques such as blue/green or canary releases there will be more than one version of your application running in production.</span></span> <span data-ttu-id="f9f12-235">Se ocorre um problema, é essencial determinar por qual versão do aplicativo ele é causado.</span><span class="sxs-lookup"><span data-stu-id="f9f12-235">If a problem should occur, it's critical to determine which version of your application is causing a problem.</span></span> <span data-ttu-id="f9f12-236">Implemente uma estratégia de registro em log robusta para capturar o máximo possível de informações específicas da versão.</span><span class="sxs-lookup"><span data-stu-id="f9f12-236">Implement a robust logging strategy to capture as much version-specific information as possible.</span></span>

<span data-ttu-id="f9f12-237">**Tenha um plano de reversão para a implantação.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-237">**Have a rollback plan for deployment.**</span></span> <span data-ttu-id="f9f12-238">É possível que a implantação do aplicativo pode falhe e deixe o aplicativo não disponível.</span><span class="sxs-lookup"><span data-stu-id="f9f12-238">It's possible that your application deployment could fail and cause your application to become unavailable.</span></span> <span data-ttu-id="f9f12-239">Crie um processo de reversão para voltar para uma última versão válida conhecida e minimizar o tempo de inatividade.</span><span class="sxs-lookup"><span data-stu-id="f9f12-239">Design a rollback process to go back to a last known good version and minimize downtime.</span></span> 

## <a name="operations"></a><span data-ttu-id="f9f12-240">Operações</span><span class="sxs-lookup"><span data-stu-id="f9f12-240">Operations</span></span>

<span data-ttu-id="f9f12-241">**Implemente as práticas recomendadas para monitoramento e alertas em seu aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-241">**Implement best practices for monitoring and alerting in your application.**</span></span> <span data-ttu-id="f9f12-242">Sem monitoramento, diagnóstico e alertas adequados, não é possível detectar falhas em seu aplicativo e alertar um operador para corrigi-las.</span><span class="sxs-lookup"><span data-stu-id="f9f12-242">Without proper monitoring, diagnostics, and alerting, there is no way to detect failures in your application and alert an operator to fix them.</span></span> <span data-ttu-id="f9f12-243">Para obter mais informações, consulte [Diretrizes de monitoramento e diagnóstico][monitoring-and-diagnostics-guidance].</span><span class="sxs-lookup"><span data-stu-id="f9f12-243">For more information, see [Monitoring and Diagnostics guidance][monitoring-and-diagnostics-guidance].</span></span>

<span data-ttu-id="f9f12-244">**Meça as estatísticas de chamada remota e disponibilize as informações para a equipe do aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-244">**Measure remote call statistics and make the information available to the application team.**</span></span>  <span data-ttu-id="f9f12-245">Se você não acompanhar e relatar estatísticas de chamada remota em tempo real e não fornecer uma maneira fácil de examinar essas informações, a equipe de operações não terá uma exibição instantânea da integridade do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-245">If you don't track and report remote call statistics in real time and provide an easy way to review this information, the operations team will not have an instantaneous view into the health of your application.</span></span> <span data-ttu-id="f9f12-246">E se você medir apenas o tempo médio das chamadas remotas, você não terá informações suficientes para revelar problemas nos serviços.</span><span class="sxs-lookup"><span data-stu-id="f9f12-246">And if you only measure average remote call time, you will not have enough information to reveal issues in the services.</span></span> <span data-ttu-id="f9f12-247">Resuma métricas de chamada remota como latência, taxa de transferência e erros no 99º e no 95º percentis.</span><span class="sxs-lookup"><span data-stu-id="f9f12-247">Summarize remote call metrics such as latency, throughput, and errors in the 99 and 95 percentiles.</span></span> <span data-ttu-id="f9f12-248">Execute análise estatística nas métricas para revelar os erros que ocorrem dentro de cada percentual.</span><span class="sxs-lookup"><span data-stu-id="f9f12-248">Perform statistical analysis on the metrics to uncover errors that occur within each percentile.</span></span>

<span data-ttu-id="f9f12-249">**Acompanhe o número de exceções transitórias e de novas tentativas durante um período de tempo apropriado.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-249">**Track the number of transient exceptions and retries over an appropriate timeframe.**</span></span> <span data-ttu-id="f9f12-250">Se você não controlar e monitorar exceções transitórias e novas tentativas ao longo do tempo, uma falha ou problema poderá ficar oculta pela lógica de repetição do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-250">If you don't track and monitor transient exceptions and retry attempts over time, it's possible that an issue or failure could be hidden by your application's retry logic.</span></span> <span data-ttu-id="f9f12-251">Ou seja, se o monitoramento e registro em log mostra somente êxito ou falha de uma operação, o fato de que a operação precisou ser repetida várias vezes devido às exceções ficará oculto.</span><span class="sxs-lookup"><span data-stu-id="f9f12-251">That is, if your monitoring and logging only shows success or failure of an operation, the fact that the operation had to be retried multiple times due to exceptions will be hidden.</span></span> <span data-ttu-id="f9f12-252">Uma tendência de aumento de exceções ao longo do tempo indica que o serviço está apresentando um problema e pode falhar.</span><span class="sxs-lookup"><span data-stu-id="f9f12-252">A trend of increasing exceptions over time indicates that the service is having an issue and may fail.</span></span> <span data-ttu-id="f9f12-253">Para obter mais informações, consulte [Diretrizes específicas sobre repetição de serviço][retry-service-guidance].</span><span class="sxs-lookup"><span data-stu-id="f9f12-253">For more information, see [Retry service specific guidance][retry-service-guidance].</span></span>

<span data-ttu-id="f9f12-254">**Implemente um sistema de avisos antecipados que alerta um operador.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-254">**Implement an early warning system that alerts an operator.**</span></span> <span data-ttu-id="f9f12-255">Identifique os indicadores chave de desempenho de integridade do aplicativo, tais como exceções transitórias e latência de chamadas remotas e defina valores limite adequados para cada um deles.</span><span class="sxs-lookup"><span data-stu-id="f9f12-255">Identify the key performance indicators of your application's health, such as transient exceptions and remote call latency, and set appropriate threshold values for each of them.</span></span> <span data-ttu-id="f9f12-256">Envie um alerta para operações quando o valor limite é atingido.</span><span class="sxs-lookup"><span data-stu-id="f9f12-256">Send an alert to operations when the threshold value is reached.</span></span> <span data-ttu-id="f9f12-257">Defina esses limites para níveis que identifiquem problemas antes que eles se tornem críticos e exijam uma resposta de recuperação.</span><span class="sxs-lookup"><span data-stu-id="f9f12-257">Set these thresholds at levels that identify issues before they become critical and require a recovery response.</span></span>

<span data-ttu-id="f9f12-258">**Verifique se mais de uma pessoa da equipe está treinada para monitorar o aplicativo e executar as etapas de recuperação manual.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-258">**Ensure that more than one person on the team is trained to monitor the application and perform any manual recovery steps.**</span></span> <span data-ttu-id="f9f12-259">Se você tem apenas um único operador da equipe que pode monitorar o aplicativo e disparar etapas de recuperação, essa pessoa se torna um ponto único de falha.</span><span class="sxs-lookup"><span data-stu-id="f9f12-259">If you only have a single operator on the team who can monitor the application and kick off recovery steps, that person becomes a single point of failure.</span></span> <span data-ttu-id="f9f12-260">Treine vários indivíduos sobre detecção e recuperação e verifique se há sempre pelo menos um ativo a qualquer momento.</span><span class="sxs-lookup"><span data-stu-id="f9f12-260">Train multiple individuals on detection and recovery and make sure there is always at least one active at any time.</span></span>

<span data-ttu-id="f9f12-261">**Verifique se o aplicativo não é submetido a [limites de assinatura do Azure](/azure/azure-subscription-service-limits/).**</span><span class="sxs-lookup"><span data-stu-id="f9f12-261">**Ensure that your application does not run up against [Azure subscription limits](/azure/azure-subscription-service-limits/).**</span></span> <span data-ttu-id="f9f12-262">As assinaturas do Azure têm limites para determinados tipos de recursos, como o número de grupos de recursos, o número de núcleos e o número de contas de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="f9f12-262">Azure subscriptions have limits on certain resource types, such as number of resource groups, number of cores, and number of storage accounts.</span></span>  <span data-ttu-id="f9f12-263">Se seus requisitos de aplicativo excedem os limites de assinatura do Azure, crie outra assinatura do Azure e provisione recursos suficientes nela.</span><span class="sxs-lookup"><span data-stu-id="f9f12-263">If your application requirements exceed Azure subscription limits, create another Azure subscription and provision sufficient resources there.</span></span>

<span data-ttu-id="f9f12-264">**Verifique se o aplicativo não é confrontado com [limites por serviço](/azure/azure-subscription-service-limits/).**</span><span class="sxs-lookup"><span data-stu-id="f9f12-264">**Ensure that your application does not run up against [per-service limits](/azure/azure-subscription-service-limits/).**</span></span> <span data-ttu-id="f9f12-265">Os serviços do Azure individuais têm limites de consumo &mdash; por exemplo, limites para armazenamento, taxa de transferência, número de conexões, solicitações por segundo e outras métricas.</span><span class="sxs-lookup"><span data-stu-id="f9f12-265">Individual Azure services have consumption limits &mdash; for example, limits on storage, throughput, number of connections, requests per second, and other metrics.</span></span> <span data-ttu-id="f9f12-266">O aplicativo falhará se ele tentar usar recursos além desses limites.</span><span class="sxs-lookup"><span data-stu-id="f9f12-266">Your application will fail if it attempts to use resources beyond these limits.</span></span> <span data-ttu-id="f9f12-267">Isso resultará em limitação do serviço e possível tempo de inatividade para os usuários afetados.</span><span class="sxs-lookup"><span data-stu-id="f9f12-267">This will result in service throttling and possible downtime for affected users.</span></span> <span data-ttu-id="f9f12-268">Dependendo do serviço específico e seus requisitos de aplicativo, você geralmente pode evitar esses limites por meio de expansão, seja escolhendo outro tipo de preço ou adicionando novas instâncias.</span><span class="sxs-lookup"><span data-stu-id="f9f12-268">Depending on the specific service and your application requirements, you can often avoid these limits by scaling up (for example, choosing another pricing tier) or scaling out (adding new instances).</span></span>  

<span data-ttu-id="f9f12-269">**Projete os requisitos de armazenamento do aplicativo para ficarem dentro das metas de desempenho e escalabilidade do Armazenamento do Azure.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-269">**Design your application's storage requirements to fall within Azure storage scalability and performance targets.**</span></span> <span data-ttu-id="f9f12-270">O Armazenamento do Azure foi projetado para funcionar dentro de metas de escalabilidade e desempenho predefinidas, portanto, projete seu aplicativo para utilizar o armazenamento dentro dessas metas.</span><span class="sxs-lookup"><span data-stu-id="f9f12-270">Azure storage is designed to function within predefined scalability and performance targets, so design your application to utilize storage within those targets.</span></span> <span data-ttu-id="f9f12-271">Se você exceder essas metas, o armazenamento do aplicativo sofrerá limitação.</span><span class="sxs-lookup"><span data-stu-id="f9f12-271">If you exceed these targets your application will experience storage throttling.</span></span> <span data-ttu-id="f9f12-272">Para corrigir isso, provisione contas de armazenamento adicionais.</span><span class="sxs-lookup"><span data-stu-id="f9f12-272">To fix this, provision additional Storage Accounts.</span></span> <span data-ttu-id="f9f12-273">Se você atingir o limite da contas de armazenamentos, provisione assinaturas do Azure adicionais e, em seguida, provisione contas de armazenamento adicionais nelas.</span><span class="sxs-lookup"><span data-stu-id="f9f12-273">If you run up against the Storage Account limit, provision additional Azure Subscriptions and then provision additional Storage Accounts there.</span></span> <span data-ttu-id="f9f12-274">Para saber mais, consulte [Metas de desempenho e escalabilidade do Armazenamento do Azure](/azure/storage/storage-scalability-targets/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-274">For more information, see [Azure Storage Scalability and Performance Targets](/azure/storage/storage-scalability-targets/).</span></span>

<span data-ttu-id="f9f12-275">**Selecione o tamanho de VM certo para o aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-275">**Select the right VM size for your application.**</span></span> <span data-ttu-id="f9f12-276">Meça a CPU, memória, disco e E/S de suas VMs em produção e verifique se o tamanho da VM que você selecionou é suficiente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-276">Measure the actual CPU, memory, disk, and I/O of your VMs in production and verify that the VM size you've selected is sufficient.</span></span> <span data-ttu-id="f9f12-277">Se não é, seu aplicativo pode apresentar problemas de capacidade, tais como VMs se aproximarem de seus limites.</span><span class="sxs-lookup"><span data-stu-id="f9f12-277">If not, your application may experience capacity issues as the VMs approach their limits.</span></span> <span data-ttu-id="f9f12-278">Tamanhos de VM são descritos em detalhes em [Tamanhos de máquinas virtuais no Azure](/azure/virtual-machines/virtual-machines-windows-sizes/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="f9f12-278">VM sizes are described in detail in [Sizes for virtual machines in Azure](/azure/virtual-machines/virtual-machines-windows-sizes/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

<span data-ttu-id="f9f12-279">**Determine se a carga de trabalho do aplicativo é estável ou varia ao longo do tempo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-279">**Determine if your application's workload is stable or fluctuating over time.**</span></span> <span data-ttu-id="f9f12-280">Se sua carga de trabalho varia ao longo do tempo, use conjuntos de dimensionamento de VMs do Azure para dimensionar automaticamente o número de instâncias de VM.</span><span class="sxs-lookup"><span data-stu-id="f9f12-280">If your workload fluctuates over time, use Azure VM scale sets to automatically scale the number of VM instances.</span></span> <span data-ttu-id="f9f12-281">Caso contrário, você precisará aumentar ou diminuir manualmente o número de VMs.</span><span class="sxs-lookup"><span data-stu-id="f9f12-281">Otherwise, you will have to manually increase or decrease the number of VMs.</span></span> <span data-ttu-id="f9f12-282">Para obter mais informações, consulte a [Visão geral de conjuntos de dimensionamento de máquinas virtuais](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-282">For more information, see the [Virtual Machine Scale Sets Overview](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/).</span></span>

<span data-ttu-id="f9f12-283">**Selecione a camada de serviço certa para o Banco de Dados SQL do Azure.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-283">**Select the right service tier for Azure SQL Database.**</span></span> <span data-ttu-id="f9f12-284">Se seu aplicativo usa o Banco de Dados SQL do Azure, verifique se você selecionou a camada de serviço apropriada.</span><span class="sxs-lookup"><span data-stu-id="f9f12-284">If your application uses Azure SQL Database, ensure that you have selected the appropriate service tier.</span></span> <span data-ttu-id="f9f12-285">Se você selecionar uma camada que não é capaz de lidar com os requisitos de DTU (unidade de transação de banco de dados) do aplicativo, o uso de dados será limitado.</span><span class="sxs-lookup"><span data-stu-id="f9f12-285">If you select a tier that is not able to handle your application's database transaction unit (DTU) requirements, your data use will be throttled.</span></span> <span data-ttu-id="f9f12-286">Para obter mais informações sobre como selecionar o plano de serviço correto, veja [Opções e desempenho de Banco de Dados SQL: saiba o que está disponível em cada camada de serviço](/azure/sql-database/sql-database-service-tiers/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-286">For more information on selecting the correct service plan, see [SQL Database options and performance: Understand what's available in each service tier](/azure/sql-database/sql-database-service-tiers/).</span></span>

<span data-ttu-id="f9f12-287">**Crie um processo para interagir com o suporte do Azure.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-287">**Create a process for interacting with Azure support.**</span></span> <span data-ttu-id="f9f12-288">Se o processo de contatar o [suporte do Azure](https://azure.microsoft.com/support/plans/) não for definido antes de a necessidade de entrar em contato com o suporte surgir, o tempo de inatividade será prolongado conforme a navegação pelo processo de suporte for realizada pela primeira vez.</span><span class="sxs-lookup"><span data-stu-id="f9f12-288">If the process for contacting [Azure support](https://azure.microsoft.com/support/plans/) is not set before the need to contact support arises, downtime will be prolonged as the support process is navigated for the first time.</span></span> <span data-ttu-id="f9f12-289">Inclua o processo de entrar em contato com o suporte e escalar problemas como parte de resiliência do aplicativo desde o início.</span><span class="sxs-lookup"><span data-stu-id="f9f12-289">Include the process for contacting support and escalating issues as part of your application's resiliency from the outset.</span></span>

<span data-ttu-id="f9f12-290">**Verifique se o aplicativo não usa mais do que o número máximo de contas de armazenamento por assinatura.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-290">**Ensure that your application doesn't use more than the maximum number of storage accounts per subscription.**</span></span> <span data-ttu-id="f9f12-291">O Azure permite um máximo de 200 contas de armazenamento por assinatura.</span><span class="sxs-lookup"><span data-stu-id="f9f12-291">Azure allows a maximum of 200 storage accounts per subscription.</span></span> <span data-ttu-id="f9f12-292">Se o aplicativo exigir mais contas de armazenamento do que estiverem atualmente disponíveis na assinatura, você precisará de criar uma nova assinatura e criar contas de armazenamento adicionais nela.</span><span class="sxs-lookup"><span data-stu-id="f9f12-292">If your application requires more storage accounts than are currently available in your subscription, you will have to create a new subscription and create additional storage accounts there.</span></span> <span data-ttu-id="f9f12-293">Para saber mais, confira [Assinatura e limites de serviço, cotas e restrições do Azure](/azure/azure-subscription-service-limits/#storage-limits).</span><span class="sxs-lookup"><span data-stu-id="f9f12-293">For more information, see [Azure subscription and service limits, quotas, and constraints](/azure/azure-subscription-service-limits/#storage-limits).</span></span>

<span data-ttu-id="f9f12-294">**Verifique se o aplicativo não excede as metas de escalabilidade para discos de máquina virtual.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-294">**Ensure that your application doesn't exceed the scalability targets for virtual machine disks.**</span></span> <span data-ttu-id="f9f12-295">Uma VM de IaaS do Azure dá suporte à anexação de um número de discos de dados que depende de vários fatores, incluindo o tamanho da VM e o tipo de conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="f9f12-295">An Azure IaaS VM supports attaching a number of data disks depending on several factors, including the VM size and type of storage account.</span></span> <span data-ttu-id="f9f12-296">Se o aplicativo exceder as metas de escalabilidade para discos de máquina virtual, provisione contas de armazenamento adicionais e crie os discos da máquina virtual nelas.</span><span class="sxs-lookup"><span data-stu-id="f9f12-296">If your application exceeds the scalability targets for virtual machine disks, provision additional storage accounts and create the virtual machine disks there.</span></span> <span data-ttu-id="f9f12-297">Para obter mais informações, consulte [Metas de desempenho e escalabilidade do Armazenamento do Azure](/azure/storage/storage-scalability-targets/#scalability-targets-for-virtual-machine-disks)</span><span class="sxs-lookup"><span data-stu-id="f9f12-297">For more information, see [Azure Storage Scalability and Performance Targets](/azure/storage/storage-scalability-targets/#scalability-targets-for-virtual-machine-disks)</span></span>

## <a name="telemetry"></a><span data-ttu-id="f9f12-298">Telemetria</span><span class="sxs-lookup"><span data-stu-id="f9f12-298">Telemetry</span></span>

<span data-ttu-id="f9f12-299">**Registre em log os dados de telemetria enquanto o aplicativo está em execução no ambiente de produção.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-299">**Log telemetry data while the application is running in the production environment.**</span></span> <span data-ttu-id="f9f12-300">Capture informações de telemetria robustas enquanto o aplicativo estiver em execução no ambiente de produção ou você não terá informações suficientes para diagnosticar a causa dos problemas enquanto ele estiver atendendo usuários ativamente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-300">Capture robust telemetry information while the application is running in the production environment or you will not have sufficient information to diagnose the cause of issues while it's actively serving users.</span></span> <span data-ttu-id="f9f12-301">Para obter mais informações, consulte [Monitoramento e diagnóstico][monitoring-and-diagnostics-guidance].</span><span class="sxs-lookup"><span data-stu-id="f9f12-301">For more information, see [Monitoring and Diagnostics][monitoring-and-diagnostics-guidance].</span></span>

<span data-ttu-id="f9f12-302">**Implemente registro em log usando um padrão assíncrono.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-302">**Implement logging using an asynchronous pattern.**</span></span> <span data-ttu-id="f9f12-303">Se as operações de registro em log são síncronas, elas podem bloquear o código do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-303">If logging operations are synchronous, they might block your application code.</span></span> <span data-ttu-id="f9f12-304">Verifique se as operações de registro em log são implementadas como operações assíncronas.</span><span class="sxs-lookup"><span data-stu-id="f9f12-304">Ensure that your logging operations are implemented as asynchronous operations.</span></span>

<span data-ttu-id="f9f12-305">**Correlacione dados de log através de limites de serviços.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-305">**Correlate log data across service boundaries.**</span></span> <span data-ttu-id="f9f12-306">Em um aplicativo de n camadas típico, uma solicitação de usuário pode atravessar vários limites de serviço.</span><span class="sxs-lookup"><span data-stu-id="f9f12-306">In a typical n-tier application, a user request may traverse several service boundaries.</span></span> <span data-ttu-id="f9f12-307">Por exemplo, uma solicitação de usuário normalmente se origina na camada da Web e é passada para a camada de negócios e por fim é persistida na camada de dados.</span><span class="sxs-lookup"><span data-stu-id="f9f12-307">For example, a user request typically originates in the web tier and is passed to the business tier and finally persisted in the data tier.</span></span> <span data-ttu-id="f9f12-308">Em cenários mais complexos, uma solicitação de usuário pode ser distribuída a muitos armazenamentos de dados e serviços diferentes.</span><span class="sxs-lookup"><span data-stu-id="f9f12-308">In more complex scenarios, a user request may be distributed to many different services and data stores.</span></span> <span data-ttu-id="f9f12-309">Verifique se o sistema de registro em log correlaciona chamadas entre limites de serviço para que você possa rastrear a solicitação pelo seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-309">Ensure that your logging system correlates calls across service boundaries so you can track the request throughout your application.</span></span>

## <a name="azure-resources"></a><span data-ttu-id="f9f12-310">Recursos do Azure</span><span class="sxs-lookup"><span data-stu-id="f9f12-310">Azure Resources</span></span>

<span data-ttu-id="f9f12-311">**Use modelos do Azure Resource Manager para provisionar recursos.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-311">**Use Azure Resource Manager templates to provision resources.**</span></span> <span data-ttu-id="f9f12-312">Modelos do Resource Manager facilitam a automatização de implantações por meio do PowerShell ou da CLI do Azure, o que leva a um processo de implantação mais confiável.</span><span class="sxs-lookup"><span data-stu-id="f9f12-312">Resource Manager templates make it easier to automate deployments via PowerShell or the Azure CLI, which leads to a more reliable deployment process.</span></span> <span data-ttu-id="f9f12-313">Para saber mais, confira [Visão geral do Azure Resource Manager][resource-manager].</span><span class="sxs-lookup"><span data-stu-id="f9f12-313">For more information, see [Azure Resource Manager overview][resource-manager].</span></span>

<span data-ttu-id="f9f12-314">**Dê nomes significativos aos recursos.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-314">**Give resources meaningful names.**</span></span> <span data-ttu-id="f9f12-315">Dar nomes significativos aos recursos facilita a localização de um recurso específico e o entendimento de sua função.</span><span class="sxs-lookup"><span data-stu-id="f9f12-315">Giving resources meaningful names makes it easier to locate a specific resource and understand its role.</span></span> <span data-ttu-id="f9f12-316">Para obter mais informações, consulte as [Convenções de nomenclatura para os Recursos do Azure](../best-practices/naming-conventions.md)</span><span class="sxs-lookup"><span data-stu-id="f9f12-316">For more information, see [Naming conventions for Azure resources](../best-practices/naming-conventions.md)</span></span>

<span data-ttu-id="f9f12-317">**Use o RBAC (Controle de Acesso Baseado em Função).**</span><span class="sxs-lookup"><span data-stu-id="f9f12-317">**Use role-based access control (RBAC).**</span></span> <span data-ttu-id="f9f12-318">Use o RBAC para controlar o acesso aos recursos do Azure que você implanta.</span><span class="sxs-lookup"><span data-stu-id="f9f12-318">Use RBAC to control access to the Azure resources that you deploy.</span></span> <span data-ttu-id="f9f12-319">O RBAC permite que você atribua funções de autorização para os membros da equipe DevOps, para impedir exclusão acidental ou alterações a recursos implantados.</span><span class="sxs-lookup"><span data-stu-id="f9f12-319">RBAC lets you assign authorization roles to members of your DevOps team, to prevent accidental deletion or changes to deployed resources.</span></span> <span data-ttu-id="f9f12-320">Para obter mais informações, veja [Introdução ao gerenciamento de acesso no Portal do Azure](/azure/active-directory/role-based-access-control-what-is/)</span><span class="sxs-lookup"><span data-stu-id="f9f12-320">For more information, see [Get started with access management in the Azure portal](/azure/active-directory/role-based-access-control-what-is/)</span></span>

<span data-ttu-id="f9f12-321">**Use bloqueios de recursos para recursos críticos, tais como VMs.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-321">**Use resource locks for critical resources, such as VMs.**</span></span> <span data-ttu-id="f9f12-322">Bloqueios de recurso impedem que um operador exclua um recurso acidentalmente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-322">Resource locks prevent an operator from accidentally deleting a resource.</span></span> <span data-ttu-id="f9f12-323">Para saber mais, confira [Bloquear recursos com o Azure Resource Manager](/azure/azure-resource-manager/resource-group-lock-resources/)</span><span class="sxs-lookup"><span data-stu-id="f9f12-323">For more information, see [Lock resources with Azure Resource Manager](/azure/azure-resource-manager/resource-group-lock-resources/)</span></span>

<span data-ttu-id="f9f12-324">**Escolha pares regionais.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-324">**Choose regional pairs.**</span></span> <span data-ttu-id="f9f12-325">Ao implantar em duas regiões, escolha regiões do mesmo par de regiões.</span><span class="sxs-lookup"><span data-stu-id="f9f12-325">When deploying to two regions, choose regions from the same regional pair.</span></span> <span data-ttu-id="f9f12-326">No caso de uma interrupção ampla, é priorizada a recuperação de uma região de cada par.</span><span class="sxs-lookup"><span data-stu-id="f9f12-326">In the event of a broad outage, recovery of one region is prioritized out of every pair.</span></span> <span data-ttu-id="f9f12-327">Alguns serviços, tais como o armazenamento com redundância geográfica, fornecem replicação automática para a região emparelhada.</span><span class="sxs-lookup"><span data-stu-id="f9f12-327">Some services such as Geo-Redundant Storage provide automatic replication to the paired region.</span></span> <span data-ttu-id="f9f12-328">Para saber mais, consulte [Continuidade dos negócios e recuperação de desastres (BCDR): Regiões Emparelhadas do Azure](/azure/best-practices-availability-paired-regions)</span><span class="sxs-lookup"><span data-stu-id="f9f12-328">For more information, see [Business continuity and disaster recovery (BCDR): Azure Paired Regions](/azure/best-practices-availability-paired-regions)</span></span>

<span data-ttu-id="f9f12-329">**Organize os grupos de recursos por função e ciclo de vida.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-329">**Organize resource groups by function and lifecycle.**</span></span>  <span data-ttu-id="f9f12-330">Em geral, um grupo de recursos deve conter recursos que compartilham o mesmo ciclo de vida.</span><span class="sxs-lookup"><span data-stu-id="f9f12-330">In general, a resource group should contain resources that share the same lifecycle.</span></span> <span data-ttu-id="f9f12-331">Isso facilita o gerenciamento de implantações, a exclusão de implantações de teste e a atribuição de direitos de acesso, reduzindo a chance de que uma implantação de produção seja acidentalmente excluída ou modificada.</span><span class="sxs-lookup"><span data-stu-id="f9f12-331">This makes it easier to manage deployments, delete test deployments, and assign access rights, reducing the chance that a production deployment is accidentally deleted or modified.</span></span> <span data-ttu-id="f9f12-332">Crie grupos de recursos separados para ambientes de produção, desenvolvimento e teste.</span><span class="sxs-lookup"><span data-stu-id="f9f12-332">Create separate resource groups for production, development, and test environments.</span></span> <span data-ttu-id="f9f12-333">Em uma implantação de várias regiões, coloque os recursos para cada região em grupos de recursos separados.</span><span class="sxs-lookup"><span data-stu-id="f9f12-333">In a multi-region deployment, put resources for each region into separate resource groups.</span></span> <span data-ttu-id="f9f12-334">Isso torna mais fácil reimplantar uma região sem afetar as outras regiões.</span><span class="sxs-lookup"><span data-stu-id="f9f12-334">This makes it easier to redeploy one region without affecting the other region(s).</span></span>

## <a name="azure-services"></a><span data-ttu-id="f9f12-335">Serviços do Azure</span><span class="sxs-lookup"><span data-stu-id="f9f12-335">Azure Services</span></span>
<span data-ttu-id="f9f12-336">Os itens de lista de verificação a seguir se aplicam a serviços específicos no Azure.</span><span class="sxs-lookup"><span data-stu-id="f9f12-336">The following checklist items apply to specific services in Azure.</span></span>

- [<span data-ttu-id="f9f12-337">Serviço de Aplicativo</span><span class="sxs-lookup"><span data-stu-id="f9f12-337">App Service</span></span>](#app-service)
- [<span data-ttu-id="f9f12-338">Gateway de Aplicativo</span><span class="sxs-lookup"><span data-stu-id="f9f12-338">Application Gateway</span></span>](#application-gateway)
- [<span data-ttu-id="f9f12-339">Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="f9f12-339">Cosmos DB</span></span>](#cosmos-db)
- [<span data-ttu-id="f9f12-340">Cache Redis</span><span class="sxs-lookup"><span data-stu-id="f9f12-340">Redis Cache</span></span>](#redis-cache)
- [<span data-ttu-id="f9f12-341">Search</span><span class="sxs-lookup"><span data-stu-id="f9f12-341">Search</span></span>](#search)
- [<span data-ttu-id="f9f12-342">Armazenamento</span><span class="sxs-lookup"><span data-stu-id="f9f12-342">Storage</span></span>](#storage)
- [<span data-ttu-id="f9f12-343">Banco de Dados SQL</span><span class="sxs-lookup"><span data-stu-id="f9f12-343">SQL Database</span></span>](#sql-database)
- [<span data-ttu-id="f9f12-344">SQL Server em execução em uma VM</span><span class="sxs-lookup"><span data-stu-id="f9f12-344">SQL Server running in a VM</span></span>](#sql-server-running-in-a-vm)
- [<span data-ttu-id="f9f12-345">Gerenciador de Tráfego</span><span class="sxs-lookup"><span data-stu-id="f9f12-345">Traffic Manager</span></span>](#traffic-manager)
- [<span data-ttu-id="f9f12-346">Máquinas virtuais</span><span class="sxs-lookup"><span data-stu-id="f9f12-346">Virtual Machines</span></span>](#virtual-machines)
- [<span data-ttu-id="f9f12-347">Rede Virtual</span><span class="sxs-lookup"><span data-stu-id="f9f12-347">Virtual Network</span></span>](#virtual-network)

### <a name="app-service"></a><span data-ttu-id="f9f12-348">Serviço de Aplicativo</span><span class="sxs-lookup"><span data-stu-id="f9f12-348">App Service</span></span>

<span data-ttu-id="f9f12-349">**Use a camada Standard ou Premium.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-349">**Use Standard or Premium tier.**</span></span> <span data-ttu-id="f9f12-350">Essas camadas dão suporte a slots de preparo e backups automáticos.</span><span class="sxs-lookup"><span data-stu-id="f9f12-350">These tiers support staging slots and automated backups.</span></span> <span data-ttu-id="f9f12-351">Para obter mais informações, consulte [Visão geral aprofundada de planos do Serviço de Aplicativo do Azure](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/)</span><span class="sxs-lookup"><span data-stu-id="f9f12-351">For more information, see [Azure App Service plans in-depth overview](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/)</span></span>

<span data-ttu-id="f9f12-352">**Evite expandir ou reduzir verticalmente.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-352">**Avoid scaling up or down.**</span></span> <span data-ttu-id="f9f12-353">Em vez disso, selecione uma camada e o tamanho de instância que atendem aos seus requisitos de desempenho sob carga típica e, em seguida, [aumente](/azure/app-service-web/web-sites-scale/) as instâncias para manipular as alterações no volume de tráfego.</span><span class="sxs-lookup"><span data-stu-id="f9f12-353">Instead, select a tier and instance size that meet your performance requirements under typical load, and then [scale out](/azure/app-service-web/web-sites-scale/) the instances to handle changes in traffic volume.</span></span> <span data-ttu-id="f9f12-354">Expandir e reduzir verticalmente pode disparar uma reinicialização do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-354">Scaling up and down may trigger an application restart.</span></span>  

<span data-ttu-id="f9f12-355">**Armazene a configuração como configurações de aplicativo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-355">**Store configuration as app settings.**</span></span> <span data-ttu-id="f9f12-356">Use as configurações de aplicativo para manter definições de configuração como configurações de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-356">Use app settings to hold configuration settings as app settings.</span></span> <span data-ttu-id="f9f12-357">Defina as configurações em seus modelos do Resource Manager ou usando o PowerShell, para que você possa aplicá-las como parte de um processo automatizado de implantação/atualização, que é mais confiável.</span><span class="sxs-lookup"><span data-stu-id="f9f12-357">Define the settings in your Resource Manager templates, or using PowerShell, so that you can apply them as part of an automated deployment / update process, which is more reliable.</span></span> <span data-ttu-id="f9f12-358">Para obter mais informações, consulte [Configurar aplicativos Web no Serviço de Aplicativo do Azure](/azure/app-service-web/web-sites-configure/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-358">For more information, see [Configure web apps in Azure App Service](/azure/app-service-web/web-sites-configure/).</span></span>

<span data-ttu-id="f9f12-359">**Crie Planos do Serviço de Aplicativo separados para produção e teste.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-359">**Create separate App Service plans for production and test.**</span></span> <span data-ttu-id="f9f12-360">Não use slots em sua implantação de produção para teste.</span><span class="sxs-lookup"><span data-stu-id="f9f12-360">Don't use slots on your production deployment for testing.</span></span>  <span data-ttu-id="f9f12-361">Todos os aplicativos dentro do mesmo Plano do Serviço de Aplicativo compartilham as mesmas instâncias de VM.</span><span class="sxs-lookup"><span data-stu-id="f9f12-361">All apps within the same App Service plan share the same VM instances.</span></span> <span data-ttu-id="f9f12-362">Se você colocar a produção e implantações de teste no mesmo plano, isso poderá afetar negativamente a implantação de produção.</span><span class="sxs-lookup"><span data-stu-id="f9f12-362">If you put production and test deployments in the same plan, it can negatively affect the production deployment.</span></span> <span data-ttu-id="f9f12-363">Por exemplo, testes de carga podem prejudicar o site de produção dinâmica.</span><span class="sxs-lookup"><span data-stu-id="f9f12-363">For example, load tests might degrade the live production site.</span></span> <span data-ttu-id="f9f12-364">Colocando as implantações de teste em um plano separado, você as isola da versão de produção.</span><span class="sxs-lookup"><span data-stu-id="f9f12-364">By putting test deployments into a separate plan, you isolate them from the production version.</span></span>  

<span data-ttu-id="f9f12-365">**Separe aplicativos Web de APIs da Web.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-365">**Separate web apps from web APIs.**</span></span> <span data-ttu-id="f9f12-366">Se sua solução tem um front-end da Web e uma API da Web, considere a possibilidade de decompô-los em aplicativos de Serviço de Aplicativo separados.</span><span class="sxs-lookup"><span data-stu-id="f9f12-366">If your solution has both a web front-end and a web API, consider decomposing them into separate App Service apps.</span></span> <span data-ttu-id="f9f12-367">Esse design torna mais fácil para decompor a solução pela carga de trabalho.</span><span class="sxs-lookup"><span data-stu-id="f9f12-367">This design makes it easier to decompose the solution by workload.</span></span> <span data-ttu-id="f9f12-368">Você pode executar o aplicativo Web e a API em Planos do Serviço de Aplicativo separados, de modo que eles possam ser dimensionados de forma independente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-368">You can run the web app and the API in separate App Service plans, so they can be scaled independently.</span></span> <span data-ttu-id="f9f12-369">Se você não precisar desse nível de escalabilidade inicialmente, poderá implantar os aplicativos no mesmo plano e movê-los para planos separados posteriormente, se necessário.</span><span class="sxs-lookup"><span data-stu-id="f9f12-369">If you don't need that level of scalability at first, you can deploy the apps into the same plan, and move them into separate plans later, if needed.</span></span>

<span data-ttu-id="f9f12-370">**Evite usar o recurso de Serviço de Aplicativo de backup para fazer backup de Bancos de Dados SQL do Azure.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-370">**Avoid using the App Service backup feature to back up Azure SQL databases.**</span></span> <span data-ttu-id="f9f12-371">Em vez disso, use os [Backups automatizados do Banco de Dados SQL][sql-backup].</span><span class="sxs-lookup"><span data-stu-id="f9f12-371">Instead, use [SQL Database automated backups][sql-backup].</span></span> <span data-ttu-id="f9f12-372">O backup do Serviço de Aplicativo exporta o banco de dados para um arquivo .bacpac do SQL, que custa DTUs.</span><span class="sxs-lookup"><span data-stu-id="f9f12-372">App Service backup exports the database to a SQL .bacpac file, which costs DTUs.</span></span>  

<span data-ttu-id="f9f12-373">**Implante em um slot de preparo.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-373">**Deploy to a staging slot.**</span></span> <span data-ttu-id="f9f12-374">Crie um slot de implantação para preparo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-374">Create a deployment slot for staging.</span></span> <span data-ttu-id="f9f12-375">Implante atualizações de aplicativo para o slot de preparo e verifique a implantação antes de trocá-la para produção.</span><span class="sxs-lookup"><span data-stu-id="f9f12-375">Deploy application updates to the staging slot, and verify the deployment before swapping it into production.</span></span> <span data-ttu-id="f9f12-376">Isso reduz a chance de uma atualização inválida em produção.</span><span class="sxs-lookup"><span data-stu-id="f9f12-376">This reduces the chance of a bad update in production.</span></span> <span data-ttu-id="f9f12-377">Isso também garante que todas as instâncias sejam aquecidas antes de serem trocadas para produção.</span><span class="sxs-lookup"><span data-stu-id="f9f12-377">It also ensures that all instances are warmed up before being swapped into production.</span></span> <span data-ttu-id="f9f12-378">Muitos aplicativos têm um tempo significativo de aquecimento e de resfriamento.</span><span class="sxs-lookup"><span data-stu-id="f9f12-378">Many applications have a significant warmup and cold-start time.</span></span> <span data-ttu-id="f9f12-379">Para obter mais informações, consulte [Configurar ambientes de preparo para aplicativos Web no Serviço de Aplicativo do Azure](/azure/app-service-web/web-sites-staged-publishing/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-379">For more information, see [Set up staging environments for web apps in Azure App Service](/azure/app-service-web/web-sites-staged-publishing/).</span></span>

<span data-ttu-id="f9f12-380">**Crie um slot de implantação para conter a LKG (última implantação válida).**</span><span class="sxs-lookup"><span data-stu-id="f9f12-380">**Create a deployment slot to hold the last-known-good (LKG) deployment.**</span></span> <span data-ttu-id="f9f12-381">Quando você implanta uma atualização para produção, mova a implantação de produção anterior para o slot da LKG.</span><span class="sxs-lookup"><span data-stu-id="f9f12-381">When you deploy an update to production, move the previous production deployment into the LKG slot.</span></span> <span data-ttu-id="f9f12-382">Isso torna mais fácil reverter uma implantação incorreta.</span><span class="sxs-lookup"><span data-stu-id="f9f12-382">This makes it easier to roll back a bad deployment.</span></span> <span data-ttu-id="f9f12-383">Se você descobrir um problema posteriormente, você poderá reverter rapidamente para a versão LKG.</span><span class="sxs-lookup"><span data-stu-id="f9f12-383">If you discover a problem later, you can quickly revert to the LKG version.</span></span> <span data-ttu-id="f9f12-384">Para obter mais informações, veja [Basic web application](../reference-architectures/app-service-web-app/basic-web-app.md) (Aplicativo Web básico).</span><span class="sxs-lookup"><span data-stu-id="f9f12-384">For more information, see [Basic web application](../reference-architectures/app-service-web-app/basic-web-app.md).</span></span>

<span data-ttu-id="f9f12-385">**Habilite o log de diagnósticos**, incluindo o log de aplicativo e o log do servidor Web.</span><span class="sxs-lookup"><span data-stu-id="f9f12-385">**Enable diagnostics logging**, including application logging and web server logging.</span></span> <span data-ttu-id="f9f12-386">O registro em log é importante para monitoramento e diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="f9f12-386">Logging is important for monitoring and diagnostics.</span></span> <span data-ttu-id="f9f12-387">Consulte [Habilitar o registro de log de diagnóstico para aplicativos Web no Serviço de Aplicativo do Azure](/azure/app-service-web/web-sites-enable-diagnostic-log/)</span><span class="sxs-lookup"><span data-stu-id="f9f12-387">See [Enable diagnostics logging for web apps in Azure App Service](/azure/app-service-web/web-sites-enable-diagnostic-log/)</span></span>

<span data-ttu-id="f9f12-388">**Registre em log para o Armazenamento de Blobs.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-388">**Log to blob storage.**</span></span> <span data-ttu-id="f9f12-389">Isso torna mais fácil coletar e analisar os dados.</span><span class="sxs-lookup"><span data-stu-id="f9f12-389">This makes it easier to collect and analyze the data.</span></span>

<span data-ttu-id="f9f12-390">**Criar uma conta de armazenamento separada para logs.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-390">**Create a separate storage account for logs.**</span></span> <span data-ttu-id="f9f12-391">Não use a mesma conta de armazenamento para logs e dados de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-391">Don't use the same storage account for logs and application data.</span></span> <span data-ttu-id="f9f12-392">Isso ajuda a impedir o registro em log de reduzir o desempenho do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-392">This helps to prevent logging from reducing application performance.</span></span>

<span data-ttu-id="f9f12-393">**Monitore o desempenho.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-393">**Monitor performance.**</span></span> <span data-ttu-id="f9f12-394">Use um serviço de monitoramento de desempenho como o [New Relic](http://newrelic.com/) ou o [Application Insights](/azure/application-insights/app-insights-overview/) para monitorar o desempenho e o comportamento do aplicativo sob carga.</span><span class="sxs-lookup"><span data-stu-id="f9f12-394">Use a performance monitoring service such as [New Relic](http://newrelic.com/) or [Application Insights](/azure/application-insights/app-insights-overview/) to monitor application performance and behavior under load.</span></span>  <span data-ttu-id="f9f12-395">O monitoramento de desempenho fornece informações sobre o aplicativo em tempo real.</span><span class="sxs-lookup"><span data-stu-id="f9f12-395">Performance monitoring gives you real-time insight into the application.</span></span> <span data-ttu-id="f9f12-396">Ele permite a você diagnosticar problemas e executar a análise de causa raiz de falhas.</span><span class="sxs-lookup"><span data-stu-id="f9f12-396">It enables you to diagnose issues and perform root-cause analysis of failures.</span></span>

### <a name="application-gateway"></a><span data-ttu-id="f9f12-397">Gateway de Aplicativo</span><span class="sxs-lookup"><span data-stu-id="f9f12-397">Application Gateway</span></span>

<span data-ttu-id="f9f12-398">**Provisione pelo menos duas instâncias.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-398">**Provision at least two instances.**</span></span> <span data-ttu-id="f9f12-399">Implante um Gateway de Aplicativo com pelo menos duas instâncias.</span><span class="sxs-lookup"><span data-stu-id="f9f12-399">Deploy Application Gateway with at least two instances.</span></span> <span data-ttu-id="f9f12-400">Uma única instância é um ponto único de falha.</span><span class="sxs-lookup"><span data-stu-id="f9f12-400">A single instance is a single point of failure.</span></span> <span data-ttu-id="f9f12-401">Use duas ou mais instâncias para redundância e escalabilidade.</span><span class="sxs-lookup"><span data-stu-id="f9f12-401">Use two or more instances for redundancy and scalability.</span></span> <span data-ttu-id="f9f12-402">Para se qualificar para o [SLA](https://azure.microsoft.com/support/legal/sla/application-gateway/v1_0/), você deverá provisionar duas ou mais instâncias médias ou maiores.</span><span class="sxs-lookup"><span data-stu-id="f9f12-402">In order to qualify for the [SLA](https://azure.microsoft.com/support/legal/sla/application-gateway/v1_0/), you must provision two or more medium or larger instances.</span></span>

### <a name="cosmos-db"></a><span data-ttu-id="f9f12-403">Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="f9f12-403">Cosmos DB</span></span>

<span data-ttu-id="f9f12-404">**Replique o banco de dados entre regiões.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-404">**Replicate the database across regions.**</span></span> <span data-ttu-id="f9f12-405">O Cosmos DB permite associar qualquer número de regiões do Azure a uma conta de banco de dados do Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="f9f12-405">Cosmos DB allows you to associate any number of Azure regions with a Cosmos DB database account.</span></span> <span data-ttu-id="f9f12-406">Um banco de dados do Azure Cosmos DB pode ter várias regiões de leitura e uma de gravação.</span><span class="sxs-lookup"><span data-stu-id="f9f12-406">A Cosmos DB database can have one write region and multiple read regions.</span></span> <span data-ttu-id="f9f12-407">Se houver uma falha na região de gravação, você poderá ler de outra réplica.</span><span class="sxs-lookup"><span data-stu-id="f9f12-407">If there is a failure in the write region, you can read from another replica.</span></span> <span data-ttu-id="f9f12-408">O SDK do cliente lida com isso automaticamente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-408">The Client SDK handles this automatically.</span></span> <span data-ttu-id="f9f12-409">Você também pode fazer failover da região de gravação para outra região.</span><span class="sxs-lookup"><span data-stu-id="f9f12-409">You can also fail over the write region to another region.</span></span> <span data-ttu-id="f9f12-410">Para obter mais informações, confira [Como distribuir os dados globalmente com o Azure Cosmos DB](/azure/cosmos-db/distribute-data-globally).</span><span class="sxs-lookup"><span data-stu-id="f9f12-410">For more information, see [How to distribute data globally with Azure Cosmos DB](/azure/cosmos-db/distribute-data-globally).</span></span>

### <a name="redis-cache"></a><span data-ttu-id="f9f12-411">Cache Redis</span><span class="sxs-lookup"><span data-stu-id="f9f12-411">Redis Cache</span></span>

<span data-ttu-id="f9f12-412">**Configurar a replicação geográfica**.</span><span class="sxs-lookup"><span data-stu-id="f9f12-412">**Configure Geo-replication**.</span></span> <span data-ttu-id="f9f12-413">A Replicação geográfica fornece um mecanismo para vincular duas instâncias de Cache Redis do Azure de camada Premium.</span><span class="sxs-lookup"><span data-stu-id="f9f12-413">Geo-replication provides a mechanism for linking two Premium tier Azure Redis Cache instances.</span></span> <span data-ttu-id="f9f12-414">Os dados gravados no cache primário são replicados para um cache secundário de somente leitura.</span><span class="sxs-lookup"><span data-stu-id="f9f12-414">Data written to the primary cache is replicated to a secondary read-only cache.</span></span> <span data-ttu-id="f9f12-415">Para obter mais informações, consulte [Como configurar a replicação geográfica do Cache Redis do Azure](/azure/redis-cache/cache-how-to-geo-replication)</span><span class="sxs-lookup"><span data-stu-id="f9f12-415">For more information, see [How to configure Geo-replication for Azure Redis Cache](/azure/redis-cache/cache-how-to-geo-replication)</span></span>

<span data-ttu-id="f9f12-416">**Configurar a persistência de dados.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-416">**Configure data persistence.**</span></span> <span data-ttu-id="f9f12-417">A persistência do Redis permite persistir os dados armazenados no Redis.</span><span class="sxs-lookup"><span data-stu-id="f9f12-417">Redis persistence allows you to persist data stored in Redis.</span></span> <span data-ttu-id="f9f12-418">Você também pode tirar instantâneos e fazer backup dos dados, que podem ser carregados em caso de falha de hardware.</span><span class="sxs-lookup"><span data-stu-id="f9f12-418">You can also take snapshots and back up the data, which you can load in case of a hardware failure.</span></span> <span data-ttu-id="f9f12-419">Para obter mais informações, consulte [Como configurar a persistência de dados para um Cache Redis do Azure Premium](/azure/redis-cache/cache-how-to-premium-persistence)</span><span class="sxs-lookup"><span data-stu-id="f9f12-419">For more information, see [How to configure data persistence for a Premium Azure Redis Cache](/azure/redis-cache/cache-how-to-premium-persistence)</span></span>

<span data-ttu-id="f9f12-420">Caso esteja usando o Cache Redis como um cache de dados temporário e não como um armazenamento persistente, essas recomendações podem não ser aplicadas.</span><span class="sxs-lookup"><span data-stu-id="f9f12-420">If you are using Redis Cache as a temporary data cache and not as a persistent store, these recommendations may not apply.</span></span> 

### <a name="search"></a><span data-ttu-id="f9f12-421">Search</span><span class="sxs-lookup"><span data-stu-id="f9f12-421">Search</span></span>

<span data-ttu-id="f9f12-422">**Provisione mais de uma réplica.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-422">**Provision more than one replica.**</span></span> <span data-ttu-id="f9f12-423">Use pelo menos duas réplicas para alta disponibilidade de leitura ou três para alta disponibilidade de leitura/gravação.</span><span class="sxs-lookup"><span data-stu-id="f9f12-423">Use at least two replicas for read high-availability, or three for read-write high-availability.</span></span>

<span data-ttu-id="f9f12-424">**Configure indexadores para implantações de várias regiões.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-424">**Configure indexers for multi-region deployments.**</span></span> <span data-ttu-id="f9f12-425">Se você tiver uma implantação de várias regiões, considere as opções para a continuidade na indexação.</span><span class="sxs-lookup"><span data-stu-id="f9f12-425">If you have a multi-region deployment, consider your options for continuity in indexing.</span></span>

  * <span data-ttu-id="f9f12-426">Se a fonte de dados é com replicação geográfica, você geralmente deve apontar cada indexador de cada serviço do Azure Search regional para a respectiva réplica de fonte de dados local.</span><span class="sxs-lookup"><span data-stu-id="f9f12-426">If the data source is geo-replicated, you should generally point each indexer of each regional Azure Search service to its local data source replica.</span></span> <span data-ttu-id="f9f12-427">No entanto, essa abordagem não é recomendada para grandes conjuntos de dados armazenados no Banco de Dados SQL do Azure.</span><span class="sxs-lookup"><span data-stu-id="f9f12-427">However, that approach is not recommended for large datasets stored in Azure SQL Database.</span></span> <span data-ttu-id="f9f12-428">O motivo é que o Azure Search não pode executar a indexação incremental de réplicas de Banco de Dados SQL secundárias, somente de réplicas primárias.</span><span class="sxs-lookup"><span data-stu-id="f9f12-428">The reason is that Azure Search cannot perform incremental indexing from secondary SQL Database replicas, only from primary replicas.</span></span> <span data-ttu-id="f9f12-429">Em vez disso, aponte todos os indexadores para a réplica primária.</span><span class="sxs-lookup"><span data-stu-id="f9f12-429">Instead, point all indexers to the primary replica.</span></span> <span data-ttu-id="f9f12-430">Após um failover, aponte os indexadores do Azure Search para a nova réplica primária.</span><span class="sxs-lookup"><span data-stu-id="f9f12-430">After a failover, point the Azure Search indexers at the new primary replica.</span></span>  
  * <span data-ttu-id="f9f12-431">Se a fonte de dados não é com replicação geográfica, aponte vários indexadores na fonte de dados, de forma que os serviços do Azure Search façam a indexação da fonte de dados de modo contínuo e independente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-431">If the data source is not geo-replicated, point multiple indexers at the same data source, so that Azure Search services in multiple regions continuously and independently index from the data source.</span></span> <span data-ttu-id="f9f12-432">Para obter mais informações, consulte [Considerações de desempenho e otimização do Azure Search][search-optimization].</span><span class="sxs-lookup"><span data-stu-id="f9f12-432">For more information, see [Azure Search performance and optimization considerations][search-optimization].</span></span>

### <a name="storage"></a><span data-ttu-id="f9f12-433">Armazenamento</span><span class="sxs-lookup"><span data-stu-id="f9f12-433">Storage</span></span>

<span data-ttu-id="f9f12-434">**Para dados de aplicativo, use RA-GRS (armazenamento com redundância geográfica com acesso de leitura).**</span><span class="sxs-lookup"><span data-stu-id="f9f12-434">**For application data, use read-access geo-redundant storage (RA-GRS).**</span></span> <span data-ttu-id="f9f12-435">O armazenamento de RA-GRS replica os dados para uma região secundária e fornece acesso somente leitura da região secundária.</span><span class="sxs-lookup"><span data-stu-id="f9f12-435">RA-GRS storage replicates the data to a secondary region, and provides read-only access from the secondary region.</span></span> <span data-ttu-id="f9f12-436">Se há uma interrupção de armazenamento na região primária, o aplicativo pode ler os dados da região secundária.</span><span class="sxs-lookup"><span data-stu-id="f9f12-436">If there is a storage outage in the primary region, the application can read the data from the secondary region.</span></span> <span data-ttu-id="f9f12-437">Para obter mais informações, consulte [Replicação do Armazenamento do Azure](/azure/storage/storage-redundancy/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-437">For more information, see [Azure Storage replication](/azure/storage/storage-redundancy/).</span></span>

<span data-ttu-id="f9f12-438">**Para discos de VM, use os Managed Disks.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-438">**For VM disks, use Managed Disks.**</span></span> <span data-ttu-id="f9f12-439">Os [Managed Disks][managed-disks] fornecem melhor confiabilidade para as VMs em um conjunto de disponibilidade porque os discos ficam suficientemente isolados entre si para evitar pontos únicos de falha.</span><span class="sxs-lookup"><span data-stu-id="f9f12-439">[Managed Disks][managed-disks] provide better reliability for VMs in an availability set, because the disks are sufficiently isolated from each other to avoid single points of failure.</span></span> <span data-ttu-id="f9f12-440">Além disso, os Managed Disks não estão sujeitos a limites de IOPS de VHDs criados em uma conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="f9f12-440">Also, Managed Disks aren't subject to the IOPS limits of VHDs created in a storage account.</span></span> <span data-ttu-id="f9f12-441">Para saber mais, consulte [Gerenciar a disponibilidade de máquinas virtuais Windows no Azure][vm-manage-availability].</span><span class="sxs-lookup"><span data-stu-id="f9f12-441">For more information, see [Manage the availability of Windows virtual machines in Azure][vm-manage-availability].</span></span>

<span data-ttu-id="f9f12-442">**Para o Armazenamento de Filas, crie uma fila de backup em outra região.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-442">**For Queue storage, create a backup queue in another region.**</span></span> <span data-ttu-id="f9f12-443">Para o armazenamento de fila, a utilidade de uma réplica somente leitura é limitada, porque não é possível enfileirar itens nem removê-los da fila.</span><span class="sxs-lookup"><span data-stu-id="f9f12-443">For Queue storage, a read-only replica has limited use, because you can't queue or dequeue items.</span></span> <span data-ttu-id="f9f12-444">Em vez disso, crie uma fila de backup em uma conta de armazenamento em outra região.</span><span class="sxs-lookup"><span data-stu-id="f9f12-444">Instead, create a backup queue in a storage account in another region.</span></span> <span data-ttu-id="f9f12-445">Se houver uma interrupção de armazenamento, o aplicativo poderá usar a fila de backup até que a região primária fique disponível novamente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-445">If there is a storage outage, the application can use the backup queue, until the primary region becomes available again.</span></span> <span data-ttu-id="f9f12-446">Dessa forma, o aplicativo ainda poderá processar novas solicitações.</span><span class="sxs-lookup"><span data-stu-id="f9f12-446">That way, the application can still process new requests.</span></span>  

### <a name="sql-database"></a><span data-ttu-id="f9f12-447">Banco de dados SQL</span><span class="sxs-lookup"><span data-stu-id="f9f12-447">SQL Database</span></span>

<span data-ttu-id="f9f12-448">**Use a camada Standard ou Premium.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-448">**Use Standard or Premium tier.**</span></span> <span data-ttu-id="f9f12-449">Essas camadas fornecem um período de Recuperação Pontual mais longo (35 dias).</span><span class="sxs-lookup"><span data-stu-id="f9f12-449">These tiers provide a longer point-in-time restore period (35 days).</span></span> <span data-ttu-id="f9f12-450">Para obter mais informações, consulte [Opções e desempenho de Banco de Dados SQL](/azure/sql-database/sql-database-service-tiers/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-450">For more information, see [SQL Database options and performance](/azure/sql-database/sql-database-service-tiers/).</span></span>

<span data-ttu-id="f9f12-451">**Habilite a auditoria do Banco de Dados SQL.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-451">**Enable SQL Database auditing.**</span></span> <span data-ttu-id="f9f12-452">A auditoria pode ser usada para diagnosticar erros humanos ou ataques mal-intencionados.</span><span class="sxs-lookup"><span data-stu-id="f9f12-452">Auditing can be used to diagnose malicious attacks or human error.</span></span> <span data-ttu-id="f9f12-453">Para saber mais, confira [Introdução à Auditoria do Banco de Dados SQL](/azure/sql-database/sql-database-auditing-get-started/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-453">For more information, see [Get started with SQL database auditing](/azure/sql-database/sql-database-auditing-get-started/).</span></span>

<span data-ttu-id="f9f12-454">**Use a Replicação Geográfica Ativa**. Use a replicação geográfica ativa para criar uma réplica secundária legível em uma região diferente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-454">**Use Active Geo-Replication** Use Active Geo-Replication to create a readable secondary in a different region.</span></span>  <span data-ttu-id="f9f12-455">Se o seu banco de dados primário falhar ou simplesmente precisar ser colocado offline, faça um failover manual para qualquer o banco de dados secundário.</span><span class="sxs-lookup"><span data-stu-id="f9f12-455">If your primary database fails, or simply needs to be taken offline, perform a manual failover to the secondary database.</span></span>  <span data-ttu-id="f9f12-456">O banco de dados secundário permanece somente leitura até você fazer o failover.</span><span class="sxs-lookup"><span data-stu-id="f9f12-456">Until you fail over, the secondary database remains read-only.</span></span>  <span data-ttu-id="f9f12-457">Para saber mais, confira [Replicação Geográfica Ativa para o Banco de Dados SQL](/azure/sql-database/sql-database-geo-replication-overview/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-457">For more information, see [SQL Database Active Geo-Replication](/azure/sql-database/sql-database-geo-replication-overview/).</span></span>

<span data-ttu-id="f9f12-458">**Use fragmentação.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-458">**Use sharding.**</span></span> <span data-ttu-id="f9f12-459">Considere o uso de fragmentação para particionar o banco de dados horizontalmente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-459">Consider using sharding to partition the database horizontally.</span></span> <span data-ttu-id="f9f12-460">A fragmentação pode proporcionar o isolamento de falhas.</span><span class="sxs-lookup"><span data-stu-id="f9f12-460">Sharding can provide fault isolation.</span></span> <span data-ttu-id="f9f12-461">Para saber mais, confira [Expansão com o Banco de Dados SQL do Azure](/azure/sql-database/sql-database-elastic-scale-introduction/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-461">For more information, see [Scaling out with Azure SQL Database](/azure/sql-database/sql-database-elastic-scale-introduction/).</span></span>

<span data-ttu-id="f9f12-462">**Use a Recuperação Pontual para se recuperar de erro humano.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-462">**Use point-in-time restore to recover from human error.**</span></span>  <span data-ttu-id="f9f12-463">A Recuperação Pontual retorna seu banco de dados para um ponto anterior no tempo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-463">Point-in-time restore returns your database to an earlier point in time.</span></span> <span data-ttu-id="f9f12-464">Para obter mais informações, consulte [Recuperar um Banco de Dados SQL do Azure usando backups de banco de dados automatizados][sql-restore].</span><span class="sxs-lookup"><span data-stu-id="f9f12-464">For more information, see [Recover an Azure SQL database using automated database backups][sql-restore].</span></span>

<span data-ttu-id="f9f12-465">**Use a restauração geográfica para recuperar-se de uma interrupção de serviço.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-465">**Use geo-restore to recover from a service outage.**</span></span> <span data-ttu-id="f9f12-466">A restauração geográfica restaura um banco de dados de um backup com redundância geográfica.</span><span class="sxs-lookup"><span data-stu-id="f9f12-466">Geo-restore restores a database from a geo-redundant backup.</span></span>  <span data-ttu-id="f9f12-467">Para obter mais informações, consulte [Recuperar um Banco de Dados SQL do Azure usando backups de banco de dados automatizados][sql-restore].</span><span class="sxs-lookup"><span data-stu-id="f9f12-467">For more information, see [Recover an Azure SQL database using automated database backups][sql-restore].</span></span>

### <a name="sql-server-running-in-a-vm"></a><span data-ttu-id="f9f12-468">SQL Server em execução em uma VM</span><span class="sxs-lookup"><span data-stu-id="f9f12-468">SQL Server running in a VM</span></span>

<span data-ttu-id="f9f12-469">**Replicar o banco de dados.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-469">**Replicate the database.**</span></span> <span data-ttu-id="f9f12-470">Use os Grupos de Disponibilidade Always On do SQL Server para replicar o banco de dados.</span><span class="sxs-lookup"><span data-stu-id="f9f12-470">Use SQL Server Always On Availability Groups to replicate the database.</span></span> <span data-ttu-id="f9f12-471">Fornece alta disponibilidade se uma instância do SQL Server falha.</span><span class="sxs-lookup"><span data-stu-id="f9f12-471">Provides high availability if one SQL Server instance fails.</span></span> <span data-ttu-id="f9f12-472">Para obter mais informações, consulte [Executar VMs do Windows para um aplicativo de N camadas](../reference-architectures/virtual-machines-windows/n-tier.md)</span><span class="sxs-lookup"><span data-stu-id="f9f12-472">For more information, see [Run Windows VMs for an N-tier application](../reference-architectures/virtual-machines-windows/n-tier.md)</span></span>

<span data-ttu-id="f9f12-473">**Fazer backup do banco de dados**.</span><span class="sxs-lookup"><span data-stu-id="f9f12-473">**Back up the database**.</span></span> <span data-ttu-id="f9f12-474">Se você já estiver usando [Backup do Azure](https://azure.microsoft.com/documentation/services/backup/) para fazer backup de suas VMs, considere usar o [Backup do Azure para cargas de trabalho do SQL Server usando o DPM](/azure/backup/backup-azure-backup-sql/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-474">If you are already using [Azure Backup](https://azure.microsoft.com/documentation/services/backup/) to back up your VMs, consider using [Azure Backup for SQL Server workloads using DPM](/azure/backup/backup-azure-backup-sql/).</span></span> <span data-ttu-id="f9f12-475">Com essa abordagem, há uma função de administrador de backup para a organização e um procedimento de recuperação unificado para as VMs e o SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f9f12-475">With this approach, there is one backup administrator role for the organization and a unified recovery procedure for VMs and SQL Server.</span></span> <span data-ttu-id="f9f12-476">Caso contrário, use o [Backup gerenciado pelo SQL Server para o Microsoft Azure](https://msdn.microsoft.com/library/dn449496.aspx).</span><span class="sxs-lookup"><span data-stu-id="f9f12-476">Otherwise, use [SQL Server Managed Backup to Microsoft Azure](https://msdn.microsoft.com/library/dn449496.aspx).</span></span>

### <a name="traffic-manager"></a><span data-ttu-id="f9f12-477">Gerenciador de Tráfego</span><span class="sxs-lookup"><span data-stu-id="f9f12-477">Traffic Manager</span></span>

<span data-ttu-id="f9f12-478">**Faça o failback manual.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-478">**Perform manual failback.**</span></span> <span data-ttu-id="f9f12-479">Após um failover do Gerenciador de Tráfego, faça o failback manual em vez de automaticamente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-479">After a Traffic Manager failover, perform manual failback, rather than automatically failing back.</span></span> <span data-ttu-id="f9f12-480">Verifique se todos os subsistemas de aplicativo estão íntegros antes de fazer o failback.</span><span class="sxs-lookup"><span data-stu-id="f9f12-480">Before failing back, verify that all application subsystems are healthy.</span></span>  <span data-ttu-id="f9f12-481">Caso contrário, você pode criar uma situação em que o aplicativo fica alternando entre os data centers.</span><span class="sxs-lookup"><span data-stu-id="f9f12-481">Otherwise, you can create a situation where the application flips back and forth between data centers.</span></span> <span data-ttu-id="f9f12-482">Para obter mais informações, consulte [Executar VMs em várias regiões para ter alta disponibilidade](../reference-architectures/virtual-machines-windows/multi-region-application.md).</span><span class="sxs-lookup"><span data-stu-id="f9f12-482">For more information, see [Run VMs in multiple regions for high availability](../reference-architectures/virtual-machines-windows/multi-region-application.md).</span></span>

<span data-ttu-id="f9f12-483">**Criar um ponto de extremidade de investigação de integridade.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-483">**Create a health probe endpoint.**</span></span> <span data-ttu-id="f9f12-484">Crie um ponto de extremidade personalizado que relata a integridade geral do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-484">Create a custom endpoint that reports on the overall health of the application.</span></span> <span data-ttu-id="f9f12-485">Isso permite que o Gerenciador de Tráfego faça failover se qualquer caminho crítico falha, não apenas o front-end.</span><span class="sxs-lookup"><span data-stu-id="f9f12-485">This enables Traffic Manager to fail over if any critical path fails, not just the front end.</span></span> <span data-ttu-id="f9f12-486">O ponto de extremidade deve retornar um código de erro HTTP se qualquer dependência crítica está não íntegra ou inacessível.</span><span class="sxs-lookup"><span data-stu-id="f9f12-486">The endpoint should return an HTTP error code if any critical dependency is unhealthy or unreachable.</span></span> <span data-ttu-id="f9f12-487">No entanto, não relate erros para serviços não críticos.</span><span class="sxs-lookup"><span data-stu-id="f9f12-487">Don't report errors for non-critical services, however.</span></span> <span data-ttu-id="f9f12-488">Caso contrário, a investigação de integridade poderá disparar o failover quando ele não for necessário, criando falsos positivos.</span><span class="sxs-lookup"><span data-stu-id="f9f12-488">Otherwise, the health probe might trigger failover when it's not needed, creating false positives.</span></span> <span data-ttu-id="f9f12-489">Para obter mais informações, consulte [Monitoramento e failover do ponto de extremidade do Gerenciador de Tráfego](/azure/traffic-manager/traffic-manager-monitoring/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-489">For more information, see [Traffic Manager endpoint monitoring and failover](/azure/traffic-manager/traffic-manager-monitoring/).</span></span>

### <a name="virtual-machines"></a><span data-ttu-id="f9f12-490">Máquinas Virtuais</span><span class="sxs-lookup"><span data-stu-id="f9f12-490">Virtual Machines</span></span>

<span data-ttu-id="f9f12-491">**Evite executar uma carga de trabalho de produção em uma única VM.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-491">**Avoid running a production workload on a single VM.**</span></span> <span data-ttu-id="f9f12-492">Uma única implantação de VM não é resiliente para manutenção (planejada ou não).</span><span class="sxs-lookup"><span data-stu-id="f9f12-492">A single VM deployment is not resilient to planned or unplanned maintenance.</span></span> <span data-ttu-id="f9f12-493">Em vez disso, coloque várias VMs em um conjunto de disponibilidade ou [conjunto de dimensionamento de VM](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/), com um balanceador de carga na frente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-493">Instead, put multiple VMs in an availability set or [VM scale set](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-overview/), with a load balancer in front.</span></span>

<span data-ttu-id="f9f12-494">**Especifique um conjunto de disponibilidade ao provisionar a VM.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-494">**Specify an availability set when you provision the VM.**</span></span> <span data-ttu-id="f9f12-495">Atualmente, não há nenhuma maneira de adicionar uma VM a um conjunto de disponibilidade depois que a VM é provisionada.</span><span class="sxs-lookup"><span data-stu-id="f9f12-495">Currently, there is no way to add a VM to an availability set after the VM is provisioned.</span></span> <span data-ttu-id="f9f12-496">Quando você adiciona uma nova VM a um conjunto de disponibilidade existente, verifique se você criou um adaptador de rede para a VM e adicione o adaptador de rede ao pool de endereços de back-end no balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="f9f12-496">When you add a new VM to an existing availability set, make sure to create a NIC for the VM, and add the NIC to the back-end address pool on the load balancer.</span></span> <span data-ttu-id="f9f12-497">Caso contrário, o balanceador de carga não roteará o tráfego de rede para essa VM.</span><span class="sxs-lookup"><span data-stu-id="f9f12-497">Otherwise, the load balancer won't route network traffic to that VM.</span></span>

<span data-ttu-id="f9f12-498">**Coloque cada camada de aplicativo em um conjunto de disponibilidade separado.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-498">**Put each application tier into a separate Availability Set.**</span></span> <span data-ttu-id="f9f12-499">Em um aplicativo de N camadas, não coloque as VMs de camadas diferentes no mesmo conjunto de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="f9f12-499">In an N-tier application, don't put VMs from different tiers into the same availability set.</span></span> <span data-ttu-id="f9f12-500">VMs em um conjunto de disponibilidade são colocadas em FDs (domínios de falha) e UDs (domínios de atualização).</span><span class="sxs-lookup"><span data-stu-id="f9f12-500">VMs in an availability set are placed across fault domains (FDs) and update domains (UD).</span></span> <span data-ttu-id="f9f12-501">No entanto, para obter o benefício de redundância de FDs e UDs, todas as VMs no conjunto de disponibilidade devem ser capazes de lidar com as mesmas solicitações de cliente.</span><span class="sxs-lookup"><span data-stu-id="f9f12-501">However, to get the redundancy benefit of FDs and UDs, every VM in the availability set must be able to handle the same client requests.</span></span>

<span data-ttu-id="f9f12-502">**Escolha o tamanho de VM correto com base nos requisitos de desempenho.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-502">**Choose the right VM size based on performance requirements.**</span></span> <span data-ttu-id="f9f12-503">Ao mover uma carga de trabalho existente para o Azure, comece com o tamanho da VM que mais se aproxima de seus servidores locais.</span><span class="sxs-lookup"><span data-stu-id="f9f12-503">When moving an existing workload to Azure, start with the VM size that's the closest match to your on-premises servers.</span></span> <span data-ttu-id="f9f12-504">Em seguida, meça o desempenho da carga de trabalho real com relação à CPU, memória e IOPS e ajuste o tamanho, se necessário.</span><span class="sxs-lookup"><span data-stu-id="f9f12-504">Then measure the performance of your actual workload with respect to CPU, memory, and disk IOPS, and adjust the size if needed.</span></span> <span data-ttu-id="f9f12-505">Isso ajuda a garantir que o aplicativo se comporte como esperado em um ambiente de nuvem.</span><span class="sxs-lookup"><span data-stu-id="f9f12-505">This helps to ensure the application behaves as expected in a cloud environment.</span></span> <span data-ttu-id="f9f12-506">Além disso, se você precisar de várias NICs, esteja ciente do limite de NIC para cada tamanho.</span><span class="sxs-lookup"><span data-stu-id="f9f12-506">Also, if you need multiple NICs, be aware of the NIC limit for each size.</span></span>

<span data-ttu-id="f9f12-507">**Use Managed Disks para VHDs.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-507">**Use Managed Disks for VHDs.**</span></span> <span data-ttu-id="f9f12-508">Os [Managed Disks][managed-disks] fornecem melhor confiabilidade para as VMs em um conjunto de disponibilidade porque os discos ficam suficientemente isolados entre si para evitar pontos únicos de falha.</span><span class="sxs-lookup"><span data-stu-id="f9f12-508">[Managed Disks][managed-disks] provide better reliability for VMs in an availability set, because the disks are sufficiently isolated from each other to avoid single points of failure.</span></span> <span data-ttu-id="f9f12-509">Além disso, os Managed Disks não estão sujeitos a limites de IOPS de VHDs criados em uma conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="f9f12-509">Also, Managed Disks aren't subject to the IOPS limits of VHDs created in a storage account.</span></span> <span data-ttu-id="f9f12-510">Para saber mais, consulte [Gerenciar a disponibilidade de máquinas virtuais Windows no Azure][vm-manage-availability].</span><span class="sxs-lookup"><span data-stu-id="f9f12-510">For more information, see [Manage the availability of Windows virtual machines in Azure][vm-manage-availability].</span></span>

<span data-ttu-id="f9f12-511">**Instale aplicativos em um disco de dados, não no disco de SO.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-511">**Install applications on a data disk, not the OS disk.**</span></span> <span data-ttu-id="f9f12-512">Caso contrário, você poderá atingir o limite de tamanho do disco.</span><span class="sxs-lookup"><span data-stu-id="f9f12-512">Otherwise, you may reach the disk size limit.</span></span>

<span data-ttu-id="f9f12-513">**Use o Backup do Azure para fazer backup de VMs.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-513">**Use Azure Backup to back up VMs.**</span></span> <span data-ttu-id="f9f12-514">Os backups protegem contra perda de dados acidental.</span><span class="sxs-lookup"><span data-stu-id="f9f12-514">Backups protect against accidental data loss.</span></span> <span data-ttu-id="f9f12-515">Para obter mais informações, consulte [Proteger VMs do Azure com um cofre de serviços de recuperação](/azure/backup/backup-azure-vms-first-look-arm/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-515">For more information, see [Protect Azure VMs with a recovery services vault](/azure/backup/backup-azure-vms-first-look-arm/).</span></span>

<span data-ttu-id="f9f12-516">**Habilite logs de diagnóstico**, incluindo métricas de integridade básicas, logs de infraestrutura e [diagnóstico de inicialização][boot-diagnostics].</span><span class="sxs-lookup"><span data-stu-id="f9f12-516">**Enable diagnostic logs**, including basic health metrics, infrastructure logs, and [boot diagnostics][boot-diagnostics].</span></span> <span data-ttu-id="f9f12-517">O diagnóstico de inicialização poderá ajudar a diagnosticar uma falha de inicialização se sua VM entrar em um estado não inicializável.</span><span class="sxs-lookup"><span data-stu-id="f9f12-517">Boot diagnostics can help you diagnose a boot failure if your VM gets into a non-bootable state.</span></span> <span data-ttu-id="f9f12-518">Para obter mais informações, consulte [Visão Geral dos Logs de Diagnóstico do Azure][diagnostics-logs].</span><span class="sxs-lookup"><span data-stu-id="f9f12-518">For more information, see [Overview of Azure Diagnostic Logs][diagnostics-logs].</span></span>

<span data-ttu-id="f9f12-519">**Use a Extensão AzureLogCollector.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-519">**Use the AzureLogCollector extension.**</span></span> <span data-ttu-id="f9f12-520">(Somente VMs do Windows.) Essa extensão agrega logs da plataforma do Azure e carrega-os no Armazenamento do Azure, sem que o operador faça logon remotamente na VM.</span><span class="sxs-lookup"><span data-stu-id="f9f12-520">(Windows VMs only.) This extension aggregates Azure platform logs and uploads them to Azure storage, without the operator remotely logging into the VM.</span></span> <span data-ttu-id="f9f12-521">Para obter mais informações, consulte [Extensão do AzureLogCollector](/azure/virtual-machines/virtual-machines-windows-log-collector-extension/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="f9f12-521">For more information, see [AzureLogCollector Extension](/azure/virtual-machines/virtual-machines-windows-log-collector-extension/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

### <a name="virtual-network"></a><span data-ttu-id="f9f12-522">Rede Virtual</span><span class="sxs-lookup"><span data-stu-id="f9f12-522">Virtual Network</span></span>

<span data-ttu-id="f9f12-523">**Para incluir endereços IP públicos na lista de permissões ou bloqueá-los, adicione um NSG à sub-rede.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-523">**To whitelist or block public IP addresses, add an NSG to the subnet.**</span></span> <span data-ttu-id="f9f12-524">Bloqueie o acesso de usuários mal-intencionados ou permita o acesso somente de usuários que têm o privilégio de acessar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="f9f12-524">Block access from malicious users, or allow access only from users who have privilege to access the application.</span></span>  

<span data-ttu-id="f9f12-525">**Crie uma investigação de integridade personalizada.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-525">**Create a custom health probe.**</span></span> <span data-ttu-id="f9f12-526">As investigações de integridade do balanceador de carga podem testar HTTP ou TCP.</span><span class="sxs-lookup"><span data-stu-id="f9f12-526">Load Balancer Health Probes can test either HTTP or TCP.</span></span> <span data-ttu-id="f9f12-527">Se uma VM for executada em um servidor HTTP, a investigação HTTP será um melhor indicador do status de integridade do que uma investigação TCP.</span><span class="sxs-lookup"><span data-stu-id="f9f12-527">If a VM runs an HTTP server, the HTTP probe is a better indicator of health status than a TCP probe.</span></span> <span data-ttu-id="f9f12-528">Para uma investigação HTTP, use um ponto de extremidade personalizado que relata a integridade geral do aplicativo, incluindo todas as dependências críticas.</span><span class="sxs-lookup"><span data-stu-id="f9f12-528">For an HTTP probe, use a custom endpoint that reports the overall health of the application, including all critical dependencies.</span></span> <span data-ttu-id="f9f12-529">Para obter mais informações, veja [Visão geral do Azure Load Balancer](/azure/load-balancer/load-balancer-overview/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-529">For more information, see [Azure Load Balancer overview](/azure/load-balancer/load-balancer-overview/).</span></span>

<span data-ttu-id="f9f12-530">**Não bloqueie a investigação de integridade.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-530">**Don't block the health probe.**</span></span> <span data-ttu-id="f9f12-531">A investigação de integridade do balanceador de carga é enviada de um endereço IP conhecido, 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="f9f12-531">The Load Balancer Health probe is sent from a known IP address, 168.63.129.16.</span></span> <span data-ttu-id="f9f12-532">Não bloqueie o tráfego de ou para esse IP em nenhuma política de firewall ou regra de NSG (Grupo de Segurança de Rede).</span><span class="sxs-lookup"><span data-stu-id="f9f12-532">Don't block traffic to or from this IP in any firewall policies or network security group (NSG) rules.</span></span> <span data-ttu-id="f9f12-533">Bloquear a investigação de integridade faria com que o balanceador de carga remova a VM da rotação.</span><span class="sxs-lookup"><span data-stu-id="f9f12-533">Blocking the health probe would cause the load balancer to remove the VM from rotation.</span></span>

<span data-ttu-id="f9f12-534">**Habilite o registro em log do balanceador de carga.**</span><span class="sxs-lookup"><span data-stu-id="f9f12-534">**Enable Load Balancer logging.**</span></span> <span data-ttu-id="f9f12-535">Os logs de mostram quantas muitas VMs no back-end não estão recebendo o tráfego de rede devido a respostas de investigação com falha.</span><span class="sxs-lookup"><span data-stu-id="f9f12-535">The logs show how many VMs on the back-end are not receiving network traffic due to failed probe responses.</span></span> <span data-ttu-id="f9f12-536">Para obter mais informações, consulte [Log Analytics para o Azure Load Balancer](/azure/load-balancer/load-balancer-monitor-log/).</span><span class="sxs-lookup"><span data-stu-id="f9f12-536">For more information, see [Log analytics for Azure Load Balancer](/azure/load-balancer/load-balancer-monitor-log/).</span></span>


<!-- links -->
[app-service-autoscale]: /azure/monitoring-and-diagnostics/insights-how-to-scale/
[asynchronous-c-sharp]: /dotnet/articles/csharp/async
[availability-sets]:/azure/virtual-machines/virtual-machines-windows-manage-availability/
[azure-backup]: https://azure.microsoft.com/documentation/services/backup/
[boot-diagnostics]: https://azure.microsoft.com/blog/boot-diagnostics-for-virtual-machines-v2/
[circuit-breaker]: ../patterns/circuit-breaker.md
[cloud-service-autoscale]: /azure/cloud-services/cloud-services-how-to-scale/
[diagnostics-logs]: /azure/monitoring-and-diagnostics/monitoring-overview-of-diagnostic-logs/
[fma]: ../resiliency/failure-mode-analysis.md
[resilient-deployment]: ../resiliency/index.md#resilient-deployment
[load-balancer]: /azure/load-balancer/load-balancer-overview/
[managed-disks]: /azure/storage/storage-managed-disks-overview
[monitoring-and-diagnostics-guidance]: ../best-practices/monitoring.md
[resource-manager]: /azure/azure-resource-manager/resource-group-overview/
[retry-pattern]: ../patterns/retry.md
[retry-service-guidance]: ../best-practices/retry-service-specific.md
[search-optimization]: /azure/search/search-performance-optimization/
[sql-backup]: /azure/sql-database/sql-database-automated-backups/
[sql-restore]: /azure/sql-database/sql-database-recovery-using-backups/
[traffic-manager]: /azure/traffic-manager/traffic-manager-overview/
[traffic-manager-routing]: /azure/traffic-manager/traffic-manager-routing-methods/
[vm-manage-availability]: /azure/virtual-machines/windows/manage-availability#use-managed-disks-for-vms-in-an-availability-set
[vmss-autoscale]: /azure/virtual-machine-scale-sets/virtual-machine-scale-sets-autoscale-overview/
