---
title: Padrão sidecar
titleSuffix: Cloud Design Patterns
description: Implante os componentes de um aplicativo em um processo ou contêiner separado para fornecer isolamento e encapsulamento.
keywords: padrão de design
author: dragon119
ms.date: 06/23/2017
ms.topic: design-pattern
ms.service: architecture-center
ms.subservice: cloud-fundamentals
ms.custom: seodec18
ms.openlocfilehash: 2b0e46a06f7fe47f281f726f73128db1d7dd1067
ms.sourcegitcommit: 14226018a058e199523106199be9c07f6a3f8592
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/31/2019
ms.locfileid: "55482919"
---
# <a name="sidecar-pattern"></a><span data-ttu-id="359c3-104">Padrão sidecar</span><span class="sxs-lookup"><span data-stu-id="359c3-104">Sidecar pattern</span></span>

<span data-ttu-id="359c3-105">Implante os componentes de um aplicativo em um processo ou contêiner separado para fornecer isolamento e encapsulamento.</span><span class="sxs-lookup"><span data-stu-id="359c3-105">Deploy components of an application into a separate process or container to provide isolation and encapsulation.</span></span> <span data-ttu-id="359c3-106">Esse padrão também pode habilitar aplicativos para serem compostos por tecnologias e componentes heterogêneos.</span><span class="sxs-lookup"><span data-stu-id="359c3-106">This pattern can also enable applications to be composed of heterogeneous components and technologies.</span></span>

<span data-ttu-id="359c3-107">Esse padrão é denominado *Sidecar* porque é semelhante a um sidecar anexado a uma moto.</span><span class="sxs-lookup"><span data-stu-id="359c3-107">This pattern is named *Sidecar* because it resembles a sidecar attached to a motorcycle.</span></span> <span data-ttu-id="359c3-108">No padrão, o sidecar está anexado a um aplicativo pai e fornece recursos de suporte para o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="359c3-108">In the pattern, the sidecar is attached to a parent application and provides supporting features for the application.</span></span> <span data-ttu-id="359c3-109">O sidecar também compartilha o mesmo ciclo de vida do aplicativo pai, sendo criado e desativado junto com ele.</span><span class="sxs-lookup"><span data-stu-id="359c3-109">The sidecar also shares the same lifecycle as the parent application, being created and retired alongside the parent.</span></span> <span data-ttu-id="359c3-110">O padrão sidecar às vezes é conhecido como o padrão de sidekick e é um padrão de decomposição.</span><span class="sxs-lookup"><span data-stu-id="359c3-110">The sidecar pattern is sometimes referred to as the sidekick pattern and is a decomposition pattern.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="359c3-111">Contexto e problema</span><span class="sxs-lookup"><span data-stu-id="359c3-111">Context and Problem</span></span>

<span data-ttu-id="359c3-112">Aplicativos e serviços geralmente requerem funcionalidades relacionadas, como monitoramento, registro em log, configuração e serviços de rede.</span><span class="sxs-lookup"><span data-stu-id="359c3-112">Applications and services often require related functionality, such as monitoring, logging, configuration, and networking services.</span></span> <span data-ttu-id="359c3-113">Essas tarefas periféricas podem ser implementadas como componentes ou serviços separados.</span><span class="sxs-lookup"><span data-stu-id="359c3-113">These peripheral tasks can be implemented as separate components or services.</span></span>

<span data-ttu-id="359c3-114">Se elas estiverem intimamente integrados ao aplicativo, poderão ser executadas no mesmo processo que o aplicativo, usando com eficiência os recursos compartilhados.</span><span class="sxs-lookup"><span data-stu-id="359c3-114">If they are tightly integrated into the application, they can run in the same process as the application, making efficient use of shared resources.</span></span> <span data-ttu-id="359c3-115">No entanto, isso também significa que eles não são bem isolados e uma interrupção em um desses componentes poderia afetar os demais componentes ou todo o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="359c3-115">However, this also means they are not well isolated, and an outage in one of these components can affect other components or the entire application.</span></span> <span data-ttu-id="359c3-116">Além disso, eles geralmente precisam ser implementados usando o mesmo idioma que o aplicativo pai.</span><span class="sxs-lookup"><span data-stu-id="359c3-116">Also, they usually need to be implemented using the same language as the parent application.</span></span> <span data-ttu-id="359c3-117">Como resultado, o componente e o aplicativo têm uma interdependência íntima entre si.</span><span class="sxs-lookup"><span data-stu-id="359c3-117">As a result, the component and the application have close interdependence on each other.</span></span>

<span data-ttu-id="359c3-118">Se o aplicativo for decomposto em serviços, cada serviço poderá ser compilado usando diferentes linguagens e tecnologias.</span><span class="sxs-lookup"><span data-stu-id="359c3-118">If the application is decomposed into services, then each service can be built using different languages and technologies.</span></span> <span data-ttu-id="359c3-119">Embora isso proporcione maior flexibilidade, também significa que cada componente tem suas próprias dependências e requer bibliotecas específicas a um idioma para acessar a plataforma subjacente e qualquer recurso compartilhados com o aplicativo pai.</span><span class="sxs-lookup"><span data-stu-id="359c3-119">While this gives more flexibility, it means that each component has its own dependencies and requires language-specific libraries to access the underlying platform and any resources shared with the parent application.</span></span> <span data-ttu-id="359c3-120">Além disso, implantar esses recursos como serviços separados pode acrescentar latência ao aplicativo.</span><span class="sxs-lookup"><span data-stu-id="359c3-120">In addition, deploying these features as separate services can add latency to the application.</span></span> <span data-ttu-id="359c3-121">Gerenciar o código e as dependências para essas interfaces específicas a um idioma também pode agregar considerável complexidade, especialmente para hospedagem, implantação e gerenciamento.</span><span class="sxs-lookup"><span data-stu-id="359c3-121">Managing the code and dependencies for these language-specific interfaces can also add considerable complexity, especially for hosting, deployment, and management.</span></span>

## <a name="solution"></a><span data-ttu-id="359c3-122">Solução</span><span class="sxs-lookup"><span data-stu-id="359c3-122">Solution</span></span>

<span data-ttu-id="359c3-123">Posicione um conjunto consistente de tarefas no aplicativo principal, porém coloque-os dentro de seu próprio processo ou contêiner, fornecendo uma interface homogênea para serviços de plataforma entre linguagens.</span><span class="sxs-lookup"><span data-stu-id="359c3-123">Co-locate a cohesive set of tasks with the primary application, but place them inside their own process or container, providing a homogeneous interface for platform services across languages.</span></span>

![Diagrama do padrão Sidecar](./_images/sidecar.png)

<span data-ttu-id="359c3-125">Um serviço sidecar não faz necessariamente parte do aplicativo, mas está conectado a ele.</span><span class="sxs-lookup"><span data-stu-id="359c3-125">A sidecar service is not necessarily part of the application, but is connected to it.</span></span> <span data-ttu-id="359c3-126">Ele irá sempre onde o aplicativo pai for.</span><span class="sxs-lookup"><span data-stu-id="359c3-126">It goes wherever the parent application goes.</span></span> <span data-ttu-id="359c3-127">Sidecars são processos ou serviços de apoio que são implantados com o aplicativo principal.</span><span class="sxs-lookup"><span data-stu-id="359c3-127">Sidecars are supporting processes or services that are deployed with the primary application.</span></span> <span data-ttu-id="359c3-128">Em um moto, o sidecar é anexado a uma moto e cada moto pode ter seu próprio sidecar.</span><span class="sxs-lookup"><span data-stu-id="359c3-128">On a motorcycle, the sidecar is attached to one motorcycle, and each motorcycle can have its own sidecar.</span></span> <span data-ttu-id="359c3-129">Da mesma forma, um serviço sidecar compartilha a sina de seu aplicativo pai.</span><span class="sxs-lookup"><span data-stu-id="359c3-129">In the same way, a sidecar service shares the fate of its parent application.</span></span> <span data-ttu-id="359c3-130">Para cada instância do aplicativo, uma instância do sidecar é implantada e hospedada junto com ele.</span><span class="sxs-lookup"><span data-stu-id="359c3-130">For each instance of the application, an instance of the sidecar is deployed and hosted alongside it.</span></span>

<span data-ttu-id="359c3-131">Vantagens de usar um padrão de sidecar:</span><span class="sxs-lookup"><span data-stu-id="359c3-131">Advantages of using a sidecar pattern include:</span></span>

- <span data-ttu-id="359c3-132">Um sidecar é independente do seu aplicativo principal em termos de ambiente de tempo de execução e de linguagem de programação, portanto você não precisa desenvolver um sidecar por linguagem.</span><span class="sxs-lookup"><span data-stu-id="359c3-132">A sidecar is independent from its primary application in terms of runtime environment and programming language, so you don't need to develop one sidecar per language.</span></span>

- <span data-ttu-id="359c3-133">O sidecar pode acessar os mesmos recursos que o aplicativo principal.</span><span class="sxs-lookup"><span data-stu-id="359c3-133">The sidecar can access the same resources as the primary application.</span></span> <span data-ttu-id="359c3-134">Por exemplo, um sidecar pode monitorar os recursos do sistema usados tanto por ele mesmo quanto pelo aplicativo principal.</span><span class="sxs-lookup"><span data-stu-id="359c3-134">For example, a sidecar can monitor system resources used by both the sidecar and the primary application.</span></span>

- <span data-ttu-id="359c3-135">Por causa de sua proximidade do aplicativo principal, não há latência significativa ao se comunicar entre eles.</span><span class="sxs-lookup"><span data-stu-id="359c3-135">Because of its proximity to the primary application, there’s no significant latency when communicating between them.</span></span>

- <span data-ttu-id="359c3-136">Mesmo para aplicativos que não fornecem um mecanismo de extensibilidade, você pode usar um sidecar para estender a funcionalidade anexando-o como o próprio processo no mesmo host ou subcontêiner como o aplicativo principal.</span><span class="sxs-lookup"><span data-stu-id="359c3-136">Even for applications that don’t provide an extensibility mechanism, you can use a sidecar to extend functionality by attaching it as own process in the same host or sub-container as the primary application.</span></span>

<span data-ttu-id="359c3-137">O padrão de sidecar geralmente é usado com contêineres e conhecido como um contêiner de sidecar ou sidekick.</span><span class="sxs-lookup"><span data-stu-id="359c3-137">The sidecar pattern is often used with containers and referred to as a sidecar container or sidekick container.</span></span>

## <a name="issues-and-considerations"></a><span data-ttu-id="359c3-138">Problemas e considerações</span><span class="sxs-lookup"><span data-stu-id="359c3-138">Issues and Considerations</span></span>

- <span data-ttu-id="359c3-139">Considere a implantação e o formato de empacotamento que você usará para implantar serviços, processos ou contêineres.</span><span class="sxs-lookup"><span data-stu-id="359c3-139">Consider the deployment and packaging format you will use to deploy services, processes, or containers.</span></span> <span data-ttu-id="359c3-140">Contêineres são especialmente adequados para o padrão de sidecar.</span><span class="sxs-lookup"><span data-stu-id="359c3-140">Containers are particularly well suited to the sidecar pattern.</span></span>
- <span data-ttu-id="359c3-141">Ao projetar um serviço sidecar, escolha cuidadosamente o mecanismo de comunicação entre processos.</span><span class="sxs-lookup"><span data-stu-id="359c3-141">When designing a sidecar service, carefully decide on the interprocess communication mechanism.</span></span> <span data-ttu-id="359c3-142">Experimente usar tecnologias independente de linguagem ou estrutura, a menos que os requisitos de desempenho tornem isso inviável.</span><span class="sxs-lookup"><span data-stu-id="359c3-142">Try to use language- or framework-agnostic technologies unless performance requirements make that impractical.</span></span>
- <span data-ttu-id="359c3-143">Antes de colocar a funcionalidade em um sidecar, considere se ela funcionaria melhor como um serviço separado ou um daemon mais tradicional.</span><span class="sxs-lookup"><span data-stu-id="359c3-143">Before putting functionality into a sidecar, consider whether it would work better as a separate service or a more traditional daemon.</span></span>
- <span data-ttu-id="359c3-144">Considere também se a funcionalidade poderia ser implementada como uma biblioteca ou usando um mecanismo de extensão tradicional.</span><span class="sxs-lookup"><span data-stu-id="359c3-144">Also consider whether the functionality could be implemented as a library or using a traditional extension mechanism.</span></span> <span data-ttu-id="359c3-145">Bibliotecas específicas a um idioma podem ter um nível mais profundo de integração e menos sobrecarga de rede.</span><span class="sxs-lookup"><span data-stu-id="359c3-145">Language-specific libraries may have a deeper level of integration and less network overhead.</span></span>

## <a name="when-to-use-this-pattern"></a><span data-ttu-id="359c3-146">Quando usar esse padrão</span><span class="sxs-lookup"><span data-stu-id="359c3-146">When to Use this Pattern</span></span>

<span data-ttu-id="359c3-147">Use esse padrão quando:</span><span class="sxs-lookup"><span data-stu-id="359c3-147">Use this pattern when:</span></span>

- <span data-ttu-id="359c3-148">O aplicativo principal usa um conjunto heterogêneo de linguagens e estruturas.</span><span class="sxs-lookup"><span data-stu-id="359c3-148">Your primary application uses a heterogeneous set of languages and frameworks.</span></span> <span data-ttu-id="359c3-149">Um componente localizado em um serviço secundários pode ser consumido por aplicativos escritos em linguagens diferentes usando estruturas diferentes.</span><span class="sxs-lookup"><span data-stu-id="359c3-149">A component located in a sidecar service can be consumed by applications written in different languages using different frameworks.</span></span>
- <span data-ttu-id="359c3-150">Um componente pertence a uma equipe remota ou a uma organização diferente.</span><span class="sxs-lookup"><span data-stu-id="359c3-150">A component is owned by a remote team or a different organization.</span></span>
- <span data-ttu-id="359c3-151">Um componente ou recurso deve ser localizado no mesmo host que o aplicativo</span><span class="sxs-lookup"><span data-stu-id="359c3-151">A component or feature must be co-located on the same host as the application</span></span>
- <span data-ttu-id="359c3-152">Você precisa de um serviço que compartilha o ciclo de vida geral do aplicativo principal, mas pode ser atualizado independentemente.</span><span class="sxs-lookup"><span data-stu-id="359c3-152">You need a service that shares the overall lifecycle of your main application, but can be independently updated.</span></span>
- <span data-ttu-id="359c3-153">Você precisa de controle refinado sobre os limites do recurso para determinado recurso ou componente.</span><span class="sxs-lookup"><span data-stu-id="359c3-153">You need fine-grained control over resource limits for a particular resource or component.</span></span> <span data-ttu-id="359c3-154">Por exemplo, você talvez queira restringir a quantidade de memória que um componente específico usa.</span><span class="sxs-lookup"><span data-stu-id="359c3-154">For example, you may want to restrict the amount of memory a specific component uses.</span></span> <span data-ttu-id="359c3-155">Você pode implantar o componente como um sidecar e gerenciar o uso de memória, independentemente do aplicativo principal.</span><span class="sxs-lookup"><span data-stu-id="359c3-155">You can deploy the component as a sidecar and manage memory usage independently of the main application.</span></span>

<span data-ttu-id="359c3-156">Esse padrão pode não ser adequado:</span><span class="sxs-lookup"><span data-stu-id="359c3-156">This pattern may not be suitable:</span></span>

- <span data-ttu-id="359c3-157">Quando a comunicação entre processos precisa ser otimizada.</span><span class="sxs-lookup"><span data-stu-id="359c3-157">When interprocess communication needs to be optimized.</span></span> <span data-ttu-id="359c3-158">A comunicação entre um aplicativo pai e os serviços de sidecar incluem certa sobrecarga e latência notável nas chamadas.</span><span class="sxs-lookup"><span data-stu-id="359c3-158">Communication between a parent application and sidecar services includes some overhead, notably latency in the calls.</span></span> <span data-ttu-id="359c3-159">Essa pode não ser uma compensação aceitável para interfaces verborrágicas.</span><span class="sxs-lookup"><span data-stu-id="359c3-159">This may not be an acceptable trade-off for chatty interfaces.</span></span>
- <span data-ttu-id="359c3-160">Para pequenos aplicativos em que o custo do recurso da implantação de um serviço de sidecar para cada instância não compensa a vantagem de isolamento.</span><span class="sxs-lookup"><span data-stu-id="359c3-160">For small applications where the resource cost of deploying a sidecar service for each instance is not worth the advantage of isolation.</span></span>
- <span data-ttu-id="359c3-161">Quando o serviço precisa ser dimensionado de forma diferente ou independente dos aplicativos principais.</span><span class="sxs-lookup"><span data-stu-id="359c3-161">When the service needs to scale differently than or independently from the main applications.</span></span> <span data-ttu-id="359c3-162">Nesse caso, é melhor implantar o recurso como um serviço separado.</span><span class="sxs-lookup"><span data-stu-id="359c3-162">If so, it may be better to deploy the feature as a separate service.</span></span>

## <a name="example"></a><span data-ttu-id="359c3-163">Exemplo</span><span class="sxs-lookup"><span data-stu-id="359c3-163">Example</span></span>

<span data-ttu-id="359c3-164">O padrão sidecar se aplica a muitos cenários.</span><span class="sxs-lookup"><span data-stu-id="359c3-164">The sidecar pattern is applicable to many scenarios.</span></span> <span data-ttu-id="359c3-165">Alguns exemplos comuns:</span><span class="sxs-lookup"><span data-stu-id="359c3-165">Some common examples:</span></span>

- <span data-ttu-id="359c3-166">API de Infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="359c3-166">Infrastructure API.</span></span> <span data-ttu-id="359c3-167">A equipe de desenvolvimento de infraestrutura cria um serviço implantado ao lado de cada aplicativo, em vez de uma biblioteca de cliente específica a um idioma para acessar a infraestrutura.</span><span class="sxs-lookup"><span data-stu-id="359c3-167">The infrastructure development team creates a service that's deployed alongside each application, instead of a language-specific client library to access the infrastructure.</span></span> <span data-ttu-id="359c3-168">O serviço é carregado como um sidecar e fornece uma camada comum para serviços de infraestrutura, incluindo registro em log, dados de ambiente, repositório de configuração, descoberta, verificações de integridade e serviços de watchdog.</span><span class="sxs-lookup"><span data-stu-id="359c3-168">The service is loaded as a sidecar and provides a common layer for infrastructure services, including logging, environment data, configuration store, discovery, health checks, and watchdog services.</span></span> <span data-ttu-id="359c3-169">O secundário também monitora o ambiente de host do aplicativo pai e o processo (ou contêiner) e registra as informações em um serviço centralizado.</span><span class="sxs-lookup"><span data-stu-id="359c3-169">The sidecar also monitors the parent application's host environment and process (or container) and logs the information to a centralized service.</span></span>
- <span data-ttu-id="359c3-170">Gerenciar NGINX/HAProxy.</span><span class="sxs-lookup"><span data-stu-id="359c3-170">Manage NGINX/HAProxy.</span></span> <span data-ttu-id="359c3-171">Implante NGINX com um serviço sidecar que monitora o estado do ambiente, em seguida, atualize o arquivo de configuração NGINX e recicle o processo quando uma alteração de estado é necessária.</span><span class="sxs-lookup"><span data-stu-id="359c3-171">Deploy NGINX with a sidecar service that monitors environment state, then updates the NGINX configuration file and recycles the process when a change in state is needed.</span></span>
- <span data-ttu-id="359c3-172">Sidecar embaixador.</span><span class="sxs-lookup"><span data-stu-id="359c3-172">Ambassador sidecar.</span></span> <span data-ttu-id="359c3-173">Implantar um serviço [embaixador](./ambassador.md) como um sidecar.</span><span class="sxs-lookup"><span data-stu-id="359c3-173">Deploy an [ambassador](./ambassador.md) service as a sidecar.</span></span> <span data-ttu-id="359c3-174">O aplicativo chama por meio do embaixador, que lida com o registro em log de solicitações, roteamento, quebra de circuito e demais recursos relacionados à conectividade.</span><span class="sxs-lookup"><span data-stu-id="359c3-174">The application calls through the ambassador, which handles request logging, routing, circuit breaking, and other connectivity related features.</span></span>
- <span data-ttu-id="359c3-175">Proxy de descarregamento.</span><span class="sxs-lookup"><span data-stu-id="359c3-175">Offload proxy.</span></span> <span data-ttu-id="359c3-176">Coloque um proxy NGINX na frente de uma instância de serviço do node.js, para manipular a distribuição do conteúdo de arquivo estático para o serviço.</span><span class="sxs-lookup"><span data-stu-id="359c3-176">Place an NGINX proxy in front of a node.js service instance, to handle serving static file content for the service.</span></span>

## <a name="related-guidance"></a><span data-ttu-id="359c3-177">Diretrizes relacionadas</span><span class="sxs-lookup"><span data-stu-id="359c3-177">Related guidance</span></span>

- [<span data-ttu-id="359c3-178">Padrão Embaixador</span><span class="sxs-lookup"><span data-stu-id="359c3-178">Ambassador pattern</span></span>](./ambassador.md)
