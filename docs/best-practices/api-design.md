---
title: Diretrizes de design de API
description: "Orientação sobre como criar uma API bem projetada."
author: dragon119
ms.date: 07/13/2016
pnp.series.title: Best Practices
ms.openlocfilehash: 3ffadce1b0c4a4da808e52d61cff0b7f0b27de11
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/14/2017
---
# <a name="api-design"></a><span data-ttu-id="200d5-103">Design de API</span><span class="sxs-lookup"><span data-stu-id="200d5-103">API design</span></span>
[!INCLUDE [header](../_includes/header.md)]

<span data-ttu-id="200d5-104">Muitas soluções modernas baseadas na Web utilizam serviços Web, hospedados por servidores Web, para fornecer funcionalidades para aplicativos de cliente remoto.</span><span class="sxs-lookup"><span data-stu-id="200d5-104">Many modern web-based solutions make the use of web services, hosted by web servers, to provide functionality for remote client applications.</span></span> <span data-ttu-id="200d5-105">As operações que um serviço Web expõe constituem uma API da Web.</span><span class="sxs-lookup"><span data-stu-id="200d5-105">The operations that a web service exposes constitute a web API.</span></span> <span data-ttu-id="200d5-106">Uma API da Web bem projetada deve buscar apoiar:</span><span class="sxs-lookup"><span data-stu-id="200d5-106">A well-designed web API should aim to support:</span></span>

* <span data-ttu-id="200d5-107">**Independência de plataforma**.</span><span class="sxs-lookup"><span data-stu-id="200d5-107">**Platform independence**.</span></span> <span data-ttu-id="200d5-108">Aplicativos cliente devem ser capazes de utilizar a API que fornece o serviço Web, sem exigências sobre o modo como os dados ou operações expostos pela API são implementados fisicamente.</span><span class="sxs-lookup"><span data-stu-id="200d5-108">Client applications should be able to utilize the API that the web service provides without requiring how the data or operations that API exposes are physically implemented.</span></span> <span data-ttu-id="200d5-109">Isso requer que a API opere em conformidade com padrões comuns que permitem que um serviço Web e aplicativos de cliente concordem sobre quais formatos de dados utilizar e sobre a estrutura dos dados que são trocados entre aplicativos cliente e o serviço Web.</span><span class="sxs-lookup"><span data-stu-id="200d5-109">This requires that the API abides by common standards that enable a client application and web service to agree on which data formats to use, and the structure of the data that is exchanged between client applications and the web service.</span></span>
* <span data-ttu-id="200d5-110">**Evolução do serviço**.</span><span class="sxs-lookup"><span data-stu-id="200d5-110">**Service evolution**.</span></span> <span data-ttu-id="200d5-111">O serviço Web deve ser capaz de evoluir e adicionar (ou remover) funcionalidade independentemente de aplicativos cliente.</span><span class="sxs-lookup"><span data-stu-id="200d5-111">The web service should be able to evolve and add (or remove) functionality independently from client applications.</span></span> <span data-ttu-id="200d5-112">Os aplicativos existentes do cliente devem ser capazes de continuar a operar sem alterações conforme os recursos fornecidos pelo serviço Web são modificados.</span><span class="sxs-lookup"><span data-stu-id="200d5-112">Existing client applications should be able to continue to operate unmodified as the features provided by the web service change.</span></span> <span data-ttu-id="200d5-113">Todas as funcionalidades também devem ser detectáveis, para que os aplicativos cliente possam utilizá-las plenamente.</span><span class="sxs-lookup"><span data-stu-id="200d5-113">All functionality should also be discoverable, so that client applications can fully utilize it.</span></span>

<span data-ttu-id="200d5-114">A finalidade destas diretrizes é descrever as questões que você deve considerar ao criar uma API da Web.</span><span class="sxs-lookup"><span data-stu-id="200d5-114">The purpose of this guidance is to describe the issues that you should consider when designing a web API.</span></span>

## <a name="introduction-to-representational-state-transfer-rest"></a><span data-ttu-id="200d5-115">Introdução ao REST (Representational State Transfer)</span><span class="sxs-lookup"><span data-stu-id="200d5-115">Introduction to Representational State Transfer (REST)</span></span>
<span data-ttu-id="200d5-116">Em sua dissertação em 2000, Roy Fielding propôs uma abordagem de arquitetura alternativa para estruturar as operações expostas por serviços Web: REST.</span><span class="sxs-lookup"><span data-stu-id="200d5-116">In his dissertation in 2000, Roy Fielding proposed an alternative architectural approach to structuring the operations exposed by web services; REST.</span></span> <span data-ttu-id="200d5-117">REST é um estilo arquitetural para a criação de sistemas distribuídos com base em hipermídia.</span><span class="sxs-lookup"><span data-stu-id="200d5-117">REST is an architectural style for building distributed systems based on hypermedia.</span></span> <span data-ttu-id="200d5-118">Uma vantagem principal do modelo REST é que ele é baseado em padrões abertos e não vincula a implementação do modelo ou os aplicativos cliente que o acessam a nenhuma implementação específica.</span><span class="sxs-lookup"><span data-stu-id="200d5-118">A primary advantage of the REST model is that it is based on open standards and does not bind the implementation of the model or the client applications that access it to any specific implementation.</span></span> <span data-ttu-id="200d5-119">Por exemplo, um serviço Web REST poderia ser implementado usando a API Web ASP.NET da Microsoft, e aplicativos cliente poderiam ser desenvolvidos usando qualquer linguagem e conjunto de ferramentas capazes de gerar solicitações HTTP e analisar as respostas HTTP.</span><span class="sxs-lookup"><span data-stu-id="200d5-119">For example, a REST web service could be implemented by using the Microsoft ASP.NET Web API, and client applications could be developed by using any language and toolset that can generate HTTP requests and parse HTTP responses.</span></span>

> [!NOTE]
> <span data-ttu-id="200d5-120">O REST é, na verdade, independente de qualquer protocolo subjacente e não está necessariamente ligado a HTTP.</span><span class="sxs-lookup"><span data-stu-id="200d5-120">REST is actually independent of any underlying protocol and is not necessarily tied to HTTP.</span></span> <span data-ttu-id="200d5-121">No entanto, as implementações mais comuns dos sistemas baseados em REST utilizam HTTP como o protocolo de aplicativo para enviar e receber solicitações.</span><span class="sxs-lookup"><span data-stu-id="200d5-121">However, most common implementations of systems that are based on REST utilize HTTP as the application protocol for sending and receiving requests.</span></span> <span data-ttu-id="200d5-122">Este documento concentra-se no mapeamento de princípios REST para sistemas projetados para operar usando HTTP.</span><span class="sxs-lookup"><span data-stu-id="200d5-122">This document focuses on mapping REST principles to systems designed to operate using HTTP.</span></span>
>
>

<span data-ttu-id="200d5-123">O modelo de REST usa um esquema de navegação para representar objetos e serviços em uma rede (mencionados como *funcionalidades*).</span><span class="sxs-lookup"><span data-stu-id="200d5-123">The REST model uses a navigational scheme to represent objects and services over a network (referred to as *resources*).</span></span> <span data-ttu-id="200d5-124">Muitos sistemas que implementam REST geralmente usam o protocolo HTTP para transmitir solicitações para acessar esses recursos.</span><span class="sxs-lookup"><span data-stu-id="200d5-124">Many systems that implement REST typically use the HTTP protocol to transmit requests to access these resources.</span></span> <span data-ttu-id="200d5-125">Nesses sistemas, um aplicativo cliente envia uma solicitação na forma de um URI que identifica um recurso, além de um método HTTP (os mais comuns são GET, POST, PUT e DELETE) que indica a operação a ser executada nesse recurso.</span><span class="sxs-lookup"><span data-stu-id="200d5-125">In these systems, a client application submits a request in the form of a URI that identifies a resource, and an HTTP method (the most common being GET, POST, PUT, or DELETE) that indicates the operation to be performed on that resource.</span></span>  <span data-ttu-id="200d5-126">O corpo da solicitação HTTP contém os dados necessários para executar a operação.</span><span class="sxs-lookup"><span data-stu-id="200d5-126">The body of the HTTP request contains the data required to perform the operation.</span></span> <span data-ttu-id="200d5-127">O ponto que é importante entender é que o REST define um modelo de solicitação sem monitoração de estado.</span><span class="sxs-lookup"><span data-stu-id="200d5-127">The important point to understand is that REST defines a stateless request model.</span></span> <span data-ttu-id="200d5-128">Solicitações HTTP devem ser independentes e podem ocorrer em qualquer ordem, portanto, a tentativa de reter informações de estado transitório entre as solicitações não é viável.</span><span class="sxs-lookup"><span data-stu-id="200d5-128">HTTP requests should be independent and may occur in any order, so attempting to retain transient state information between requests is not feasible.</span></span>  <span data-ttu-id="200d5-129">O único local onde as informações são armazenadas é nos próprios recursos, e cada solicitação deve ser uma operação atômica.</span><span class="sxs-lookup"><span data-stu-id="200d5-129">The only place where information is stored is in the resources themselves, and each request should be an atomic operation.</span></span> <span data-ttu-id="200d5-130">Na verdade, um modelo REST implementa uma máquina de estado finito onde uma solicitação faz, em um recurso, a transição de um estado bem definido não transitório para outro.</span><span class="sxs-lookup"><span data-stu-id="200d5-130">Effectively, a REST model implements a finite state machine where a request transitions a resource from one well-defined non-transient state to another.</span></span>

> [!NOTE]
> <span data-ttu-id="200d5-131">A natureza sem monitoração de estado de solicitações individuais no modelo REST permite que um sistema construído seguindo esses princípios seja altamente dimensionável.</span><span class="sxs-lookup"><span data-stu-id="200d5-131">The stateless nature of individual requests in the REST model enables a system constructed by following these principles to be highly scalable.</span></span> <span data-ttu-id="200d5-132">Não é necessário manter qualquer afinidade entre um aplicativo cliente fazendo uma série de solicitações e os servidores Web específicos tratando dessas solicitações.</span><span class="sxs-lookup"><span data-stu-id="200d5-132">There is no need to retain any affinity between a client application making a series of requests and the specific web servers handling those requests.</span></span>
>
>

<span data-ttu-id="200d5-133">Outro ponto crucial na implementação de um modelo eficaz do REST é entender as relações entre os vários recursos aos quais o modelo fornece acesso.</span><span class="sxs-lookup"><span data-stu-id="200d5-133">Another crucial point in implementing an effective REST model is to understand the relationships between the various resources to which the model provides access.</span></span> <span data-ttu-id="200d5-134">Esses recursos normalmente são organizados como coleções e relacionamentos.</span><span class="sxs-lookup"><span data-stu-id="200d5-134">These resources are typically organized as collections and relationships.</span></span> <span data-ttu-id="200d5-135">Por exemplo, suponha que uma rápida análise de um sistema de comércio eletrônico mostre que há duas coleções pelas quais aplicativos cliente provavelmente se interessam: pedidos e clientes.</span><span class="sxs-lookup"><span data-stu-id="200d5-135">For example, suppose that a quick analysis of an ecommerce system shows that there are two collections in which client applications are likely to be interested: orders and customers.</span></span> <span data-ttu-id="200d5-136">Cada pedido e cliente deve ter sua própria chave exclusiva para fins de identificação.</span><span class="sxs-lookup"><span data-stu-id="200d5-136">Each order and customer should have its own unique key for identification purposes.</span></span> <span data-ttu-id="200d5-137">O URI para acessar a coleção de pedidos pode ser algo tão simples quanto */orders* e, do mesmo modo, o URI para recuperar todos os clientes pode ser */customers*.</span><span class="sxs-lookup"><span data-stu-id="200d5-137">The URI to access the collection of orders could be something as simple as */orders*, and similarly the URI for retrieving all customers could be */customers*.</span></span> <span data-ttu-id="200d5-138">Emitir uma solicitação HTTP GET para o URI */orders* deve retornar uma lista que representa todos os pedidos na coleção, codificada como uma resposta HTTP:</span><span class="sxs-lookup"><span data-stu-id="200d5-138">Issuing an HTTP GET request to the */orders* URI should return a list representing all orders in the collection encoded as an HTTP response:</span></span>

```HTTP
GET http://adventure-works.com/orders HTTP/1.1
...
```

<span data-ttu-id="200d5-139">A resposta mostrada abaixo codifica os pedidos como uma estrutura de lista JSON.</span><span class="sxs-lookup"><span data-stu-id="200d5-139">The response shown below encodes the orders as a JSON list structure:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Date: Fri, 22 Aug 2014 08:49:02 GMT
Content-Length: ...
[{"orderId":1,"orderValue":99.90,"productId":1,"quantity":1},{"orderId":2,"orderValue":10.00,"productId":4,"quantity":2},{"orderId":3,"orderValue":16.60,"productId":2,"quantity":4},{"orderId":4,"orderValue":25.90,"productId":3,"quantity":1},{"orderId":5,"orderValue":99.90,"productId":1,"quantity":1}]
```
<span data-ttu-id="200d5-140">Buscar um pedido individual requer a especificação do identificador para o pedido por meio do recurso *orders*, como */orders/2*:</span><span class="sxs-lookup"><span data-stu-id="200d5-140">To fetch an individual order requires specifying the identifier for the order from the *orders* resource, such as */orders/2*:</span></span>

```HTTP
GET http://adventure-works.com/orders/2 HTTP/1.1
...
```

```HTTP
HTTP/1.1 200 OK
...
Date: Fri, 22 Aug 2014 08:49:02 GMT
Content-Length: ...
{"orderId":2,"orderValue":10.00,"productId":4,"quantity":2}
```

> [!NOTE]
> <span data-ttu-id="200d5-141">Para simplificar, nestes exemplos mostram as informações nas respostas sendo retornadas como dados de texto JSON.</span><span class="sxs-lookup"><span data-stu-id="200d5-141">For simplicity, these examples show the information in responses being returned as JSON text data.</span></span> <span data-ttu-id="200d5-142">No entanto, não há nenhuma razão pela qual recursos não devam conter qualquer outro tipo de dados para o qual HTTP oferece suporte, como informações binárias ou criptografadas; o tipo de conteúdo na resposta HTTP deve especificar o tipo.</span><span class="sxs-lookup"><span data-stu-id="200d5-142">However, there is no reason why resources should not contain any other type of data supported by HTTP, such as binary or encrypted information; the content-type in the HTTP response should specify the type.</span></span> <span data-ttu-id="200d5-143">Além disso, um modelo REST pode ser capaz de retornar os mesmos dados em diferentes formatos, como XML ou JSON.</span><span class="sxs-lookup"><span data-stu-id="200d5-143">Also, a REST model may be able to return the same data in different formats, such as XML or JSON.</span></span> <span data-ttu-id="200d5-144">Nesse caso, o serviço Web deve ser capaz de realizar a negociação de conteúdo com o cliente que está fazendo a solicitação.</span><span class="sxs-lookup"><span data-stu-id="200d5-144">In this case, the web service should be able to perform content negotiation with the client making the request.</span></span> <span data-ttu-id="200d5-145">A solicitação pode incluir um cabeçalho *Accept* que especifica o formato preferencial que o cliente gostaria de receber, sendo que o serviço Web deve tentar honrar esse formato se possível.</span><span class="sxs-lookup"><span data-stu-id="200d5-145">The request can include an *Accept* header which specifies the preferred format that the client would like to receive and the web service should attempt to honor this format if at all possible.</span></span>
>
>

<span data-ttu-id="200d5-146">Observe que a resposta de uma solicitação REST faz uso dos códigos de status HTTP padrão.</span><span class="sxs-lookup"><span data-stu-id="200d5-146">Notice that the response from a REST request makes use of the standard HTTP status codes.</span></span> <span data-ttu-id="200d5-147">Por exemplo, uma solicitação que retorna dados válidos deve incluir o código de resposta HTTP 200 (OK), enquanto uma solicitação que não consegue localizar ou excluir um recurso especificado deve retornar uma resposta que inclui o código de status HTTP 404 (Não Encontrado).</span><span class="sxs-lookup"><span data-stu-id="200d5-147">For example, a request that returns valid data should include the HTTP response code 200 (OK), while a request that fails to find or delete a specified resource should return a response that includes the HTTP status code 404 (Not Found).</span></span>

## <a name="design-and-structure-of-a-restful-web-api"></a><span data-ttu-id="200d5-148">Design e a estrutura de uma API da Web RESTful</span><span class="sxs-lookup"><span data-stu-id="200d5-148">Design and structure of a RESTful web API</span></span>
<span data-ttu-id="200d5-149">As chaves para a criação de uma API da Web bem-sucedida são simplicidade e consistência.</span><span class="sxs-lookup"><span data-stu-id="200d5-149">The keys to designing a successful web API are simplicity and consistency.</span></span> <span data-ttu-id="200d5-150">Uma API da Web que exibe esses dois fatores facilita a criação de aplicativos cliente que precisam consumir a API.</span><span class="sxs-lookup"><span data-stu-id="200d5-150">A Web API that exhibits these two factors makes it easier to build client applications that need to consume the API.</span></span>

<span data-ttu-id="200d5-151">Uma API da Web RESTful concentra-se na exposição de um conjunto de recursos conectados e no fornecimento das principais operações que permitem que um aplicativo manipule esses recursos e navegue facilmente entre eles.</span><span class="sxs-lookup"><span data-stu-id="200d5-151">A RESTful web API is focused on exposing a set of connected resources, and providing the core operations that enable an application to manipulate these resources and easily navigate between them.</span></span> <span data-ttu-id="200d5-152">Por esse motivo, os URIs que constituem uma API da Web RESTful típica deve ser orientados para os dados que ela expõe, além de usar os recursos fornecidos pelo HTTP para realizar operações com esses dados.</span><span class="sxs-lookup"><span data-stu-id="200d5-152">For this reason, the URIs that constitute a typical RESTful web API should be oriented towards the data that it exposes, and use the facilities provided by HTTP to operate on this data.</span></span> <span data-ttu-id="200d5-153">Essa abordagem exige uma mentalidade diferente daquela empregada normalmente durante a criação de um conjunto de classes em uma API orientada a objeto, que tende a ser mais motivada pelo comportamento de objetos e classes.</span><span class="sxs-lookup"><span data-stu-id="200d5-153">This approach requires a different mindset from that typically employed when designing a set of classes in an object-oriented API which tends to be more motivated by the behavior of objects and classes.</span></span> <span data-ttu-id="200d5-154">Além disso, uma API da Web RESTful deve ser sem monitoração de estado e não deve depender de operações serem invocadas em uma sequência específica.</span><span class="sxs-lookup"><span data-stu-id="200d5-154">Additionally, a RESTful web API should be stateless and not depend on operations being invoked in a particular sequence.</span></span> <span data-ttu-id="200d5-155">As seções a seguir resumem os pontos que você deve considerar ao criar uma API da Web RESTful.</span><span class="sxs-lookup"><span data-stu-id="200d5-155">The following sections summarize the points you should consider when designing a RESTful web API.</span></span>

### <a name="organizing-the-web-api-around-resources"></a><span data-ttu-id="200d5-156">Organizando a API da Web em torno de recursos</span><span class="sxs-lookup"><span data-stu-id="200d5-156">Organizing the web API around resources</span></span>
> [!TIP]
> <span data-ttu-id="200d5-157">Os URIs expostos por um serviço Web REST deve se basear em substantivos (os dados aos quais a API da Web fornece acesso) e não em verbos (o que um aplicativo pode fazer com os dados).</span><span class="sxs-lookup"><span data-stu-id="200d5-157">The URIs exposed by a REST web service should be based on nouns (the data to which the web API provides access) and not verbs (what an application can do with the data).</span></span>
>
>

<span data-ttu-id="200d5-158">Concentre-se nas entidades comerciais que a API da Web expõe.</span><span class="sxs-lookup"><span data-stu-id="200d5-158">Focus on the business entities that the web API exposes.</span></span> <span data-ttu-id="200d5-159">Por exemplo, em uma API da Web projetada para oferecer suporte ao sistema de comércio eletrônico descrito anteriormente, as entidades principais são clientes e pedidos.</span><span class="sxs-lookup"><span data-stu-id="200d5-159">For example, in a web API designed to support the ecommerce system described earlier, the primary entities are customers and orders.</span></span> <span data-ttu-id="200d5-160">Processos como o ato de fazer um pedido podem ser realizados pelo fornecimento de uma operação HTTP POST, que coleta as informações do pedido e adiciona-as à lista de pedidos para o cliente.</span><span class="sxs-lookup"><span data-stu-id="200d5-160">Processes such as the act of placing an order can be achieved by providing an HTTP POST operation that takes the order information and adds it to the list of orders for the customer.</span></span> <span data-ttu-id="200d5-161">Internamente, essa operação POST pode executar tarefas como verificação dos níveis de estoque e cobrança do cliente.</span><span class="sxs-lookup"><span data-stu-id="200d5-161">Internally, this POST operation can perform tasks such as checking stock levels, and billing the customer.</span></span> <span data-ttu-id="200d5-162">A resposta HTTP pode indicar se o pedido foi feito com êxito ou não.</span><span class="sxs-lookup"><span data-stu-id="200d5-162">The HTTP response can indicate whether the order was placed successfully or not.</span></span> <span data-ttu-id="200d5-163">Observe também que um recurso não precisa se basear em um único item de dados físico.</span><span class="sxs-lookup"><span data-stu-id="200d5-163">Also note that a resource does not have to be based on a single physical data item.</span></span> <span data-ttu-id="200d5-164">Por exemplo, um recurso de pedido pode ser implementado internamente usando informações agregadas de muitas linhas distribuídas por várias tabelas em um banco de dados relacional, mas apresentadas ao cliente como uma única entidade.</span><span class="sxs-lookup"><span data-stu-id="200d5-164">As an example, an order resource might be implemented internally by using information aggregated from many rows spread across several tables in a relational database but presented to the client as a single entity.</span></span>

> [!TIP]
> <span data-ttu-id="200d5-165">Evite a criação de uma interface REST que espelhe ou dependa da estrutura interna dos dados que ele expõe.</span><span class="sxs-lookup"><span data-stu-id="200d5-165">Avoid designing a REST interface that mirrors or depends on the internal structure of the data that it exposes.</span></span> <span data-ttu-id="200d5-166">REST tem maior foco na implementação de operações CRUD (Create, Retrieve, Update, Delete - criar, recuperar, atualizar, excluir) simples em tabelas separadas em um banco de dados relacional.</span><span class="sxs-lookup"><span data-stu-id="200d5-166">REST is about more than implementing simple CRUD (Create, Retrieve, Update, Delete) operations over separate tables in a relational database.</span></span> <span data-ttu-id="200d5-167">A finalidade do REST é mapear entidades comerciais e as operações que um aplicativo pode executar nessas entidades para a implementação física dessas entidades, mas um cliente não deve ser exposto a esses detalhes físicos.</span><span class="sxs-lookup"><span data-stu-id="200d5-167">The purpose of REST is to map business entities and the operations that an application can perform on these entities to the physical implementation of these entities, but a client should not be exposed to these physical details.</span></span>
>
>

<span data-ttu-id="200d5-168">Entidades comerciais individuais raramente existem em isolamento (embora possam existir alguns objetos singleton), mas em vez disso, tendem a ser agrupadas em coleções.</span><span class="sxs-lookup"><span data-stu-id="200d5-168">Individual business entities rarely exist in isolation (although some singleton objects may exist), but instead tend to be grouped together into collections.</span></span> <span data-ttu-id="200d5-169">Em termos de REST, cada entidade e cada coleção são recursos.</span><span class="sxs-lookup"><span data-stu-id="200d5-169">In REST terms, each entity and each collection are resources.</span></span> <span data-ttu-id="200d5-170">Em uma API da Web RESTful, cada coleção tem seu próprio URI contido no serviço Web, e executar uma solicitação HTTP GET por um URI para uma coleção recupera uma lista dos itens nessa coleção.</span><span class="sxs-lookup"><span data-stu-id="200d5-170">In a RESTful web API, each collection has its own URI within the web service, and performing an HTTP GET request over a URI for a collection retrieves a list of items in that collection.</span></span> <span data-ttu-id="200d5-171">Cada item individual também tem seu próprio URI, e um aplicativo pode enviar outra solicitação HTTP GET usando esse URI para obter os detalhes desse item.</span><span class="sxs-lookup"><span data-stu-id="200d5-171">Each individual item also has its own URI, and an application can submit another HTTP GET request using that URI to retrieve the details of that item.</span></span> <span data-ttu-id="200d5-172">Você deve organizar os URIs para coleções e itens de maneira hierárquica.</span><span class="sxs-lookup"><span data-stu-id="200d5-172">You should organize the URIs for collections and items in a hierarchical manner.</span></span> <span data-ttu-id="200d5-173">No sistema de comércio eletrônico, o URI */customers* denota a coleção de clientes, e */customers/5* recupera os detalhes para o único cliente com ID 5 desta coleção.</span><span class="sxs-lookup"><span data-stu-id="200d5-173">In the ecommerce system, the URI */customers* denotes the customer’s collection, and */customers/5* retrieves the details for the single customer with the ID 5 from this collection.</span></span> <span data-ttu-id="200d5-174">Essa abordagem ajuda a manter a API da Web intuitiva.</span><span class="sxs-lookup"><span data-stu-id="200d5-174">This approach helps to keep the web API intuitive.</span></span>

> [!TIP]
> <span data-ttu-id="200d5-175">Adote uma convenção de nomenclatura consistente nos URIs; em geral, ajuda usar substantivos plurais para URIs que fazem referência a coleções.</span><span class="sxs-lookup"><span data-stu-id="200d5-175">Adopt a consistent naming convention in URIs; in general it helps to use plural nouns for URIs that reference collections.</span></span>
>
>

<span data-ttu-id="200d5-176">Você também precisa considerar as relações entre diferentes tipos de recursos e como você pode expor essas associações.</span><span class="sxs-lookup"><span data-stu-id="200d5-176">You also need to consider the relationships between different types of resources and how you might expose these associations.</span></span> <span data-ttu-id="200d5-177">Por exemplo, os clientes podem fazer zero ou mais pedidos.</span><span class="sxs-lookup"><span data-stu-id="200d5-177">For example, customers may place zero or more orders.</span></span> <span data-ttu-id="200d5-178">Uma maneira natural de representar essa relação seria por meio de um URI como */clientes/5/orders* , para localizar todos os pedidos do cliente 5.</span><span class="sxs-lookup"><span data-stu-id="200d5-178">A natural way to represent this relationship would be through a URI such as */customers/5/orders* to find all the orders for customer 5.</span></span> <span data-ttu-id="200d5-179">Você também pode considerar a possibilidade de representar a associação de um pedido a um cliente específico, por meio de um URI como */orders/99/customer* para localizar o cliente para o pedido 99, mas estender muito esse modelo pode torná-lo difícil de implementar.</span><span class="sxs-lookup"><span data-stu-id="200d5-179">You might also consider representing the association from an order back to a specific customer through a URI such as */orders/99/customer* to find the customer for order 99, but extending this model too far can become cumbersome to implement.</span></span> <span data-ttu-id="200d5-180">Uma solução melhor é fornecer links navegáveis para recursos associados, como o cliente, no corpo da mensagem de resposta HTTP retornada quando se consulta o pedido.</span><span class="sxs-lookup"><span data-stu-id="200d5-180">A better solution is to provide navigable links to associated resources, such as the customer, in the body of the HTTP response message returned when the order is queried.</span></span> <span data-ttu-id="200d5-181">Esse mecanismo é descrito mais detalhadamente na seção Usando a Abordagem de HATEOAS Para Habilitar a Navegação Para Recursos Relacionados, posteriormente nestas diretrizes.</span><span class="sxs-lookup"><span data-stu-id="200d5-181">This mechanism is described in more detail in the section Using the HATEOAS Approach to Enable Navigation To Related Resources later in this guidance.</span></span>

<span data-ttu-id="200d5-182">Em sistemas mais complexos pode haver muito mais tipos de entidade, e pode ser tentador fornecer URIs que permitem a um aplicativo cliente navegar por vários níveis de relações, como */customers/1/orders/99/products* para obter a lista de produtos no pedido 99 feito pelo cliente 1.</span><span class="sxs-lookup"><span data-stu-id="200d5-182">In more complex systems there may be many more types of entity, and it can be tempting to provide URIs that enable a client application to navigate through several levels of relationships, such as */customers/1/orders/99/products* to obtain the list of products in order 99 placed by customer 1.</span></span> <span data-ttu-id="200d5-183">No entanto, esse nível de complexidade pode ser difícil de manter e é inflexível no caso de as relações entre os recursos mudarem no futuro.</span><span class="sxs-lookup"><span data-stu-id="200d5-183">However, this level of complexity can be difficult to maintain and is inflexible if the relationships between resources change in the future.</span></span> <span data-ttu-id="200d5-184">Em vez disso, você deve tentar manter os URIs relativamente simples.</span><span class="sxs-lookup"><span data-stu-id="200d5-184">Rather, you should seek to keep URIs relatively simple.</span></span> <span data-ttu-id="200d5-185">Tenha em mente que uma vez que um aplicativo tem uma referência a um recurso, deve ser possível usar essa referência para localizar itens relacionados a esse recurso.</span><span class="sxs-lookup"><span data-stu-id="200d5-185">Bear in mind that once an application has a reference to a resource, it should be possible to use this reference to find items related to that resource.</span></span> <span data-ttu-id="200d5-186">A consulta anterior pode ser substituída pelo URI */customers/1/orders* para localizar todos os pedidos do cliente 1 e, em seguida, consultar o URI */orders/99/products* para encontrar os produtos nesse pedido (supondo que o pedido 99 tenha sido feito pelo cliente 1).</span><span class="sxs-lookup"><span data-stu-id="200d5-186">The preceding query can be replaced with the URI */customers/1/orders* to find all the orders for customer 1, and then query the URI */orders/99/products* to find the products in this order (assuming order 99 was placed by customer 1).</span></span>

> [!TIP]
> <span data-ttu-id="200d5-187">Evite exigir URIs de recurso mais complexos do que *collection/item/collection*.</span><span class="sxs-lookup"><span data-stu-id="200d5-187">Avoid requiring resource URIs more complex than *collection/item/collection*.</span></span>
>
>

<span data-ttu-id="200d5-188">Outro ponto a considerar é que todas as solicitações da Web impõem uma carga ao servidor Web; quanto maior o número de solicitações, maior será a carga.</span><span class="sxs-lookup"><span data-stu-id="200d5-188">Another point to consider is that all web requests impose a load on the web server, and the greater the number of requests the bigger the load.</span></span> <span data-ttu-id="200d5-189">Você deve tentar definir seus recursos para evitar APIs da Web "verborrágicas", que expõem um grande número de recursos pequenos.</span><span class="sxs-lookup"><span data-stu-id="200d5-189">You should attempt to define your resources to avoid “chatty” web APIs that expose a large number of small resources.</span></span> <span data-ttu-id="200d5-190">Uma API desse tipo pode exigir que um aplicativo cliente envie várias solicitações para localizar todos os dados que ele necessita.</span><span class="sxs-lookup"><span data-stu-id="200d5-190">Such an API may require a client application to submit multiple requests to find all the data that it requires.</span></span> <span data-ttu-id="200d5-191">Pode ser benéfico desnormalizar dados e combinar informações relacionadas em recursos maiores, que podem ser recuperados por meio de uma única solicitação.</span><span class="sxs-lookup"><span data-stu-id="200d5-191">It may be beneficial to denormalize data and combine related information together into bigger resources that can be retrieved by issuing a single request.</span></span> <span data-ttu-id="200d5-192">No entanto, você precisa equilibrar essa abordagem em relação à sobrecarga causada pela coleta de dados que podem, frequentemente, não ser solicitados pelo cliente.</span><span class="sxs-lookup"><span data-stu-id="200d5-192">However, you need to balance this approach against the overhead of fetching data that might not be frequently required by the client.</span></span> <span data-ttu-id="200d5-193">Recuperar objetos grandes pode aumentar a latência de uma solicitação e incorre em custos de largura de banda adicional, o que traz pouca vantagem se os dados adicionais não são usados com frequência.</span><span class="sxs-lookup"><span data-stu-id="200d5-193">Retrieving large objects can increase the latency of a request and incur additional bandwidth costs for little advantage if the additional data is not often used.</span></span>

<span data-ttu-id="200d5-194">Evite introduzir as dependências entre a API da Web na estrutura, tipo ou local das fontes de dados subjacentes.</span><span class="sxs-lookup"><span data-stu-id="200d5-194">Avoid introducing dependencies between the web API to the structure, type, or location of the underlying data sources.</span></span> <span data-ttu-id="200d5-195">Por exemplo, se seus dados estão localizados em um banco de dados relacional, a API da Web não precisa expor cada tabela como uma coleção de recursos.</span><span class="sxs-lookup"><span data-stu-id="200d5-195">For example, if your data is located in a relational database, the web API does not need to expose each table as a collection of resources.</span></span> <span data-ttu-id="200d5-196">Considere a API da Web como uma abstração do banco de dados e, se necessário, introduza uma camada de mapeamento entre o banco de dados e a API da Web.</span><span class="sxs-lookup"><span data-stu-id="200d5-196">Think of the web API as an abstraction of the database, and if necessary introduce a mapping layer between the database and the web API.</span></span> <span data-ttu-id="200d5-197">Desse modo, se a implementação ou o design do banco de dados for alterado (por exemplo, você deixa de usar um banco de dados relacional que contém uma coleção de tabelas normalizadas e passa a usar um sistema de armazenamento NoSQL desnormalizado, como um banco de dados de documentos), aplicativos cliente serão protegidos contra essas alterações.</span><span class="sxs-lookup"><span data-stu-id="200d5-197">In this way, if the design or implementation of the database changes (for example, you move from a relational database containing a collection of normalized tables to a denormalized NoSQL storage system such as a document database) client applications are insulated from these changes.</span></span>

> [!TIP]
> <span data-ttu-id="200d5-198">A fonte de dados que serve de base para uma API da Web não precisa ser um armazenamento de dados; pode ser outro serviço ou aplicativo de linha de negócios, ou até mesmo um aplicativo herdado em execução local, dentro de uma organização.</span><span class="sxs-lookup"><span data-stu-id="200d5-198">The source of the data that underpins a web API does not have to be a data store; it could be another service or line-of-business application or even a legacy application running on-premises within an organization.</span></span>
>
>

<span data-ttu-id="200d5-199">Por fim, pode não ser possível mapear toda operação implementada por uma API da Web para um recurso específico.</span><span class="sxs-lookup"><span data-stu-id="200d5-199">Finally, it might not be possible to map every operation implemented by a web API to a specific resource.</span></span> <span data-ttu-id="200d5-200">Você pode tratar desses cenários *sem recursos* por meio de solicitações HTTP GET, que invocam uma funcionalidade e retornam os resultados como uma mensagem de resposta HTTP.</span><span class="sxs-lookup"><span data-stu-id="200d5-200">You can handle such *non-resource* scenarios through HTTP GET requests that invoke a piece of functionality and return the results as an HTTP response message.</span></span> <span data-ttu-id="200d5-201">Uma API da Web que implementa operações simples estilo calculadora, como adicionar e subtrair, pode fornecer URIs que exponham essas operações como pseudorrecursos, além de utilizar a cadeia de consulta para especificar os parâmetros necessários.</span><span class="sxs-lookup"><span data-stu-id="200d5-201">A web API that implements simple calculator-style operations such as add and subtract could provide URIs that expose these operations as pseudo resources and utilize the query string to specify the parameters required.</span></span> <span data-ttu-id="200d5-202">Por exemplo, uma solicitação GET para o URI */add?operand1=99&operand2=1* pode retornar uma mensagem de resposta com o corpo contendo o valor 100, enquanto a solicitação GET para o URI */subtract?operand1=50&operand2=20* pode retornar uma mensagem de resposta com o corpo contendo o valor 30.</span><span class="sxs-lookup"><span data-stu-id="200d5-202">For example a GET request to the URI */add?operand1=99&operand2=1* could return a response message with the body containing the value 100, and GET request to the URI */subtract?operand1=50&operand2=20* could return a response message with the body containing the value 30.</span></span> <span data-ttu-id="200d5-203">No entanto, use essas formas de URIs apenas com moderação.</span><span class="sxs-lookup"><span data-stu-id="200d5-203">However, only use these forms of URIs sparingly.</span></span>

### <a name="defining-operations-in-terms-of-http-methods"></a><span data-ttu-id="200d5-204">Definindo operações em termos de métodos HTTP</span><span class="sxs-lookup"><span data-stu-id="200d5-204">Defining operations in terms of HTTP methods</span></span>
<span data-ttu-id="200d5-205">O protocolo HTTP define vários métodos que atribuem significado semântico a uma solicitação.</span><span class="sxs-lookup"><span data-stu-id="200d5-205">The HTTP protocol defines a number of methods that assign semantic meaning to a request.</span></span> <span data-ttu-id="200d5-206">Os métodos HTTP comuns usados pelas APIs da Web mais RESTful são:</span><span class="sxs-lookup"><span data-stu-id="200d5-206">The common HTTP methods used by most RESTful web APIs are:</span></span>

* <span data-ttu-id="200d5-207">**GET**, para obter uma cópia do recurso no URI especificado.</span><span class="sxs-lookup"><span data-stu-id="200d5-207">**GET**, to retrieve a copy of the resource at the specified URI.</span></span> <span data-ttu-id="200d5-208">O corpo da mensagem de resposta contém os detalhes do recurso solicitado.</span><span class="sxs-lookup"><span data-stu-id="200d5-208">The body of the response message contains the details of the requested resource.</span></span>
* <span data-ttu-id="200d5-209">**POST**, para criar um novo recurso no URI especificado.</span><span class="sxs-lookup"><span data-stu-id="200d5-209">**POST**, to create a new resource at the specified URI.</span></span> <span data-ttu-id="200d5-210">O corpo da mensagem de solicitação fornece os detalhes do novo recurso.</span><span class="sxs-lookup"><span data-stu-id="200d5-210">The body of the request message provides the details of the new resource.</span></span> <span data-ttu-id="200d5-211">Observe que POST também pode ser usado para disparar operações que, na verdade, não criam recursos.</span><span class="sxs-lookup"><span data-stu-id="200d5-211">Note that POST can also be used to trigger operations that don't actually create resources.</span></span>
* <span data-ttu-id="200d5-212">**PUT**, para substituir ou atualizar o recurso no URI especificado.</span><span class="sxs-lookup"><span data-stu-id="200d5-212">**PUT**, to replace or update the resource at the specified URI.</span></span> <span data-ttu-id="200d5-213">O corpo da mensagem de solicitação especifica o recurso a ser modificado e os valores a serem aplicados.</span><span class="sxs-lookup"><span data-stu-id="200d5-213">The body of the request message specifies the resource to be modified and the values to be applied.</span></span>
* <span data-ttu-id="200d5-214">**DELETE**, para remover o recurso no URI especificado.</span><span class="sxs-lookup"><span data-stu-id="200d5-214">**DELETE**, to remove the resource at the specified URI.</span></span>

> [!NOTE]
> <span data-ttu-id="200d5-215">O protocolo HTTP também define outros métodos menos usados como PATCH, que é usado para solicitar atualizações seletivas a um recurso; HEAD, que é usado para solicitar uma descrição de um recurso; OPTIONS, que permite a um cliente obter informações sobre as opções de comunicação para as quais há suporte no servidor; por fim, TRACE, que permite que um cliente solicite informações que pode usar para fins de teste e diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="200d5-215">The HTTP protocol also defines other less commonly-used methods, such as PATCH which is used to request selective updates to a resource, HEAD which is used to request a description of a resource, OPTIONS which enables a client information to obtain information about the communication options supported by the server, and TRACE which allows a client to request information that it can use for testing and diagnostics purposes.</span></span>
>
>

<span data-ttu-id="200d5-216">O efeito de uma solicitação específica deve depender de o recurso ao qual ela é aplicada tratar-se de uma coleção ou um item individual.</span><span class="sxs-lookup"><span data-stu-id="200d5-216">The effect of a specific request should depend on whether the resource to which it is applied is a collection or an individual item.</span></span> <span data-ttu-id="200d5-217">A tabela a seguir resume as convenções comuns adotadas pelas implementações mais RESTful, usando o exemplo de comércio eletrônico.</span><span class="sxs-lookup"><span data-stu-id="200d5-217">The following table summarizes the common conventions adopted by most RESTful implementations using the ecommerce example.</span></span> <span data-ttu-id="200d5-218">Observe que nem todas essas solicitações podem ser implementadas; isso depende do cenário específico.</span><span class="sxs-lookup"><span data-stu-id="200d5-218">Note that not all of these requests might be implemented; it depends on the specific scenario.</span></span>

| <span data-ttu-id="200d5-219">**Recurso**</span><span class="sxs-lookup"><span data-stu-id="200d5-219">**Resource**</span></span> | <span data-ttu-id="200d5-220">**POST**</span><span class="sxs-lookup"><span data-stu-id="200d5-220">**POST**</span></span> | <span data-ttu-id="200d5-221">**GET**</span><span class="sxs-lookup"><span data-stu-id="200d5-221">**GET**</span></span> | <span data-ttu-id="200d5-222">**PUT**</span><span class="sxs-lookup"><span data-stu-id="200d5-222">**PUT**</span></span> | <span data-ttu-id="200d5-223">**DELETE**</span><span class="sxs-lookup"><span data-stu-id="200d5-223">**DELETE**</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="200d5-224">/clientes</span><span class="sxs-lookup"><span data-stu-id="200d5-224">/customers</span></span> |<span data-ttu-id="200d5-225">Criar um novo cliente</span><span class="sxs-lookup"><span data-stu-id="200d5-225">Create a new customer</span></span> |<span data-ttu-id="200d5-226">Obter todos os clientes</span><span class="sxs-lookup"><span data-stu-id="200d5-226">Retrieve all customers</span></span> |<span data-ttu-id="200d5-227">Atualização em massa de clientes (*se implementado*)</span><span class="sxs-lookup"><span data-stu-id="200d5-227">Bulk update of customers (*if implemented*)</span></span> |<span data-ttu-id="200d5-228">Remover todos os clientes</span><span class="sxs-lookup"><span data-stu-id="200d5-228">Remove all customers</span></span> |
| <span data-ttu-id="200d5-229">/clientes/1</span><span class="sxs-lookup"><span data-stu-id="200d5-229">/customers/1</span></span> |<span data-ttu-id="200d5-230">Erro</span><span class="sxs-lookup"><span data-stu-id="200d5-230">Error</span></span> |<span data-ttu-id="200d5-231">Obter os detalhes do cliente 1</span><span class="sxs-lookup"><span data-stu-id="200d5-231">Retrieve the details for customer 1</span></span> |<span data-ttu-id="200d5-232">Atualizar os detalhes do cliente 1 se ele existir; caso contrário, retornar um erro</span><span class="sxs-lookup"><span data-stu-id="200d5-232">Update the details of customer 1 if it exists, otherwise return an error</span></span> |<span data-ttu-id="200d5-233">Remover cliente 1</span><span class="sxs-lookup"><span data-stu-id="200d5-233">Remove customer 1</span></span> |
| <span data-ttu-id="200d5-234">/clientes/1/pedidos</span><span class="sxs-lookup"><span data-stu-id="200d5-234">/customers/1/orders</span></span> |<span data-ttu-id="200d5-235">Criar um novo pedido para o cliente 1</span><span class="sxs-lookup"><span data-stu-id="200d5-235">Create a new order for customer 1</span></span> |<span data-ttu-id="200d5-236">Obter todos os pedidos do cliente 1</span><span class="sxs-lookup"><span data-stu-id="200d5-236">Retrieve all orders for customer 1</span></span> |<span data-ttu-id="200d5-237">Atualização em massa de pedidos do cliente 1 (*se implementado*)</span><span class="sxs-lookup"><span data-stu-id="200d5-237">Bulk update of orders for customer 1 (*if implemented*)</span></span> |<span data-ttu-id="200d5-238">Remover todos os pedidos do cliente 1 (*se implementado*)</span><span class="sxs-lookup"><span data-stu-id="200d5-238">Remove all orders for customer 1(*if implemented*)</span></span> |

<span data-ttu-id="200d5-239">A finalidade de solicitações GET e DELETE são relativamente simples, mas há escopo suficiente para confusão no que se refere à finalidade e aos efeitos das solicitações POST e PUT.</span><span class="sxs-lookup"><span data-stu-id="200d5-239">The purpose of GET and DELETE requests are relatively straightforward, but there is scope for confusion concerning the purpose and effects of POST and PUT requests.</span></span>

<span data-ttu-id="200d5-240">Uma solicitação POST deve criar um novo recurso com dados fornecidos no corpo da solicitação.</span><span class="sxs-lookup"><span data-stu-id="200d5-240">A POST request should create a new resource with data provided in the body of the request.</span></span> <span data-ttu-id="200d5-241">No modelo de REST, você aplica frequentemente solicitações POST a recursos que são coleções; o novo recurso é adicionado à coleção.</span><span class="sxs-lookup"><span data-stu-id="200d5-241">In the REST model, you frequently apply POST requests to resources that are collections; the new resource is added to the collection.</span></span>

> [!NOTE]
> <span data-ttu-id="200d5-242">Você também pode definir as solicitações POST que disparam alguma funcionalidade (e que não necessariamente retornam dados), e esses tipos de solicitação podem ser aplicados a coleções.</span><span class="sxs-lookup"><span data-stu-id="200d5-242">You can also define POST requests that trigger some functionality (and that don't necessarily return data), and these types of request can be applied to collections.</span></span> <span data-ttu-id="200d5-243">Por exemplo, você poderia usar uma solicitação POST para transmitir um quadro de horários para um serviço de processamento de folha de pagamento e obter os impostos calculados como uma resposta.</span><span class="sxs-lookup"><span data-stu-id="200d5-243">For example you could use a POST request to pass a timesheet to a payroll processing service and get the calculated taxes back as a response.</span></span>
>
>

<span data-ttu-id="200d5-244">Uma solicitação PUT destina-se a modificar um recurso existente.</span><span class="sxs-lookup"><span data-stu-id="200d5-244">A PUT request is intended to modify an existing resource.</span></span> <span data-ttu-id="200d5-245">Se o recurso especificado não existir, a solicitação PUT poderia retornar um erro (em alguns casos ela pode até, na verdade, criar o recurso).</span><span class="sxs-lookup"><span data-stu-id="200d5-245">If the specified resource does not exist, the PUT request could return an error (in some cases, it might actually create the resource).</span></span> <span data-ttu-id="200d5-246">Solicitações PUT são aplicadas com mais frequência aos recursos que são itens individuais (como um cliente ou pedido específico), embora elas possam ser aplicadas a coleções - o que, todavia, é implementado menos frequentemente.</span><span class="sxs-lookup"><span data-stu-id="200d5-246">PUT requests are most frequently applied to resources that are individual items (such as a specific customer or order), although they can be applied to collections, although this is less-commonly implemented.</span></span> <span data-ttu-id="200d5-247">Observe que as solicitações PUT são idempotentes, enquanto as solicitações POST não são; se um aplicativo envia a mesma solicitação PUT várias vezes, os resultados devem ser sempre os mesmos (o mesmo recurso será modificado com os mesmos valores), mas se um aplicativo repete a mesma solicitação POST, o resultado será a criação de vários recursos.</span><span class="sxs-lookup"><span data-stu-id="200d5-247">Note that PUT requests are idempotent whereas POST requests are not; if an application submits the same PUT request multiple times the results should always be the same (the same resource will be modified with the same values), but if an application repeats the same POST request the result will be the creation of multiple resources.</span></span>

> [!NOTE]
> <span data-ttu-id="200d5-248">A rigor, uma solicitação HTTP PUT substitui um recurso existente pelo recurso especificado no corpo da solicitação.</span><span class="sxs-lookup"><span data-stu-id="200d5-248">Strictly speaking, an HTTP PUT request replaces an existing resource with the resource specified in the body of the request.</span></span> <span data-ttu-id="200d5-249">Se a intenção é modificar uma seleção de propriedades em um recurso mantendo as demais propriedades inalteradas, isso deve ser implementado usando uma solicitação HTTP PATCH.</span><span class="sxs-lookup"><span data-stu-id="200d5-249">If the intention is to modify a selection of properties in a resource but leave other properties unchanged, then this should be implemented by using an HTTP PATCH request.</span></span> <span data-ttu-id="200d5-250">No entanto, muitas implementações RESTful flexibilizam essa regra e usam PUT para ambas as situações.</span><span class="sxs-lookup"><span data-stu-id="200d5-250">However, many RESTful implementations relax this rule and use PUT for both situations.</span></span>
>
>

### <a name="processing-http-requests"></a><span data-ttu-id="200d5-251">Processando solicitações HTTP</span><span class="sxs-lookup"><span data-stu-id="200d5-251">Processing HTTP requests</span></span>
<span data-ttu-id="200d5-252">Os dados incluídos por um aplicativo cliente em muitas solicitações HTTP e as mensagens de resposta correspondentes no servidor Web podem ser apresentados em uma variedade de formatos (ou tipos de mídia).</span><span class="sxs-lookup"><span data-stu-id="200d5-252">The data included by a client application in many HTTP requests, and the corresponding response messages from the web server, could be presented in a variety of formats (or media types).</span></span> <span data-ttu-id="200d5-253">Por exemplo, os dados que especificam os detalhes de um cliente ou pedido podem ser fornecidos como XML, JSON ou algum outro formato codificado e compactado.</span><span class="sxs-lookup"><span data-stu-id="200d5-253">For example, the data that specifies the details for a customer or order could be provided as XML, JSON, or some other encoded and compressed format.</span></span> <span data-ttu-id="200d5-254">Uma API da Web RESTful deve oferecer suporte a diferentes tipos de mídia, conforme solicitado pelo aplicativo cliente que envia uma solicitação.</span><span class="sxs-lookup"><span data-stu-id="200d5-254">A RESTful web API should support different media types as requested by the client application that submits a request.</span></span>

<span data-ttu-id="200d5-255">Quando um aplicativo cliente envia uma solicitação que retorna dados no corpo de uma mensagem ele pode especificar, no cabeçalho Accept da solicitação, os tipos de mídia com os quais pode lidar.</span><span class="sxs-lookup"><span data-stu-id="200d5-255">When a client application sends a request that returns data in the body of a message, it can specify the media types it can handle in the Accept header of the request.</span></span> <span data-ttu-id="200d5-256">O código a seguir ilustra uma solicitação HTTP GET que obtém os detalhes do pedido 2 e solicita que os resultados sejam retornados como JSON (o cliente ainda deve examinar o tipo de mídia dos dados na resposta, para verificar o formato dos dados retornados):</span><span class="sxs-lookup"><span data-stu-id="200d5-256">The following code illustrates an HTTP GET request that retrieves the details of order 2 and requests the result to be returned as JSON (the client should still examine the media type of the data in the response to verify the format of the data returned):</span></span>

```HTTP
GET http://adventure-works.com/orders/2 HTTP/1.1
...
Accept: application/json
...
```

<span data-ttu-id="200d5-257">Se o servidor Web oferece suporte a esse tipo de mídia, ele pode enviar uma resposta que inclui o cabeçalho Content-Type, que especifica o formato dos dados no corpo da mensagem:</span><span class="sxs-lookup"><span data-stu-id="200d5-257">If the web server supports this media type, it can reply with a response that includes Content-Type header that specifies the format of the data in the body of the message:</span></span>

> [!NOTE]
> <span data-ttu-id="200d5-258">Para interoperabilidade máxima, a tipos referenciados nos cabeçalhos Accept e Content-Type devem ser tipos MIME reconhecidos, em vez de algum tipo personalizado de mídia.</span><span class="sxs-lookup"><span data-stu-id="200d5-258">For maximum interoperability, the media types referenced in the Accept and Content-Type headers should be recognized MIME types rather than some custom media type.</span></span>
>
>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
{"orderID":2,"productID":4,"quantity":2,"orderValue":10.00}
```

<span data-ttu-id="200d5-259">Se o servidor Web não oferece suporte ao tipo de mídia solicitado, ele pode enviar os dados em um formato diferente.</span><span class="sxs-lookup"><span data-stu-id="200d5-259">If the web server does not support the requested media type, it can send the data in a different format.</span></span> <span data-ttu-id="200d5-260">Em todos os casos, ele deve especificar o tipo de mídia (como *application/json*) no cabeçalho Content-Type.</span><span class="sxs-lookup"><span data-stu-id="200d5-260">IN all cases it must specify the media type (such as *application/json*) in the Content-Type header.</span></span> <span data-ttu-id="200d5-261">É responsabilidade do aplicativo cliente analisar a mensagem de resposta e interpretar adequadamente os resultados no corpo da mensagem.</span><span class="sxs-lookup"><span data-stu-id="200d5-261">It is the responsibility of the client application to parse the response message and interpret the results in the message body appropriately.</span></span>

<span data-ttu-id="200d5-262">Observe que neste exemplo, o servidor Web recupera com êxito os dados solicitados e indica tal êxito, passando de volta um código de status 200 no cabeçalho de resposta.</span><span class="sxs-lookup"><span data-stu-id="200d5-262">Note that in this example, the web server successfully retrieves the requested data and indicates success by passing back a status code of 200 in the response header.</span></span> <span data-ttu-id="200d5-263">Se nenhum dado correspondente for encontrado, ele deverá retornar um código de status de 404 (não encontrado) e o corpo da mensagem de resposta pode conter informações adicionais.</span><span class="sxs-lookup"><span data-stu-id="200d5-263">If no matching data is found, it should instead return a status code of 404 (not found) and the body of the response message can contain additional information.</span></span> <span data-ttu-id="200d5-264">O formato dessas informações é especificado pelo cabeçalho Content-Type, conforme mostrado no exemplo a seguir:</span><span class="sxs-lookup"><span data-stu-id="200d5-264">The format of this information is specified by the Content-Type header, as shown in the following example:</span></span>

```HTTP
GET http://adventure-works.com/orders/222 HTTP/1.1
...
Accept: application/json
...
```

<span data-ttu-id="200d5-265">O pedido 222 não existe, portanto, a mensagem de resposta tem essa aparência:</span><span class="sxs-lookup"><span data-stu-id="200d5-265">Order 222 does not exist, so the response message looks like this:</span></span>

```HTTP
HTTP/1.1 404 Not Found
...
Content-Type: application/json; charset=utf-8
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
{"message":"No such order"}
```

<span data-ttu-id="200d5-266">Quando um aplicativo envia uma solicitação HTTP PUT para atualizar um recurso, ele especifica o URI do recurso e fornece os dados a serem modificados no corpo da mensagem de solicitação.</span><span class="sxs-lookup"><span data-stu-id="200d5-266">When an application sends an HTTP PUT request to update a resource, it specifies the URI of the resource and provides the data to be modified in the body of the request message.</span></span> <span data-ttu-id="200d5-267">Ele também deve especificar o formato desses dados por meio do cabeçalho Content-Type.</span><span class="sxs-lookup"><span data-stu-id="200d5-267">It should also specify the format of this data by using the Content-Type header.</span></span> <span data-ttu-id="200d5-268">Um formato comum usado para informações baseadas em texto é *application/x-www-form-urlencoded*, que inclui um conjunto de pares nome/valor separados pelo caractere &.</span><span class="sxs-lookup"><span data-stu-id="200d5-268">A common format used for text-based information is *application/x-www-form-urlencoded*, which comprises a set of name/value pairs separated by the & character.</span></span> <span data-ttu-id="200d5-269">O exemplo a seguir mostra uma solicitação HTTP PUT que modifica as informações no pedido 1:</span><span class="sxs-lookup"><span data-stu-id="200d5-269">The next example shows an HTTP PUT request that modifies the information in order 1:</span></span>

```HTTP
PUT http://adventure-works.com/orders/1 HTTP/1.1
...
Content-Type: application/x-www-form-urlencoded
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
ProductID=3&Quantity=5&OrderValue=250
```

<span data-ttu-id="200d5-270">Se a modificação for bem-sucedida, ele deve idealmente responder com um código de status HTTP 204, indicando que o processo foi tratado com êxito, mas sem nenhuma informação adicional no corpo da resposta.</span><span class="sxs-lookup"><span data-stu-id="200d5-270">If the modification is successful, it should ideally respond with an HTTP 204 status code, indicating that the process has been successfully handled, but that the response body contains no further information.</span></span> <span data-ttu-id="200d5-271">O cabeçalho Location na resposta contém o URI do recurso recém-atualizado:</span><span class="sxs-lookup"><span data-stu-id="200d5-271">The Location header in the response contains the URI of the newly updated resource:</span></span>

```HTTP
HTTP/1.1 204 No Content
...
Location: http://adventure-works.com/orders/1
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
```

> [!TIP]
> <span data-ttu-id="200d5-272">Se os dados em uma mensagem de solicitação HTTP PUT incluem informações de data e hora, certifique-se de que o serviço Web aceita datas e horários formatados segundo o padrão ISO 8601.</span><span class="sxs-lookup"><span data-stu-id="200d5-272">If the data in an HTTP PUT request message includes date and time information, make sure that your web service accepts dates and times formatted following the ISO 8601 standard.</span></span>
>
>

<span data-ttu-id="200d5-273">Se o recurso a ser atualizado não existe, o servidor Web pode responder com uma resposta “Não Encontrado”, conforme descrito anteriormente.</span><span class="sxs-lookup"><span data-stu-id="200d5-273">If the resource to be updated does not exist, the web server can respond with a Not Found response as described earlier.</span></span> <span data-ttu-id="200d5-274">Alternativamente, se o próprio servidor efetivamente cria o objeto, ele pode retornar os códigos de status HTTP 200 (OK) ou HTTP 201 (Criado) e o corpo da resposta pode conter os dados para o novo recurso.</span><span class="sxs-lookup"><span data-stu-id="200d5-274">Alternatively, if the server actually creates the object itself it could return the status codes HTTP 200 (OK) or HTTP 201 (Created) and the response body could contain the data for the new resource.</span></span> <span data-ttu-id="200d5-275">Se o cabeçalho Content-Type da solicitação especifica um formato de dados que o servidor Web não pode processar, ele deve responder com o código de status HTTP 415 (Tipo de Mídia Sem Suporte).</span><span class="sxs-lookup"><span data-stu-id="200d5-275">If the Content-Type header of the request specifies a data format that the web server cannot handle, it should respond with HTTP status code 415 (Unsupported Media Type).</span></span>

> [!TIP]
> <span data-ttu-id="200d5-276">Considere a possibilidade de implementar operações HTTP PUT em massa, que podem realizar atualizações em lote para vários recursos em uma coleção.</span><span class="sxs-lookup"><span data-stu-id="200d5-276">Consider implementing bulk HTTP PUT operations that can batch updates to multiple resources in a collection.</span></span> <span data-ttu-id="200d5-277">A solicitação PUT deve especificar o URI da coleção, enquanto o corpo da solicitação deve especificar os detalhes dos recursos a serem modificados.</span><span class="sxs-lookup"><span data-stu-id="200d5-277">The PUT request should specify the URI of the collection, and the request body should specify the details of the resources to be modified.</span></span> <span data-ttu-id="200d5-278">Essa abordagem pode ajudar a reduzir a verborragia e a melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="200d5-278">This approach can help to reduce chattiness and improve performance.</span></span>
>
>

<span data-ttu-id="200d5-279">O formato das solicitações HTTP POST que criam novos recursos é semelhante ao das solicitações PUT; o corpo da mensagem contém os detalhes do novo recurso a ser adicionado.</span><span class="sxs-lookup"><span data-stu-id="200d5-279">The format of an HTTP POST requests that create new resources are similar to those of PUT requests; the message body contains the details of the new resource to be added.</span></span> <span data-ttu-id="200d5-280">No entanto, o URI normalmente especifica a coleção à qual o recurso deve ser adicionado.</span><span class="sxs-lookup"><span data-stu-id="200d5-280">However, the URI typically specifies the collection to which the resource should be added.</span></span> <span data-ttu-id="200d5-281">O exemplo a seguir cria um novo pedido e adiciona-o à coleção de pedidos:</span><span class="sxs-lookup"><span data-stu-id="200d5-281">The following example creates a new order and adds it to the orders collection:</span></span>

```HTTP
POST http://adventure-works.com/orders HTTP/1.1
...
Content-Type: application/x-www-form-urlencoded
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
productID=5&quantity=15&orderValue=400
```

<span data-ttu-id="200d5-282">Se a solicitação for bem-sucedida, o servidor Web deve responder com um código de mensagem com o código de status HTTP 201 (Criado).</span><span class="sxs-lookup"><span data-stu-id="200d5-282">If the request is successful, the web server should respond with a message code with HTTP status code 201 (Created).</span></span> <span data-ttu-id="200d5-283">O cabeçalho Location deve conter o URI do recurso recém-criado, e o corpo da resposta deve conter uma cópia do novo recurso; o cabeçalho Content-Type especifica o formato desses dados:</span><span class="sxs-lookup"><span data-stu-id="200d5-283">The Location header should contain the URI of the newly created resource, and the body of the response should contain a copy of the new resource; the Content-Type header specifies the format of this data:</span></span>

```HTTP
HTTP/1.1 201 Created
...
Content-Type: application/json; charset=utf-8
Location: http://adventure-works.com/orders/99
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
Content-Length: ...
{"orderID":99,"productID":5,"quantity":15,"orderValue":400}
```

> [!TIP]
> <span data-ttu-id="200d5-284">Se os dados fornecidos por uma solicitação PUT ou POST forem inválidos, o servidor Web deve responder com uma mensagem com código de status HTTP 400 (Solicitação Incorreta).</span><span class="sxs-lookup"><span data-stu-id="200d5-284">If the data provided by a PUT or POST request is invalid, the web server should respond with a message with HTTP status code 400 (Bad Request).</span></span> <span data-ttu-id="200d5-285">O corpo da mensagem pode conter informações adicionais sobre o problema com a solicitação e os formatos esperados, ou pode conter um link para uma URL que fornece mais detalhes.</span><span class="sxs-lookup"><span data-stu-id="200d5-285">The body of this message can contain additional information about the problem with the request and the formats expected, or it can contain a link to a URL that provides more details.</span></span>
>
>

<span data-ttu-id="200d5-286">Para remover um recurso, uma solicitação HTTP DELETE simplesmente fornece o URI do recurso a ser excluído.</span><span class="sxs-lookup"><span data-stu-id="200d5-286">To remove a resource, an HTTP DELETE request simply provides the URI of the resource to be deleted.</span></span> <span data-ttu-id="200d5-287">O exemplo a seguir tenta remover o pedido 99:</span><span class="sxs-lookup"><span data-stu-id="200d5-287">The following example attempts to remove order 99:</span></span>

```HTTP
DELETE http://adventure-works.com/orders/99 HTTP/1.1
...
```

<span data-ttu-id="200d5-288">Se a operação de exclusão for bem-sucedida, o servidor Web deve responder com o código de status HTTP 204, indicando que o processo ocorreu com êxito mas o corpo da resposta não contém nenhuma informação adicional (trata-se da mesma resposta retornada por uma operação PUT bem-sucedida, porém sem um cabeçalho Location, já que o recurso não existe mais). Também é possível que uma solicitação de exclusão retorne o código de status HTTP 200 (OK) ou 202 (Aceito) se a exclusão for executada de modo assíncrono.</span><span class="sxs-lookup"><span data-stu-id="200d5-288">If the delete operation is successful, the web server should respond with HTTP status code 204, indicating that the process has been successfully handled, but that the response body contains no further information (this is the same response returned by a successful PUT operation, but without a Location header as the resource no longer exists.) It is also possible for a DELETE request to return HTTP status code 200 (OK) or 202 (Accepted) if the deletion is performed asynchronously.</span></span>

```HTTP
HTTP/1.1 204 No Content
...
Date: Fri, 22 Aug 2014 09:18:37 GMT
```

<span data-ttu-id="200d5-289">Se o recurso não for encontrado, o servidor Web deverá retornar,  em vez disso, uma mensagem 404 (Não Encontrado).</span><span class="sxs-lookup"><span data-stu-id="200d5-289">If the resource is not found, the web server should return a 404 (Not Found) message instead.</span></span>

> [!TIP]
> <span data-ttu-id="200d5-290">Se todos os recursos em uma coleção precisarem ser excluídos, permita que uma solicitação HTTP DELETE seja especificada para o URI da coleção, em vez de forçar um aplicativo a remover um recurso da coleção de cada vez.</span><span class="sxs-lookup"><span data-stu-id="200d5-290">If all the resources in a collection need to be deleted, enable an HTTP DELETE request to be specified for the URI of the collection rather than forcing an application to remove each resource in turn from the collection.</span></span>
>
>

### <a name="filtering-and-paginating-data"></a><span data-ttu-id="200d5-291">Filtragem e paginação de dados</span><span class="sxs-lookup"><span data-stu-id="200d5-291">Filtering and paginating data</span></span>
<span data-ttu-id="200d5-292">Você deve se esforçar para manter os URIs simples e intuitivos.</span><span class="sxs-lookup"><span data-stu-id="200d5-292">You should endeavor to keep the URIs simple and intuitive.</span></span> <span data-ttu-id="200d5-293">Expor uma coleção de recursos por meio de um único URI ajuda nesse sentido, mas pode levar a aplicativos que buscam grandes quantidades de dados, quando apenas um subconjunto dessas informações é necessário.</span><span class="sxs-lookup"><span data-stu-id="200d5-293">Exposing a collection of resources through a single URI assists in this respect, but it can lead to applications fetching large amounts of data when only a subset of the information is required.</span></span> <span data-ttu-id="200d5-294">Gerar um grande volume de tráfego afeta não apenas o desempenho e a escalabilidade do servidor Web, mas também a capacidade de resposta dos aplicativos cliente que solicitam os dados.</span><span class="sxs-lookup"><span data-stu-id="200d5-294">Generating a large volume of traffic impacts not only the performance and scalability of the web server but also adversely affect the responsiveness of client applications requesting the data.</span></span>

<span data-ttu-id="200d5-295">Por exemplo, se pedidos contêm o preço pago pelo pedido, um aplicativo cliente que precisa recuperar todos os pedidos que têm um custo por um valor específico talvez precise recuperar todos os pedidos do URI */orders* e, em seguida, filtrar esses pedidos localmente.</span><span class="sxs-lookup"><span data-stu-id="200d5-295">For example, if orders contain the price paid for the order, a client application that needs to retrieve all orders that have a cost over a specific value might need to retrieve all orders from the */orders* URI and then filter these orders locally.</span></span> <span data-ttu-id="200d5-296">Fica claro que esse processo é muito ineficiente; desperdiça energia tanto de processamento quanto de largura de banda de rede no servidor que hospeda a API da Web.</span><span class="sxs-lookup"><span data-stu-id="200d5-296">Clearly this process is highly inefficient; it wastes network bandwidth and processing power on the server hosting the web API.</span></span>

<span data-ttu-id="200d5-297">Uma solução pode ser fornecer um esquema de URI, como */orders/ordervalue_greater_than_n*, onde *n* é o preço do pedido; porém, para todos os preços exceto um número limitado, essa abordagem não é prática.</span><span class="sxs-lookup"><span data-stu-id="200d5-297">One solution may be to provide a URI scheme such as */orders/ordervalue_greater_than_n* where *n* is the order price, but for all but a limited number of prices such an approach is impractical.</span></span> <span data-ttu-id="200d5-298">Além disso, se você precisar consultar pedidos com base em outros critérios, você pode terminar sendo obrigado a fornecer uma longa lista de URIs com nomes possivelmente não intuitivos.</span><span class="sxs-lookup"><span data-stu-id="200d5-298">Additionally, if you need to query orders based on other criteria, you can end up being faced with providing with a long list of URIs with possibly non-intuitive names.</span></span>

<span data-ttu-id="200d5-299">Uma estratégia melhor para filtragem de dados é fornecer os critérios de filtro na cadeia de consulta que é passada para a API da Web, como */pedidos?ordervaluethreshold=n*.</span><span class="sxs-lookup"><span data-stu-id="200d5-299">A better strategy to filtering data is to provide the filter criteria in the query string that is passed to the web API, such as */orders?ordervaluethreshold=n*.</span></span> <span data-ttu-id="200d5-300">Neste exemplo, a operação correspondente na API da Web é responsável pela análise e processamento do parâmetro `ordervaluethreshold` na cadeia de consulta e por retornar os resultados filtrados na resposta HTTP.</span><span class="sxs-lookup"><span data-stu-id="200d5-300">In this example, the corresponding operation in the web API is responsible for parsing and handling the `ordervaluethreshold` parameter in the query string and returning the filtered results in the HTTP response.</span></span>

<span data-ttu-id="200d5-301">Algumas solicitações HTTP GET simples sobre os recursos de coleção teriam potencial de retornar um grande número de itens.</span><span class="sxs-lookup"><span data-stu-id="200d5-301">Some simple HTTP GET requests over collection resources could potentially return a large number of items.</span></span> <span data-ttu-id="200d5-302">Para combater a possibilidade dessa ocorrência, você deve projetar a API da Web para limitar a quantidade de dados retornados por qualquer solicitação única.</span><span class="sxs-lookup"><span data-stu-id="200d5-302">To combat the possibility of this occurring you should design the web API to limit the amount of data returned by any single request.</span></span> <span data-ttu-id="200d5-303">Você pode obter isso oferecendo suporte a cadeias de consulta que permitam ao usuário especificar o número máximo de itens a serem recuperados (que poderia, por sua vez, estar sujeito a um limite máximo para ajudar a evitar ataques de Negação de Serviço) e um deslocamento inicial na coleção.</span><span class="sxs-lookup"><span data-stu-id="200d5-303">You can achieve this by supporting query strings that enable the user to specify the maximum number of items to be retrieved (which could itself be subject to an upperbound limit to help prevent Denial of Service attacks), and a starting offset into the collection.</span></span> <span data-ttu-id="200d5-304">Por exemplo, a cadeia de consulta no URI */orders?limit=25&offset=50* deve recuperar 25 pedidos, começando a partir do 50º pedido encontrado na coleção pedidos.</span><span class="sxs-lookup"><span data-stu-id="200d5-304">For example, the query string in the URI */orders?limit=25&offset=50* should retrieve 25 orders starting with the 50th order found in the orders collection.</span></span> <span data-ttu-id="200d5-305">Assim como ocorre com a filtragem de dados, a operação que implementa a solicitação GET na API da Web é responsável pela análise e processamento dos parâmetros `limit` e `offset` na cadeia de consulta.</span><span class="sxs-lookup"><span data-stu-id="200d5-305">As with filtering data, the operation that implements the GET request in the web API is responsible for parsing and handling the `limit` and `offset` parameters in the query string.</span></span> <span data-ttu-id="200d5-306">Para ajudar aplicativos cliente, solicitações GET que retornam dados paginados também devem incluir algum tipo de metadados que indiquem o número total de recursos disponíveis na coleção.</span><span class="sxs-lookup"><span data-stu-id="200d5-306">To assist client applications, GET requests that return paginated data should also include some form of metadata that indicate the total number of resources available in the collection.</span></span> <span data-ttu-id="200d5-307">Você também pode considerar outras estratégias de paginação inteligente; para obter mais informações, consulte [Observações Sobre Design de API: Paginação Inteligente](http://bizcoder.com/api-design-notes-smart-paging)</span><span class="sxs-lookup"><span data-stu-id="200d5-307">You might also consider other intelligent paging strategies; for more information, see [API Design Notes: Smart Paging](http://bizcoder.com/api-design-notes-smart-paging)</span></span>

<span data-ttu-id="200d5-308">Você pode seguir uma estratégia semelhante para classificar os dados conforme eles são encontrados; você pode fornecer um parâmetro de classificação que use um nome de campo como o valor, tal como */orders?sort=ProductID*.</span><span class="sxs-lookup"><span data-stu-id="200d5-308">You can follow a similar strategy for sorting data as it is fetched; you could provide a sort parameter that takes a field name as the value, such as */orders?sort=ProductID*.</span></span> <span data-ttu-id="200d5-309">No entanto, observe que essa abordagem pode ter um efeito deletério no cache (parâmetros de cadeia de consulta fazem parte do identificador de recurso usado por muitas implementações de cache como a chave para dados armazenados em cache).</span><span class="sxs-lookup"><span data-stu-id="200d5-309">However, note that this approach can have a deleterious effect on caching (query string parameters form part of the resource identifier used by many cache implementations as the key to cached data).</span></span>

<span data-ttu-id="200d5-310">Você pode estender esse método para limitar (projetar) os campos retornados se um único item de recurso contém uma grande quantidade de dados.</span><span class="sxs-lookup"><span data-stu-id="200d5-310">You can extend this approach to limit (project) the fields returned if a single resource item contains a large amount of data.</span></span> <span data-ttu-id="200d5-311">Por exemplo, você poderia usar um parâmetro de cadeia de consulta que aceita uma lista de campos delimitada por vírgulas, como */orders?fields=ProductID,Quantity*.</span><span class="sxs-lookup"><span data-stu-id="200d5-311">For example, you could use a query string parameter that accepts a comma-delimited list of fields, such as */orders?fields=ProductID,Quantity*.</span></span>

> [!TIP]
> <span data-ttu-id="200d5-312">Forneça padrões significativos a todos os parâmetros opcionais nas cadeias de consulta.</span><span class="sxs-lookup"><span data-stu-id="200d5-312">Give all optional parameters in query strings meaningful defaults.</span></span> <span data-ttu-id="200d5-313">Por exemplo, defina o parâmetro `limit` como 10 e o parâmetro `offset` como 0 se você implementar a paginação, defina o parâmetro sort para a chave do recurso se você implementar ordenação e, por fim, defina o parâmetro `fields` para todos os campos no recurso se você oferecer suporte a projeções.</span><span class="sxs-lookup"><span data-stu-id="200d5-313">For example, set the `limit` parameter to 10 and the `offset` parameter to 0 if you implement pagination, set the sort parameter to the key of the resource if you implement ordering, and set the `fields` parameter to all fields in the resource if you support projections.</span></span>
>
>

### <a name="handling-large-binary-resources"></a><span data-ttu-id="200d5-314">Manipulação de recursos binários grandes</span><span class="sxs-lookup"><span data-stu-id="200d5-314">Handling large binary resources</span></span>
<span data-ttu-id="200d5-315">Um único recurso pode conter campos binários grandes, como arquivos ou imagens.</span><span class="sxs-lookup"><span data-stu-id="200d5-315">A single resource may contain large binary fields, such as files or images.</span></span> <span data-ttu-id="200d5-316">Para superar os problemas de transmissão causados por conexões intermitentes e não confiáveis e para melhorar os tempos de resposta, considere a possibilidade de fornecer operações que habilitem a recuperação desses recursos em partes pelo aplicativo cliente.</span><span class="sxs-lookup"><span data-stu-id="200d5-316">To overcome the transmission problems caused by unreliable and intermittent connections and to improve response times, consider providing operations that enable such resources to be retrieved in chunks by the client application.</span></span> <span data-ttu-id="200d5-317">Para fazer isso, a API da Web deve oferecer suporte ao cabeçalho Accept-Ranges para solicitações GET para grandes recursos e, idealmente, implementar solicitações HTTP HEAD para esses recursos.</span><span class="sxs-lookup"><span data-stu-id="200d5-317">To do this, the web API should support the Accept-Ranges header for GET requests for large resources, and ideally implement HTTP HEAD requests for these resources.</span></span> <span data-ttu-id="200d5-318">O cabeçalho Accept-Ranges indica que a operação GET oferece suporte a resultados parciais, e que um aplicativo cliente pode enviar solicitações GET que retornam um subconjunto de um recurso especificado como um intervalo de bytes.</span><span class="sxs-lookup"><span data-stu-id="200d5-318">The Accept-Ranges header indicates that the GET operation supports partial results, and that a client application can submit GET requests that return a subset of a resource specified as a range of bytes.</span></span> <span data-ttu-id="200d5-319">Uma solicitação HEAD é semelhante a uma solicitação GET, porém retorna apenas um cabeçalho que descreve o recurso e um corpo de mensagem vazio.</span><span class="sxs-lookup"><span data-stu-id="200d5-319">A HEAD request is similar to a GET request except that it only returns a header that describes the resource and an empty message body.</span></span> <span data-ttu-id="200d5-320">Um aplicativo cliente pode emitir uma solicitação HEAD para determinar se deve ou não buscar um recurso pelo uso de solicitações GET parciais.</span><span class="sxs-lookup"><span data-stu-id="200d5-320">A client application can issue a HEAD request to determine whether to fetch a resource by using partial GET requests.</span></span> <span data-ttu-id="200d5-321">O exemplo a seguir mostra uma solicitação HEAD que obtém informações sobre uma imagem do produto:</span><span class="sxs-lookup"><span data-stu-id="200d5-321">The following example shows a HEAD request that obtains information about a product image:</span></span>

```HTTP
HEAD http://adventure-works.com/products/10?fields=productImage HTTP/1.1
...
```

<span data-ttu-id="200d5-322">A mensagem de resposta contém um cabeçalho que inclui o tamanho do recurso (4.580 bytes) e o cabeçalho Accept-Ranges, que indica que a operação GET correspondente oferece suporte a resultados parciais:</span><span class="sxs-lookup"><span data-stu-id="200d5-322">The response message contains a header that includes the size of the resource (4580 bytes), and the Accept-Ranges header that the corresponding GET operation supports partial results:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 4580
...
```

<span data-ttu-id="200d5-323">O aplicativo cliente pode usar essas informações para construir uma série de operações GET para recuperar a imagem em partes menores.</span><span class="sxs-lookup"><span data-stu-id="200d5-323">The client application can use this information to construct a series of GET operations to retrieve the image in smaller chunks.</span></span> <span data-ttu-id="200d5-324">A primeira solicitação busca os primeiros 2.500 bytes usando o cabeçalho Range:</span><span class="sxs-lookup"><span data-stu-id="200d5-324">The first request fetches the first 2500 bytes by using the Range header:</span></span>

```HTTP
GET http://adventure-works.com/products/10?fields=productImage HTTP/1.1
Range: bytes=0-2499
...
```

<span data-ttu-id="200d5-325">A mensagem de resposta indica, ao retornar o código de status HTTP 206, que esta é uma resposta parcial.</span><span class="sxs-lookup"><span data-stu-id="200d5-325">The response message indicates that this is a partial response by returning HTTP status code 206.</span></span> <span data-ttu-id="200d5-326">O cabeçalho Content-Length especifica o número real de bytes retornados no corpo da mensagem (não o tamanho do recurso), enquanto o cabeçalho Content-Range indica que parte do recurso isso é (0-2.499 bytes de 4.580):</span><span class="sxs-lookup"><span data-stu-id="200d5-326">The Content-Length header specifies the actual number of bytes returned in the message body (not the size of the resource), and the Content-Range header indicates which part of the resource this is (bytes 0-2499 out of 4580):</span></span>

```HTTP
HTTP/1.1 206 Partial Content
...
Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 2500
Content-Range: bytes 0-2499/4580
...
_{binary data not shown}_
```

<span data-ttu-id="200d5-327">Uma solicitação subsequente do aplicativo cliente pode recuperar o restante do recurso usando um cabeçalho Range apropriado:</span><span class="sxs-lookup"><span data-stu-id="200d5-327">A subsequent request from the client application can retrieve the remainder of the resource by using an appropriate Range header:</span></span>

```HTTP
GET http://adventure-works.com/products/10?fields=productImage HTTP/1.1
Range: bytes=2500-
...
```

<span data-ttu-id="200d5-328">A mensagem de resultado correspondente deve ter esta aparência:</span><span class="sxs-lookup"><span data-stu-id="200d5-328">The corresponding result message should look like this:</span></span>

```HTTP
HTTP/1.1 206 Partial Content
...
Accept-Ranges: bytes
Content-Type: image/jpeg
Content-Length: 2080
Content-Range: bytes 2500-4580/4580
...
```

## <a name="using-the-hateoas-approach-to-enable-navigation-to-related-resources"></a><span data-ttu-id="200d5-329">Usando a abordagem HATEOAS para habilitar a navegação para recursos relacionados</span><span class="sxs-lookup"><span data-stu-id="200d5-329">Using the HATEOAS approach to enable navigation to related resources</span></span>
<span data-ttu-id="200d5-330">Uma das principais motivações por trás de REST é a que deve ser possível navegar por todo o conjunto de recursos sem exigir conhecimento prévio do esquema de URI.</span><span class="sxs-lookup"><span data-stu-id="200d5-330">One of the primary motivations behind REST is that it should be possible to navigate the entire set of resources without requiring prior knowledge of the URI scheme.</span></span> <span data-ttu-id="200d5-331">Cada solicitação HTTP GET deve retornar as informações necessárias para localizar os recursos relacionados diretamente ao objeto solicitado por hiperlinks incluídos na resposta, e também deve ser provida de informações descrevendo as operações disponíveis em cada um desses recursos.</span><span class="sxs-lookup"><span data-stu-id="200d5-331">Each HTTP GET request should return the information necessary to find the resources related directly to the requested object through hyperlinks included in the response, and it should also be provided with information that describes the operations available on each of these resources.</span></span> <span data-ttu-id="200d5-332">Esse conceito é conhecido como HATEOAS, ou Hipertexto como o Mecanismo de Estado do Aplicativo.</span><span class="sxs-lookup"><span data-stu-id="200d5-332">This principle is known as HATEOAS, or Hypertext as the Engine of Application State.</span></span> <span data-ttu-id="200d5-333">O sistema é efetivamente uma máquina de estado finito, e a resposta para cada solicitação contém as informações necessárias para ir de um estado para outro; nenhuma outra informação deve ser necessária.</span><span class="sxs-lookup"><span data-stu-id="200d5-333">The system is effectively a finite state machine, and the response to each request contains the information necessary to move from one state to another; no other information should be necessary.</span></span>

> [!NOTE]
> <span data-ttu-id="200d5-334">Atualmente não há padrões nem especificações que definam como  modelar o princípio HATEOAS.</span><span class="sxs-lookup"><span data-stu-id="200d5-334">Currently there are no standards or specifications that define how to model the HATEOAS principle.</span></span> <span data-ttu-id="200d5-335">Os exemplos mostrados nesta seção ilustram uma possível solução.</span><span class="sxs-lookup"><span data-stu-id="200d5-335">The examples shown in this section illustrate one possible solution.</span></span>
>
>

<span data-ttu-id="200d5-336">Por exemplo, para lidar com o relacionamento entre clientes e pedidos, os dados retornados na resposta para um pedido específico devem conter URIs na forma de um hiperlink que identifica o cliente que fez o pedido e as operações que podem ser executadas nesse cliente.</span><span class="sxs-lookup"><span data-stu-id="200d5-336">As an example, to handle the relationship between customers and orders, the data returned in the response for a specific order should contain URIs in the form of a hyperlink identifying the customer that placed the order, and the operations that can be performed on that customer.</span></span>

```HTTP
GET http://adventure-works.com/orders/3 HTTP/1.1
Accept: application/json
...
```

<span data-ttu-id="200d5-337">O corpo da mensagem de resposta contém uma matriz `links` (realçada no código de exemplo) que especifica a natureza da relação (*Customer*), o URI do cliente (*http://adventure-works.com/customers/3*), como obter os detalhes desse cliente (*GET*), e os tipos MIME para os quais há suporte no servidor Web usados para recuperar essas informações (*text/xml* e *application/json*).</span><span class="sxs-lookup"><span data-stu-id="200d5-337">The body of the response message contains a `links` array (highlighted in the code example) that specifies the nature of the relationship (*Customer*), the URI of the customer (*http://adventure-works.com/customers/3*), how to retrieve the details of this customer (*GET*), and the MIME types that the web server supports for retrieving this information (*text/xml* and *application/json*).</span></span> <span data-ttu-id="200d5-338">Essas são todas as informações de que um aplicativo cliente precisa para ser capaz de obter os detalhes do cliente.</span><span class="sxs-lookup"><span data-stu-id="200d5-338">This is all the information that a client application needs to be able to fetch the details of the customer.</span></span> <span data-ttu-id="200d5-339">Além disso, a matriz Links também inclui links para as operações que podem ser executadas, como PUT (para modificar o cliente, junto com o formato que o servidor Web espera que o cliente forneça) e DELETE.</span><span class="sxs-lookup"><span data-stu-id="200d5-339">Additionally, the Links array also includes links for the other operations that can be performed, such as PUT (to modify the customer, together with the format that the web server expects the client to provide), and DELETE.</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"orderID":3,"productID":2,"quantity":4,"orderValue":16.60,"links":[(some links omitted){"rel":"customer","href":" http://adventure-works.com/customers/3", "action":"GET","types":["text/xml","application/json"]},{"rel":"
customer","href":" http://adventure-works.com /customers/3", "action":"PUT","types":["application/x-www-form-urlencoded"]},{"rel":"customer","href":" http://adventure-works.com /customers/3","action":"DELETE","types":[]}]}
```

<span data-ttu-id="200d5-340">Para ser completa, a matriz de Links também deve incluir informações de autorreferência pertencentes ao recurso que foi recuperado.</span><span class="sxs-lookup"><span data-stu-id="200d5-340">For completeness, the Links array should also include self-referencing information pertaining to the resource that has been retrieved.</span></span> <span data-ttu-id="200d5-341">Esses links foram omitidos do exemplo anterior, mas são destacados no código a seguir.</span><span class="sxs-lookup"><span data-stu-id="200d5-341">These links have been omitted from the previous example, but are highlighted in the following code.</span></span> <span data-ttu-id="200d5-342">Observe que nesses links, a relação *self* foi usada para indicar que se trata de uma referência ao recurso que está sendo retornado pela operação:</span><span class="sxs-lookup"><span data-stu-id="200d5-342">Notice that in these links, the relationship *self* has been used to indicate that this is a reference to the resource being returned by the operation:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"orderID":3,"productID":2,"quantity":4,"orderValue":16.60,"links":[{"rel":"self","href":" http://adventure-works.com/orders/3", "action":"GET","types":["text/xml","application/json"]},{"rel":" self","href":" http://adventure-works.com /orders/3", "action":"PUT","types":["application/x-www-form-urlencoded"]},{"rel":"self","href":" http://adventure-works.com /orders/3", "action":"DELETE","types":[]},{"rel":"customer",
"href":" http://adventure-works.com /customers/3", "action":"GET","types":["text/xml","application/json"]},{"rel":" customer" (customer links omitted)}]}
```

<span data-ttu-id="200d5-343">Para que essa abordagem seja eficaz, aplicativos cliente devem estar preparados para recuperar e analisar essas informações adicionais.</span><span class="sxs-lookup"><span data-stu-id="200d5-343">For this approach to be effective, client applications must be prepared to retrieve and parse this additional information.</span></span>

## <a name="versioning-a-restful-web-api"></a><span data-ttu-id="200d5-344">Controlando a versão de uma API da Web RESTful</span><span class="sxs-lookup"><span data-stu-id="200d5-344">Versioning a RESTful web API</span></span>
<span data-ttu-id="200d5-345">É muito improvável em todas as situações, exceto as mais simples, que uma API da Web permanecerá estática.</span><span class="sxs-lookup"><span data-stu-id="200d5-345">It is highly unlikely that in all but the simplest of situations that a web API will remain static.</span></span> <span data-ttu-id="200d5-346">Conforme os requisitos de negócios mudam, novas coleções de recursos podem ser adicionados, as relações entre os recursos podem mudar e a estrutura dos dados nos recursos pode ser alterada.</span><span class="sxs-lookup"><span data-stu-id="200d5-346">As business requirements change new collections of resources may be added, the relationships between resources might change, and the structure of the data in resources might be amended.</span></span> <span data-ttu-id="200d5-347">Enquanto a atualização de uma API da Web para lidar com requisitos novos ou diferentes é um processo relativamente simples, você deve considerar os efeitos que essas mudanças terão em aplicativos cliente que consomem a API da Web.</span><span class="sxs-lookup"><span data-stu-id="200d5-347">While updating a web API to handle new or differing requirements is a relatively straightforward process, you must consider the effects that such changes will have on client applications consuming the web API.</span></span> <span data-ttu-id="200d5-348">O problema é que, embora o desenvolvedor que projeta e implementa uma API da Web tenha controle total sobre essa API, o desenvolvedor não tem o mesmo grau de controle sobre os aplicativos cliente, que podem ser criados por organizações terceirizadas operando remotamente.</span><span class="sxs-lookup"><span data-stu-id="200d5-348">The issue is that although the developer designing and implementing a web API has full control over that API, the developer does not have the same degree of control over client applications which may be built by third party organizations operating remotely.</span></span> <span data-ttu-id="200d5-349">A principal prioridade é habilitar aplicativos cliente existentes a continuar funcionando inalterados, permitindo simultaneamente que novos aplicativos cliente tirem proveito das novas funções e recursos.</span><span class="sxs-lookup"><span data-stu-id="200d5-349">The primary imperative is to enable existing client applications to continue functioning unchanged while allowing new client applications to take advantage of new features and resources.</span></span>

<span data-ttu-id="200d5-350">O controle de versão permite que uma API da Web indique os recursos e as funções que ela expõe, e um aplicativo cliente pode enviar solicitações direcionadas a uma versão específica de uma função ou recurso.</span><span class="sxs-lookup"><span data-stu-id="200d5-350">Versioning enables a web API to indicate the features and resources that it exposes, and a client application can submit requests that are directed to a specific version of a feature or resource.</span></span> <span data-ttu-id="200d5-351">As seções a seguir descrevem várias abordagens diferentes, cada qual com suas próprias vantagens e desvantagens.</span><span class="sxs-lookup"><span data-stu-id="200d5-351">The following sections describe several different approaches, each of which has its own benefits and trade-offs.</span></span>

### <a name="no-versioning"></a><span data-ttu-id="200d5-352">Sem controle de versão</span><span class="sxs-lookup"><span data-stu-id="200d5-352">No versioning</span></span>
<span data-ttu-id="200d5-353">Essa é a abordagem mais simples e pode ser aceitável para algumas APIs internas.</span><span class="sxs-lookup"><span data-stu-id="200d5-353">This is the simplest approach, and may be acceptable for some internal APIs.</span></span> <span data-ttu-id="200d5-354">Grandes alterações poderiam ser representadas como novos recursos ou novos links.</span><span class="sxs-lookup"><span data-stu-id="200d5-354">Big changes could be represented as new resources or new links.</span></span>  <span data-ttu-id="200d5-355">Adicionar conteúdo aos recursos existentes não deve representar uma alteração significativa, já que aplicativos cliente que não esperavam ver esse conteúdo vão simplesmente ignorá-lo.</span><span class="sxs-lookup"><span data-stu-id="200d5-355">Adding content to existing resources might not present a breaking change as client applications that are not expecting to see this content will simply ignore it.</span></span>

<span data-ttu-id="200d5-356">Por exemplo, uma solicitação para o URI *http://adventure-works.com/customers/3* deve retornar os detalhes de um único cliente contendo os campos `id`, `name` e `address` esperados pelo aplicativo cliente:</span><span class="sxs-lookup"><span data-stu-id="200d5-356">For example, a request to the URI *http://adventure-works.com/customers/3* should return the details of a single customer containing `id`, `name`, and `address` fields expected by the client application:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

> [!NOTE]
> <span data-ttu-id="200d5-357">Para simplicidade e maior clareza, os exemplos de resposta mostrados nesta seção não incluem links HATEOAS.</span><span class="sxs-lookup"><span data-stu-id="200d5-357">For the purposes of simplicity and clarity, the example responses shown in this section do not include HATEOAS links.</span></span>
>
>

<span data-ttu-id="200d5-358">Se o campo `DateCreated` é adicionado ao esquema do recurso de cliente, a resposta terá essa aparência:</span><span class="sxs-lookup"><span data-stu-id="200d5-358">If the `DateCreated` field is added to the schema of the customer resource, then the response would look like this:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="200d5-359">Aplicativos cliente existentes podem continuar funcionando corretamente se forem capazes de ignorar campos não reconhecidos, enquanto os novos aplicativos cliente podem ser projetados para lidar com esse novo campo.</span><span class="sxs-lookup"><span data-stu-id="200d5-359">Existing client applications might continue functioning correctly if they are capable of ignoring unrecognized fields, while new client applications can be designed to handle this new field.</span></span> <span data-ttu-id="200d5-360">No entanto, se ocorrerem alterações mais radicais ao esquema de recursos (por exemplo, remover ou renomear campos) ou se as relações entre os recursos mudarem, estas poderão constituir alterações significativas que impedem que aplicativos cliente existentes funcionem corretamente.</span><span class="sxs-lookup"><span data-stu-id="200d5-360">However, if more radical changes to the schema of resources occur (such as removing or renaming fields) or the relationships between resources change then these may constitute breaking changes that prevent existing client applications from functioning correctly.</span></span> <span data-ttu-id="200d5-361">Nessas situações, você deve considerar uma das abordagens a seguir.</span><span class="sxs-lookup"><span data-stu-id="200d5-361">In these situations you should consider one of the following approaches.</span></span>

### <a name="uri-versioning"></a><span data-ttu-id="200d5-362">Controle de versão de URI</span><span class="sxs-lookup"><span data-stu-id="200d5-362">URI versioning</span></span>
<span data-ttu-id="200d5-363">Cada vez que você modifica a API da Web ou altera o esquema de recursos, você adiciona um número de versão ao URI para cada recurso.</span><span class="sxs-lookup"><span data-stu-id="200d5-363">Each time you modify the web API or change the schema of resources, you add a version number to the URI for each resource.</span></span> <span data-ttu-id="200d5-364">Os URIs previamente existentes devem continuar a funcionar como antes, recuperando recursos que estão em conformidade com seu esquema original.</span><span class="sxs-lookup"><span data-stu-id="200d5-364">The previously existing URIs should continue to operate as before, returning resources that conform to their original schema.</span></span>

<span data-ttu-id="200d5-365">Estendendo o exemplo anterior, se o campo `address` é reestruturado em subcampos contendo cada parte constituinte do endereço (como `streetAddress`, `city`, `state` e `zipCode`), esta versão do recurso pode ser exposta por meio de um URI contendo um número de versão, como http://adventure-works.com/v2/customers/3:</span><span class="sxs-lookup"><span data-stu-id="200d5-365">Extending the previous example, if the `address` field is restructured into sub-fields containing each constituent part of the address (such as `streetAddress`, `city`, `state`, and `zipCode`), this version of the resource could be exposed through a URI containing a version number, such as http://adventure-works.com/v2/customers/3:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":{"streetAddress":"1 Microsoft Way","city":"Redmond","state":"WA","zipCode":98053}}
```

<span data-ttu-id="200d5-366">Esse mecanismo de controle de versão é muito simples, mas depende do servidor realizar o roteamento da solicitação para o ponto de extremidade apropriado.</span><span class="sxs-lookup"><span data-stu-id="200d5-366">This versioning mechanism is very simple but depends on the server routing the request to the appropriate endpoint.</span></span> <span data-ttu-id="200d5-367">No entanto, ele pode se tornar inviável conforme a API da Web amadurece ao passar por várias iterações e o servidor tem que oferecer suporte a um número de versões diferentes.</span><span class="sxs-lookup"><span data-stu-id="200d5-367">However, it can become unwieldy as the web API matures through several iterations and the server has to support a number of different versions.</span></span> <span data-ttu-id="200d5-368">Além disso, de um ponto de vista purista, em todos os casos os aplicativos cliente estão buscando os mesmos dados (cliente 3), portanto o URI não deve ser diferente, independentemente de qual for a versão.</span><span class="sxs-lookup"><span data-stu-id="200d5-368">Also, from a purist’s point of view, in all cases the client applications are fetching the same data (customer 3), so the URI should not really be different depending on the version.</span></span> <span data-ttu-id="200d5-369">Esse esquema também complica a implementação de HATEOAS, já que todos os links precisarão incluir o número da versão em seus URIs.</span><span class="sxs-lookup"><span data-stu-id="200d5-369">This scheme also complicates implementation of HATEOAS as all links will need to include the version number in their URIs.</span></span>

### <a name="query-string-versioning"></a><span data-ttu-id="200d5-370">Controle de versão de cadeia de consulta</span><span class="sxs-lookup"><span data-stu-id="200d5-370">Query string versioning</span></span>
<span data-ttu-id="200d5-371">Em vez de fornecer vários URIs, você pode especificar a versão do recurso usando um parâmetro de cadeia de consulta acrescentada à solicitação HTTP, como *http://adventure-works.com/customers/3?version=2*.</span><span class="sxs-lookup"><span data-stu-id="200d5-371">Rather than providing multiple URIs, you can specify the version of the resource by using a parameter within the query string appended to the HTTP request, such as *http://adventure-works.com/customers/3?version=2*.</span></span> <span data-ttu-id="200d5-372">O parâmetro de versão, caso seja omitido por aplicativos cliente mais antigos, deve passar a usar um valor padrão significativo, como 1.</span><span class="sxs-lookup"><span data-stu-id="200d5-372">The version parameter should default to a meaningful value such as 1 if it is omitted by older client applications.</span></span>

<span data-ttu-id="200d5-373">Essa abordagem tem a vantagem de semântica que o mesmo recurso é sempre recuperado do mesmo URI, mas para isso, é necessário que o código que processa a solicitação analise a cadeia de consulta e envie de volta a resposta HTTP apropriada.</span><span class="sxs-lookup"><span data-stu-id="200d5-373">This approach has the semantic advantage that the same resource is always retrieved from the same URI, but it depends on the code that handles the request to parse the query string and send back the appropriate HTTP response.</span></span> <span data-ttu-id="200d5-374">Essa abordagem também tem as mesmas complicações para implementar HATEOAS como o mecanismo de controle de versão do URI.</span><span class="sxs-lookup"><span data-stu-id="200d5-374">This approach also suffers from the same complications for implementing HATEOAS as the URI versioning mechanism.</span></span>

> [!NOTE]
> <span data-ttu-id="200d5-375">Alguns navegadores e proxies da Web mais antigos não armazenarão em cache respostas para solicitações que incluam, na URL, uma cadeia de consulta.</span><span class="sxs-lookup"><span data-stu-id="200d5-375">Some older web browsers and web proxies will not cache responses for requests that include a query string in the URL.</span></span> <span data-ttu-id="200d5-376">Isso pode ter um impacto negativo no desempenho de aplicativos Web que usam uma API da Web e que são executados de um navegador da Web desse tipo.</span><span class="sxs-lookup"><span data-stu-id="200d5-376">This can have an adverse impact on performance for web applications that use a web API and that run from within such a web browser.</span></span>
>
>

### <a name="header-versioning"></a><span data-ttu-id="200d5-377">Controle de versão de cabeçalho</span><span class="sxs-lookup"><span data-stu-id="200d5-377">Header versioning</span></span>
<span data-ttu-id="200d5-378">Em vez de acrescentar o número de versão como um parâmetro de cadeia de consulta, você pode implementar um cabeçalho personalizado que indica a versão do recurso.</span><span class="sxs-lookup"><span data-stu-id="200d5-378">Rather than appending the version number as a query string parameter, you could implement a custom header that indicates the version of the resource.</span></span> <span data-ttu-id="200d5-379">Essa abordagem requer que o aplicativo cliente adicione o cabeçalho apropriado a quaisquer solicitações, embora o código que processa a solicitação do cliente possa usar um valor padrão (versão 1) se o cabeçalho da versão for omitido.</span><span class="sxs-lookup"><span data-stu-id="200d5-379">This approach requires that the client application adds the appropriate header to any requests, although the code handling the client request could use a default value (version 1) if the version header is omitted.</span></span> <span data-ttu-id="200d5-380">Os exemplos a seguir utilizam um cabeçalho personalizado chamado *Custom-Header*.</span><span class="sxs-lookup"><span data-stu-id="200d5-380">The following examples utilize a custom header named *Custom-Header*.</span></span> <span data-ttu-id="200d5-381">O valor desse cabeçalho indica a versão da API da Web.</span><span class="sxs-lookup"><span data-stu-id="200d5-381">The value of this header indicates the version of web API.</span></span>

<span data-ttu-id="200d5-382">Versão 1:</span><span class="sxs-lookup"><span data-stu-id="200d5-382">Version 1:</span></span>

```HTTP
GET http://adventure-works.com/customers/3 HTTP/1.1
...
Custom-Header: api-version=1
...
```

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="200d5-383">Versão 2:</span><span class="sxs-lookup"><span data-stu-id="200d5-383">Version 2:</span></span>

```HTTP
GET http://adventure-works.com/customers/3 HTTP/1.1
...
Custom-Header: api-version=2
...
```

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","dateCreated":"2014-09-04T12:11:38.0376089Z","address":{"streetAddress":"1 Microsoft Way","city":"Redmond","state":"WA","zipCode":98053}}
```

<span data-ttu-id="200d5-384">Observe que assim como nas duas abordagens anteriores, implementar HATEOAS requer a inclusão do cabeçalho personalizado apropriado em quaisquer eventuais links.</span><span class="sxs-lookup"><span data-stu-id="200d5-384">Note that as with the previous two approaches, implementing HATEOAS requires including the appropriate custom header in any links.</span></span>

### <a name="media-type-versioning"></a><span data-ttu-id="200d5-385">Controle de versão do tipo de mídia</span><span class="sxs-lookup"><span data-stu-id="200d5-385">Media type versioning</span></span>
<span data-ttu-id="200d5-386">Quando um aplicativo cliente envia uma solicitação HTTP GET para um servidor Web, ele deve estipular o formato do conteúdo que pode manipular usando um cabeçalho Accept, conforme descrito anteriormente nestas diretrizes.</span><span class="sxs-lookup"><span data-stu-id="200d5-386">When a client application sends an HTTP GET request to a web server it should stipulate the format of the content that it can handle by using an Accept header, as described earlier in this guidance.</span></span> <span data-ttu-id="200d5-387">Frequentemente, a finalidade do cabeçalho *Accept* é permitir que o aplicativo cliente especifique se o corpo da resposta deve ser XML, JSON ou algum outro formato comum que o cliente possa analisar.</span><span class="sxs-lookup"><span data-stu-id="200d5-387">Frequently the purpose of the *Accept* header is to allow the client application to specify whether the body of the response should be XML, JSON, or some other common format that the client can parse.</span></span> <span data-ttu-id="200d5-388">No entanto, é possível definir tipos de mídia personalizados que incluem informações, permitindo que o aplicativo cliente indique qual versão de um recurso esse aplicativo está esperando.</span><span class="sxs-lookup"><span data-stu-id="200d5-388">However, it is possible to define custom media types that include information enabling the client application to indicate which version of a resource it is expecting.</span></span> <span data-ttu-id="200d5-389">O exemplo a seguir mostra uma solicitação que especifica um cabeçalho *Accept* com o valor *application/vnd.adventure-works.v1+json*.</span><span class="sxs-lookup"><span data-stu-id="200d5-389">The following example shows a request that specifies an *Accept* header with the value *application/vnd.adventure-works.v1+json*.</span></span> <span data-ttu-id="200d5-390">O elemento *vnd.adventure-works.v1* indica ao servidor Web que ele deve retornar a versão 1 do recurso, enquanto o elemento *json* especifica que o formato do corpo da resposta deve ser JSON:</span><span class="sxs-lookup"><span data-stu-id="200d5-390">The *vnd.adventure-works.v1* element indicates to the web server that it should return version 1 of the resource, while the *json* element specifies that the format of the response body should be JSON:</span></span>

```HTTP
GET http://adventure-works.com/customers/3 HTTP/1.1
...
Accept: application/vnd.adventure-works.v1+json
...
```

<span data-ttu-id="200d5-391">O código que processa a solicitação é responsável por processar o cabeçalho *Accept* e honrá-lo o máximo possível (o aplicativo cliente pode especificar vários formatos no cabeçalho *Accept*; nesse caso, o servidor Web pode escolher o formato mais apropriado para o corpo de resposta).</span><span class="sxs-lookup"><span data-stu-id="200d5-391">The code handling the request is responsible for processing the *Accept* header and honoring it as far as possible (the client application may specify multiple formats in the *Accept* header, in which case the web server can choose the most appropriate format for the response body).</span></span> <span data-ttu-id="200d5-392">O servidor Web confirma o formato dos dados no corpo da resposta usando o cabeçalho Content-Type:</span><span class="sxs-lookup"><span data-stu-id="200d5-392">The web server confirms the format of the data in the response body by using the Content-Type header:</span></span>

```HTTP
HTTP/1.1 200 OK
...
Content-Type: application/vnd.adventure-works.v1+json; charset=utf-8
...
Content-Length: ...
{"id":3,"name":"Contoso LLC","address":"1 Microsoft Way Redmond WA 98053"}
```

<span data-ttu-id="200d5-393">Se o cabeçalho Accept não especificar nenhum tipo de mídia conhecido, o servidor Web pode gerar uma mensagem de resposta HTTP 406 (Não Aceitável) ou retornar uma mensagem com um tipo de mídia padrão.</span><span class="sxs-lookup"><span data-stu-id="200d5-393">If the Accept header does not specify any known media types, the web server could generate an HTTP 406 (Not Acceptable) response message or return a message with a default media type.</span></span>

<span data-ttu-id="200d5-394">Essa abordagem é possivelmente o mais puro dos mecanismos de controle de versão e aplica-se naturalmente a HATEOAS, que pode incluir o tipo MIME dos dados relacionados em links de recursos.</span><span class="sxs-lookup"><span data-stu-id="200d5-394">This approach is arguably the purest of the versioning mechanisms and lends itself naturally to HATEOAS, which can include the MIME type of related data in resource links.</span></span>

> [!NOTE]
> <span data-ttu-id="200d5-395">Quando você seleciona uma estratégia de controle de versão, você também deve considerar as implicações de desempenho, especialmente no armazenamento em cache no servidor Web.</span><span class="sxs-lookup"><span data-stu-id="200d5-395">When you select a versioning strategy, you should also consider the implications on performance, especially caching on the web server.</span></span> <span data-ttu-id="200d5-396">O controle de versão do URI e esquemas de controle de versão de cadeia de consulta facilitam o armazenamento em cache na medida em que, a cada vez, a mesma combinação de URI/cadeia de consulta refere-se aos mesmos dados.</span><span class="sxs-lookup"><span data-stu-id="200d5-396">The URI versioning and Query String versioning schemes are cache-friendly inasmuch as the same URI/query string combination refers to the same data each time.</span></span>
>
> <span data-ttu-id="200d5-397">Os mecanismos de controle de versão do cabeçalho e do tipo de mídia, normalmente, exigem lógica adicional para examinar os valores no cabeçalho personalizado ou no cabeçalho Accept.</span><span class="sxs-lookup"><span data-stu-id="200d5-397">The Header versioning and Media Type versioning mechanisms typically require additional logic to examine the values in the custom header or the Accept header.</span></span> <span data-ttu-id="200d5-398">Em um ambiente de grande escala, muitos clientes usando versões diferentes de uma API da Web podem resultar em uma quantidade significativa de dados duplicados em um cache do lado do servidor.</span><span class="sxs-lookup"><span data-stu-id="200d5-398">In a large-scale environment, many clients using different versions of a web API can result in a significant amount of duplicated data in a server-side cache.</span></span> <span data-ttu-id="200d5-399">Esse problema pode se tornar importante se um aplicativo cliente se comunica com um servidor Web através de um proxy que implementa caching, e que encaminha uma solicitação ao servidor Web somente se ele não mantém atualmente uma cópia dos dados solicitados em seu cache.</span><span class="sxs-lookup"><span data-stu-id="200d5-399">This issue can become acute if a client application communicates with a web server through a proxy that implements caching, and that only forwards a request to the web server if it does not currently hold a copy of the requested data in its cache.</span></span>
>
>

## <a name="open-api-initiative"></a><span data-ttu-id="200d5-400">Abrir Iniciativa de API</span><span class="sxs-lookup"><span data-stu-id="200d5-400">Open API Initiative</span></span>
<span data-ttu-id="200d5-401">A [Open API Initiative](https://www.openapis.org/) foi criada por um consórcio do setor para padronizar descrições de API REST entre fornecedores.</span><span class="sxs-lookup"><span data-stu-id="200d5-401">The [Open API Initiative](https://www.openapis.org/) was created by an industry consortium to standardize REST API descriptions across vendors.</span></span> <span data-ttu-id="200d5-402">Como parte dessa iniciativa, a especificação de Swagger 2.0 foi renomeada como OAS (OpenAPI Specification) e colocada sob a iniciativa de API aberta.</span><span class="sxs-lookup"><span data-stu-id="200d5-402">As part of this initiative, the Swagger 2.0 specification was renamed the OpenAPI Specification (OAS) and brought under the Open API Initiative.</span></span>

<span data-ttu-id="200d5-403">Talvez você queira adotar a OpenAPI para suas APIs Web.</span><span class="sxs-lookup"><span data-stu-id="200d5-403">You may want to adopt OpenAPI for your web APIs.</span></span> <span data-ttu-id="200d5-404">Considere o seguinte:</span><span class="sxs-lookup"><span data-stu-id="200d5-404">Some points to consider:</span></span>

- <span data-ttu-id="200d5-405">A OpenAPI Specification vem com um conjunto de diretrizes teimosas sobre como uma API REST deve ser criada.</span><span class="sxs-lookup"><span data-stu-id="200d5-405">The OpenAPI Specification comes with with a set of opinionated guidelines on how a REST API should be designed.</span></span> <span data-ttu-id="200d5-406">Isso apresenta vantagens para a interoperabilidade, mas requer mais cuidado durante o design de sua API para ficar de acordo com a especificação.</span><span class="sxs-lookup"><span data-stu-id="200d5-406">That has advantages for interoperability, but requires more care when designing your API to conform to the specification.</span></span>
- <span data-ttu-id="200d5-407">A OpenAPI promove uma abordagem de primeiro contrato, em vez de uma primeira abordagem de implementação.</span><span class="sxs-lookup"><span data-stu-id="200d5-407">OpenAPI promotes a contract-first approach, rather than an implementation-first approach.</span></span> <span data-ttu-id="200d5-408">Primeiro contato significa que você projeta o contrato da API (a interface) primeiro e então escreve o código que implementa o contrato.</span><span class="sxs-lookup"><span data-stu-id="200d5-408">Contract-first means you design the API contract (the interface) first and then write code that implements the contract.</span></span> 
- <span data-ttu-id="200d5-409">Ferramentas como o Swagger podem gerar bibliotecas de cliente ou a documentação de contratos de API.</span><span class="sxs-lookup"><span data-stu-id="200d5-409">Tools like Swagger can generate client libraries or documentation from API contracts.</span></span> <span data-ttu-id="200d5-410">Por exemplo, veja [Páginas da Ajuda da API Web ASP.NET usando o Swagger](/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span><span class="sxs-lookup"><span data-stu-id="200d5-410">For example, see [ASP.NET Web API Help Pages using Swagger](/aspnet/core/tutorials/web-api-help-pages-using-swagger).</span></span>

## <a name="more-information"></a><span data-ttu-id="200d5-411">Mais informações</span><span class="sxs-lookup"><span data-stu-id="200d5-411">More information</span></span>
* <span data-ttu-id="200d5-412">As [Diretrizes da API REST da Microsoft](https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md) contêm recomendações detalhadas para a criação de APIs REST públicas.</span><span class="sxs-lookup"><span data-stu-id="200d5-412">The [Microsoft REST API Guidelines](https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md) contain detailed recommendations for designing public REST APIs.</span></span>
* <span data-ttu-id="200d5-413">O [Guia RESTful](http://restcookbook.com/) contém uma introdução à criação de APIs RESTful.</span><span class="sxs-lookup"><span data-stu-id="200d5-413">The [RESTful Cookbook](http://restcookbook.com/) contains an introduction to building RESTful APIs.</span></span>
* <span data-ttu-id="200d5-414">A [Lista de Verificação de API Web](https://mathieu.fenniak.net/the-api-checklist/) contém uma lista útil de itens a serem considerados ao projetar e implementar uma API Web.</span><span class="sxs-lookup"><span data-stu-id="200d5-414">The [Web API Checklist](https://mathieu.fenniak.net/the-api-checklist/) contains a useful list of items to consider when designing and implementing a web API.</span></span>
* <span data-ttu-id="200d5-415">O site [Open API Initiative](https://www.openapis.org/) contém toda a documentação relacionada e os detalhes da implementação da Open API.</span><span class="sxs-lookup"><span data-stu-id="200d5-415">The [Open API Initiative](https://www.openapis.org/) site, contains all related documentation and implementation details on Open API.</span></span>
