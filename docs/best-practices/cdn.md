---
title: "Diretrizes da Rede de Distribuição de Conteúdo"
description: "Diretriz na Rede de Distribuição de Conteúdo (CDN) para fornecer conteúdo de alta largura de banda hospedado no Azure."
author: dragon119
ms.date: 02/02/2018
pnp.series.title: Best Practices
ms.openlocfilehash: 42b73db08ecef858f5279ea292cf8c0df77b847c
ms.sourcegitcommit: 29fbcb1eec44802d2c01b6d3bcf7d7bd0bae65fc
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/27/2018
---
# <a name="best-practices-for-using-content-delivery-networks-cdns"></a><span data-ttu-id="003c9-103">Melhores práticas para uso das CDNs (redes de distribuição de conteúdo)</span><span class="sxs-lookup"><span data-stu-id="003c9-103">Best practices for using content delivery networks (CDNs)</span></span>

<span data-ttu-id="003c9-104">Uma CDN (rede de distribuição de conteúdo) é uma rede distribuída de servidores que pode fornecer conteúdo da Web para os usuários com eficiência.</span><span class="sxs-lookup"><span data-stu-id="003c9-104">A content delivery network (CDN) is a distributed network of servers that can efficiently deliver web content to users.</span></span> <span data-ttu-id="003c9-105">As CDNs armazenam conteúdo armazenado em cache em servidores de borda que estão próximos aos usuários finais, a fim de minimizar a latência.</span><span class="sxs-lookup"><span data-stu-id="003c9-105">CDNs store cached content on edge servers that are close to end-users, to minimize latency.</span></span> 

<span data-ttu-id="003c9-106">As CDNs normalmente são usadas para fornecimento de conteúdo estático, como imagens, folhas de estilo, documentos, scripts do lado do cliente e páginas HTML.</span><span class="sxs-lookup"><span data-stu-id="003c9-106">CDNs are typically used to deliver static content such as images, style sheets, documents, client-side scripts, and HTML pages.</span></span> <span data-ttu-id="003c9-107">As principais vantagens de usar uma CDN são latência mais baixa e fornecimento mais rápido de conteúdo aos usuários, independentemente de sua localização geográfica em relação ao datacenter no qual o aplicativo está hospedado.</span><span class="sxs-lookup"><span data-stu-id="003c9-107">The major advantages of using a CDN are lower latency and faster delivery of content to users, regardless of their geographical location in relation to the datacenter where the application is hosted.</span></span> <span data-ttu-id="003c9-108">As CDNs também podem ajudar a reduzir a carga em um aplicativo Web, porque o aplicativo não precisa atender a solicitações para o conteúdo que está hospedado na CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-108">CDNs can also help to reduce load on a web application, because the application does not have to service requests for the content that is hosted in the CDN.</span></span>
 
![Diagrama da CDN](./images/cdn/CDN.png)

<span data-ttu-id="003c9-110">No Azure, a [Rede de Distribuição de Conteúdo do Azure](/azure/cdn/cdn-overview) é uma solução global de CDN de fornecimento de conteúdo de alta largura de banda hospedada no Azure ou em qualquer outro local.</span><span class="sxs-lookup"><span data-stu-id="003c9-110">In Azure, the [Azure Content Delivery Network](/azure/cdn/cdn-overview) is a global CDN solution for delivering high-bandwidth content that is hosted in Azure or any other location.</span></span> <span data-ttu-id="003c9-111">Usando a CDN do Azure, você pode armazenar em cache objetos disponíveis publicamente carregados de um armazenamento de blobs do Azure, um aplicativo Web, uma máquina virtual e qualquer servidor Web acessível publicamente.</span><span class="sxs-lookup"><span data-stu-id="003c9-111">Using Azure CDN, you can cache publicly available objects loaded from Azure blob storage, a web application, virtual machine, any publicly accessible web server.</span></span> 

<span data-ttu-id="003c9-112">Este tópico descreve algumas das melhores práticas gerais e considerações ao usar uma CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-112">This topic describes some general best practices and considerations when using a CDN.</span></span> <span data-ttu-id="003c9-113">Para saber mais sobre como usar a CDN do Azure, consulte [Documentação da CDN](/azure/cdn/).</span><span class="sxs-lookup"><span data-stu-id="003c9-113">To learn more about using Azure CDN, see [CDN Documentation](/azure/cdn/).</span></span>

## <a name="how-and-why-a-cdn-is-used"></a><span data-ttu-id="003c9-114">Como e por que a CDN é usada</span><span class="sxs-lookup"><span data-stu-id="003c9-114">How and why a CDN is used</span></span>

<span data-ttu-id="003c9-115">Entre os usos comuns para a CDN estão:</span><span class="sxs-lookup"><span data-stu-id="003c9-115">Typical uses for a CDN include:</span></span>  

* <span data-ttu-id="003c9-116">Fornecer recursos estáticos para aplicativos cliente, geralmente por meio de um site.</span><span class="sxs-lookup"><span data-stu-id="003c9-116">Delivering static resources for client applications, often from a website.</span></span> <span data-ttu-id="003c9-117">Esses recursos podem ser imagens, folhas de estilo, documentos, arquivos, scripts do lado do cliente, páginas HTML, fragmentos HTML ou qualquer outro conteúdo que o servidor não precise modificar para cada solicitação.</span><span class="sxs-lookup"><span data-stu-id="003c9-117">These resources can be images, style sheets, documents, files, client-side scripts, HTML pages, HTML fragments, or any other content that the server does not need to modify for each request.</span></span> <span data-ttu-id="003c9-118">O aplicativo pode criar itens em tempo de execução e disponibilizá-los para o CDN (por exemplo, ao criar uma lista atual de manchetes de notícias), mas ele não faz isso para cada solicitação.</span><span class="sxs-lookup"><span data-stu-id="003c9-118">The application can create items at runtime and make them available to the CDN (for example, by creating a list of current news headlines), but it does not do so for each request.</span></span>
* <span data-ttu-id="003c9-119">Fornecimento de conteúdo estático e compartilhado público para dispositivos como telefones móveis e tablet PCs.</span><span class="sxs-lookup"><span data-stu-id="003c9-119">Delivering public static and shared content to devices such as mobile phones and tablet computers.</span></span> <span data-ttu-id="003c9-120">O aplicativo em si é um serviço web que oferece uma API aos clientes que são executados em vários dispositivos.</span><span class="sxs-lookup"><span data-stu-id="003c9-120">The application itself is a web service that offers an API to clients running on the various devices.</span></span> <span data-ttu-id="003c9-121">O CDN também pode fornecer conjuntos de dados estáticos (por meio do serviço web) para os clientes usarem, talvez para gerar a interface do usuário do cliente.</span><span class="sxs-lookup"><span data-stu-id="003c9-121">The CDN can also deliver static datasets (via the web service) for the clients to use, perhaps to generate the client UI.</span></span> <span data-ttu-id="003c9-122">Por exemplo, o CDN pode ser usado para distribuir documentos XML ou JSON.</span><span class="sxs-lookup"><span data-stu-id="003c9-122">For example, the CDN could be used to distribute JSON or XML documents.</span></span>
* <span data-ttu-id="003c9-123">Servir sites inteiros que consistem em apenas conteúdo estático público para os clientes, sem a necessidade de quaisquer recursos de computação dedicados.</span><span class="sxs-lookup"><span data-stu-id="003c9-123">Serving entire websites that consist of only public static content to clients, without requiring any dedicated compute resources.</span></span>
* <span data-ttu-id="003c9-124">Fazer o streaming de arquivos de vídeo ao cliente sob demanda.</span><span class="sxs-lookup"><span data-stu-id="003c9-124">Streaming video files to the client on demand.</span></span> <span data-ttu-id="003c9-125">Os benefícios do vídeo de baixa latência e conectividade confiável disponível em datacenters globalmente localizados que oferecem conexões do CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-125">Video benefits from the low latency and reliable connectivity available from the globally located datacenters that offer CDN connections.</span></span> <span data-ttu-id="003c9-126">Os Serviços de Mídia do Microsoft Azure (AMS) integram-se com o Azure CDN para entregar conteúdo diretamente ao CDN para melhor distribuição.</span><span class="sxs-lookup"><span data-stu-id="003c9-126">Microsoft Azure Media Services (AMS) integrates with Azure CDN to deliver content directly to the CDN for further distribution.</span></span> <span data-ttu-id="003c9-127">Para saber mais, confira [Streaming endpoints overview](/azure/media-services/media-services-streaming-endpoints-overview) (Visão geral dos pontos de extremidade de streaming).</span><span class="sxs-lookup"><span data-stu-id="003c9-127">For more information, see [Streaming endpoints overview](/azure/media-services/media-services-streaming-endpoints-overview).</span></span>
* <span data-ttu-id="003c9-128">Geralmente aprimorar a experiência dos usuários, especialmente aqueles localizados longe o datacenter que hospeda o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="003c9-128">Generally improving the experience for users, especially those located far from the datacenter hosting the application.</span></span> <span data-ttu-id="003c9-129">Esses usuários poderiam, de outra forma, sofrer latência mais alta.</span><span class="sxs-lookup"><span data-stu-id="003c9-129">These users might otherwise suffer higher latency.</span></span> <span data-ttu-id="003c9-130">Uma grande proporção do tamanho total do conteúdo em um aplicativo Web geralmente é estática e usar o CDN pode ajudar a manter o desempenho e a experiência geral do usuário eliminando a necessidade de implantar o aplicativo em vários datacenters.</span><span class="sxs-lookup"><span data-stu-id="003c9-130">A large proportion of the total size of the content in a web application is often static, and using the CDN can help to maintain performance and overall user experience while eliminating the requirement to deploy the application to multiple data centers.</span></span> <span data-ttu-id="003c9-131">Para ver uma lista de locais de nó da CDN do Azure, consulte [Locais POP da CDN do Azure](/azure/cdn/cdn-pop-locations/).</span><span class="sxs-lookup"><span data-stu-id="003c9-131">For a list of Azure CDN node locations, see [Azure CDN POP Locations](/azure/cdn/cdn-pop-locations/).</span></span>
* <span data-ttu-id="003c9-132">Dando suporte a soluções de IoT (Internet das Coisas).</span><span class="sxs-lookup"><span data-stu-id="003c9-132">Supporting IoT (Internet of Things) solutions.</span></span> <span data-ttu-id="003c9-133">O grande número de dispositivos e aplicativos envolvidos em uma solução de IoT pode sobrecarregar um aplicativo com facilidade, se ele precisasse distribuir atualizações de firmware diretamente para cada dispositivo.</span><span class="sxs-lookup"><span data-stu-id="003c9-133">The huge numbers of devices and appliances involved in an IoT solution could easily overwhelm an application if it had to distribute firmware updates directly to each device.</span></span>
* <span data-ttu-id="003c9-134">Lidar com picos e sobretensão de energia sob demanda sem exigir que o aplicativo dimensione, evitando o consequente aumento dos custos de execução.</span><span class="sxs-lookup"><span data-stu-id="003c9-134">Coping with peaks and surges in demand without requiring the application to scale, avoiding the consequent increased running costs.</span></span> <span data-ttu-id="003c9-135">Por exemplo, quando uma atualização para um sistema operacional é liberada, para um dispositivo de hardware, como um modelo específico do roteador ou para um dispositivo do consumidor, como uma smart TV, haverá um grande pico na demanda conforme ele é baixado por milhões de usuários e dispositivos em um curto período de tempo.</span><span class="sxs-lookup"><span data-stu-id="003c9-135">For example, when an update to an operating system is released for a hardware device such as a specific model of router, or for a consumer device such as a smart TV, there will be a huge peak in demand as it is downloaded by millions of users and devices over a short period.</span></span>

## <a name="challenges"></a><span data-ttu-id="003c9-136">Desafios</span><span class="sxs-lookup"><span data-stu-id="003c9-136">Challenges</span></span>

<span data-ttu-id="003c9-137">Há vários desafios a serem considerados ao planejar o uso de uma CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-137">There are several challenges to take into account when planning to use a CDN.</span></span>  

* <span data-ttu-id="003c9-138">**Implantação**.</span><span class="sxs-lookup"><span data-stu-id="003c9-138">**Deployment**.</span></span> <span data-ttu-id="003c9-139">Decida a origem da qual a CDN busca o conteúdo e se é necessário implantar o conteúdo em mais de um sistema de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="003c9-139">Decide the origin from which the CDN fetches the content, and whether you need to deploy the content in more than one storage system.</span></span> <span data-ttu-id="003c9-140">Leve em consideração o processo de implantação de recursos e conteúdo estático.</span><span class="sxs-lookup"><span data-stu-id="003c9-140">Take into account the process for deploying static content and resources.</span></span> <span data-ttu-id="003c9-141">Por exemplo, talvez seja necessário implementar uma etapa separada para carregar conteúdo no armazenamento de blobs do Azure.</span><span class="sxs-lookup"><span data-stu-id="003c9-141">For example, you may need to implement a separate step to load content into Azure blob storage.</span></span>
* <span data-ttu-id="003c9-142">**Controle de versão e controle de cache**.</span><span class="sxs-lookup"><span data-stu-id="003c9-142">**Versioning and cache-control**.</span></span> <span data-ttu-id="003c9-143">Leve em consideração como você atualizará o conteúdo estático e implantará novas versões.</span><span class="sxs-lookup"><span data-stu-id="003c9-143">Consider how you will update static content and deploy new versions.</span></span> <span data-ttu-id="003c9-144">Entenda como a CDN executa o cache e a TTL (vida útil).</span><span class="sxs-lookup"><span data-stu-id="003c9-144">Understand how the CDN performs caching and time-to-live (TTL).</span></span> <span data-ttu-id="003c9-145">Para a CDN do Azure, consulte [Como funciona o cache](/azure/cdn/cdn-how-caching-works).</span><span class="sxs-lookup"><span data-stu-id="003c9-145">For Azure CDN, see [How caching works](/azure/cdn/cdn-how-caching-works).</span></span>
* <span data-ttu-id="003c9-146">**Testando**.</span><span class="sxs-lookup"><span data-stu-id="003c9-146">**Testing**.</span></span> <span data-ttu-id="003c9-147">Pode ser difícil executar teste local de suas configurações de CDN ao desenvolver e testar um aplicativo localmente ou em um ambiente de preparo.</span><span class="sxs-lookup"><span data-stu-id="003c9-147">It can be difficult to perform local testing of your CDN settings when developing and testing an application locally or in a staging environment.</span></span>
* <span data-ttu-id="003c9-148">**SEO (otimização do mecanismo de pesquisa)**.</span><span class="sxs-lookup"><span data-stu-id="003c9-148">**Search engine optimization (SEO)**.</span></span> <span data-ttu-id="003c9-149">Conteúdo como imagens e documentos são atendidos de um domínio diferente quando você usa CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-149">Content such as images and documents are served from a different domain when you use the CDN.</span></span> <span data-ttu-id="003c9-150">Isso pode afetar a SEO para esse conteúdo.</span><span class="sxs-lookup"><span data-stu-id="003c9-150">This can have an effect on SEO for this content.</span></span>
* <span data-ttu-id="003c9-151">**Segurança de conteúdo**.</span><span class="sxs-lookup"><span data-stu-id="003c9-151">**Content security**.</span></span> <span data-ttu-id="003c9-152">Nem todas as CDNs oferecem uma forma de controle de acesso para o conteúdo.</span><span class="sxs-lookup"><span data-stu-id="003c9-152">Not all CDNs offer any form of access control for the content.</span></span> <span data-ttu-id="003c9-153">Alguns serviços da CDN, incluindo a CDN do Azure, dão suporte à autenticação baseada em token para proteger o conteúdo da CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-153">Some CDN services, including Azure CDN, support token-based authentication to protect CDN content.</span></span> <span data-ttu-id="003c9-154">Para obter mais informações, consulte [Protegendo ativos da Rede de Distribuição de Conteúdo do Azure com autenticação de token](/azure/cdn/cdn-token-auth).</span><span class="sxs-lookup"><span data-stu-id="003c9-154">For more information, see [Securing Azure Content Delivery Network assets with token authentication](/azure/cdn/cdn-token-auth).</span></span>
* <span data-ttu-id="003c9-155">**Segurança do cliente**.</span><span class="sxs-lookup"><span data-stu-id="003c9-155">**Client security**.</span></span> <span data-ttu-id="003c9-156">Os clientes podem se conectar por meio de um ambiente que não permita acesso a recursos no CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-156">Clients might connect from an environment that does not allow access to resources on the CDN.</span></span> <span data-ttu-id="003c9-157">Isso pode ser um ambiente restrito de segurança que limita o acesso a apenas um conjunto de fontes conhecidas ou que impede o carregamento de recursos por meio  de qualquer coisa que não seja a origem da página.</span><span class="sxs-lookup"><span data-stu-id="003c9-157">This could be a security-constrained environment that limits access to only a set of known sources, or one that prevents loading of resources from anything other than the page origin.</span></span> <span data-ttu-id="003c9-158">Uma implementação de fallback é necessária para lidar com esses casos.</span><span class="sxs-lookup"><span data-stu-id="003c9-158">A fallback implementation is required to handle these cases.</span></span>
* <span data-ttu-id="003c9-159">**Resiliência**.</span><span class="sxs-lookup"><span data-stu-id="003c9-159">**Resilience**.</span></span> <span data-ttu-id="003c9-160">O CDN é um ponto único de falha em potencial de um aplicativo.</span><span class="sxs-lookup"><span data-stu-id="003c9-160">The CDN is a potential single point of failure for an application.</span></span> 

<span data-ttu-id="003c9-161">Os cenários onde o CDN pode ser menos útil incluem:</span><span class="sxs-lookup"><span data-stu-id="003c9-161">Scenarios where CDN may be less useful include:</span></span>  

* <span data-ttu-id="003c9-162">Se o conteúdo tiver uma baixa taxa de ocorrências, ele pode ser acessado apenas algumas vezes enquanto for válido (determinado pela sua configuração de tempo de vida).</span><span class="sxs-lookup"><span data-stu-id="003c9-162">If the content has a low hit rate, it might be accessed only few times while it is valid (determined by its time-to-live setting).</span></span> 
* <span data-ttu-id="003c9-163">Se os dados forem particulares, como para empresas de grande porte ou ecossistemas de cadeia de suprimentos.</span><span class="sxs-lookup"><span data-stu-id="003c9-163">If the data is private, such as for large enterprises or supply chain ecosystems.</span></span>

## <a name="general-guidelines-and-good-practices"></a><span data-ttu-id="003c9-164">Diretrizes gerais e práticas recomendadas</span><span class="sxs-lookup"><span data-stu-id="003c9-164">General guidelines and good practices</span></span>

<span data-ttu-id="003c9-165">O uso de uma CDN é uma boa maneira de minimizar a carga no aplicativo e maximizar a disponibilidade e o desempenho.</span><span class="sxs-lookup"><span data-stu-id="003c9-165">Using a CDN is a good way to minimize the load on your application, and maximize availability and performance.</span></span> <span data-ttu-id="003c9-166">Leve em consideração a adoção dessa estratégia para todos os recursos e conteúdos apropriados que o seu aplicativo usa.</span><span class="sxs-lookup"><span data-stu-id="003c9-166">Consider adopting this strategy for all of the appropriate content and resources your application uses.</span></span> <span data-ttu-id="003c9-167">Considere os pontos nas seções a seguir ao projetar sua estratégia para usar uma CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-167">Consider the points in the following sections when designing your strategy to use a CDN.</span></span>

### <a name="deployment"></a><span data-ttu-id="003c9-168">Implantação</span><span class="sxs-lookup"><span data-stu-id="003c9-168">Deployment</span></span>
<span data-ttu-id="003c9-169">O conteúdo estático pode precisar ser provisionado e implantado independentemente do aplicativo se você não incluí-lo no pacote ou processo de implantação do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="003c9-169">Static content may need to be provisioned and deployed independently from the application if you do not include it in the application deployment package or process.</span></span> <span data-ttu-id="003c9-170">Considere como isso afetará a abordagem do controle de versão usada para gerenciar os componentes do aplicativo e o conteúdo de recursos estáticos.</span><span class="sxs-lookup"><span data-stu-id="003c9-170">Consider how this will affect the versioning approach you use to manage both the application components and the static resource content.</span></span>

<span data-ttu-id="003c9-171">Considere o uso de técnicas de agrupamento e minificação para reduzir os tempos de carregamento para clientes.</span><span class="sxs-lookup"><span data-stu-id="003c9-171">Consider using bundling and minification techniques to reduce load times for clients.</span></span> <span data-ttu-id="003c9-172">O agrupamento combina vários arquivos em um único arquivo.</span><span class="sxs-lookup"><span data-stu-id="003c9-172">Bundling combines multiple files into a single file.</span></span> <span data-ttu-id="003c9-173">A minificação remove caracteres desnecessários de scripts e arquivos CSS sem alterar a funcionalidade.</span><span class="sxs-lookup"><span data-stu-id="003c9-173">Minification removes unnecessary characters from scripts and CSS files without altering functionality.</span></span>

<span data-ttu-id="003c9-174">Se você precisar implantar o conteúdo em um local adicional, isso será uma etapa extra no processo de implantação.</span><span class="sxs-lookup"><span data-stu-id="003c9-174">If you need to deploy the content to an additional location, this will be an extra step in the deployment process.</span></span> <span data-ttu-id="003c9-175">Se o aplicativo atualizar o conteúdo para o CDN, talvez em intervalos regulares ou em resposta a um evento, ele deve armazenar o conteúdo atualizado em todos os locais adicionais, bem como o ponto de extremidade para o CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-175">If the application updates the content for the CDN, perhaps at regular intervals or in response to an event, it must store the updated content in any additional locations as well as the endpoint for the CDN.</span></span>

<span data-ttu-id="003c9-176">Considere como você manipulará o desenvolvimento e teste local quando um conteúdo estático precisar ser fornecido por meio de uma CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-176">Consider how you will handle local development and testing when some static content is expected to be served from a CDN.</span></span> <span data-ttu-id="003c9-177">Por exemplo, você pode pré-implantar o conteúdo na CDN como parte do script de build.</span><span class="sxs-lookup"><span data-stu-id="003c9-177">For example, you could pre-deploy the content to the CDN as part of your build script.</span></span> <span data-ttu-id="003c9-178">Como alternativa, use as diretivas de compilação ou sinalizadores para controlar como o aplicativo carrega os recursos.</span><span class="sxs-lookup"><span data-stu-id="003c9-178">Alternatively, use compile directives or flags to control how the application loads the resources.</span></span> <span data-ttu-id="003c9-179">Por exemplo, no modo de depuração, o aplicativo pôde carregar recursos estáticos de uma pasta local.</span><span class="sxs-lookup"><span data-stu-id="003c9-179">For example, in debug mode, the application could load static resources from a local folder.</span></span> <span data-ttu-id="003c9-180">No modo de versão, o aplicativo usará a CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-180">In release mode, the application would use the CDN.</span></span>

<span data-ttu-id="003c9-181">Considere as opções de compactação de arquivo, como gzip (GNU zip).</span><span class="sxs-lookup"><span data-stu-id="003c9-181">Consider the options for file compression, such as gzip (GNU zip).</span></span> <span data-ttu-id="003c9-182">A compactação pode ser executada no servidor de origem pelo aplicativo Web host ou diretamente nos servidores de borda pela CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-182">Compression may be performed on the origin server by the web application hosting or directly on the edge servers by the CDN.</span></span> <span data-ttu-id="003c9-183">Para obter mais informações, consulte [Melhorar o desempenho compactando arquivos na CDN do Azure](/azure/cdn/cdn-improve-performance).</span><span class="sxs-lookup"><span data-stu-id="003c9-183">For more information, see [Improve performance by compressing files in Azure CDN](/azure/cdn/cdn-improve-performance).</span></span>


### <a name="routing-and-versioning"></a><span data-ttu-id="003c9-184">Roteamento e controle de versão</span><span class="sxs-lookup"><span data-stu-id="003c9-184">Routing and versioning</span></span>
<span data-ttu-id="003c9-185">Você talvez precise usar diferentes instâncias do CDN em vários momentos.</span><span class="sxs-lookup"><span data-stu-id="003c9-185">You may need to use different CDN instances at various times.</span></span> <span data-ttu-id="003c9-186">Por exemplo, ao implantar uma nova versão do aplicativo, você pode querer usar um novo CDN e reter o CDN antigo (mantendo o conteúdo em um formato antigo) para versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="003c9-186">For example, when you deploy a new version of the application you may want to use a new CDN and retain the old CDN (holding content in an older format) for previous versions.</span></span> <span data-ttu-id="003c9-187">Se você usar o armazenamento de blob do Azure como a origem de conteúdo, pode criar uma conta de armazenamento separada ou um contêiner separado e direcionar o ponto de extremidade da CDN a ele.</span><span class="sxs-lookup"><span data-stu-id="003c9-187">If you use Azure blob storage as the content origin, you can create a separate storage account or a separate container and point the CDN endpoint to it.</span></span> 

<span data-ttu-id="003c9-188">Não use a cadeia de caracteres de consulta para denotar versões diferentes do aplicativo nos links para recursos na CDN, pois, ao recuperar o conteúdo do armazenamento de blobs do Azure, a cadeia de caracteres de consulta faz parte do nome do recurso (o nome de blob).</span><span class="sxs-lookup"><span data-stu-id="003c9-188">Do not use the query string to denote different versions of the application in links to resources on the CDN because, when retrieving content from Azure blob storage, the query string is part of the resource name (the blob name).</span></span> <span data-ttu-id="003c9-189">Essa abordagem também pode afetar como o cliente armazena os recursos em cache.</span><span class="sxs-lookup"><span data-stu-id="003c9-189">This approach can also affect how the client caches resources.</span></span>

<span data-ttu-id="003c9-190">Implantar novas versões do conteúdo estático quando você atualiza um aplicativo pode ser um desafio se os recursos anteriores forem armazenados em cache no CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-190">Deploying new versions of static content when you update an application can be a challenge if the previous resources are cached on the CDN.</span></span> <span data-ttu-id="003c9-191">Para obter mais informações, consulte a seção sobre controle de cache abaixo.</span><span class="sxs-lookup"><span data-stu-id="003c9-191">For more information, see the section on cache control, below.</span></span>

<span data-ttu-id="003c9-192">Considere restringir o acesso ao conteúdo CDN por país.</span><span class="sxs-lookup"><span data-stu-id="003c9-192">Consider restricting the CDN content access by country.</span></span> <span data-ttu-id="003c9-193">O CDN do Azure permite filtrar solicitações com base no país de origem e restringir o conteúdo fornecido.</span><span class="sxs-lookup"><span data-stu-id="003c9-193">Azure CDN allows you to filter requests based on the country of origin and restrict the content delivered.</span></span> <span data-ttu-id="003c9-194">Para saber mais, veja [Restringir o acesso ao seu conteúdo por país](/azure/cdn/cdn-restrict-access-by-country/).</span><span class="sxs-lookup"><span data-stu-id="003c9-194">For more information, see [Restrict access to your content by country](/azure/cdn/cdn-restrict-access-by-country/).</span></span>

### <a name="cache-control"></a><span data-ttu-id="003c9-195">controle de cache</span><span class="sxs-lookup"><span data-stu-id="003c9-195">Cache control</span></span>
<span data-ttu-id="003c9-196">Considere como gerenciar o caching dentro do sistema.</span><span class="sxs-lookup"><span data-stu-id="003c9-196">Consider how to manage caching within the system.</span></span> <span data-ttu-id="003c9-197">Por exemplo, na CDN do Azure, você pode definir regras de cache global e, em seguida, definir um cache personalizado para pontos de extremidade de origem específicos.</span><span class="sxs-lookup"><span data-stu-id="003c9-197">For example, in Azure CDN, you can set global caching rules, and then set custom caching for particular origin endpoints.</span></span> <span data-ttu-id="003c9-198">Você também pode controlar como o cache é executado em uma CDN pelo envio de cabeçalhos de diretiva de cache na origem.</span><span class="sxs-lookup"><span data-stu-id="003c9-198">You can also control how caching is performed in a CDN by sending cache-directive headers at the origin.</span></span> 

<span data-ttu-id="003c9-199">Para obter mais informações, consulte [Como funciona o cache](/azure/cdn/cdn-how-caching-works).</span><span class="sxs-lookup"><span data-stu-id="003c9-199">For more information, see [How caching works](/azure/cdn/cdn-how-caching-works).</span></span>

<span data-ttu-id="003c9-200">Para impedir que objetos estejam disponíveis na CDN, exclua-os da origem remova ou exclua o ponto de extremidade da CDN ou, no caso do armazenamento de blobs, torne o contêiner ou blob particular.</span><span class="sxs-lookup"><span data-stu-id="003c9-200">To prevent objects from being available on the CDN, you can delete them from the origin, remove or delete the CDN endpoint, or in the case of blob storage, make the container or blob private.</span></span> <span data-ttu-id="003c9-201">No entanto, os itens não são removidos até que a vida útil expire.</span><span class="sxs-lookup"><span data-stu-id="003c9-201">However, items are not removed from the until the time-to-live expires.</span></span> <span data-ttu-id="003c9-202">Também limpe manualmente um ponto de extremidade da CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-202">You can also manually purge a CDN endpoint.</span></span>

### <a name="security"></a><span data-ttu-id="003c9-203">Segurança</span><span class="sxs-lookup"><span data-stu-id="003c9-203">Security</span></span>

<span data-ttu-id="003c9-204">A CDN pode entregar conteúdo pelo HTTPS (SSL) usando o certificado fornecido pela CDN, e também pelo HTTP padrão.</span><span class="sxs-lookup"><span data-stu-id="003c9-204">The CDN can deliver content over HTTPS (SSL), by using the certificate provided by the CDN, as well as over standard HTTP.</span></span> <span data-ttu-id="003c9-205">Para evitar avisos de navegador sobre o conteúdo misto, talvez seja necessário usar HTTPS para solicitar o conteúdo estático que é exibido nas páginas carregadas por meio de HTTPS.</span><span class="sxs-lookup"><span data-stu-id="003c9-205">To avoid browser warnings about mixed content, you might need to use HTTPS to request static content that is displayed in pages loaded through HTTPS.</span></span>

<span data-ttu-id="003c9-206">Se você entregar ativos estáticos (como arquivos de fonte) usando a CDN, talvez encontre problemas de política de mesma origem se usar uma chamada *XMLHttpRequest* para solicitar esses recursos de um domínio diferente.</span><span class="sxs-lookup"><span data-stu-id="003c9-206">If you deliver static assets such as font files by using the CDN, you might encounter same-origin policy issues if you use an *XMLHttpRequest* call to request these resources from a different domain.</span></span> <span data-ttu-id="003c9-207">Muitos navegadores da web impedem o compartilhamento de recursos de origens cruzadas (CORS), a menos que o servidor Web esteja configurado para definir os cabeçalhos de resposta apropriada.</span><span class="sxs-lookup"><span data-stu-id="003c9-207">Many web browsers prevent cross-origin resource sharing (CORS) unless the web server is configured to set the appropriate response headers.</span></span> <span data-ttu-id="003c9-208">É possível configurar a CDN para dar suporte ao CORS usando um dos seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="003c9-208">You can configure the CDN to support CORS by using one of the following methods:</span></span>

* <span data-ttu-id="003c9-209">Configure a CDN para adicionar cabeçalhos CORS às respostas.</span><span class="sxs-lookup"><span data-stu-id="003c9-209">Configure the CDN to add CORS headers to the responses.</span></span> <span data-ttu-id="003c9-210">Para obter mais informações, confira [Usando a CDN do Azure com o CORS](/azure/cdn/cdn-cors).</span><span class="sxs-lookup"><span data-stu-id="003c9-210">For more information, see [Using Azure CDN with CORS](/azure/cdn/cdn-cors).</span></span> 
* <span data-ttu-id="003c9-211">Se a origem é o armazenamento de blobs do Azure, adicione regras do CORS ao ponto de extremidade de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="003c9-211">If the origin is Azure blob storage, add CORS rules to the storage endpoint.</span></span> <span data-ttu-id="003c9-212">Para obter mais informações, consulte [Suporte de Compartilhamento de Recursos de Origens Cruzadas (CORS) para os serviços de armazenamento do Azure](http://msdn.microsoft.com/library/azure/dn535601.aspx).</span><span class="sxs-lookup"><span data-stu-id="003c9-212">For more information, see [Cross-Origin Resource Sharing (CORS) Support for the Azure Storage Services](http://msdn.microsoft.com/library/azure/dn535601.aspx).</span></span>
* <span data-ttu-id="003c9-213">Configure o aplicativo para definir os cabeçalhos CORS.</span><span class="sxs-lookup"><span data-stu-id="003c9-213">Configure the application to set the CORS headers.</span></span> <span data-ttu-id="003c9-214">Por exemplo, confira [Habilitando as Solicitações Entre Origens (CORS)](/aspnet/core/security/cors) na documentação do ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="003c9-214">For example, see [Enabling Cross-Origin Requests (CORS)](/aspnet/core/security/cors) in the ASP.NET Core documentation.</span></span>

### <a name="cdn-fallback"></a><span data-ttu-id="003c9-215">Fallback de CDN</span><span class="sxs-lookup"><span data-stu-id="003c9-215">CDN fallback</span></span>
<span data-ttu-id="003c9-216">Leve em consideração como seu aplicativo lidará com uma falha ou indisponibilidade temporária da CDN.</span><span class="sxs-lookup"><span data-stu-id="003c9-216">Consider how your application will cope with a failure or temporary unavailability of the CDN.</span></span> <span data-ttu-id="003c9-217">Os aplicativos cliente poderão usar cópias dos recursos que foram armazenados em cache localmente (no cliente) durante solicitações anteriores, ou eles podem incluir o código que detecta falhas e solicita, em vez disso, os recursos de origem (a pasta de aplicativo ou o contêiner de blob do Azure que contém os recursos) se o CDN não estiver disponível.</span><span class="sxs-lookup"><span data-stu-id="003c9-217">Client applications may be able to use copies of the resources that were cached locally (on the client) during previous requests, or you can include code that detects failure and instead requests resources from the origin (the application folder or Azure blob container that holds the resources) if the CDN is unavailable.</span></span>
