---
title: Design a aumentar
titleSuffix: Azure Application Architecture Guide
description: Aplicativos de nuvem devem ser criados para escala horizontal.
author: MikeWasson
ms.date: 08/30/2018
ms.custom: seojan19
ms.openlocfilehash: 9e8a36146c711fda2b03e00dfeb3554caf1fd5f0
ms.sourcegitcommit: 1f4cdb08fe73b1956e164ad692f792f9f635b409
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/08/2019
ms.locfileid: "54113052"
---
# <a name="design-to-scale-out"></a><span data-ttu-id="07d9b-103">Design a aumentar</span><span class="sxs-lookup"><span data-stu-id="07d9b-103">Design to scale out</span></span>

## <a name="design-your-application-so-that-it-can-scale-horizontally"></a><span data-ttu-id="07d9b-104">Desenvolva seu aplicativo para que ele possa ser colocado em escala horizontalmente</span><span class="sxs-lookup"><span data-stu-id="07d9b-104">Design your application so that it can scale horizontally</span></span>

<span data-ttu-id="07d9b-105">Uma vantagem importante da nuvem é a escala elástica &mdash; a habilidade de usar tanta capacidade quanto necessário, expandir conforme a carga aumenta e reduzir a escala quando a capacidade extra não for necessária.</span><span class="sxs-lookup"><span data-stu-id="07d9b-105">A primary advantage of the cloud is elastic scaling &mdash; the ability to use as much capacity as you need, scaling out as load increases, and scaling in when the extra capacity is not needed.</span></span> <span data-ttu-id="07d9b-106">Crie seu aplicativo para que ele possa ser dimensionado horizontalmente, adicionando ou removendo novas instâncias como exige.</span><span class="sxs-lookup"><span data-stu-id="07d9b-106">Design your application so that it can scale horizontally, adding or removing new instances as demand requires.</span></span>

## <a name="recommendations"></a><span data-ttu-id="07d9b-107">Recomendações</span><span class="sxs-lookup"><span data-stu-id="07d9b-107">Recommendations</span></span>

<span data-ttu-id="07d9b-108">**Evitar a adesão de instância**.</span><span class="sxs-lookup"><span data-stu-id="07d9b-108">**Avoid instance stickiness**.</span></span> <span data-ttu-id="07d9b-109">Adesão ou *afinidade de sessão*, é quando as solicitações do mesmo cliente sempre são roteadas para o mesmo servidor.</span><span class="sxs-lookup"><span data-stu-id="07d9b-109">Stickiness, or *session affinity*, is when requests from the same client are always routed to the same server.</span></span> <span data-ttu-id="07d9b-110">A adesão limita a capacidade de aumentar o aplicativo. Por exemplo, o tráfego de um usuário de alto volume não será distribuído entre instâncias.</span><span class="sxs-lookup"><span data-stu-id="07d9b-110">Stickiness limits the application's ability to scale out. For example, traffic from a high-volume user will not be distributed across instances.</span></span> <span data-ttu-id="07d9b-111">Causas de adesão incluem armazenamento de estado de sessão na memória e usar chaves específicas de computador para a criptografia.</span><span class="sxs-lookup"><span data-stu-id="07d9b-111">Causes of stickiness include storing session state in memory, and using machine-specific keys for encryption.</span></span> <span data-ttu-id="07d9b-112">Todas as instâncias devem conseguir lidar com uma solicitação.</span><span class="sxs-lookup"><span data-stu-id="07d9b-112">Make sure that any instance can handle any request.</span></span>

<span data-ttu-id="07d9b-113">**Identificar gargalos**.</span><span class="sxs-lookup"><span data-stu-id="07d9b-113">**Identify bottlenecks**.</span></span> <span data-ttu-id="07d9b-114">Escalar horizontalmente não é uma correção mágica para todos os problemas de desempenho.</span><span class="sxs-lookup"><span data-stu-id="07d9b-114">Scaling out isn't a magic fix for every performance issue.</span></span> <span data-ttu-id="07d9b-115">Por exemplo, se seu banco de dados de back-end for o gargalo, não adiantará adicionar mais servidores Web.</span><span class="sxs-lookup"><span data-stu-id="07d9b-115">For example, if your backend database is the bottleneck, it won't help to add more web servers.</span></span> <span data-ttu-id="07d9b-116">Primeiro identifique e resolva os gargalos do sistema antes de lançar mais instâncias no problema.</span><span class="sxs-lookup"><span data-stu-id="07d9b-116">Identify and resolve the bottlenecks in the system first, before throwing more instances at the problem.</span></span> <span data-ttu-id="07d9b-117">Partes com estado do sistema são a causa mais provável de gargalos.</span><span class="sxs-lookup"><span data-stu-id="07d9b-117">Stateful parts of the system are the most likely cause of bottlenecks.</span></span>

<span data-ttu-id="07d9b-118">**Decompor cargas de trabalho por requisitos de escalabilidade.**</span><span class="sxs-lookup"><span data-stu-id="07d9b-118">**Decompose workloads by scalability requirements.**</span></span>  <span data-ttu-id="07d9b-119">Os aplicativos geralmente consistem em várias cargas de trabalho, com diferentes requisitos de dimensionamento.</span><span class="sxs-lookup"><span data-stu-id="07d9b-119">Applications often consist of multiple workloads, with different requirements for scaling.</span></span> <span data-ttu-id="07d9b-120">Por exemplo, um aplicativo pode ter um site voltado ao público e um site de administração separados.</span><span class="sxs-lookup"><span data-stu-id="07d9b-120">For example, an application might have a public-facing site and a separate administration site.</span></span> <span data-ttu-id="07d9b-121">O site público pode apresentar surtos repentinos no tráfego, enquanto o site de administração tem uma carga menor e mais previsível.</span><span class="sxs-lookup"><span data-stu-id="07d9b-121">The public site may experience sudden surges in traffic, while the administration site has a smaller, more predictable load.</span></span>

<span data-ttu-id="07d9b-122">**Descarregar tarefas com uso intenso de recursos.**</span><span class="sxs-lookup"><span data-stu-id="07d9b-122">**Offload resource-intensive tasks.**</span></span> <span data-ttu-id="07d9b-123">As tarefas que exigem muitos recursos de CPU ou E/S devem ser movidas para [trabalhos em segundo plano][background-jobs] quando possível para minimizar a carga no front-end que está manipulando as solicitações do usuário.</span><span class="sxs-lookup"><span data-stu-id="07d9b-123">Tasks that require a lot of CPU or I/O resources should be moved to [background jobs][background-jobs] when possible, to minimize the load on the front end that is handling user requests.</span></span>

<span data-ttu-id="07d9b-124">**Usar recursos de dimensionamento automático internos**.</span><span class="sxs-lookup"><span data-stu-id="07d9b-124">**Use built-in autoscaling features**.</span></span> <span data-ttu-id="07d9b-125">Muitos serviços de computação do Azure têm suporte interno para dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="07d9b-125">Many Azure compute services have built-in support for autoscaling.</span></span> <span data-ttu-id="07d9b-126">Se o aplicativo tem uma carga de trabalho previsível e regular, aumente conforme um agendamento.</span><span class="sxs-lookup"><span data-stu-id="07d9b-126">If the application has a predictable, regular workload, scale out on a schedule.</span></span> <span data-ttu-id="07d9b-127">Por exemplo, aumente durante o horário comercial.</span><span class="sxs-lookup"><span data-stu-id="07d9b-127">For example, scale out during business hours.</span></span> <span data-ttu-id="07d9b-128">Caso contrário, se a carga de trabalho não for previsível, use métricas de desempenho, como comprimento da fila de solicitação ou CPU para disparar o dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="07d9b-128">Otherwise, if the workload is not predictable, use performance metrics such as CPU or request queue length to trigger autoscaling.</span></span> <span data-ttu-id="07d9b-129">Para melhores práticas sobre dimensionamento automático, consulte [Dimensionamento automático][autoscaling].</span><span class="sxs-lookup"><span data-stu-id="07d9b-129">For autoscaling best practices, see [Autoscaling][autoscaling].</span></span>

<span data-ttu-id="07d9b-130">**Considere dimensionamento automático agressivo para cargas de trabalho críticas**.</span><span class="sxs-lookup"><span data-stu-id="07d9b-130">**Consider aggressive autoscaling for critical workloads**.</span></span> <span data-ttu-id="07d9b-131">Para cargas de trabalho críticas, você deseja se manter à frente de demanda.</span><span class="sxs-lookup"><span data-stu-id="07d9b-131">For critical workloads, you want to keep ahead of demand.</span></span> <span data-ttu-id="07d9b-132">É melhor adicionar novas instâncias rapidamente sob carga pesada para tratar do tráfego adicional e, em seguida, aumentar gradualmente outra vez.</span><span class="sxs-lookup"><span data-stu-id="07d9b-132">It's better to add new instances quickly under heavy load to handle the additional traffic, and then gradually scale back.</span></span>

<span data-ttu-id="07d9b-133">**Design para reduzir horizontalmente**.</span><span class="sxs-lookup"><span data-stu-id="07d9b-133">**Design for scale in**.</span></span>  <span data-ttu-id="07d9b-134">Lembre-se de que, com a escala elástica, o aplicativo terá períodos de redução horizontal, quando as instâncias são removidas.</span><span class="sxs-lookup"><span data-stu-id="07d9b-134">Remember that with elastic scale, the application will have periods of scale in, when instances get removed.</span></span> <span data-ttu-id="07d9b-135">O aplicativo deve tratar normalmente instâncias que estão sendo removidas.</span><span class="sxs-lookup"><span data-stu-id="07d9b-135">The application must gracefully handle instances being removed.</span></span> <span data-ttu-id="07d9b-136">Aqui estão algumas maneiras de tratar a redução horizontal:</span><span class="sxs-lookup"><span data-stu-id="07d9b-136">Here are some ways to handle scalein:</span></span>

- <span data-ttu-id="07d9b-137">Escutar eventos de desligamento (quando disponíveis) e desligar corretamente.</span><span class="sxs-lookup"><span data-stu-id="07d9b-137">Listen for shutdown events (when available) and shut down cleanly.</span></span>
- <span data-ttu-id="07d9b-138">Clientes/consumidores de um serviço devem dar suporte a tratamento de falhas transitórias e novas tentativas.</span><span class="sxs-lookup"><span data-stu-id="07d9b-138">Clients/consumers of a service should support transient fault handling and retry.</span></span>
- <span data-ttu-id="07d9b-139">Para tarefas de longa execução, considere dividir o trabalho, usando pontos de verificação ou o padrão [Pipes e Filtros][pipes-filters-pattern].</span><span class="sxs-lookup"><span data-stu-id="07d9b-139">For long-running tasks, consider breaking up the work, using checkpoints or the [Pipes and Filters][pipes-filters-pattern] pattern.</span></span>
- <span data-ttu-id="07d9b-140">Coloque os itens de trabalho em uma fila para que outra instância possa assumir o trabalho se uma instância for removida no meio do processamento.</span><span class="sxs-lookup"><span data-stu-id="07d9b-140">Put work items on a queue so that another instance can pick up the work, if an instance is removed in the middle of processing.</span></span>

<!-- links -->

[autoscaling]: ../../best-practices/auto-scaling.md
[background-jobs]: ../../best-practices/background-jobs.md
[pipes-filters-pattern]: ../../patterns/pipes-and-filters.md
