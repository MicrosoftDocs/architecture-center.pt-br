---
title: Tornar todas as coisas redundantes
titleSuffix: Azure Application Architecture Guide
description: Evite pontos únicos de falha com a criação de redundância em seu aplicativo.
author: MikeWasson
ms.date: 08/30/2018
ms.topic: guide
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: seojan19
ms.openlocfilehash: c8722250b5b5357c9ffcf65eced95b4f2b487c72
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/23/2019
ms.locfileid: "54481348"
---
# <a name="make-all-things-redundant"></a><span data-ttu-id="23a05-103">Tornar todas as coisas redundantes</span><span class="sxs-lookup"><span data-stu-id="23a05-103">Make all things redundant</span></span>

## <a name="build-redundancy-into-your-application-to-avoid-having-single-points-of-failure"></a><span data-ttu-id="23a05-104">Criar redundância no seu aplicativo, evite ter pontos únicos de falha</span><span class="sxs-lookup"><span data-stu-id="23a05-104">Build redundancy into your application, to avoid having single points of failure</span></span>

<span data-ttu-id="23a05-105">Um aplicativo resiliente contorna a falha.</span><span class="sxs-lookup"><span data-stu-id="23a05-105">A resilient application routes around failure.</span></span> <span data-ttu-id="23a05-106">Identifique os caminhos críticos em seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="23a05-106">Identify the critical paths in your application.</span></span> <span data-ttu-id="23a05-107">Há redundância em cada ponto no caminho?</span><span class="sxs-lookup"><span data-stu-id="23a05-107">Is there redundancy at each point in the path?</span></span> <span data-ttu-id="23a05-108">Se um subsistema falhar, o aplicativo falhará em outra coisa?</span><span class="sxs-lookup"><span data-stu-id="23a05-108">If a subsystem fails, will the application fail over to something else?</span></span>

## <a name="recommendations"></a><span data-ttu-id="23a05-109">Recomendações</span><span class="sxs-lookup"><span data-stu-id="23a05-109">Recommendations</span></span>

<span data-ttu-id="23a05-110">**Considere os requisitos de negócios**.</span><span class="sxs-lookup"><span data-stu-id="23a05-110">**Consider business requirements**.</span></span> <span data-ttu-id="23a05-111">A quantidade de redundância incorporada em um sistema pode afetar o custo e a complexidade.</span><span class="sxs-lookup"><span data-stu-id="23a05-111">The amount of redundancy built into a system can affect both cost and complexity.</span></span> <span data-ttu-id="23a05-112">Sua arquitetura deve ser informada por seus requisitos de negócios, como o objetivo de tempo de recuperação (RTO).</span><span class="sxs-lookup"><span data-stu-id="23a05-112">Your architecture should be informed by your business requirements, such as recovery time objective (RTO).</span></span> <span data-ttu-id="23a05-113">Por exemplo, uma implantação de várias regiões é mais cara do que uma implantação de região única e é mais complicada para gerenciar.</span><span class="sxs-lookup"><span data-stu-id="23a05-113">For example, a multi-region deployment is more expensive than a single-region deployment, and is more complicated to manage.</span></span> <span data-ttu-id="23a05-114">Você precisará de procedimentos operacionais para lidar com o failover e o failback.</span><span class="sxs-lookup"><span data-stu-id="23a05-114">You will need operational procedures to handle failover and failback.</span></span> <span data-ttu-id="23a05-115">O custo adicional e a complexidade podem ser justificados para alguns cenários de negócios e para outros não.</span><span class="sxs-lookup"><span data-stu-id="23a05-115">The additional cost and complexity might be justified for some business scenarios and not others.</span></span>

<span data-ttu-id="23a05-116">**Posicione as VMs por trás de um balanceador de carga**.</span><span class="sxs-lookup"><span data-stu-id="23a05-116">**Place VMs behind a load balancer**.</span></span> <span data-ttu-id="23a05-117">Não use uma única VM para cargas de trabalho de missão crítica.</span><span class="sxs-lookup"><span data-stu-id="23a05-117">Don't use a single VM for mission-critical workloads.</span></span> <span data-ttu-id="23a05-118">Em vez disso, posicione várias VMs atrás de um balanceador de carga.</span><span class="sxs-lookup"><span data-stu-id="23a05-118">Instead, place multiple VMs behind a load balancer.</span></span> <span data-ttu-id="23a05-119">Se qualquer VM ficar indisponível, o balanceador de carga distribuirá o tráfego para as VMs íntegras restantes.</span><span class="sxs-lookup"><span data-stu-id="23a05-119">If any VM becomes unavailable, the load balancer distributes traffic to the remaining healthy VMs.</span></span> <span data-ttu-id="23a05-120">Para saber como implantar essa configuração, confira [Várias VMs para escalabilidade e disponibilidade][multi-vm-blueprint].</span><span class="sxs-lookup"><span data-stu-id="23a05-120">To learn how to deploy this configuration, see [Multiple VMs for scalability and availability][multi-vm-blueprint].</span></span>

![Diagrama de VMs com balanceamento de carga](./images/load-balancing.svg)

<span data-ttu-id="23a05-122">**Replique os bancos de dados**.</span><span class="sxs-lookup"><span data-stu-id="23a05-122">**Replicate databases**.</span></span> <span data-ttu-id="23a05-123">O Banco de Dados SQL do Azure e o Cosmos DB replicam automaticamente os dados dentro de uma região, e você pode habilitar a replicação geográfica entre regiões.</span><span class="sxs-lookup"><span data-stu-id="23a05-123">Azure SQL Database and Cosmos DB automatically replicate the data within a region, and you can enable geo-replication across regions.</span></span> <span data-ttu-id="23a05-124">Se você estiver usando uma solução de banco de dados de IaaS, escolha uma que dê suporte à replicação e failover, tal como os [Grupos de Alta Disponibilidade Always On do SQL Server][sql-always-on].</span><span class="sxs-lookup"><span data-stu-id="23a05-124">If you are using an IaaS database solution, choose one that supports replication and failover, such as [SQL Server Always On Availability Groups][sql-always-on].</span></span>

<span data-ttu-id="23a05-125">**Habilite a replicação geográfica**.</span><span class="sxs-lookup"><span data-stu-id="23a05-125">**Enable geo-replication**.</span></span> <span data-ttu-id="23a05-126">A replicação geográfica para o [Banco de Dados SQL do Azure][sql-geo-replication] e o [Cosmos DB][cosmosdb-geo-replication] cria réplicas secundárias de leitura de seus dados em uma ou mais regiões secundárias.</span><span class="sxs-lookup"><span data-stu-id="23a05-126">Geo-replication for [Azure SQL Database][sql-geo-replication] and [Cosmos DB][cosmosdb-geo-replication] creates secondary readable replicas of your data in one or more secondary regions.</span></span> <span data-ttu-id="23a05-127">No caso de uma interrupção, o banco de dados poderá fazer failover para a região secundária para gravações.</span><span class="sxs-lookup"><span data-stu-id="23a05-127">In the event of an outage, the database can fail over to the secondary region for writes.</span></span>

<span data-ttu-id="23a05-128">**Partição para disponibilidade**.</span><span class="sxs-lookup"><span data-stu-id="23a05-128">**Partition for availability**.</span></span> <span data-ttu-id="23a05-129">O particionamento do banco de dados geralmente é usado para melhorar a escalabilidade, mas também pode melhorar a disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="23a05-129">Database partitioning is often used to improve scalability, but it can also improve availability.</span></span> <span data-ttu-id="23a05-130">Se um fragmento falhar, os outros fragmentos ainda poderão ser acessados.</span><span class="sxs-lookup"><span data-stu-id="23a05-130">If one shard goes down, the other shards can still be reached.</span></span> <span data-ttu-id="23a05-131">Uma falha em um fragmento interromperá apenas um subconjunto do total de transações.</span><span class="sxs-lookup"><span data-stu-id="23a05-131">A failure in one shard will only disrupt a subset of the total transactions.</span></span>

<span data-ttu-id="23a05-132">**Implante mais de uma região**.</span><span class="sxs-lookup"><span data-stu-id="23a05-132">**Deploy to more than one region**.</span></span> <span data-ttu-id="23a05-133">Para obter a maior disponibilidade, implante o aplicativo em mais de uma região.</span><span class="sxs-lookup"><span data-stu-id="23a05-133">For the highest availability, deploy the application to more than one region.</span></span> <span data-ttu-id="23a05-134">Dessa forma, em casos raros, quando um problema afetar uma região inteira, o aplicativo poderá fazer failover para outra região.</span><span class="sxs-lookup"><span data-stu-id="23a05-134">That way, in the rare case when a problem affects an entire region, the application can fail over to another region.</span></span> <span data-ttu-id="23a05-135">O diagrama a seguir mostra um aplicativo de várias regiões que usa o Gerenciador de Tráfego do Azure para controlar o failover.</span><span class="sxs-lookup"><span data-stu-id="23a05-135">The following diagram shows a multi-region application that uses Azure Traffic Manager to handle failover.</span></span>

![Diagrama do uso do Gerenciador de Tráfego do Azure para controlar o failover](./images/failover.svg)

<span data-ttu-id="23a05-137">**Sincronize o failover de front e back-end**.</span><span class="sxs-lookup"><span data-stu-id="23a05-137">**Synchronize front and backend failover**.</span></span> <span data-ttu-id="23a05-138">Use o Gerenciador de Tráfego do Azure para fazer failover do front-end.</span><span class="sxs-lookup"><span data-stu-id="23a05-138">Use Azure Traffic Manager to fail over the front end.</span></span> <span data-ttu-id="23a05-139">Se o front-end não puder ser acessado em uma região, o Gerenciador de Tráfego direcionará novas solicitações para a região secundária.</span><span class="sxs-lookup"><span data-stu-id="23a05-139">If the front end becomes unreachable in one region, Traffic Manager will route new requests to the secondary region.</span></span> <span data-ttu-id="23a05-140">Dependendo de sua solução de banco de dados, talvez seja necessário coordenar o failover de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="23a05-140">Depending on your database solution, you may need to coordinate failing over the database.</span></span>

<span data-ttu-id="23a05-141">**Use o failover automático, mas o failback manual**.</span><span class="sxs-lookup"><span data-stu-id="23a05-141">**Use automatic failover but manual failback**.</span></span> <span data-ttu-id="23a05-142">Use o Gerenciador de Tráfego para o failover automático, mas não para failback automático.</span><span class="sxs-lookup"><span data-stu-id="23a05-142">Use Traffic Manager for automatic failover, but not for automatic failback.</span></span> <span data-ttu-id="23a05-143">O failback automático traz um risco de você alternar para a região primária antes de a região estar completamente íntegra.</span><span class="sxs-lookup"><span data-stu-id="23a05-143">Automatic failback carries a risk that you might switch to the primary region before the region is completely healthy.</span></span> <span data-ttu-id="23a05-144">Em vez disso, verifique se todos os subsistemas de aplicativo estão íntegros antes de realizar o failback.</span><span class="sxs-lookup"><span data-stu-id="23a05-144">Instead, verify that all application subsystems are healthy before manually failing back.</span></span> <span data-ttu-id="23a05-145">Além disso, dependendo do banco de dados, você precisará verificar a consistência de dados antes do failback.</span><span class="sxs-lookup"><span data-stu-id="23a05-145">Also, depending on the database, you might need to check data consistency before failing back.</span></span>

<span data-ttu-id="23a05-146">**Inclua redundância para o Gerenciador de Tráfego**.</span><span class="sxs-lookup"><span data-stu-id="23a05-146">**Include redundancy for Traffic Manager**.</span></span> <span data-ttu-id="23a05-147">O Gerenciador de Tráfego é um possível ponto de falha.</span><span class="sxs-lookup"><span data-stu-id="23a05-147">Traffic Manager is a possible failure point.</span></span> <span data-ttu-id="23a05-148">Examine o SLA do Gerenciador de Tráfego e determine se usar apenas o Gerenciador de Tráfego atende aos seus requisitos de negócios para alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="23a05-148">Review the Traffic Manager SLA, and determine whether using Traffic Manager alone meets your business requirements for high availability.</span></span> <span data-ttu-id="23a05-149">Caso contrário, considere adicionar outra solução de gerenciamento de tráfego como um failback.</span><span class="sxs-lookup"><span data-stu-id="23a05-149">If not, consider adding another traffic management solution as a failback.</span></span> <span data-ttu-id="23a05-150">Se o serviço do Gerenciador de Tráfego do Azure falhar, altere os registros CNAME no DNS para apontar para outro serviço de gerenciamento de tráfego.</span><span class="sxs-lookup"><span data-stu-id="23a05-150">If the Azure Traffic Manager service fails, change your CNAME records in DNS to point to the other traffic management service.</span></span>

<!-- links -->

[multi-vm-blueprint]: ../../reference-architectures/virtual-machines-windows/multi-vm.md

[cassandra]: https://cassandra.apache.org/
[cosmosdb-geo-replication]: /azure/cosmos-db/distribute-data-globally
[sql-always-on]: https://msdn.microsoft.com/library/hh510230.aspx
[sql-geo-replication]: /azure/sql-database/sql-database-geo-replication-overview
