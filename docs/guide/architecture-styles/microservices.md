---
title: "Estilo de arquitetura de microsserviços"
description: "Descreve benefícios, desafios e melhores práticas para arquiteturas de N camadas no Azure"
author: MikeWasson
ms.openlocfilehash: 6426b3342a319832baf5eec35e9c783ba9348bdd
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/14/2017
---
# <a name="microservices-architecture-style"></a><span data-ttu-id="ea64a-103">Estilo de arquitetura de microsserviços</span><span class="sxs-lookup"><span data-stu-id="ea64a-103">Microservices architecture style</span></span>

<span data-ttu-id="ea64a-104">Uma arquitetura de microsserviços consiste em uma coleção de pequenos serviços autônomos.</span><span class="sxs-lookup"><span data-stu-id="ea64a-104">A microservices architecture consists of a collection of small, autonomous services.</span></span> <span data-ttu-id="ea64a-105">Cada serviço é independente e deve implementar uma única funcionalidade comercial.</span><span class="sxs-lookup"><span data-stu-id="ea64a-105">Each service is self-contained and should implement a single business capability.</span></span> 

![](./images/microservices-logical.svg)
 
<span data-ttu-id="ea64a-106">Em alguns aspectos, microsserviços são a evolução natural das arquiteturas orientada a serviços (SOA), mas há diferenças entre microsserviços e SOA.</span><span class="sxs-lookup"><span data-stu-id="ea64a-106">In some ways, microservices are the natural evolution of service oriented architectures (SOA), but there are differences between microservices and SOA.</span></span> <span data-ttu-id="ea64a-107">Aqui estão algumas características que definem um microsserviço:</span><span class="sxs-lookup"><span data-stu-id="ea64a-107">Here are some defining characteristics of a microservice:</span></span>

- <span data-ttu-id="ea64a-108">Em uma arquitetura de microsserviços, os serviços são pequenos, independentes e fracamente acoplados.</span><span class="sxs-lookup"><span data-stu-id="ea64a-108">In a microservices architecture, services are small, independent, and loosely coupled.</span></span>

- <span data-ttu-id="ea64a-109">Cada serviço é uma base de código separado, que pode ser gerenciado por uma equipe de desenvolvimento pequena.</span><span class="sxs-lookup"><span data-stu-id="ea64a-109">Each service is a separate codebase, which can be managed by a small development team.</span></span>

- <span data-ttu-id="ea64a-110">Os serviços podem ser implantados de maneira independente.</span><span class="sxs-lookup"><span data-stu-id="ea64a-110">Services can be deployed independently.</span></span> <span data-ttu-id="ea64a-111">Uma equipe pode atualizar um serviço existente sem recompilar e reimplantar o aplicativo inteiro.</span><span class="sxs-lookup"><span data-stu-id="ea64a-111">A team can update an existing service without rebuilding and redeploying the entire application.</span></span>

- <span data-ttu-id="ea64a-112">Os serviços são responsáveis por manter seus próprios dados ou o estado externo.</span><span class="sxs-lookup"><span data-stu-id="ea64a-112">Services are responsible for persisting their own data or external state.</span></span> <span data-ttu-id="ea64a-113">Isso é diferente do modelo tradicional, em que uma camada de dados separada lida com a persistência de dados.</span><span class="sxs-lookup"><span data-stu-id="ea64a-113">This differs from the traditional model, where a separate data layer handles data persistence.</span></span>

- <span data-ttu-id="ea64a-114">Os serviços comunicam-se entre si por meio de APIs bem definidas.</span><span class="sxs-lookup"><span data-stu-id="ea64a-114">Services communicate with each other by using well-defined APIs.</span></span> <span data-ttu-id="ea64a-115">Detalhes da implementação interna de cada serviço ficam ocultos de outros serviços.</span><span class="sxs-lookup"><span data-stu-id="ea64a-115">Internal implementation details of each service are hidden from other services.</span></span>

- <span data-ttu-id="ea64a-116">Os serviços não precisam compartilhar a mesma pilha de tecnologia, bibliotecas ou estruturas.</span><span class="sxs-lookup"><span data-stu-id="ea64a-116">Services don't need to share the same technology stack, libraries, or frameworks.</span></span>

<span data-ttu-id="ea64a-117">Além para os próprios serviços, alguns outros componentes aparecem em uma arquitetura de microsserviços típica:</span><span class="sxs-lookup"><span data-stu-id="ea64a-117">Besides for the services themselves, some other components appear in a typical microservices architecture:</span></span>

<span data-ttu-id="ea64a-118">**Gerenciamento**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-118">**Management**.</span></span> <span data-ttu-id="ea64a-119">O componente de gerenciamento é responsável por colocar serviços em nós, identificar falhas, rebalancear serviços entre nós e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="ea64a-119">The management component is responsible for placing services on nodes, identifying failures, rebalancing services across nodes, and so forth.</span></span>  

<span data-ttu-id="ea64a-120">**Descoberta de Serviço**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-120">**Service Discovery**.</span></span>  <span data-ttu-id="ea64a-121">Mantém uma lista de serviços e em quais nós eles estão localizados.</span><span class="sxs-lookup"><span data-stu-id="ea64a-121">Maintains a list of services and which nodes they are located on.</span></span> <span data-ttu-id="ea64a-122">Habilita a pesquisa de serviço para localizar o ponto de extremidade para um serviço.</span><span class="sxs-lookup"><span data-stu-id="ea64a-122">Enables service lookup to find the endpoint for a service.</span></span> 

<span data-ttu-id="ea64a-123">**Gateway de API**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-123">**API Gateway**.</span></span> <span data-ttu-id="ea64a-124">O gateway de API é o ponto de entrada para os clientes.</span><span class="sxs-lookup"><span data-stu-id="ea64a-124">The API gateway is the entry point for clients.</span></span> <span data-ttu-id="ea64a-125">Os clientes não chamam serviços diretamente.</span><span class="sxs-lookup"><span data-stu-id="ea64a-125">Clients don't call services directly.</span></span> <span data-ttu-id="ea64a-126">Em vez disso, eles chamam o gateway de API, que encaminha a chamada para os serviços apropriados no back-end.</span><span class="sxs-lookup"><span data-stu-id="ea64a-126">Instead, they call the API gateway, which forwards the call to the appropriate services on the back end.</span></span> <span data-ttu-id="ea64a-127">O gateway de API pode agregar as respostas de vários serviços e retornar a resposta agregada.</span><span class="sxs-lookup"><span data-stu-id="ea64a-127">The API gateway might aggregate the responses from several services and return the aggregated response.</span></span> 

<span data-ttu-id="ea64a-128">As vantagens de usar um gateway de API incluem:</span><span class="sxs-lookup"><span data-stu-id="ea64a-128">The advantages of using an API gateway include:</span></span>

- <span data-ttu-id="ea64a-129">Desacoplar os clientes dos serviços.</span><span class="sxs-lookup"><span data-stu-id="ea64a-129">It decouples clients from services.</span></span> <span data-ttu-id="ea64a-130">Os serviços podem ter controle de versão ou ser refatorado sem necessidade de atualizar todos os clientes.</span><span class="sxs-lookup"><span data-stu-id="ea64a-130">Services can be versioned or refactored without needing to update all of the clients.</span></span>

-  <span data-ttu-id="ea64a-131">Os serviços podem usar protocolos de mensagens que não sejam amigáveis à Web, como AMQP.</span><span class="sxs-lookup"><span data-stu-id="ea64a-131">Services can use messaging protocols that are not web friendly, such as AMQP.</span></span>

- <span data-ttu-id="ea64a-132">O Gateway de API pode executar outras funções abrangentes, como autenticação, registro em log, terminação SSL e balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="ea64a-132">The API Gateway can perform other cross-cutting functions such as authentication, logging, SSL termination, and load balancing.</span></span>

## <a name="when-to-use-this-architecture"></a><span data-ttu-id="ea64a-133">Quando usar esta arquitetura</span><span class="sxs-lookup"><span data-stu-id="ea64a-133">When to use this architecture</span></span>

<span data-ttu-id="ea64a-134">Considere esse estilo de arquitetura para:</span><span class="sxs-lookup"><span data-stu-id="ea64a-134">Consider this architecture style for:</span></span>

- <span data-ttu-id="ea64a-135">Aplicativos grandes que precisem de uma alta velocidade de liberação.</span><span class="sxs-lookup"><span data-stu-id="ea64a-135">Large applications that require a high release velocity.</span></span>

- <span data-ttu-id="ea64a-136">Aplicativos complexos que precisem ser altamente dimensionável.</span><span class="sxs-lookup"><span data-stu-id="ea64a-136">Complex applications that need to be highly scalable.</span></span>

- <span data-ttu-id="ea64a-137">Aplicativos com domínios avançados ou muitos subdomínios.</span><span class="sxs-lookup"><span data-stu-id="ea64a-137">Applications with rich domains or many subdomains.</span></span>

- <span data-ttu-id="ea64a-138">Uma organização que consista em pequenas equipes de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="ea64a-138">An organization that consists of small development teams.</span></span>


## <a name="benefits"></a><span data-ttu-id="ea64a-139">Benefícios</span><span class="sxs-lookup"><span data-stu-id="ea64a-139">Benefits</span></span> 

- <span data-ttu-id="ea64a-140">**Implantações independentes**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-140">**Independent deployments**.</span></span> <span data-ttu-id="ea64a-141">Você pode atualizar um serviço sem reimplantar o aplicativo inteiro e, em seguida, reverter ou efetuar roll forward de uma atualização se algo der errado.</span><span class="sxs-lookup"><span data-stu-id="ea64a-141">You can update a service without redeploying the entire application, and roll back or roll forward an update if something goes wrong.</span></span> <span data-ttu-id="ea64a-142">Correções de bugs e liberações de recurso são mais fáceis de gerenciar e menos arriscadas.</span><span class="sxs-lookup"><span data-stu-id="ea64a-142">Bug fixes and feature releases are more manageable and less risky.</span></span>

- <span data-ttu-id="ea64a-143">**Desenvolvimento independente**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-143">**Independent development**.</span></span> <span data-ttu-id="ea64a-144">Uma única equipe de desenvolvimento pode criar, testar e implantar um serviço.</span><span class="sxs-lookup"><span data-stu-id="ea64a-144">A single development team can build, test, and deploy a service.</span></span> <span data-ttu-id="ea64a-145">O resultado é inovação contínua e um ritmo mais rápido de liberação.</span><span class="sxs-lookup"><span data-stu-id="ea64a-145">The result is continuous innovation and a faster release cadence.</span></span> 

- <span data-ttu-id="ea64a-146">**Equipes pequenas e focadas**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-146">**Small, focused teams**.</span></span> <span data-ttu-id="ea64a-147">As equipes podem se concentrar em um serviço.</span><span class="sxs-lookup"><span data-stu-id="ea64a-147">Teams can focus on one service.</span></span> <span data-ttu-id="ea64a-148">O escopo menor de cada serviço torna a base de código mais fácil de entender e é mais fácil para novos membros da equipe fazerem a expansão.</span><span class="sxs-lookup"><span data-stu-id="ea64a-148">The smaller scope of each service makes the code base easier to understand, and it's easier for new team members to ramp up.</span></span>

- <span data-ttu-id="ea64a-149">**Isolamento de falha**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-149">**Fault isolation**.</span></span> <span data-ttu-id="ea64a-150">Se um serviço falhar, ele não derrubará o aplicativo inteiro.</span><span class="sxs-lookup"><span data-stu-id="ea64a-150">If a service goes down, it won't take out the entire application.</span></span> <span data-ttu-id="ea64a-151">No entanto, isso não significa que você obtém resiliência gratuitamente.</span><span class="sxs-lookup"><span data-stu-id="ea64a-151">However, that doesn't mean you get resiliency for free.</span></span> <span data-ttu-id="ea64a-152">Você ainda precisa seguir as melhores práticas de resiliência e padrões de design.</span><span class="sxs-lookup"><span data-stu-id="ea64a-152">You still need to follow resiliency best practices and design patterns.</span></span> <span data-ttu-id="ea64a-153">Consulte [Desenvolvimento de aplicativos resilientes para o Azure][resiliency-overview].</span><span class="sxs-lookup"><span data-stu-id="ea64a-153">See [Designing resilient applications for Azure][resiliency-overview].</span></span>

- <span data-ttu-id="ea64a-154">**Pilhas de tecnologia mistas**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-154">**Mixed technology stacks**.</span></span> <span data-ttu-id="ea64a-155">As equipes podem escolher a tecnologia mais adequada para seu serviço.</span><span class="sxs-lookup"><span data-stu-id="ea64a-155">Teams can pick the technology that best fits their service.</span></span> 

- <span data-ttu-id="ea64a-156">**Dimensionamento granular**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-156">**Granular scaling**.</span></span> <span data-ttu-id="ea64a-157">Os serviços podem ser dimensionados de maneira independente.</span><span class="sxs-lookup"><span data-stu-id="ea64a-157">Services can be scaled independently.</span></span> <span data-ttu-id="ea64a-158">Ao mesmo tempo, a densidade mais alta de serviços por VM significa que os recursos de VM são totalmente usados.</span><span class="sxs-lookup"><span data-stu-id="ea64a-158">At the same time, the higher density of services per VM means that VM resources are fully utilized.</span></span> <span data-ttu-id="ea64a-159">Usando restrições de posicionamento, um serviço pode corresponder a um perfil de VM (alta utilização da CPU e de memória e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="ea64a-159">Using placement constraints, a services can be matched to a VM profile (high CPU, high memory, and so on).</span></span>

## <a name="challenges"></a><span data-ttu-id="ea64a-160">Desafios</span><span class="sxs-lookup"><span data-stu-id="ea64a-160">Challenges</span></span>

- <span data-ttu-id="ea64a-161">**Complexidade**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-161">**Complexity**.</span></span> <span data-ttu-id="ea64a-162">Um aplicativo de microsserviços tem mais partes móveis que o aplicativo monolítico equivalente.</span><span class="sxs-lookup"><span data-stu-id="ea64a-162">A microservices application has more moving parts than the equivalent monolithic application.</span></span> <span data-ttu-id="ea64a-163">Cada serviço é mais simples, mas o sistema como um todo é mais complexo.</span><span class="sxs-lookup"><span data-stu-id="ea64a-163">Each service is simpler, but the entire system as a whole is more complex.</span></span>

- <span data-ttu-id="ea64a-164">**Desenvolvimento e teste**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-164">**Development and test**.</span></span> <span data-ttu-id="ea64a-165">Desenvolver com relação a dependências de serviço exige uma abordagem diferente.</span><span class="sxs-lookup"><span data-stu-id="ea64a-165">Developing against service dependencies requires a different approach.</span></span> <span data-ttu-id="ea64a-166">As ferramentas existentes não são necessariamente projetadas para funcionar com dependências de serviço.</span><span class="sxs-lookup"><span data-stu-id="ea64a-166">Existing tools are not necessarily designed to work with service dependencies.</span></span> <span data-ttu-id="ea64a-167">Refatorar entre limites de serviços pode ser difícil.</span><span class="sxs-lookup"><span data-stu-id="ea64a-167">Refactoring across service boundaries can be difficult.</span></span> <span data-ttu-id="ea64a-168">Também pode ser um desafio testar as dependências de serviço, especialmente quando o aplicativo está evoluindo rapidamente.</span><span class="sxs-lookup"><span data-stu-id="ea64a-168">It is also challenging to test service dependencies, especially when the application is evolving quickly.</span></span>

- <span data-ttu-id="ea64a-169">**Falta de governança**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-169">**Lack of governance**.</span></span> <span data-ttu-id="ea64a-170">A abordagem descentralizada para compilar microsserviços tem vantagens, mas também pode causar problemas.</span><span class="sxs-lookup"><span data-stu-id="ea64a-170">The decentralized approach to building microservices has advantages, but it can also lead to problems.</span></span> <span data-ttu-id="ea64a-171">Você pode acabar com muitos idiomas e estruturas diferentes que tornem difícil a manutenção do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ea64a-171">You may end up with so many different languages and frameworks that the application becomes hard to maintain.</span></span> <span data-ttu-id="ea64a-172">Pode ser útil estabelecer alguns padrões para todo o projeto, sem restringir excessivamente a flexibilidade das equipes.</span><span class="sxs-lookup"><span data-stu-id="ea64a-172">It may be useful to put some project-wide standards in place, without overly restricting teams' flexibility.</span></span> <span data-ttu-id="ea64a-173">Isso se aplica especialmente a funcionalidades abrangentes como registro em log.</span><span class="sxs-lookup"><span data-stu-id="ea64a-173">This especially applies to cross-cutting functionality such as logging.</span></span>

- <span data-ttu-id="ea64a-174">**Latência e congestionamento de rede**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-174">**Network congestion and latency**.</span></span> <span data-ttu-id="ea64a-175">O uso de muitos serviços granulares pequenos pode resultar em mais comunicação entre serviços.</span><span class="sxs-lookup"><span data-stu-id="ea64a-175">The use of many small, granular services can result in more interservice communication.</span></span> <span data-ttu-id="ea64a-176">Além disso, se a cadeia de dependências de serviço ficar muito longa (o serviço A chamada o B, que chama o C…) a latência adicional poderá se tornar um problema.</span><span class="sxs-lookup"><span data-stu-id="ea64a-176">Also, if the chain of service dependencies gets too long (service A calls B, which calls C...), the additional latency can become a problem.</span></span> <span data-ttu-id="ea64a-177">Você precisará projetar APIs com cuidado.</span><span class="sxs-lookup"><span data-stu-id="ea64a-177">You will need to design APIs carefully.</span></span> <span data-ttu-id="ea64a-178">Evite APIs excessivamente prolixas, pense em formatos de serialização e procure locais para usar padrões de comunicação assíncrona.</span><span class="sxs-lookup"><span data-stu-id="ea64a-178">Avoid overly chatty APIs, think about serialization formats, and look for places to use asynchronous communication patterns.</span></span>

- <span data-ttu-id="ea64a-179">**Integridade de dados**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-179">**Data integrity**.</span></span> <span data-ttu-id="ea64a-180">Cada microsserviço deve ser responsável pela própria persistência de dados.</span><span class="sxs-lookup"><span data-stu-id="ea64a-180">With each microservice responsible for its own data persistence.</span></span> <span data-ttu-id="ea64a-181">Assim, a consistência dos dados pode ser um desafio.</span><span class="sxs-lookup"><span data-stu-id="ea64a-181">As a result, data consistency can be a challenge.</span></span> <span data-ttu-id="ea64a-182">Adote consistência eventual quando possível.</span><span class="sxs-lookup"><span data-stu-id="ea64a-182">Embrace eventual consistency where possible.</span></span>

- <span data-ttu-id="ea64a-183">**Gerenciamento**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-183">**Management**.</span></span> <span data-ttu-id="ea64a-184">Ter êxito com microsserviços requer uma cultura DevOps madura.</span><span class="sxs-lookup"><span data-stu-id="ea64a-184">To be successful with microservices requires a mature DevOps culture.</span></span> <span data-ttu-id="ea64a-185">Registro em log correlacionado entre serviços pode ser desafiador.</span><span class="sxs-lookup"><span data-stu-id="ea64a-185">Correlated logging across services can be challenging.</span></span> <span data-ttu-id="ea64a-186">Normalmente, o registro em log deve correlacionar várias chamadas de serviço para uma operação de um único usuário.</span><span class="sxs-lookup"><span data-stu-id="ea64a-186">Typically, logging must correlate multiple service calls for a single user operation.</span></span>

- <span data-ttu-id="ea64a-187">**Controle de versão**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-187">**Versioning**.</span></span> <span data-ttu-id="ea64a-188">As atualizações de um serviço não devem interromper os serviços que dependerem delas.</span><span class="sxs-lookup"><span data-stu-id="ea64a-188">Updates to a service must not break services that depend on it.</span></span> <span data-ttu-id="ea64a-189">Vários serviços podem ser atualizados a qualquer momento, portanto, sem design cuidadoso, você pode ter problemas com compatibilidade com versões anteriores ou futuras.</span><span class="sxs-lookup"><span data-stu-id="ea64a-189">Multiple services could be updated at any given time, so without careful design, you might have problems with backward or forward compatibility.</span></span>

- <span data-ttu-id="ea64a-190">**Conjunto de qualificações**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-190">**Skillset**.</span></span> <span data-ttu-id="ea64a-191">Os microsserviços são sistemas altamente distribuídos.</span><span class="sxs-lookup"><span data-stu-id="ea64a-191">Microservices are highly distributed systems.</span></span> <span data-ttu-id="ea64a-192">Avalie cuidadosamente se a equipe tem as habilidades e a experiência para ser bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="ea64a-192">Carefully evaluate whether the team has the skills and experience to be successful.</span></span>

## <a name="best-practices"></a><span data-ttu-id="ea64a-193">Práticas recomendadas</span><span class="sxs-lookup"><span data-stu-id="ea64a-193">Best practices</span></span>

- <span data-ttu-id="ea64a-194">Modele os serviços em torno de domínio da empresa.</span><span class="sxs-lookup"><span data-stu-id="ea64a-194">Model services around the business domain.</span></span> 

- <span data-ttu-id="ea64a-195">Descentralize tudo.</span><span class="sxs-lookup"><span data-stu-id="ea64a-195">Decentralize everything.</span></span> <span data-ttu-id="ea64a-196">Equipes individuais são responsáveis por projetar e criar serviços.</span><span class="sxs-lookup"><span data-stu-id="ea64a-196">Individual teams are responsible for designing and building services.</span></span> <span data-ttu-id="ea64a-197">Evite compartilhar esquemas de dados ou códigos.</span><span class="sxs-lookup"><span data-stu-id="ea64a-197">Avoid sharing code or data schemas.</span></span> 

- <span data-ttu-id="ea64a-198">O armazenamento de dados deve ser privado para o serviço que é o proprietário dos dados.</span><span class="sxs-lookup"><span data-stu-id="ea64a-198">Data storage should be private to the service that owns the data.</span></span> <span data-ttu-id="ea64a-199">Use o melhor armazenamento para cada serviço e tipo de dados.</span><span class="sxs-lookup"><span data-stu-id="ea64a-199">Use the best storage for each service and data type.</span></span> 

- <span data-ttu-id="ea64a-200">Os serviços comunicam-se por meio de APIs bem projetadas.</span><span class="sxs-lookup"><span data-stu-id="ea64a-200">Services communicate through well-designed APIs.</span></span> <span data-ttu-id="ea64a-201">Evite o vazamento de detalhes da implementação.</span><span class="sxs-lookup"><span data-stu-id="ea64a-201">Avoid leaking implementation details.</span></span> <span data-ttu-id="ea64a-202">As APIs devem modelar o domínio, não a implementação interna do serviço.</span><span class="sxs-lookup"><span data-stu-id="ea64a-202">APIs should model the domain, not the internal implementation of the service.</span></span>

- <span data-ttu-id="ea64a-203">Evite acoplamento entre serviços.</span><span class="sxs-lookup"><span data-stu-id="ea64a-203">Avoid coupling between services.</span></span> <span data-ttu-id="ea64a-204">Causas de acoplamento incluem protocolos de comunicação rígidos e esquemas de banco de dados compartilhados.</span><span class="sxs-lookup"><span data-stu-id="ea64a-204">Causes of coupling include shared database schemas and rigid communication protocols.</span></span>

- <span data-ttu-id="ea64a-205">Descarregue preocupações abrangentes, como autenticação e terminação SSL, para o gateway.</span><span class="sxs-lookup"><span data-stu-id="ea64a-205">Offload cross-cutting concerns, such as authentication and SSL termination, to the gateway.</span></span>

- <span data-ttu-id="ea64a-206">Mantenha o conhecimento de domínio fora do gateway.</span><span class="sxs-lookup"><span data-stu-id="ea64a-206">Keep domain knowledge out of the gateway.</span></span> <span data-ttu-id="ea64a-207">O gateway deve tratar e rotear solicitações de cliente sem qualquer conhecimento das regras de negócios ou da lógica do domínio.</span><span class="sxs-lookup"><span data-stu-id="ea64a-207">The gateway should handle and route client requests without any knowledge of the business rules or domain logic.</span></span> <span data-ttu-id="ea64a-208">Caso contrário, o gateway se tornará uma dependência e poderá causar um acoplamento entre serviços.</span><span class="sxs-lookup"><span data-stu-id="ea64a-208">Otherwise, the gateway becomes a dependency and can cause coupling between services.</span></span>

- <span data-ttu-id="ea64a-209">Os serviços devem ter um acoplamento flexível e alta coesão funcional.</span><span class="sxs-lookup"><span data-stu-id="ea64a-209">Services should have loose coupling and high functional cohesion.</span></span> <span data-ttu-id="ea64a-210">Funções que provavelmente mudarão juntas devem ser empacotadas e implantadas juntas.</span><span class="sxs-lookup"><span data-stu-id="ea64a-210">Functions that are likely to change together should be packaged and deployed together.</span></span> <span data-ttu-id="ea64a-211">Se residirem em serviços separados, esses serviços acabarão sendo fortemente acoplados, porque uma alteração em um serviço exigirá atualizar outro.</span><span class="sxs-lookup"><span data-stu-id="ea64a-211">If they reside in separate services, those services end up being tightly coupled, because a change in one service will require updating the other service.</span></span> <span data-ttu-id="ea64a-212">Uma comunicação excessivamente prolixa entre dois serviços pode ser um sintoma de acoplamento forte e coesão baixa.</span><span class="sxs-lookup"><span data-stu-id="ea64a-212">Overly chatty communication between two services may be a symptom of tight coupling and low cohesion.</span></span> 

- <span data-ttu-id="ea64a-213">Isole falhas.</span><span class="sxs-lookup"><span data-stu-id="ea64a-213">Isolate failures.</span></span> <span data-ttu-id="ea64a-214">Use estratégias de resiliência para impedir que falhas em um serviço distribuam-se em cascata.</span><span class="sxs-lookup"><span data-stu-id="ea64a-214">Use resiliency strategies to prevent failures within a service from cascading.</span></span> <span data-ttu-id="ea64a-215">Consulte [Padrões de resiliência][resiliency-patterns] e [Design de aplicativos resilientes][resiliency-overview].</span><span class="sxs-lookup"><span data-stu-id="ea64a-215">See [Resiliency patterns][resiliency-patterns] and [Designing resilient applications][resiliency-overview].</span></span>

## <a name="microservices-using-azure-container-service"></a><span data-ttu-id="ea64a-216">Microsserviços usando o Serviço de Contêiner do Azure</span><span class="sxs-lookup"><span data-stu-id="ea64a-216">Microservices using Azure Container Service</span></span> 

<span data-ttu-id="ea64a-217">Você pode usar o Serviço de Contêiner do Azure para configurar e provisionar um cluster do Docker.</span><span class="sxs-lookup"><span data-stu-id="ea64a-217">You can use Azure Container Service to configure and provision a Docker cluster.</span></span> <span data-ttu-id="ea64a-218">Os Serviços de Contêiner do Azure dão suporte a vários orquestradores de contêiner populares, incluindo Kubernetes, DC/SO e Docker Swarm.</span><span class="sxs-lookup"><span data-stu-id="ea64a-218">Azure Container Services supports several popular container orchestrators, including Kubernetes, DC/OS, and Docker Swarm.</span></span>

![](./images/microservices-acs.png)
 
<span data-ttu-id="ea64a-219">**Nós públicos**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-219">**Public nodes**.</span></span> <span data-ttu-id="ea64a-220">Esses nós estão acessíveis por meio de um balanceador de carga voltado para o público.</span><span class="sxs-lookup"><span data-stu-id="ea64a-220">These nodes are reachable through a public-facing load balancer.</span></span> <span data-ttu-id="ea64a-221">O gateway de API é hospedado nesses nós.</span><span class="sxs-lookup"><span data-stu-id="ea64a-221">The API gateway is hosted on these nodes.</span></span>

<span data-ttu-id="ea64a-222">**Nós de back-end**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-222">**Backend nodes**.</span></span> <span data-ttu-id="ea64a-223">Esses nós executam serviços que os clientes acessam por meio do gateway de API.</span><span class="sxs-lookup"><span data-stu-id="ea64a-223">These nodes run services that clients reach via the API gateway.</span></span> <span data-ttu-id="ea64a-224">Esses nós não recebem o tráfego de Internet diretamente.</span><span class="sxs-lookup"><span data-stu-id="ea64a-224">These nodes don't receive Internet traffic directly.</span></span> <span data-ttu-id="ea64a-225">Os nós de back-end podem incluir mais de um pool de VMs, cada um com um perfil de hardware diferente.</span><span class="sxs-lookup"><span data-stu-id="ea64a-225">The backend nodes might include more than one pool of VMs, each with a different hardware profile.</span></span> <span data-ttu-id="ea64a-226">Por exemplo, você pode criar grupos separados para cargas de trabalho de computação geral, cargas de trabalho com consumo elevado de CPU e cargas de trabalho com consumo elevado de memória.</span><span class="sxs-lookup"><span data-stu-id="ea64a-226">For example, you could create separate pools for general compute workloads, high CPU workloads, and high memory workloads.</span></span> 

<span data-ttu-id="ea64a-227">**VMs de gerenciamento**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-227">**Management VMs**.</span></span> <span data-ttu-id="ea64a-228">Essas VMs executam os nós mestres para o orquestrador de contêiner.</span><span class="sxs-lookup"><span data-stu-id="ea64a-228">These VMs run the master nodes for the container orchestrator.</span></span> 

<span data-ttu-id="ea64a-229">**Rede**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-229">**Networking**.</span></span> <span data-ttu-id="ea64a-230">Os nós públicos, os nós de back-end e as VMs de gerenciamento são colocados em sub-redes separadas na mesma VNet (rede virtual).</span><span class="sxs-lookup"><span data-stu-id="ea64a-230">The public nodes, backend nodes, and management VMs are placed in separate subnets within the same virtual network (VNet).</span></span> 

<span data-ttu-id="ea64a-231">**Balanceadores de carga**.</span><span class="sxs-lookup"><span data-stu-id="ea64a-231">**Load balancers**.</span></span>  <span data-ttu-id="ea64a-232">Um balanceador de carga voltado para fora se encontra na frente de nós do públicos.</span><span class="sxs-lookup"><span data-stu-id="ea64a-232">An externally facing load balancer sits in front of the public nodes.</span></span> <span data-ttu-id="ea64a-233">Ela distribui solicitações da Internet para os nós públicos.</span><span class="sxs-lookup"><span data-stu-id="ea64a-233">It distributes internet requests to the public nodes.</span></span> <span data-ttu-id="ea64a-234">Outro balanceador de carga é colocado na frente das VMs de gerenciamento para garantir tráfego SSH (Secure Shell) para as VMs de gerenciamento usando as regras NAT.</span><span class="sxs-lookup"><span data-stu-id="ea64a-234">Another load balancer is placed in front of the management VMs, to allow secure shell (ssh) traffic to the management VMs, using NAT rules.</span></span>

<span data-ttu-id="ea64a-235">Para escalabilidade e confiabilidade, cada serviço é replicado entre várias VMs.</span><span class="sxs-lookup"><span data-stu-id="ea64a-235">For reliability and scalability, each service is replicated across multiple VMs.</span></span> <span data-ttu-id="ea64a-236">No entanto, como serviços também são relativamente leves (em comparação a um aplicativo monolítico), vários serviços normalmente são incluídos em uma única VM.</span><span class="sxs-lookup"><span data-stu-id="ea64a-236">However, because services are also relatively lightweight (compared with a monolithic application), multiple services are usually packed into a single VM.</span></span> <span data-ttu-id="ea64a-237">Maior densidade permite melhor utilização de recursos.</span><span class="sxs-lookup"><span data-stu-id="ea64a-237">Higher density allows better resource utilization.</span></span> <span data-ttu-id="ea64a-238">Se um serviço específico não usar muitos recursos, você não precisará dedicar toda uma VM para executar esse serviço.</span><span class="sxs-lookup"><span data-stu-id="ea64a-238">If a particular service doesn't use a lot of resources, you don't need to dedicate an entire VM to running that service.</span></span>

<span data-ttu-id="ea64a-239">O diagrama a seguir mostra três nós executando quatro serviços diferentes (indicados por diferentes formas).</span><span class="sxs-lookup"><span data-stu-id="ea64a-239">The following diagram shows three nodes running four different services (indicated by different shapes).</span></span> <span data-ttu-id="ea64a-240">Observe que cada serviço tem pelo menos duas instâncias.</span><span class="sxs-lookup"><span data-stu-id="ea64a-240">Notice that each service has at least two instances.</span></span> 
 
![](./images/microservices-node-density.png)

## <a name="microservices-using-azure-service-fabric"></a><span data-ttu-id="ea64a-241">Microsserviços usando o Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="ea64a-241">Microservices using Azure Service Fabric</span></span>

<span data-ttu-id="ea64a-242">O diagrama a seguir mostra uma arquitetura de microsserviços usando o Azure Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="ea64a-242">The following diagram shows a microservices architecture using Azure Service Fabric.</span></span>

![](./images/service-fabric.png)

<span data-ttu-id="ea64a-243">O Cluster do Service Fabric é implantado em um ou mais conjuntos de dimensionamento de VM.</span><span class="sxs-lookup"><span data-stu-id="ea64a-243">The Service Fabric Cluster is deployed to one or more VM scale sets.</span></span> <span data-ttu-id="ea64a-244">Você pode ter mais de um conjunto de dimensionamento de VM definido no cluster para ter uma combinação de tipos de VM.</span><span class="sxs-lookup"><span data-stu-id="ea64a-244">You might have more than one VM scale set in the cluster, in order to have a mix of VM types.</span></span> <span data-ttu-id="ea64a-245">Um Gateway de API é colocado na frente do cluster do Service Fabric, com um balanceador externo de carga para receber solicitações do cliente.</span><span class="sxs-lookup"><span data-stu-id="ea64a-245">An API Gateway is placed in front of the Service Fabric cluster, with an external load balancer to receive client requests.</span></span>

<span data-ttu-id="ea64a-246">O tempo de execução do Service Fabric realiza o gerenciamento de cluster, incluindo posicionamento do serviço, failover de nó e monitoramento de integridade.</span><span class="sxs-lookup"><span data-stu-id="ea64a-246">The Service Fabric runtime performs cluster management, including service placement, node failover, and health monitoring.</span></span> <span data-ttu-id="ea64a-247">O tempo de execução é implantado nos próprios nós de cluster.</span><span class="sxs-lookup"><span data-stu-id="ea64a-247">The runtime is deployed on the cluster nodes themselves.</span></span> <span data-ttu-id="ea64a-248">Não há um conjunto separado de VMs de gerenciamento de cluster.</span><span class="sxs-lookup"><span data-stu-id="ea64a-248">There isn't a separate set of cluster management VMs.</span></span>

<span data-ttu-id="ea64a-249">Os serviços comunicam-se entre si usando o proxy inverso interno do Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="ea64a-249">Services communicate with each other using the reverse proxy that is built into Service Fabric.</span></span> <span data-ttu-id="ea64a-250">O Service Fabric fornece um serviço de descoberta que pode resolver o ponto de extremidade para um serviço nomeado.</span><span class="sxs-lookup"><span data-stu-id="ea64a-250">Service Fabric provides a discovery service that can resolve the endpoint for a named service.</span></span>


<!-- links -->

[resiliency-overview]: ../../resiliency/index.md
[resiliency-patterns]: ../../patterns/category/resiliency.md



