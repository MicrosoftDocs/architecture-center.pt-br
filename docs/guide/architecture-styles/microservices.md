---
title: Estilo de arquitetura de microsserviços
description: Descreve benefícios, desafios e melhores práticas para arquiteturas de N camadas no Azure
author: MikeWasson
ms.openlocfilehash: 08fd39b6cf0b3c88af654b27e21b2d7dd9fb19b1
ms.sourcegitcommit: 7764a804f000180c37a4f8dbab946b525f784f58
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/09/2018
ms.locfileid: "27717633"
---
# <a name="microservices-architecture-style"></a><span data-ttu-id="e8fc0-103">Estilo de arquitetura de microsserviços</span><span class="sxs-lookup"><span data-stu-id="e8fc0-103">Microservices architecture style</span></span>

<span data-ttu-id="e8fc0-104">Uma arquitetura de microsserviços consiste em uma coleção de pequenos serviços autônomos.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-104">A microservices architecture consists of a collection of small, autonomous services.</span></span> <span data-ttu-id="e8fc0-105">Cada serviço é independente e deve implementar uma única funcionalidade comercial.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-105">Each service is self-contained and should implement a single business capability.</span></span> <span data-ttu-id="e8fc0-106">Para obter orientações detalhadas sobre como criar uma arquitetura de microsserviços no Azure, consulte [Projetar, criar e operar microsserviços no Azure](../../microservices/index.md).</span><span class="sxs-lookup"><span data-stu-id="e8fc0-106">For detailed guidance about building a microservices architecture on Azure, see [Designing, building, and operating microservices on Azure](../../microservices/index.md).</span></span>

![](./images/microservices-logical.svg)
 
<span data-ttu-id="e8fc0-107">Em alguns aspectos, microsserviços são a evolução natural das arquiteturas orientada a serviços (SOA), mas há diferenças entre microsserviços e SOA.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-107">In some ways, microservices are the natural evolution of service oriented architectures (SOA), but there are differences between microservices and SOA.</span></span> <span data-ttu-id="e8fc0-108">Aqui estão algumas características que definem um microsserviço:</span><span class="sxs-lookup"><span data-stu-id="e8fc0-108">Here are some defining characteristics of a microservice:</span></span>

- <span data-ttu-id="e8fc0-109">Em uma arquitetura de microsserviços, os serviços são pequenos, independentes e fracamente acoplados.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-109">In a microservices architecture, services are small, independent, and loosely coupled.</span></span>

- <span data-ttu-id="e8fc0-110">Cada serviço é uma base de código separado, que pode ser gerenciado por uma equipe de desenvolvimento pequena.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-110">Each service is a separate codebase, which can be managed by a small development team.</span></span>

- <span data-ttu-id="e8fc0-111">Os serviços podem ser implantados de maneira independente.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-111">Services can be deployed independently.</span></span> <span data-ttu-id="e8fc0-112">Uma equipe pode atualizar um serviço existente sem recompilar e reimplantar o aplicativo inteiro.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-112">A team can update an existing service without rebuilding and redeploying the entire application.</span></span>

- <span data-ttu-id="e8fc0-113">Os serviços são responsáveis por manter seus próprios dados ou o estado externo.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-113">Services are responsible for persisting their own data or external state.</span></span> <span data-ttu-id="e8fc0-114">Isso é diferente do modelo tradicional, em que uma camada de dados separada lida com a persistência de dados.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-114">This differs from the traditional model, where a separate data layer handles data persistence.</span></span>

- <span data-ttu-id="e8fc0-115">Os serviços comunicam-se entre si por meio de APIs bem definidas.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-115">Services communicate with each other by using well-defined APIs.</span></span> <span data-ttu-id="e8fc0-116">Detalhes da implementação interna de cada serviço ficam ocultos de outros serviços.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-116">Internal implementation details of each service are hidden from other services.</span></span>

- <span data-ttu-id="e8fc0-117">Os serviços não precisam compartilhar a mesma pilha de tecnologia, bibliotecas ou estruturas.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-117">Services don't need to share the same technology stack, libraries, or frameworks.</span></span>

<span data-ttu-id="e8fc0-118">Além para os próprios serviços, alguns outros componentes aparecem em uma arquitetura de microsserviços típica:</span><span class="sxs-lookup"><span data-stu-id="e8fc0-118">Besides for the services themselves, some other components appear in a typical microservices architecture:</span></span>

<span data-ttu-id="e8fc0-119">**Gerenciamento**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-119">**Management**.</span></span> <span data-ttu-id="e8fc0-120">O componente de gerenciamento é responsável por colocar serviços em nós, identificar falhas, rebalancear serviços entre nós e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-120">The management component is responsible for placing services on nodes, identifying failures, rebalancing services across nodes, and so forth.</span></span>  

<span data-ttu-id="e8fc0-121">**Descoberta de Serviço**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-121">**Service Discovery**.</span></span>  <span data-ttu-id="e8fc0-122">Mantém uma lista de serviços e em quais nós eles estão localizados.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-122">Maintains a list of services and which nodes they are located on.</span></span> <span data-ttu-id="e8fc0-123">Habilita a pesquisa de serviço para localizar o ponto de extremidade para um serviço.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-123">Enables service lookup to find the endpoint for a service.</span></span> 

<span data-ttu-id="e8fc0-124">**Gateway de API**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-124">**API Gateway**.</span></span> <span data-ttu-id="e8fc0-125">O gateway de API é o ponto de entrada para os clientes.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-125">The API gateway is the entry point for clients.</span></span> <span data-ttu-id="e8fc0-126">Os clientes não chamam serviços diretamente.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-126">Clients don't call services directly.</span></span> <span data-ttu-id="e8fc0-127">Em vez disso, eles chamam o gateway de API, que encaminha a chamada para os serviços apropriados no back-end.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-127">Instead, they call the API gateway, which forwards the call to the appropriate services on the back end.</span></span> <span data-ttu-id="e8fc0-128">O gateway de API pode agregar as respostas de vários serviços e retornar a resposta agregada.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-128">The API gateway might aggregate the responses from several services and return the aggregated response.</span></span> 

<span data-ttu-id="e8fc0-129">As vantagens de usar um gateway de API incluem:</span><span class="sxs-lookup"><span data-stu-id="e8fc0-129">The advantages of using an API gateway include:</span></span>

- <span data-ttu-id="e8fc0-130">Desacoplar os clientes dos serviços.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-130">It decouples clients from services.</span></span> <span data-ttu-id="e8fc0-131">Os serviços podem ter controle de versão ou ser refatorado sem necessidade de atualizar todos os clientes.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-131">Services can be versioned or refactored without needing to update all of the clients.</span></span>

-  <span data-ttu-id="e8fc0-132">Os serviços podem usar protocolos de mensagens que não sejam amigáveis à Web, como AMQP.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-132">Services can use messaging protocols that are not web friendly, such as AMQP.</span></span>

- <span data-ttu-id="e8fc0-133">O Gateway de API pode executar outras funções abrangentes, como autenticação, registro em log, terminação SSL e balanceamento de carga.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-133">The API Gateway can perform other cross-cutting functions such as authentication, logging, SSL termination, and load balancing.</span></span>

## <a name="when-to-use-this-architecture"></a><span data-ttu-id="e8fc0-134">Quando usar essa arquitetura</span><span class="sxs-lookup"><span data-stu-id="e8fc0-134">When to use this architecture</span></span>

<span data-ttu-id="e8fc0-135">Considere esse estilo de arquitetura para:</span><span class="sxs-lookup"><span data-stu-id="e8fc0-135">Consider this architecture style for:</span></span>

- <span data-ttu-id="e8fc0-136">Aplicativos grandes que precisem de uma alta velocidade de liberação.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-136">Large applications that require a high release velocity.</span></span>

- <span data-ttu-id="e8fc0-137">Aplicativos complexos que precisem ser altamente dimensionável.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-137">Complex applications that need to be highly scalable.</span></span>

- <span data-ttu-id="e8fc0-138">Aplicativos com domínios avançados ou muitos subdomínios.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-138">Applications with rich domains or many subdomains.</span></span>

- <span data-ttu-id="e8fc0-139">Uma organização que consista em pequenas equipes de desenvolvimento.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-139">An organization that consists of small development teams.</span></span>


## <a name="benefits"></a><span data-ttu-id="e8fc0-140">Benefícios</span><span class="sxs-lookup"><span data-stu-id="e8fc0-140">Benefits</span></span> 

- <span data-ttu-id="e8fc0-141">**Implantações independentes**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-141">**Independent deployments**.</span></span> <span data-ttu-id="e8fc0-142">Você pode atualizar um serviço sem reimplantar o aplicativo inteiro e, em seguida, reverter ou efetuar roll forward de uma atualização se algo der errado.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-142">You can update a service without redeploying the entire application, and roll back or roll forward an update if something goes wrong.</span></span> <span data-ttu-id="e8fc0-143">Correções de bugs e liberações de recurso são mais fáceis de gerenciar e menos arriscadas.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-143">Bug fixes and feature releases are more manageable and less risky.</span></span>

- <span data-ttu-id="e8fc0-144">**Desenvolvimento independente**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-144">**Independent development**.</span></span> <span data-ttu-id="e8fc0-145">Uma única equipe de desenvolvimento pode criar, testar e implantar um serviço.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-145">A single development team can build, test, and deploy a service.</span></span> <span data-ttu-id="e8fc0-146">O resultado é inovação contínua e um ritmo mais rápido de liberação.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-146">The result is continuous innovation and a faster release cadence.</span></span> 

- <span data-ttu-id="e8fc0-147">**Equipes pequenas e focadas**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-147">**Small, focused teams**.</span></span> <span data-ttu-id="e8fc0-148">As equipes podem se concentrar em um serviço.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-148">Teams can focus on one service.</span></span> <span data-ttu-id="e8fc0-149">O escopo menor de cada serviço torna a base de código mais fácil de entender e é mais fácil para novos membros da equipe fazerem a expansão.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-149">The smaller scope of each service makes the code base easier to understand, and it's easier for new team members to ramp up.</span></span>

- <span data-ttu-id="e8fc0-150">**Isolamento de falha**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-150">**Fault isolation**.</span></span> <span data-ttu-id="e8fc0-151">Se um serviço falhar, ele não derrubará o aplicativo inteiro.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-151">If a service goes down, it won't take out the entire application.</span></span> <span data-ttu-id="e8fc0-152">No entanto, isso não significa que você obtém resiliência gratuitamente.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-152">However, that doesn't mean you get resiliency for free.</span></span> <span data-ttu-id="e8fc0-153">Você ainda precisa seguir as melhores práticas de resiliência e padrões de design.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-153">You still need to follow resiliency best practices and design patterns.</span></span> <span data-ttu-id="e8fc0-154">Consulte [Desenvolvimento de aplicativos resilientes para o Azure][resiliency-overview].</span><span class="sxs-lookup"><span data-stu-id="e8fc0-154">See [Designing resilient applications for Azure][resiliency-overview].</span></span>

- <span data-ttu-id="e8fc0-155">**Pilhas de tecnologia mistas**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-155">**Mixed technology stacks**.</span></span> <span data-ttu-id="e8fc0-156">As equipes podem escolher a tecnologia mais adequada para seu serviço.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-156">Teams can pick the technology that best fits their service.</span></span> 

- <span data-ttu-id="e8fc0-157">**Dimensionamento granular**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-157">**Granular scaling**.</span></span> <span data-ttu-id="e8fc0-158">Os serviços podem ser dimensionados de maneira independente.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-158">Services can be scaled independently.</span></span> <span data-ttu-id="e8fc0-159">Ao mesmo tempo, a densidade mais alta de serviços por VM significa que os recursos de VM são totalmente usados.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-159">At the same time, the higher density of services per VM means that VM resources are fully utilized.</span></span> <span data-ttu-id="e8fc0-160">Usando restrições de posicionamento, um serviço pode corresponder a um perfil de VM (alta utilização da CPU e de memória e assim por diante).</span><span class="sxs-lookup"><span data-stu-id="e8fc0-160">Using placement constraints, a services can be matched to a VM profile (high CPU, high memory, and so on).</span></span>

## <a name="challenges"></a><span data-ttu-id="e8fc0-161">Desafios</span><span class="sxs-lookup"><span data-stu-id="e8fc0-161">Challenges</span></span>

- <span data-ttu-id="e8fc0-162">**Complexidade**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-162">**Complexity**.</span></span> <span data-ttu-id="e8fc0-163">Um aplicativo de microsserviços tem mais partes móveis que o aplicativo monolítico equivalente.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-163">A microservices application has more moving parts than the equivalent monolithic application.</span></span> <span data-ttu-id="e8fc0-164">Cada serviço é mais simples, mas o sistema como um todo é mais complexo.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-164">Each service is simpler, but the entire system as a whole is more complex.</span></span>

- <span data-ttu-id="e8fc0-165">**Desenvolvimento e teste**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-165">**Development and test**.</span></span> <span data-ttu-id="e8fc0-166">Desenvolver com relação a dependências de serviço exige uma abordagem diferente.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-166">Developing against service dependencies requires a different approach.</span></span> <span data-ttu-id="e8fc0-167">As ferramentas existentes não são necessariamente projetadas para funcionar com dependências de serviço.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-167">Existing tools are not necessarily designed to work with service dependencies.</span></span> <span data-ttu-id="e8fc0-168">Refatorar entre limites de serviços pode ser difícil.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-168">Refactoring across service boundaries can be difficult.</span></span> <span data-ttu-id="e8fc0-169">Também pode ser um desafio testar as dependências de serviço, especialmente quando o aplicativo está evoluindo rapidamente.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-169">It is also challenging to test service dependencies, especially when the application is evolving quickly.</span></span>

- <span data-ttu-id="e8fc0-170">**Falta de governança**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-170">**Lack of governance**.</span></span> <span data-ttu-id="e8fc0-171">A abordagem descentralizada para compilar microsserviços tem vantagens, mas também pode causar problemas.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-171">The decentralized approach to building microservices has advantages, but it can also lead to problems.</span></span> <span data-ttu-id="e8fc0-172">Você pode acabar com muitos idiomas e estruturas diferentes que tornem difícil a manutenção do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-172">You may end up with so many different languages and frameworks that the application becomes hard to maintain.</span></span> <span data-ttu-id="e8fc0-173">Pode ser útil estabelecer alguns padrões para todo o projeto, sem restringir excessivamente a flexibilidade das equipes.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-173">It may be useful to put some project-wide standards in place, without overly restricting teams' flexibility.</span></span> <span data-ttu-id="e8fc0-174">Isso se aplica especialmente a funcionalidades abrangentes como registro em log.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-174">This especially applies to cross-cutting functionality such as logging.</span></span>

- <span data-ttu-id="e8fc0-175">**Latência e congestionamento de rede**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-175">**Network congestion and latency**.</span></span> <span data-ttu-id="e8fc0-176">O uso de muitos serviços granulares pequenos pode resultar em mais comunicação entre serviços.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-176">The use of many small, granular services can result in more interservice communication.</span></span> <span data-ttu-id="e8fc0-177">Além disso, se a cadeia de dependências de serviço ficar muito longa (o serviço A chamada o B, que chama o C…) a latência adicional poderá se tornar um problema.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-177">Also, if the chain of service dependencies gets too long (service A calls B, which calls C...), the additional latency can become a problem.</span></span> <span data-ttu-id="e8fc0-178">Você precisará projetar APIs com cuidado.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-178">You will need to design APIs carefully.</span></span> <span data-ttu-id="e8fc0-179">Evite APIs excessivamente prolixas, pense em formatos de serialização e procure locais para usar padrões de comunicação assíncrona.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-179">Avoid overly chatty APIs, think about serialization formats, and look for places to use asynchronous communication patterns.</span></span>

- <span data-ttu-id="e8fc0-180">**Integridade de dados**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-180">**Data integrity**.</span></span> <span data-ttu-id="e8fc0-181">Cada microsserviço deve ser responsável pela própria persistência de dados.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-181">With each microservice responsible for its own data persistence.</span></span> <span data-ttu-id="e8fc0-182">Assim, a consistência dos dados pode ser um desafio.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-182">As a result, data consistency can be a challenge.</span></span> <span data-ttu-id="e8fc0-183">Adote consistência eventual quando possível.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-183">Embrace eventual consistency where possible.</span></span>

- <span data-ttu-id="e8fc0-184">**Gerenciamento**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-184">**Management**.</span></span> <span data-ttu-id="e8fc0-185">Ter êxito com microsserviços requer uma cultura DevOps madura.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-185">To be successful with microservices requires a mature DevOps culture.</span></span> <span data-ttu-id="e8fc0-186">Registro em log correlacionado entre serviços pode ser desafiador.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-186">Correlated logging across services can be challenging.</span></span> <span data-ttu-id="e8fc0-187">Normalmente, o registro em log deve correlacionar várias chamadas de serviço para uma operação de um único usuário.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-187">Typically, logging must correlate multiple service calls for a single user operation.</span></span>

- <span data-ttu-id="e8fc0-188">**Controle de versão**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-188">**Versioning**.</span></span> <span data-ttu-id="e8fc0-189">As atualizações de um serviço não devem interromper os serviços que dependerem delas.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-189">Updates to a service must not break services that depend on it.</span></span> <span data-ttu-id="e8fc0-190">Vários serviços podem ser atualizados a qualquer momento, portanto, sem design cuidadoso, você pode ter problemas com compatibilidade com versões anteriores ou futuras.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-190">Multiple services could be updated at any given time, so without careful design, you might have problems with backward or forward compatibility.</span></span>

- <span data-ttu-id="e8fc0-191">**Conjunto de qualificações**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-191">**Skillset**.</span></span> <span data-ttu-id="e8fc0-192">Os microsserviços são sistemas altamente distribuídos.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-192">Microservices are highly distributed systems.</span></span> <span data-ttu-id="e8fc0-193">Avalie cuidadosamente se a equipe tem as habilidades e a experiência para ser bem-sucedida.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-193">Carefully evaluate whether the team has the skills and experience to be successful.</span></span>

## <a name="best-practices"></a><span data-ttu-id="e8fc0-194">Práticas recomendadas</span><span class="sxs-lookup"><span data-stu-id="e8fc0-194">Best practices</span></span>

- <span data-ttu-id="e8fc0-195">Modele os serviços em torno de domínio da empresa.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-195">Model services around the business domain.</span></span> 

- <span data-ttu-id="e8fc0-196">Descentralize tudo.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-196">Decentralize everything.</span></span> <span data-ttu-id="e8fc0-197">Equipes individuais são responsáveis por projetar e criar serviços.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-197">Individual teams are responsible for designing and building services.</span></span> <span data-ttu-id="e8fc0-198">Evite compartilhar esquemas de dados ou códigos.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-198">Avoid sharing code or data schemas.</span></span> 

- <span data-ttu-id="e8fc0-199">O armazenamento de dados deve ser privado para o serviço que é o proprietário dos dados.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-199">Data storage should be private to the service that owns the data.</span></span> <span data-ttu-id="e8fc0-200">Use o melhor armazenamento para cada serviço e tipo de dados.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-200">Use the best storage for each service and data type.</span></span> 

- <span data-ttu-id="e8fc0-201">Os serviços comunicam-se por meio de APIs bem projetadas.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-201">Services communicate through well-designed APIs.</span></span> <span data-ttu-id="e8fc0-202">Evite o vazamento de detalhes da implementação.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-202">Avoid leaking implementation details.</span></span> <span data-ttu-id="e8fc0-203">As APIs devem modelar o domínio, não a implementação interna do serviço.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-203">APIs should model the domain, not the internal implementation of the service.</span></span>

- <span data-ttu-id="e8fc0-204">Evite acoplamento entre serviços.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-204">Avoid coupling between services.</span></span> <span data-ttu-id="e8fc0-205">Causas de acoplamento incluem protocolos de comunicação rígidos e esquemas de banco de dados compartilhados.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-205">Causes of coupling include shared database schemas and rigid communication protocols.</span></span>

- <span data-ttu-id="e8fc0-206">Descarregue preocupações abrangentes, como autenticação e terminação SSL, para o gateway.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-206">Offload cross-cutting concerns, such as authentication and SSL termination, to the gateway.</span></span>

- <span data-ttu-id="e8fc0-207">Mantenha o conhecimento de domínio fora do gateway.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-207">Keep domain knowledge out of the gateway.</span></span> <span data-ttu-id="e8fc0-208">O gateway deve tratar e rotear solicitações de cliente sem qualquer conhecimento das regras de negócios ou da lógica do domínio.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-208">The gateway should handle and route client requests without any knowledge of the business rules or domain logic.</span></span> <span data-ttu-id="e8fc0-209">Caso contrário, o gateway se tornará uma dependência e poderá causar um acoplamento entre serviços.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-209">Otherwise, the gateway becomes a dependency and can cause coupling between services.</span></span>

- <span data-ttu-id="e8fc0-210">Os serviços devem ter um acoplamento flexível e alta coesão funcional.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-210">Services should have loose coupling and high functional cohesion.</span></span> <span data-ttu-id="e8fc0-211">Funções que provavelmente mudarão juntas devem ser empacotadas e implantadas juntas.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-211">Functions that are likely to change together should be packaged and deployed together.</span></span> <span data-ttu-id="e8fc0-212">Se residirem em serviços separados, esses serviços acabarão sendo fortemente acoplados, porque uma alteração em um serviço exigirá atualizar outro.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-212">If they reside in separate services, those services end up being tightly coupled, because a change in one service will require updating the other service.</span></span> <span data-ttu-id="e8fc0-213">Uma comunicação excessivamente prolixa entre dois serviços pode ser um sintoma de acoplamento forte e coesão baixa.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-213">Overly chatty communication between two services may be a symptom of tight coupling and low cohesion.</span></span> 

- <span data-ttu-id="e8fc0-214">Isole falhas.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-214">Isolate failures.</span></span> <span data-ttu-id="e8fc0-215">Use estratégias de resiliência para impedir que falhas em um serviço distribuam-se em cascata.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-215">Use resiliency strategies to prevent failures within a service from cascading.</span></span> <span data-ttu-id="e8fc0-216">Consulte [Padrões de resiliência][resiliency-patterns] e [Design de aplicativos resilientes][resiliency-overview].</span><span class="sxs-lookup"><span data-stu-id="e8fc0-216">See [Resiliency patterns][resiliency-patterns] and [Designing resilient applications][resiliency-overview].</span></span>

## <a name="microservices-using-azure-container-service"></a><span data-ttu-id="e8fc0-217">Microsserviços usando o Serviço de Contêiner do Azure</span><span class="sxs-lookup"><span data-stu-id="e8fc0-217">Microservices using Azure Container Service</span></span> 

<span data-ttu-id="e8fc0-218">Você pode usar o [Serviço de Contêiner do Azure](/azure/container-service/) para configurar e provisionar um cluster do Docker.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-218">You can use [Azure Container Service](/azure/container-service/) to configure and provision a Docker cluster.</span></span> <span data-ttu-id="e8fc0-219">Os Serviços de Contêiner do Azure dão suporte a vários orquestradores de contêiner populares, incluindo Kubernetes, DC/SO e Docker Swarm.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-219">Azure Container Services supports several popular container orchestrators, including Kubernetes, DC/OS, and Docker Swarm.</span></span>

![](./images/microservices-acs.png)
 
<span data-ttu-id="e8fc0-220">**Nós públicos**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-220">**Public nodes**.</span></span> <span data-ttu-id="e8fc0-221">Esses nós estão acessíveis por meio de um balanceador de carga voltado para o público.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-221">These nodes are reachable through a public-facing load balancer.</span></span> <span data-ttu-id="e8fc0-222">O gateway de API é hospedado nesses nós.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-222">The API gateway is hosted on these nodes.</span></span>

<span data-ttu-id="e8fc0-223">**Nós de back-end**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-223">**Backend nodes**.</span></span> <span data-ttu-id="e8fc0-224">Esses nós executam serviços que os clientes acessam por meio do gateway de API.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-224">These nodes run services that clients reach via the API gateway.</span></span> <span data-ttu-id="e8fc0-225">Esses nós não recebem o tráfego de Internet diretamente.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-225">These nodes don't receive Internet traffic directly.</span></span> <span data-ttu-id="e8fc0-226">Os nós de back-end podem incluir mais de um pool de VMs, cada um com um perfil de hardware diferente.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-226">The backend nodes might include more than one pool of VMs, each with a different hardware profile.</span></span> <span data-ttu-id="e8fc0-227">Por exemplo, você pode criar grupos separados para cargas de trabalho de computação geral, cargas de trabalho com consumo elevado de CPU e cargas de trabalho com consumo elevado de memória.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-227">For example, you could create separate pools for general compute workloads, high CPU workloads, and high memory workloads.</span></span> 

<span data-ttu-id="e8fc0-228">**VMs de gerenciamento**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-228">**Management VMs**.</span></span> <span data-ttu-id="e8fc0-229">Essas VMs executam os nós mestres para o orquestrador de contêiner.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-229">These VMs run the master nodes for the container orchestrator.</span></span> 

<span data-ttu-id="e8fc0-230">**Rede**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-230">**Networking**.</span></span> <span data-ttu-id="e8fc0-231">Os nós públicos, os nós de back-end e as VMs de gerenciamento são colocados em sub-redes separadas na mesma VNet (rede virtual).</span><span class="sxs-lookup"><span data-stu-id="e8fc0-231">The public nodes, backend nodes, and management VMs are placed in separate subnets within the same virtual network (VNet).</span></span> 

<span data-ttu-id="e8fc0-232">**Balanceadores de carga**.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-232">**Load balancers**.</span></span>  <span data-ttu-id="e8fc0-233">Um balanceador de carga voltado para fora se encontra na frente de nós do públicos.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-233">An externally facing load balancer sits in front of the public nodes.</span></span> <span data-ttu-id="e8fc0-234">Ela distribui solicitações da Internet para os nós públicos.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-234">It distributes internet requests to the public nodes.</span></span> <span data-ttu-id="e8fc0-235">Outro balanceador de carga é colocado na frente das VMs de gerenciamento para garantir tráfego SSH (Secure Shell) para as VMs de gerenciamento usando as regras NAT.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-235">Another load balancer is placed in front of the management VMs, to allow secure shell (ssh) traffic to the management VMs, using NAT rules.</span></span>

<span data-ttu-id="e8fc0-236">Para escalabilidade e confiabilidade, cada serviço é replicado entre várias VMs.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-236">For reliability and scalability, each service is replicated across multiple VMs.</span></span> <span data-ttu-id="e8fc0-237">No entanto, como serviços também são relativamente leves (em comparação a um aplicativo monolítico), vários serviços normalmente são incluídos em uma única VM.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-237">However, because services are also relatively lightweight (compared with a monolithic application), multiple services are usually packed into a single VM.</span></span> <span data-ttu-id="e8fc0-238">Maior densidade permite melhor utilização de recursos.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-238">Higher density allows better resource utilization.</span></span> <span data-ttu-id="e8fc0-239">Se um serviço específico não usar muitos recursos, você não precisará dedicar toda uma VM para executar esse serviço.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-239">If a particular service doesn't use a lot of resources, you don't need to dedicate an entire VM to running that service.</span></span>

<span data-ttu-id="e8fc0-240">O diagrama a seguir mostra três nós executando quatro serviços diferentes (indicados por diferentes formas).</span><span class="sxs-lookup"><span data-stu-id="e8fc0-240">The following diagram shows three nodes running four different services (indicated by different shapes).</span></span> <span data-ttu-id="e8fc0-241">Observe que cada serviço tem pelo menos duas instâncias.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-241">Notice that each service has at least two instances.</span></span> 
 
![](./images/microservices-node-density.png)

## <a name="microservices-using-azure-service-fabric"></a><span data-ttu-id="e8fc0-242">Microsserviços usando o Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="e8fc0-242">Microservices using Azure Service Fabric</span></span>

<span data-ttu-id="e8fc0-243">O diagrama a seguir mostra uma arquitetura de microsserviços usando o [Azure Service Fabric](/azure/service-fabric/).</span><span class="sxs-lookup"><span data-stu-id="e8fc0-243">The following diagram shows a microservices architecture using [Azure Service Fabric](/azure/service-fabric/).</span></span>

![](./images/service-fabric.png)

<span data-ttu-id="e8fc0-244">O cluster do Service Fabric é implantado em um ou mais conjuntos de dimensionamento de VMs.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-244">The Service Fabric cluster is deployed to one or more VM scale sets.</span></span> <span data-ttu-id="e8fc0-245">Você pode ter mais de um conjunto de dimensionamento de VM definido no cluster para ter uma combinação de tipos de VM.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-245">You might have more than one VM scale set in the cluster, in order to have a mix of VM types.</span></span> <span data-ttu-id="e8fc0-246">Um Gateway de API é colocado na frente do cluster do Service Fabric, com um balanceador externo de carga para receber solicitações do cliente.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-246">An API Gateway is placed in front of the Service Fabric cluster, with an external load balancer to receive client requests.</span></span>

<span data-ttu-id="e8fc0-247">O tempo de execução do Service Fabric realiza o gerenciamento de cluster, incluindo posicionamento do serviço, failover de nó e monitoramento de integridade.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-247">The Service Fabric runtime performs cluster management, including service placement, node failover, and health monitoring.</span></span> <span data-ttu-id="e8fc0-248">O tempo de execução é implantado nos próprios nós de cluster.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-248">The runtime is deployed on the cluster nodes themselves.</span></span> <span data-ttu-id="e8fc0-249">Não há um conjunto separado de VMs de gerenciamento de cluster.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-249">There isn't a separate set of cluster management VMs.</span></span>

<span data-ttu-id="e8fc0-250">Os serviços comunicam-se entre si usando o proxy inverso interno do Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-250">Services communicate with each other using the reverse proxy that is built into Service Fabric.</span></span> <span data-ttu-id="e8fc0-251">O Service Fabric fornece um serviço de descoberta que pode resolver o ponto de extremidade para um serviço nomeado.</span><span class="sxs-lookup"><span data-stu-id="e8fc0-251">Service Fabric provides a discovery service that can resolve the endpoint for a named service.</span></span>


<!-- links -->

[resiliency-overview]: ../../resiliency/index.md
[resiliency-patterns]: ../../patterns/category/resiliency.md



