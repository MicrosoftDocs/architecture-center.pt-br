---
title: Arquitetura orientada a eventos
titleSuffix: Azure Application Architecture Guide
description: Descreve os benefícios, os desafios e as práticas recomendadas para eventos e arquiteturas de IoT no Azure.
author: MikeWasson
ms.date: 08/30/2018
ms.topic: guide
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: seojan19
ms.openlocfilehash: b83a919e4ccd41d20b508b10604365a0b4ca90af
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/20/2019
ms.locfileid: "58245637"
---
# <a name="event-driven-architecture-style"></a><span data-ttu-id="7a0d2-103">Arquitetura orientada a eventos</span><span class="sxs-lookup"><span data-stu-id="7a0d2-103">Event-driven architecture style</span></span>

<span data-ttu-id="7a0d2-104">Consiste em uma arquitetura orientada a eventos de **produtores de eventos** que geram um fluxo de eventos, e **consumidores dos eventos** que escutam eventos.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-104">An event-driven architecture consists of **event producers** that generate a stream of events, and **event consumers** that listen for the events.</span></span>

![Diagrama um estilo de arquitetura orientado por eventos](./images/event-driven.svg)

<span data-ttu-id="7a0d2-106">Os eventos são entregues quase em tempo real, para que os consumidores possam responder imediatamente conforme os eventos ocorrem.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-106">Events are delivered in near real time, so consumers can respond immediately to events as they occur.</span></span> <span data-ttu-id="7a0d2-107">Os produtores são separados dos consumidores &mdash;. Um produtor não sabe quais consumidores estão ouvindo.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-107">Producers are decoupled from consumers &mdash; a producer doesn't know which consumers are listening.</span></span> <span data-ttu-id="7a0d2-108">Os consumidores também são separados uns dos outros; e cada consumidor vê todos os eventos.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-108">Consumers are also decoupled from each other, and every consumer sees all of the events.</span></span> <span data-ttu-id="7a0d2-109">Isso difere do padrão de [Consumidores Concorrentes][competing-consumers], onde os consumidores removem mensagens de uma fila, e uma mensagem é processada apenas uma vez (presumindo que não haja erros).</span><span class="sxs-lookup"><span data-stu-id="7a0d2-109">This differs from a [Competing Consumers][competing-consumers] pattern, where consumers pull messages from a queue and a message is processed just once (assuming no errors).</span></span> <span data-ttu-id="7a0d2-110">Em alguns sistemas, como IoT, os eventos devem ser incluídos em volumes muito altos.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-110">In some systems, such as IoT, events must be ingested at very high volumes.</span></span>

<span data-ttu-id="7a0d2-111">Um evento controlado por arquitetura pode usar um modelo de pub/sub ou um modelo de fluxo de evento.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-111">An event driven architecture can use a pub/sub model or an event stream model.</span></span>

- <span data-ttu-id="7a0d2-112">**Pub/sub**: a infraestrutura de mensagens acompanha o controle de assinaturas.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-112">**Pub/sub**: The messaging infrastructure keeps track of subscriptions.</span></span> <span data-ttu-id="7a0d2-113">Quando um evento é publicado, ele envia o evento para cada assinante.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-113">When an event is published, it sends the event to each subscriber.</span></span> <span data-ttu-id="7a0d2-114">Depois que um evento é recebido, ele não pode ser reproduzido e não será exibido para assinantes novos.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-114">After an event is received, it cannot be replayed, and new subscribers do not see the event.</span></span>

- <span data-ttu-id="7a0d2-115">**Streaming de eventos**: eventos são gravados em um registro.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-115">**Event streaming**: Events are written to a log.</span></span> <span data-ttu-id="7a0d2-116">Os eventos são estritamente ordenados (dentro de uma partição) e duráveis.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-116">Events are strictly ordered (within a partition) and durable.</span></span> <span data-ttu-id="7a0d2-117">Os clientes não assinam o fluxo, em vez disso, um cliente pode ler a partir de qualquer parte do fluxo.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-117">Clients don't subscribe to the stream, instead a client can read from any part of the stream.</span></span> <span data-ttu-id="7a0d2-118">O cliente é responsável por avançar a sua posição no fluxo.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-118">The client is responsible for advancing its position in the stream.</span></span> <span data-ttu-id="7a0d2-119">Isso significa que um cliente pode participar a qualquer momento e pode reproduzir eventos.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-119">That means a client can join at any time, and can replay events.</span></span>

<span data-ttu-id="7a0d2-120">No lado do consumidor, há algumas variações comuns:</span><span class="sxs-lookup"><span data-stu-id="7a0d2-120">On the consumer side, there are some common variations:</span></span>

- <span data-ttu-id="7a0d2-121">**Processamento de eventos simples**.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-121">**Simple event processing**.</span></span> <span data-ttu-id="7a0d2-122">Um evento dispara imediatamente uma ação no consumidor.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-122">An event immediately triggers an action in the consumer.</span></span> <span data-ttu-id="7a0d2-123">Por exemplo, você pode usar as Azure Functions com um gatilho de Barramento de Serviço para que uma função seja executada sempre que uma mensagem é publicada em um tópico do Barramento de Serviço.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-123">For example, you could use Azure Functions with a Service Bus trigger, so that a function executes whenever a message is published to a Service Bus topic.</span></span>

- <span data-ttu-id="7a0d2-124">**Processamento de eventos complexos**.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-124">**Complex event processing**.</span></span> <span data-ttu-id="7a0d2-125">Um consumidor processa uma série de eventos, procurando padrões nos dados de eventos usando uma tecnologia, como o Azure Stream Analytics ou o Apache Storm.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-125">A consumer processes a series of events, looking for patterns in the event data, using a technology such as Azure Stream Analytics or Apache Storm.</span></span> <span data-ttu-id="7a0d2-126">Por exemplo, você pode agregar as leituras de um dispositivo incorporado em uma janela de tempo e gerar uma notificação se a média móvel ultrapassar um certo limite.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-126">For example, you could aggregate readings from an embedded device over a time window, and generate a notification if the moving average crosses a certain threshold.</span></span>

- <span data-ttu-id="7a0d2-127">**Processamento de fluxo de eventos**.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-127">**Event stream processing**.</span></span> <span data-ttu-id="7a0d2-128">Use uma plataforma de fluxo de dados, como o Hub IoT do Azure ou o Apache Kafka, como um pipeline para ingestão de eventos e os encaminhe para os processadores de fluxo.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-128">Use a data streaming platform, such as Azure IoT Hub or Apache Kafka, as a pipeline to ingest events and feed them to stream processors.</span></span> <span data-ttu-id="7a0d2-129">Os processadores de fluxo agem para processar ou transformar o fluxo.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-129">The stream processors act to process or transform the stream.</span></span> <span data-ttu-id="7a0d2-130">Pode haver vários processadores de fluxo para subsistemas diferentes do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-130">There may be multiple stream processors for different subsystems of the application.</span></span> <span data-ttu-id="7a0d2-131">Esta abordagem é uma boa opção para cargas de trabalho de IoT.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-131">This approach is a good fit for IoT workloads.</span></span>

<span data-ttu-id="7a0d2-132">A fonte dos eventos pode ser externa ao sistema, como dispositivos físicos em uma solução de IoT.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-132">The source of the events may be external to the system, such as physical devices in an IoT solution.</span></span> <span data-ttu-id="7a0d2-133">Nesse caso, o sistema deve ser capaz de receber os dados no volume e taxa de transferência necessários para a fonte de dados.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-133">In that case, the system must be able to ingest the data at the volume and throughput that is required by the data source.</span></span>

<span data-ttu-id="7a0d2-134">No diagrama lógico acima, cada tipo de consumidor é mostrado como uma única caixa.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-134">In the logical diagram above, each type of consumer is shown as a single box.</span></span> <span data-ttu-id="7a0d2-135">Na prática, é comum ter várias instâncias de um consumidor para evitar que o consumidor se torne um ponto único de falha no sistema.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-135">In practice, it's common to have multiple instances of a consumer, to avoid having the consumer become a single point of failure in system.</span></span> <span data-ttu-id="7a0d2-136">Também pode ser necessário ter várias instâncias para lidar com o volume e a frequência de eventos.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-136">Multiple instances might also be necessary to handle the volume and frequency of events.</span></span> <span data-ttu-id="7a0d2-137">Além disso, um único consumidor pode processar eventos em vários threads.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-137">Also, a single consumer might process events on multiple threads.</span></span> <span data-ttu-id="7a0d2-138">Isso pode criar desafios se os eventos tiverem que ser processados em ordem, ou se solicitarem semânticas exatamente uma vez.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-138">This can create challenges if events must be processed in order, or require exactly-once semantics.</span></span> <span data-ttu-id="7a0d2-139">Confira [Minimizar Coordenação][minimize-coordination].</span><span class="sxs-lookup"><span data-stu-id="7a0d2-139">See [Minimize Coordination][minimize-coordination].</span></span>

## <a name="when-to-use-this-architecture"></a><span data-ttu-id="7a0d2-140">Quando usar essa arquitetura</span><span class="sxs-lookup"><span data-stu-id="7a0d2-140">When to use this architecture</span></span>

- <span data-ttu-id="7a0d2-141">Vários subsistemas devem processar os mesmos eventos.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-141">Multiple subsystems must process the same events.</span></span>
- <span data-ttu-id="7a0d2-142">Processamento em tempo real com retardo mínimo de tempo.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-142">Real-time processing with minimum time lag.</span></span>
- <span data-ttu-id="7a0d2-143">O processamento de eventos complexos, como a correspondência de padrões ou agregação em janelas de tempo.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-143">Complex event processing, such as pattern matching or aggregation over time windows.</span></span>
- <span data-ttu-id="7a0d2-144">Alto volume e alta velocidade de dados, como IoT.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-144">High volume and high velocity of data, such as IoT.</span></span>

## <a name="benefits"></a><span data-ttu-id="7a0d2-145">Benefícios</span><span class="sxs-lookup"><span data-stu-id="7a0d2-145">Benefits</span></span>

- <span data-ttu-id="7a0d2-146">Produtores e consumidores são separados.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-146">Producers and consumers are decoupled.</span></span>
- <span data-ttu-id="7a0d2-147">Nenhuma integração de ponta a ponta.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-147">No point-to point-integrations.</span></span> <span data-ttu-id="7a0d2-148">É fácil adicionar novos consumidores ao sistema.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-148">It's easy to add new consumers to the system.</span></span>
- <span data-ttu-id="7a0d2-149">Os consumidores podem responder aos eventos imediatamente assim que chegarem.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-149">Consumers can respond to events immediately as they arrive.</span></span>
- <span data-ttu-id="7a0d2-150">Altamente escalonável e distribuído.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-150">Highly scalable and distributed.</span></span>
- <span data-ttu-id="7a0d2-151">Os subsistemas têm exibições independentes do fluxo de evento.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-151">Subsystems have independent views of the event stream.</span></span>

## <a name="challenges"></a><span data-ttu-id="7a0d2-152">Desafios</span><span class="sxs-lookup"><span data-stu-id="7a0d2-152">Challenges</span></span>

- <span data-ttu-id="7a0d2-153">Entrega garantida.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-153">Guaranteed delivery.</span></span> <span data-ttu-id="7a0d2-154">Em alguns sistemas, especialmente em situações de IoT, é crucial garantir que os eventos sejam entregues.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-154">In some systems, especially in IoT scenarios, it's crucial to guarantee that events are delivered.</span></span>
- <span data-ttu-id="7a0d2-155">Eventos processados em ordem ou exatamente uma vez.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-155">Processing events in order or exactly once.</span></span> <span data-ttu-id="7a0d2-156">Normalmente, cada tipo de consumidor é executado em várias instâncias de resiliência e escalabilidade.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-156">Each consumer type typically runs in multiple instances, for resiliency and scalability.</span></span> <span data-ttu-id="7a0d2-157">Isso pode criar um desafio se os eventos devem ser processados em ordem (dentro de um tipo de consumidor), ou se a lógica de processamento não for idempotente.</span><span class="sxs-lookup"><span data-stu-id="7a0d2-157">This can create a challenge if the events must be processed in order (within a consumer type), or if the processing logic is not idempotent.</span></span>

 <!-- links -->

[competing-consumers]: ../../patterns/competing-consumers.md
[minimize-coordination]: ../design-principles/minimize-coordination.md
