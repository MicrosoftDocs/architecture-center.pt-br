---
title: Implantar o SAP NetWeaver e o SAP HANA no Azure
description: "Práticas comprovadas para executar o SAP HANA em um ambiente de alta disponibilidade no Azure."
author: njray
ms.date: 06/29/2017
ms.openlocfilehash: 27a97103c0c6f305cb8e830d670c8d0ba7e22aa5
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/14/2017
---
# <a name="deploy-sap-netweaver-and-sap-hana-on-azure"></a><span data-ttu-id="59d79-103">Implantar o SAP NetWeaver e o SAP HANA no Azure</span><span class="sxs-lookup"><span data-stu-id="59d79-103">Deploy SAP NetWeaver and SAP HANA on Azure</span></span>

<span data-ttu-id="59d79-104">Essa arquitetura de referência mostra um conjunto de práticas comprovadas para executar o SAP HANA em um ambiente de alta disponibilidade no Azure.</span><span class="sxs-lookup"><span data-stu-id="59d79-104">This reference architecture shows a set of proven practices for running SAP HANA in a high availability environment on Azure.</span></span> [<span data-ttu-id="59d79-105">**Implantar esta solução**.</span><span class="sxs-lookup"><span data-stu-id="59d79-105">**Deploy this solution**.</span></span>](#deploy-the-solution)

<span data-ttu-id="59d79-106">![0][0]</span><span class="sxs-lookup"><span data-stu-id="59d79-106">![0][0]</span></span>

<span data-ttu-id="59d79-107">*Baixar um [arquivo Visio][visio-download] dessa arquitetura.*</span><span class="sxs-lookup"><span data-stu-id="59d79-107">*Download a [Visio file][visio-download] of this architecture.*</span></span>

> [!NOTE]
> <span data-ttu-id="59d79-108">Implantar essa arquitetura de referência requer um licenciamento apropriado de produtos SAP e outras tecnologias que não são da Microsoft.</span><span class="sxs-lookup"><span data-stu-id="59d79-108">Deploying this reference architecture requires appropriate licensing of SAP products and other non-Microsoft technologies.</span></span> <span data-ttu-id="59d79-109">Para obter informações sobre a parceria entre a Microsoft e o SAP, consulte [SAP HANA no Azure][sap-hana-on-azure].</span><span class="sxs-lookup"><span data-stu-id="59d79-109">For information about the partnership between Microsoft and SAP, see [SAP HANA on Azure][sap-hana-on-azure].</span></span>

## <a name="architecture"></a><span data-ttu-id="59d79-110">Arquitetura</span><span class="sxs-lookup"><span data-stu-id="59d79-110">Architecture</span></span>

<span data-ttu-id="59d79-111">Essa arquitetura consiste nos seguintes componentes.</span><span class="sxs-lookup"><span data-stu-id="59d79-111">The architecture consists of the following components.</span></span>

- <span data-ttu-id="59d79-112">**Rede virtual (VNet)**.</span><span class="sxs-lookup"><span data-stu-id="59d79-112">**Virtual network (VNet)**.</span></span> <span data-ttu-id="59d79-113">Uma rede virtual é uma representação de uma rede isolada logicamente no Azure.</span><span class="sxs-lookup"><span data-stu-id="59d79-113">A VNet is a representation of a logically isolated network in Azure.</span></span> <span data-ttu-id="59d79-114">Todas as VMs nesta arquitetura de referência são implantadas para a mesma rede virtual.</span><span class="sxs-lookup"><span data-stu-id="59d79-114">All of the VMs in this reference architecture are deployed to the same VNet.</span></span> <span data-ttu-id="59d79-115">A rede virtual é, posteriormente, subdividida em sub-redes.</span><span class="sxs-lookup"><span data-stu-id="59d79-115">The VNet is further subdivided into subnets.</span></span> <span data-ttu-id="59d79-116">Crie uma sub-rede separada para cada camada, incluindo o aplicativo (SAP NetWeaver), o banco de dados (SAP HANA), gerenciamento (o jumpbox) e o Active Directory.</span><span class="sxs-lookup"><span data-stu-id="59d79-116">Create a separate subnet for each tier, including application (SAP NetWeaver), database (SAP HANA), management (the jumpbox), and Active Directory.</span></span>

- <span data-ttu-id="59d79-117">**Máquinas Virtuais (VMs)**.</span><span class="sxs-lookup"><span data-stu-id="59d79-117">**Virtual machines (VMs)**.</span></span> <span data-ttu-id="59d79-118">As VMs dessa arquitetura são agrupadas em vários camadas distintas.</span><span class="sxs-lookup"><span data-stu-id="59d79-118">The VMs for this architecture are grouped into several distinct tiers.</span></span>

    - <span data-ttu-id="59d79-119">**SAP NetWeaver**.</span><span class="sxs-lookup"><span data-stu-id="59d79-119">**SAP NetWeaver**.</span></span> <span data-ttu-id="59d79-120">Inclui SAP ASCS, SAP Web Dispatcher e os servidores de aplicativos SAP.</span><span class="sxs-lookup"><span data-stu-id="59d79-120">Includes SAP ASCS, SAP Web Dispatcher, and the SAP application servers.</span></span> 
    
    - <span data-ttu-id="59d79-121">**SAP HANA**.</span><span class="sxs-lookup"><span data-stu-id="59d79-121">**SAP HANA**.</span></span> <span data-ttu-id="59d79-122">Essa arquitetura de referência usa o SAP HANA para a camada de banco de dados, em execução em uma única instância [GS5][vm-sizes-mem] instância.</span><span class="sxs-lookup"><span data-stu-id="59d79-122">This reference architecture uses SAP HANA for the database tier, running on a single [GS5][vm-sizes-mem] instance.</span></span> <span data-ttu-id="59d79-123">O SAP HANA é certificado para cargas de trabalho de produção OLAP em GS5 ou [HANA SAP no Azure grandes instâncias][azure-large-instances].</span><span class="sxs-lookup"><span data-stu-id="59d79-123">SAP HANA is certified for production OLAP workloads on GS5 or [SAP HANA on Azure Large Instances][azure-large-instances].</span></span> <span data-ttu-id="59d79-124">Essa arquitetura de referência é para máquinas virtuais do Azure na série G e série M.</span><span class="sxs-lookup"><span data-stu-id="59d79-124">This reference architecture is for Azure virtual machines in the G-series and M-series.</span></span> <span data-ttu-id="59d79-125">Para obter informações sobre o SAP HANA Instâncias Grandes do Azure, consulte [Visão geral do SAP HANA (grandes instâncias) e arquitetura no Azure][azure-large-instances].</span><span class="sxs-lookup"><span data-stu-id="59d79-125">For information about SAP HANA on Azure Large Instances, see [SAP HANA (large instances) overview and architecture on Azure][azure-large-instances].</span></span>
   
    - <span data-ttu-id="59d79-126">**Jumpbox**.</span><span class="sxs-lookup"><span data-stu-id="59d79-126">**Jumpbox**.</span></span> <span data-ttu-id="59d79-127">Também chamada de um host bastião.</span><span class="sxs-lookup"><span data-stu-id="59d79-127">Also called a bastion host.</span></span> <span data-ttu-id="59d79-128">Esta é uma VM segura na rede que os administradores usam para se conectar às outras VMs.</span><span class="sxs-lookup"><span data-stu-id="59d79-128">This is a secure VM on the network that administrators use to connect to the other VMs.</span></span> 
     
    - <span data-ttu-id="59d79-129">**Controladores de domínio do Active Directory (AD) do Windows Server.**</span><span class="sxs-lookup"><span data-stu-id="59d79-129">**Windows Server Active Directory (AD) domain controllers.**</span></span> <span data-ttu-id="59d79-130">Os controladores de domínio são usados para configurar o Cluster de Failover do Windows Server (veja abaixo).</span><span class="sxs-lookup"><span data-stu-id="59d79-130">The domain controllers are used to configure the Windows Server Failover Cluster (see below).</span></span>
 
- <span data-ttu-id="59d79-131">**Conjuntos de disponibilidade**.</span><span class="sxs-lookup"><span data-stu-id="59d79-131">**Availability sets**.</span></span> <span data-ttu-id="59d79-132">Coloque as máquinas virtuais para as funções de SAP Web Dispatcher, servidor de aplicativos SAP e SAP Web Dispatcher em conjuntos de disponibilidade separados e provisione pelo menos duas VMs para cada função.</span><span class="sxs-lookup"><span data-stu-id="59d79-132">Place the VMs for the SAP Web Dispatcher, SAP application server, and SAP ACSC roles into separate availability sets, and provision at least two VMs for each role.</span></span> <span data-ttu-id="59d79-133">Isso torna as VMs qualificadas para um contrato de nível de serviço (SLA) mais alto.</span><span class="sxs-lookup"><span data-stu-id="59d79-133">This makes the VMs eligible for a higher service level agreement (SLA).</span></span>
    
- <span data-ttu-id="59d79-134">**NICs.**</span><span class="sxs-lookup"><span data-stu-id="59d79-134">**NICs.**</span></span> <span data-ttu-id="59d79-135">As máquinas virtuais que executam o SAP NetWeaver e o SAP HANA exigem duas interfaces de rede (NICs).</span><span class="sxs-lookup"><span data-stu-id="59d79-135">The VMs that run SAP NetWeaver and SAP HANA require two network interfaces (NICs).</span></span> <span data-ttu-id="59d79-136">Cada NIC é atribuído a uma sub-rede diferente, para separar os diferentes tipos de tráfego.</span><span class="sxs-lookup"><span data-stu-id="59d79-136">Each NIC is assigned to a different subnet, to segregate different types of traffic.</span></span> <span data-ttu-id="59d79-137">Consulte as [Recomendações](#recommendations) abaixo para obter mais informações.</span><span class="sxs-lookup"><span data-stu-id="59d79-137">See [Recommendations](#recommendations) below for more information.</span></span>

- <span data-ttu-id="59d79-138">**Cluster de Failover do Windows Server**.</span><span class="sxs-lookup"><span data-stu-id="59d79-138">**Windows Server Failover Cluster**.</span></span> <span data-ttu-id="59d79-139">As VMs que executam ACSC SAP são configuradas como um cluster de failover para alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="59d79-139">The VMs that run SAP ACSC are configured as a failover cluster for high availability.</span></span> <span data-ttu-id="59d79-140">Para dar suporte ao cluster de failover, a SIOS DataKeeper Cluster Edition executa a função de volume de cluster compartilhado (CSV) replicando discos independentes pertencentes a nós de cluster.</span><span class="sxs-lookup"><span data-stu-id="59d79-140">To support the failover cluster, SIOS DataKeeper Cluster Edition performs the cluster shared volume (CSV) function by replicating independent disks owned by the cluster nodes.</span></span> <span data-ttu-id="59d79-141">Para obter detalhes, consulte [Executar aplicativos do SAP na plataforma da Microsoft][running-sap].</span><span class="sxs-lookup"><span data-stu-id="59d79-141">For details, see [Running SAP applications on the Microsoft platform][running-sap].</span></span>
    
- <span data-ttu-id="59d79-142">**Balanceadores de carga.**</span><span class="sxs-lookup"><span data-stu-id="59d79-142">**Load balancers.**</span></span> <span data-ttu-id="59d79-143">Duas instâncias do [Azure Load Balancer][azure-lb] são usadas.</span><span class="sxs-lookup"><span data-stu-id="59d79-143">Two [Azure Load Balancer][azure-lb] instances are used.</span></span> <span data-ttu-id="59d79-144">A primeira, mostrado à esquerda do diagrama, distribui o tráfego para VMs do SAP Web Dispatcher.</span><span class="sxs-lookup"><span data-stu-id="59d79-144">The first, shown on the left of the diagram, distributes traffic to the SAP Web Dispatcher VMs.</span></span> <span data-ttu-id="59d79-145">Essa configuração implementa a opção de dispatcher Web paralelo descrita em [Alta Disponibilidade do SAP Web Dispatcher][sap-dispatcher-ha].</span><span class="sxs-lookup"><span data-stu-id="59d79-145">This configuration implements the parallel web dispatcher option described in [High Availability of the SAP Web Dispatcher][sap-dispatcher-ha].</span></span> <span data-ttu-id="59d79-146">O segundo balanceador de carga, exibido à direita, permite o failover no Cluster de Failover do Windows Server, direcionando as conexões de entrada para o nó ativo/íntegro.</span><span class="sxs-lookup"><span data-stu-id="59d79-146">The second load balancer, shown on the right, enables failover in the Windows Server Failover Cluster, by directing incoming connections to the active/healthy node.</span></span>

- <span data-ttu-id="59d79-147">**Gateway de VPN.**</span><span class="sxs-lookup"><span data-stu-id="59d79-147">**VPN Gateway.**</span></span> <span data-ttu-id="59d79-148">Um Gateway de VPN estende sua rede local para a rede virtual do Azure.</span><span class="sxs-lookup"><span data-stu-id="59d79-148">The VPN Gateway extends your on-premises network to the Azure VNet.</span></span> <span data-ttu-id="59d79-149">Você também pode usar o ExpressRoute, que usa uma conexão privada dedicada que não passa pela Internet pública.</span><span class="sxs-lookup"><span data-stu-id="59d79-149">You can also use ExpressRoute, which uses a dedicated private connection that does not go over the public Internet.</span></span> <span data-ttu-id="59d79-150">A solução de exemplo não implanta o gateway.</span><span class="sxs-lookup"><span data-stu-id="59d79-150">The example solution does not deploy the gateway.</span></span> <span data-ttu-id="59d79-151">Para obter mais informações, consulte [Conectar uma rede local ao Azure][hybrid-networking].</span><span class="sxs-lookup"><span data-stu-id="59d79-151">For more information, see [Connect an on-premises network to Azure][hybrid-networking].</span></span>

## <a name="recommendations"></a><span data-ttu-id="59d79-152">Recomendações</span><span class="sxs-lookup"><span data-stu-id="59d79-152">Recommendations</span></span>

<span data-ttu-id="59d79-153">Seus requisitos podem ser diferentes dos requisitos da arquitetura descrita aqui.</span><span class="sxs-lookup"><span data-stu-id="59d79-153">Your requirements might differ from the architecture described here.</span></span> <span data-ttu-id="59d79-154">Use essas recomendações como ponto de partida.</span><span class="sxs-lookup"><span data-stu-id="59d79-154">Use these recommendations as a starting point.</span></span>

### <a name="load-balancers"></a><span data-ttu-id="59d79-155">Balanceadores de carga</span><span class="sxs-lookup"><span data-stu-id="59d79-155">Load balancers</span></span>

<span data-ttu-id="59d79-156">O [SAP Web Dispatcher][sap-dispatcher] lida com o balanceamento de carga do tráfego HTTP(S) para servidores de pilha dupla (ABAP e Java).</span><span class="sxs-lookup"><span data-stu-id="59d79-156">[SAP Web Dispatcher][sap-dispatcher] handles load balancing of HTTP(S) traffic to dual-stack servers (ABAP and Java).</span></span> <span data-ttu-id="59d79-157">A empresa SAP tem defendido servidores de aplicativos de pilha única por anos, então muito poucos aplicativos são executados em um modelo de implantação de pilha dupla hoje em dia.</span><span class="sxs-lookup"><span data-stu-id="59d79-157">SAP has advocated single-stack application servers for years, so very few applications run on a dual-stack deployment model nowadays.</span></span> <span data-ttu-id="59d79-158">O balanceador de carga do Azure mostrado no diagrama da arquitetura implementa o cluster de alta disponibilidade para o SAP Web Dispatcher.</span><span class="sxs-lookup"><span data-stu-id="59d79-158">The Azure load balancer shown in the architecture diagram implements the high availability cluster for the SAP Web Dispatcher.</span></span>

<span data-ttu-id="59d79-159">O balanceamento de carga de tráfego para os servidores de aplicativo é manipulado no SAP.</span><span class="sxs-lookup"><span data-stu-id="59d79-159">Load balancing of traffic to the application servers is handled within SAP.</span></span> <span data-ttu-id="59d79-160">Para o tráfego de clientes SAPGUI conectando-se a um servidor SAP por meio de DIAG e Remote Function Calls (RFC), o servidor de mensagens SCS equilibra a carga por meio da criação do Servidor de Aplicativos SAP [Grupos de Logon][logon-groups].</span><span class="sxs-lookup"><span data-stu-id="59d79-160">For traffic from SAPGUI clients connecting to a SAP server via DIAG and Remote Function Calls (RFC), the SCS message server balances the load by creating SAP App Server [Logon Groups][logon-groups].</span></span> 

<span data-ttu-id="59d79-161">SMLG é uma transação SAP ABAP usada para gerenciar o recurso de balanceamento de carga de logon do SAP Central Services.</span><span class="sxs-lookup"><span data-stu-id="59d79-161">SMLG is an SAP ABAP transaction used to manage the logon load balancing capability of SAP Central Services.</span></span> <span data-ttu-id="59d79-162">O pool de back-end do grupo de logon tem mais de um servidor de aplicativo ABAP.</span><span class="sxs-lookup"><span data-stu-id="59d79-162">The backend pool of the logon group has more than one ABAP application server.</span></span> <span data-ttu-id="59d79-163">Clientes que acessam os serviços de cluster ASCS conectam-se ao balanceador de carga do Azure por meio de um endereço IP de front-end.</span><span class="sxs-lookup"><span data-stu-id="59d79-163">Clients accessing ASCS cluster services connect to the Azure load balancer through a frontend IP address.</span></span> <span data-ttu-id="59d79-164">O nome de rede virtual do cluster ASCS também possui um endereço IP.</span><span class="sxs-lookup"><span data-stu-id="59d79-164">The ASCS cluster virtual network name also has an IP address.</span></span> <span data-ttu-id="59d79-165">Opcionalmente, esse endereço pode ser associado a um endereço IP adicional no balanceador de carga do Azure, para que o cluster possa ser gerenciado remotamente.</span><span class="sxs-lookup"><span data-stu-id="59d79-165">Optionally, this address can be associated with an additional IP address on the Azure load balancer, so that the cluster can be managed remotely.</span></span>  

### <a name="nics"></a><span data-ttu-id="59d79-166">NICs</span><span class="sxs-lookup"><span data-stu-id="59d79-166">NICs</span></span>

<span data-ttu-id="59d79-167">As funções de gerenciamento de paisagem SAP exigem diferenciação de tráfego do servidor nas diferentes NICs.</span><span class="sxs-lookup"><span data-stu-id="59d79-167">SAP landscape management functions require segregation of server traffic on different NICs.</span></span> <span data-ttu-id="59d79-168">Por exemplo, dados de negócios devem ser separados de tráfego administrativo e de backup.</span><span class="sxs-lookup"><span data-stu-id="59d79-168">For example, business data should be separated from administrative traffic and backup traffic.</span></span> <span data-ttu-id="59d79-169">Atribuir várias NICs em diferentes sub-redes permite a diferenciação de dados.</span><span class="sxs-lookup"><span data-stu-id="59d79-169">Assigning multiple NICs to different subnets enables this data segregation.</span></span> <span data-ttu-id="59d79-170">Para obter mais informações, consulte "Rede" em [Criar Alta Disponibilidade para o SAP NetWeaver e o SAP HANA][sap-ha] (PDF).</span><span class="sxs-lookup"><span data-stu-id="59d79-170">For more information, see "Network" in [Building High Availability for SAP NetWeaver and SAP HANA][sap-ha] (PDF).</span></span>

<span data-ttu-id="59d79-171">Atribua a NIC de administração à sub-rede de gerenciamento e atribua a NIC de comunicação de dados a uma sub-rede separada.</span><span class="sxs-lookup"><span data-stu-id="59d79-171">Assign the administration NIC to the management subnet, and assign the data communication NIC to a separate subnet.</span></span> <span data-ttu-id="59d79-172">Para obter detalhes sobre a configuração, consulte [Criar e gerencia uma máquina virtual do Windows que tem várias NICs][multiple-vm-nics].</span><span class="sxs-lookup"><span data-stu-id="59d79-172">For configuration details, see [Create and manage a Windows virtual machine that has multiple NICs][multiple-vm-nics].</span></span>

### <a name="azure-storage"></a><span data-ttu-id="59d79-173">Armazenamento do Azure</span><span class="sxs-lookup"><span data-stu-id="59d79-173">Azure Storage</span></span>

<span data-ttu-id="59d79-174">Recomendamos usar o Armazenamento Premium do Azure para latência de leitura/gravação consistente em todas as VMs do servidor de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="59d79-174">With all database server VMs, we recommend using Azure Premium Storage for consistent read/write latency.</span></span> <span data-ttu-id="59d79-175">Para servidores de aplicativos SAP, incluindo as máquinas virtuais (A)SCS, você pode usar o Armazenamento Padrão do Azure, já que a execução do aplicativo ocorre na memória e utiliza discos somente para registro em log.</span><span class="sxs-lookup"><span data-stu-id="59d79-175">For SAP application servers, including the (A)SCS virtual machines, you can use Azure Standard Storage, because application execution takes place in memory and uses disks for logging only.</span></span>

<span data-ttu-id="59d79-176">Para melhor confiabilidade, é recomendável usar o [Azure Managed Disks][managed-disks].</span><span class="sxs-lookup"><span data-stu-id="59d79-176">For best reliability, we recommend using [Azure Managed Disks][managed-disks].</span></span> <span data-ttu-id="59d79-177">Os discos gerenciados garantem que os discos para VMs dentro de um conjunto de disponibilidade são isolados para evitar pontos únicos de falha.</span><span class="sxs-lookup"><span data-stu-id="59d79-177">Managed disks ensure that the disks for VMs within an availability set are isolated to avoid single points of failure.</span></span>

> [!NOTE]
> <span data-ttu-id="59d79-178">Atualmente o modelo do Resource Manager para esta arquitetura de referência não utiliza discos gerenciados.</span><span class="sxs-lookup"><span data-stu-id="59d79-178">Currently the Resource Manager template for this reference architecture does not use managed disks.</span></span> <span data-ttu-id="59d79-179">Estamos planejando atualizar o modelo para usar discos gerenciados.</span><span class="sxs-lookup"><span data-stu-id="59d79-179">We are planning to update the template to use managed disks.</span></span>

<span data-ttu-id="59d79-180">Para obter IOPS e taxa de transferência do disco da largura de banda altos, as práticas comuns na otimização de desempenho do volume de armazenamento se aplicam ao layout de armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="59d79-180">To achieve high IOPS and disk bandwidth throughput, the common practices in storage volume performance optimization apply to Azure storage layout.</span></span> <span data-ttu-id="59d79-181">Por exemplo, a distribuição de vários discos em conjunto para criar um volume de disco maior melhora o desempenho de E/S.</span><span class="sxs-lookup"><span data-stu-id="59d79-181">For example, striping multiple disks together to create a larger disk volume improves IO performance.</span></span> <span data-ttu-id="59d79-182">Habilitar o cache de leitura do conteúdo de armazenamento que raramente é alterado melhora a velocidade de recuperação de dados.</span><span class="sxs-lookup"><span data-stu-id="59d79-182">Enabling the read cache on storage content that changes infrequently enhances the speed of data retrieval.</span></span> <span data-ttu-id="59d79-183">Para obter detalhes sobre os requisitos de desempenho, consulte [Nota SAP 1943937 - Ferramenta de verificação de configuração de hardware][sap-1943937].</span><span class="sxs-lookup"><span data-stu-id="59d79-183">For details about performance requirements, see [SAP note 1943937 - Hardware Configuration Check Tool][sap-1943937].</span></span>

<span data-ttu-id="59d79-184">Para o armazenamento de dados de backup, é recomendável usar a [camada de armazenamento esporádico][cool-blob-storage] do Armazenamento de Blobs do Azure.</span><span class="sxs-lookup"><span data-stu-id="59d79-184">For the backup data store, we recommend using the [cool storage tier][cool-blob-storage] of Azure Blob storage.</span></span> <span data-ttu-id="59d79-185">A camada de armazenamento esporádico é uma forma econômica para armazenar dados que são acessados com menos frequência e de longa duração.</span><span class="sxs-lookup"><span data-stu-id="59d79-185">The cool storage tier is a cost-effective way to store data that is less frequently accessed and long-lived.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="59d79-186">Considerações sobre escalabilidade</span><span class="sxs-lookup"><span data-stu-id="59d79-186">Scalability considerations</span></span>

<span data-ttu-id="59d79-187">Na camada de aplicativo SAP, o Azure oferece uma ampla variedade de tamanhos de máquina virtual para expansão.</span><span class="sxs-lookup"><span data-stu-id="59d79-187">At the SAP application layer, Azure offers a wide range of virtual machine sizes for scaling up.</span></span> <span data-ttu-id="59d79-188">Para obter uma lista inclusiva, consulte [Nota SAP 1928533 - Aplicativos SAP no Azure: Tipos de VM do Azure e produtos com suporte][sap-1928533].</span><span class="sxs-lookup"><span data-stu-id="59d79-188">For an inclusive list, see [SAP note 1928533 - SAP Applications on Azure: Supported Products and Azure VM Types][sap-1928533].</span></span> <span data-ttu-id="59d79-189">Faça a expansão adicionando mais VMs ao conjunto de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="59d79-189">Scale out by adding more VMs to the availability set.</span></span>

<span data-ttu-id="59d79-190">Para o SAP HANA em máquinas virtuais do Azure com aplicativos OLTP e OLAP SAP, o tamanho da máquina de virtual com certificação SAP é GS5 com uma única instância VM.</span><span class="sxs-lookup"><span data-stu-id="59d79-190">For SAP HANA on Azure virtual machines with both OLTP and OLAP SAP applications, the SAP-certified virtual machine size is GS5 with a single VM instance.</span></span> <span data-ttu-id="59d79-191">Para cargas de trabalho maiores, a Microsoft também oferece [Grandes Instâncias do Azure][azure-large-instances] para SAP HANA em servidores físicos co-localizados em um datacenter certificado do Microsoft Azure, que fornece até 4 TB de capacidade de memória para uma única instância no momento.</span><span class="sxs-lookup"><span data-stu-id="59d79-191">For larger workloads, Microsoft also offers [Azure Large Instances][azure-large-instances] for SAP HANA on physical servers co-located in a Microsoft Azure certified datacenter, which provides up to 4 TB of memory capacity for a single instance at this time.</span></span> <span data-ttu-id="59d79-192">Uma configuração de vários nós também é possível com uma capacidade de memória total de até 32 TB.</span><span class="sxs-lookup"><span data-stu-id="59d79-192">Multi-node configuration is also possible with a total memory capacity of up to 32 TB.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="59d79-193">Considerações sobre disponibilidade</span><span class="sxs-lookup"><span data-stu-id="59d79-193">Availability considerations</span></span>

<span data-ttu-id="59d79-194">Nesta instalação distribuída do aplicativo SAP em um banco de dados centralizado, a instalação básica é replicada para alcançar alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="59d79-194">In this distributed installation of the SAP application on a centralized database, the base installation is replicated to achieve high availability.</span></span> <span data-ttu-id="59d79-195">Para cada camada da arquitetura, o design de alta disponibilidade varia:</span><span class="sxs-lookup"><span data-stu-id="59d79-195">For each layer of the architecture, the high availability design varies:</span></span>

- <span data-ttu-id="59d79-196">**Web Dispatcher.**</span><span class="sxs-lookup"><span data-stu-id="59d79-196">**Web Dispatcher.**</span></span> <span data-ttu-id="59d79-197">A alta disponibilidade é obtida com instâncias redundantes do SAP Web Dispatcher com o tráfego do aplicativo SAP.</span><span class="sxs-lookup"><span data-stu-id="59d79-197">High availability is achieved with redundant SAP Web Dispatcher instances with SAP application traffic.</span></span> <span data-ttu-id="59d79-198">Consulte [SAP Web Dispatcher][swd] na documentação do SAP.</span><span class="sxs-lookup"><span data-stu-id="59d79-198">See [SAP Web Dispatcher][swd] in the SAP Documentation.</span></span>

- <span data-ttu-id="59d79-199">**ASCS.**</span><span class="sxs-lookup"><span data-stu-id="59d79-199">**ASCS.**</span></span> <span data-ttu-id="59d79-200">Para obter uma alta disponibilidade do ASCS em máquinas virtuais do Windows Azure, o Clustering de Failover do Windows Server é usado com o SIOS DataKeeper para implementar o volume compartilhado de cluster.</span><span class="sxs-lookup"><span data-stu-id="59d79-200">For high availability of ASCS on Azure Windows virtual machines, Windows Sever Failover Clustering is used with SIOS DataKeeper to implement the cluster shared volume.</span></span> <span data-ttu-id="59d79-201">Para obter detalhes de implementação, consulte [Clustering do SAP ASCS no Azure][clustering].</span><span class="sxs-lookup"><span data-stu-id="59d79-201">For implementation details, see [Clustering SAP ASCS on Azure][clustering].</span></span>

- <span data-ttu-id="59d79-202">**Servidores de aplicativos.**</span><span class="sxs-lookup"><span data-stu-id="59d79-202">**Application servers.**</span></span> <span data-ttu-id="59d79-203">A alta disponibilidade é obtida pelo tráfego de balanceamento de carga dentro de um pool de servidores de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="59d79-203">High availability is achieved by load balancing traffic within a pool of application servers.</span></span>

- <span data-ttu-id="59d79-204">**Camada de banco de dados.**</span><span class="sxs-lookup"><span data-stu-id="59d79-204">**Database tier.**</span></span> <span data-ttu-id="59d79-205">Essa arquitetura de referência implanta uma única instância de banco de dados do SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="59d79-205">This reference architecture deploys a single SAP HANA database instance.</span></span> <span data-ttu-id="59d79-206">Para obter alta disponibilidade, faça a implantação de mais de uma instância e usar a Replicação de Sistema do HANA (HSR) para implementar o failover manual.</span><span class="sxs-lookup"><span data-stu-id="59d79-206">For high availability, deploy more than one instance and use HANA System Replication (HSR) to implement manual failover.</span></span> <span data-ttu-id="59d79-207">Para habilitar o failover automático, uma extensão de alta disponibilidade para a distribuição de Linux específica é necessária.</span><span class="sxs-lookup"><span data-stu-id="59d79-207">To enable automatic failover, an HA extension for the specific Linux distribution is required.</span></span>

### <a name="disaster-recovery-considerations"></a><span data-ttu-id="59d79-208">Considerações de recuperação de desastres</span><span class="sxs-lookup"><span data-stu-id="59d79-208">Disaster recovery considerations</span></span>

<span data-ttu-id="59d79-209">Cada camada usa uma estratégia diferente para fornecer proteção de recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="59d79-209">Each tier uses a different strategy to provide disaster recovery (DR) protection.</span></span>

- <span data-ttu-id="59d79-210">**Servidores de aplicativos.**</span><span class="sxs-lookup"><span data-stu-id="59d79-210">**Application servers.**</span></span> <span data-ttu-id="59d79-211">Servidores de aplicativos SAP não contêm dados corporativos.</span><span class="sxs-lookup"><span data-stu-id="59d79-211">SAP application servers don't contain business data.</span></span> <span data-ttu-id="59d79-212">No Azure, uma estratégia simples de recuperação de desastres é criar servidores de aplicativos SAP em outra região.</span><span class="sxs-lookup"><span data-stu-id="59d79-212">On Azure, a simple DR strategy is to create SAP application servers in another region.</span></span> <span data-ttu-id="59d79-213">Após quaisquer alterações de configuração ou atualizações de kernel no servidor de aplicativo primário, as mesmas alterações devem ser copiadas para VMs na região de recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="59d79-213">Upon any configuration changes or kernel updates on the primary application server, the same changes must be copied to VMs in the DR region.</span></span> <span data-ttu-id="59d79-214">Por exemplo, os executáveis de kernel copiados para as VMs de recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="59d79-214">For example, the kernel executables copied to the DR VMs.</span></span>

- <span data-ttu-id="59d79-215">**SAP Central Services.**</span><span class="sxs-lookup"><span data-stu-id="59d79-215">**SAP Central Services.**</span></span> <span data-ttu-id="59d79-216">Este componente da pilha do aplicativo SAP também não mantém dados corporativos.</span><span class="sxs-lookup"><span data-stu-id="59d79-216">This component of the SAP application stack also doesn't persist business data.</span></span> <span data-ttu-id="59d79-217">Você pode criar uma VM na região de recuperação de desastres para executar a função SCS.</span><span class="sxs-lookup"><span data-stu-id="59d79-217">You can build a VM in the DR region to run the SCS role.</span></span> <span data-ttu-id="59d79-218">O único conteúdo do nó SCS primário a ser sincronizado é o conteúdo compartilhado **/sapmnt**.</span><span class="sxs-lookup"><span data-stu-id="59d79-218">The only content from the primary SCS node to synchronize is the **/sapmnt** share content.</span></span> <span data-ttu-id="59d79-219">Além disso, se as alterações de configuração ou atualizações de kernel ocorrem em servidores do SCS primários, elas devem ser repetidas no SCS de recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="59d79-219">Also, if configuration changes or kernel updates take place on the primary SCS servers, they must be repeated on the DR SCS.</span></span> <span data-ttu-id="59d79-220">Para sincronizar os dois servidores, basta usar um trabalho de cópia agendado regularmente para copiar **/sapmnt** para o lado de recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="59d79-220">To synchronize the two servers, simply use a regularly scheduled copy job to copy **/sapmnt** to the DR side.</span></span> <span data-ttu-id="59d79-221">Para obter detalhes sobre a criação, cópia e o processo de failover de teste, baixe [SAP NetWeaver: Criando uma solução de recuperação de desastres baseada em Hyper-V e no Microsoft Azure][sap-netweaver-dr] e consulte "4.3.</span><span class="sxs-lookup"><span data-stu-id="59d79-221">For details about the build, copy, and test failover process, download [SAP NetWeaver: Building a Hyper-V and Microsoft Azure–based Disaster Recovery Solution][sap-netweaver-dr], and refer to "4.3.</span></span> <span data-ttu-id="59d79-222">Camada SAP SPOF (ASCS)."</span><span class="sxs-lookup"><span data-stu-id="59d79-222">SAP SPOF layer (ASCS)."</span></span>

- <span data-ttu-id="59d79-223">**Camada de banco de dados.**</span><span class="sxs-lookup"><span data-stu-id="59d79-223">**Database tier.**</span></span> <span data-ttu-id="59d79-224">Use soluções de replicação com suporte HANA como HSR ou Replicação de Armazenamento.</span><span class="sxs-lookup"><span data-stu-id="59d79-224">Use HANA-supported replication solutions such as HSR or Storage Replication.</span></span> 

## <a name="manageability-considerations"></a><span data-ttu-id="59d79-225">Considerações sobre capacidade de gerenciamento</span><span class="sxs-lookup"><span data-stu-id="59d79-225">Manageability considerations</span></span>

<span data-ttu-id="59d79-226">O SAP HANA possui um recurso de backup que usa a infraestrutura subjacente do Azure.</span><span class="sxs-lookup"><span data-stu-id="59d79-226">SAP HANA has a backup feature that uses the underlying Azure infrastructure.</span></span> <span data-ttu-id="59d79-227">Para fazer backup do banco de dados do SAP HANA em execução em máquinas virtuais do Azure, o instantâneo do armazenamento do Azure e o instantâneo do SAP HANA são usados para garantir a consistência dos arquivos de backup.</span><span class="sxs-lookup"><span data-stu-id="59d79-227">To back up the SAP HANA database running on Azure virtual machines, both the SAP HANA snapshot and Azure storage snapshot are used to ensure the consistency of backup files.</span></span> <span data-ttu-id="59d79-228">Para obter detalhes, consulte o [Guia de backup para o SAP HANA em máquinas virtuais do Azure][hana-backup] e [Perguntas frequentes sobre o serviço de Backup do Azure][backup-faq].</span><span class="sxs-lookup"><span data-stu-id="59d79-228">For details, see [Backup guide for SAP HANA on Azure Virtual Machines][hana-backup] and the [Azure Backup service FAQ][backup-faq].</span></span>

<span data-ttu-id="59d79-229">O Azure fornece várias funções para [monitoramento e diagnóstico][monitoring] da infra-estrutura geral.</span><span class="sxs-lookup"><span data-stu-id="59d79-229">Azure provides several functions for [monitoring and diagnostics][monitoring] of the overall infrastructure.</span></span> <span data-ttu-id="59d79-230">Além disso, o monitoramento avançado de máquinas virtuais do Azure (Linux ou Windows) é tratado pelo Azure Operations Management Suite (OMS).</span><span class="sxs-lookup"><span data-stu-id="59d79-230">Also, enhanced monitoring of Azure virtual machines (Linux or Windows) is handled by Azure Operations Management Suite (OMS).</span></span>

<span data-ttu-id="59d79-231">Para fornecer monitoramento de recursos baseado em SAP e desempenho de serviço da infraestrutura do SAP, use a extensão de monitoramento aprimorado do SAP do Azure.</span><span class="sxs-lookup"><span data-stu-id="59d79-231">To provide SAP-based monitoring of resources and service performance of the SAP infrastructure, use the Azure SAP Enhanced Monitoring extension.</span></span> <span data-ttu-id="59d79-232">Essa extensão fornece as estatísticas de monitoramento do Azure para o aplicativo SAP para monitoramento do sistema operacional e as funções da ferramenta cockpit de DBA.</span><span class="sxs-lookup"><span data-stu-id="59d79-232">This extension feeds Azure monitoring statistics into the SAP application for operating system monitoring and DBA Cockpit functions.</span></span> 

## <a name="security-considerations"></a><span data-ttu-id="59d79-233">Considerações de segurança</span><span class="sxs-lookup"><span data-stu-id="59d79-233">Security considerations</span></span>

<span data-ttu-id="59d79-234">O SAP tem seu próprio mecanismo de gerenciamento de usuários (UME) para controlar o acesso e a autorização baseados em função do aplicativo SAP.</span><span class="sxs-lookup"><span data-stu-id="59d79-234">SAP has its own Users Management Engine (UME) to control role-based access and authorization within the SAP application.</span></span> <span data-ttu-id="59d79-235">Para obter detalhes, consulte [Segurança do SAP HANA - Uma visão geral][sap-security].</span><span class="sxs-lookup"><span data-stu-id="59d79-235">For details, see [SAP HANA Security - An Overview][sap-security].</span></span> <span data-ttu-id="59d79-236">(Uma conta do SAP Service Marketplace é necessária para o acesso.)</span><span class="sxs-lookup"><span data-stu-id="59d79-236">(A SAP Service Marketplace account is required for access.)</span></span>

<span data-ttu-id="59d79-237">Para segurança da infraestrutura, os dados são protegidos em trânsito e em repouso.</span><span class="sxs-lookup"><span data-stu-id="59d79-237">For infrastructure security, data is safeguarded in transit and at rest.</span></span> <span data-ttu-id="59d79-238">A seção "Considerações sobre segurança" do [SAP NetWeaver nas máquinas virtuais (VMs) do Azure – Guia de planejamento e implementação][netweaver-on-azure] começa a tratar da segurança de rede.</span><span class="sxs-lookup"><span data-stu-id="59d79-238">The “Security considerations” section of the [SAP NetWeaver on Azure Virtual Machines (VMs) – Planning and Implementation Guide][netweaver-on-azure] begins to address network security.</span></span> <span data-ttu-id="59d79-239">O guia também especifica as portas de rede que você deve abrir nos firewalls para permitir a comunicação do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="59d79-239">The guide also specifies the network ports you must open on the firewalls to allow application communication.</span></span> 

<span data-ttu-id="59d79-240">Para criptografar os discos de máquina virtual do IaaS Windows e Linux, você pode usar o [Azure Disk Encryption][disk-encryption].</span><span class="sxs-lookup"><span data-stu-id="59d79-240">To encrypt Windows and Linux IaaS virtual machine disks, you can use [Azure Disk Encryption][disk-encryption].</span></span> <span data-ttu-id="59d79-241">O Azure Disk Encryption usa o recurso BitLocker do Windows e o recurso DM-Crypt do Linux para fornecer uma criptografia de volume para o sistema operacional e os discos de dados.</span><span class="sxs-lookup"><span data-stu-id="59d79-241">Azure Disk Encryption uses the BitLocker feature of Windows and the DM-Crypt feature of Linux to provide volume encryption for the operating system and the data disks.</span></span> <span data-ttu-id="59d79-242">A solução também funciona com o Azure Key Vault para ajudá-lo a controlar e gerenciar os segredos e chaves de criptografia de disco em sua assinatura do Key Vault.</span><span class="sxs-lookup"><span data-stu-id="59d79-242">The solution also works with Azure Key Vault to help you control and manage the disk-encryption keys and secrets in your Key Vault subscription.</span></span> <span data-ttu-id="59d79-243">Os dados em discos da máquina virtual são criptografados em repouso no armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="59d79-243">Data on the virtual machine disks are encrypted at rest in your Azure storage.</span></span>

<span data-ttu-id="59d79-244">Para criptografia de dados em repouso do SAP HANA, é recomendável usar a tecnologia de criptografia nativa do SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="59d79-244">For SAP HANA data-at-rest encryption, we recommend using the SAP HANA native encryption technology.</span></span>

> [!NOTE]
> <span data-ttu-id="59d79-245">Não use a criptografia de dados em repouso HANA com criptografia de disco do Azure no mesmo servidor.</span><span class="sxs-lookup"><span data-stu-id="59d79-245">Don't use the HANA data-at-rest encryption with Azure disk encryption on the same server.</span></span>

<span data-ttu-id="59d79-246">Considere o uso de [grupos de segurança de rede][nsg] (NSGs) para restringir o tráfego entre as várias sub-redes na rede virtual.</span><span class="sxs-lookup"><span data-stu-id="59d79-246">Consider using [network security groups][nsg] (NSGs) to restrict traffic between the various subnets in the VNet.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="59d79-247">Implantar a solução</span><span class="sxs-lookup"><span data-stu-id="59d79-247">Deploy the solution</span></span> 

<span data-ttu-id="59d79-248">Os scripts de implantação para essa arquitetura de referência estão disponíveis no [GitHub][github].</span><span class="sxs-lookup"><span data-stu-id="59d79-248">The deployment scripts for this reference architecture are available on [GitHub][github].</span></span>


### <a name="prerequisites"></a><span data-ttu-id="59d79-249">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="59d79-249">Prerequisites</span></span>

- <span data-ttu-id="59d79-250">Você deve ter acesso ao Centro de Download de Software SAP para concluir a instalação.</span><span class="sxs-lookup"><span data-stu-id="59d79-250">You must have access to the SAP Software Download Center to complete the installation.</span></span>
 
- <span data-ttu-id="59d79-251">Instale a versão mais recente do [Azure PowerShell][azure-ps].</span><span class="sxs-lookup"><span data-stu-id="59d79-251">Install the latest version of [Azure PowerShell][azure-ps].</span></span> 

- <span data-ttu-id="59d79-252">Essa implantação exige 51 núcleos.</span><span class="sxs-lookup"><span data-stu-id="59d79-252">This deployment requires 51 cores.</span></span> <span data-ttu-id="59d79-253">Antes de implantar, verifique se sua assinatura tem cota suficiente de núcleos VM.</span><span class="sxs-lookup"><span data-stu-id="59d79-253">Before deploying, verify that your subscription has sufficient quota for VM cores.</span></span> <span data-ttu-id="59d79-254">Caso não tenha, use o portal do Azure para enviar uma solicitação de suporte para mais cota.</span><span class="sxs-lookup"><span data-stu-id="59d79-254">If not, use the Azure portal to submit a support request for more quota.</span></span>
 
- <span data-ttu-id="59d79-255">Essa implantação usa a máquina virtual da série GS.</span><span class="sxs-lookup"><span data-stu-id="59d79-255">This deployment uses a GS-series VM.</span></span> <span data-ttu-id="59d79-256">Verifique a disponibilidade da série GS por região [aqui][region-availability].</span><span class="sxs-lookup"><span data-stu-id="59d79-256">Check the availability of the GS series per region [here][region-availability].</span></span>

- <span data-ttu-id="59d79-257">Para estimar o custo da implantação, consulte a [Calculadora de Preços do Azure][azure-pricing].</span><span class="sxs-lookup"><span data-stu-id="59d79-257">To estimate the cost of this deployment, see the [Azure Pricing Calculator][azure-pricing].</span></span> 
 
<span data-ttu-id="59d79-258">Essa arquitetura de referência implanta as máquinas virtuais a seguir:</span><span class="sxs-lookup"><span data-stu-id="59d79-258">This reference architecture deploys the following VMs:</span></span>

| <span data-ttu-id="59d79-259">Nome do recurso</span><span class="sxs-lookup"><span data-stu-id="59d79-259">Resource name</span></span> | <span data-ttu-id="59d79-260">Tamanho da VM</span><span class="sxs-lookup"><span data-stu-id="59d79-260">VM Size</span></span> | <span data-ttu-id="59d79-261">Finalidade</span><span class="sxs-lookup"><span data-stu-id="59d79-261">Purpose</span></span>  |
|---------------|---------|----------|
| <span data-ttu-id="59d79-262">`ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`</span><span class="sxs-lookup"><span data-stu-id="59d79-262">`ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`</span></span> | <span data-ttu-id="59d79-263">DS11v2</span><span class="sxs-lookup"><span data-stu-id="59d79-263">DS11v2</span></span> | <span data-ttu-id="59d79-264">SAP Central Services</span><span class="sxs-lookup"><span data-stu-id="59d79-264">SAP Central Services</span></span> |
| <span data-ttu-id="59d79-265">`ra-sapApps-vm1` ... `ra-sapApps-vmN`</span><span class="sxs-lookup"><span data-stu-id="59d79-265">`ra-sapApps-vm1` ... `ra-sapApps-vmN`</span></span> | <span data-ttu-id="59d79-266">DS11v2</span><span class="sxs-lookup"><span data-stu-id="59d79-266">DS11v2</span></span> | <span data-ttu-id="59d79-267">Aplicativo SAP NetWeaver</span><span class="sxs-lookup"><span data-stu-id="59d79-267">SAP NetWeaver application</span></span> |
| <span data-ttu-id="59d79-268">`ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`</span><span class="sxs-lookup"><span data-stu-id="59d79-268">`ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`</span></span> | <span data-ttu-id="59d79-269">DS11v2</span><span class="sxs-lookup"><span data-stu-id="59d79-269">DS11v2</span></span> | <span data-ttu-id="59d79-270">SAP Web Dispatcher</span><span class="sxs-lookup"><span data-stu-id="59d79-270">SAP Web Dispatcher</span></span> |
| `ra-sap-data-vm1` | <span data-ttu-id="59d79-271">GS5</span><span class="sxs-lookup"><span data-stu-id="59d79-271">GS5</span></span> | <span data-ttu-id="59d79-272">Instância de banco de dados do SAP HANA</span><span class="sxs-lookup"><span data-stu-id="59d79-272">SAP HANA database instance</span></span> |
| `ra-sap-jumpbox-vm1` | <span data-ttu-id="59d79-273">DS1V2</span><span class="sxs-lookup"><span data-stu-id="59d79-273">DS1V2</span></span> | <span data-ttu-id="59d79-274">Jumpbox</span><span class="sxs-lookup"><span data-stu-id="59d79-274">Jumpbox</span></span> |

<span data-ttu-id="59d79-275">Uma única instância do SAP HANA é implantada.</span><span class="sxs-lookup"><span data-stu-id="59d79-275">A single SAP HANA instance is deployed.</span></span> <span data-ttu-id="59d79-276">Para as VMs de aplicativo, o número de instâncias a implantar é especificado nos parâmetros do modelo.</span><span class="sxs-lookup"><span data-stu-id="59d79-276">For the application VMs, the number of instances to deploy is specified in the template parameters.</span></span>

### <a name="deploy-sap-infrastructure"></a><span data-ttu-id="59d79-277">Implantar a infraestrutura SAP</span><span class="sxs-lookup"><span data-stu-id="59d79-277">Deploy SAP infrastructure</span></span>

<span data-ttu-id="59d79-278">Você pode implantar essa arquitetura incrementalmente ou de uma só vez.</span><span class="sxs-lookup"><span data-stu-id="59d79-278">You can deploy this architecture incrementally or all at once.</span></span> <span data-ttu-id="59d79-279">Na primeira vez, é recomendável uma implantação incremental, para que você possa ver o que cada etapa da implantação faz.</span><span class="sxs-lookup"><span data-stu-id="59d79-279">The first time, we recommend an incremental deployment, so that you can see what each deployment step does.</span></span> <span data-ttu-id="59d79-280">Especificar o incremento usando um dos seguintes parâmetros de *modo*</span><span class="sxs-lookup"><span data-stu-id="59d79-280">Specify the increment using one of the following *mode* parameters</span></span>

| <span data-ttu-id="59d79-281">Modo</span><span class="sxs-lookup"><span data-stu-id="59d79-281">Mode</span></span>           | <span data-ttu-id="59d79-282">O que faz</span><span class="sxs-lookup"><span data-stu-id="59d79-282">What it does</span></span>                                                                                                            |
|----------------|-----------------------------------------------------|
| <span data-ttu-id="59d79-283">infrastructure</span><span class="sxs-lookup"><span data-stu-id="59d79-283">infrastructure</span></span> | <span data-ttu-id="59d79-284">Definir a infraestrutura de rede no Azure.</span><span class="sxs-lookup"><span data-stu-id="59d79-284">Deploys the network infrastructure in Azure.</span></span>        |
| <span data-ttu-id="59d79-285">workload</span><span class="sxs-lookup"><span data-stu-id="59d79-285">workload</span></span>       | <span data-ttu-id="59d79-286">Implanta os servidores SAP na rede.</span><span class="sxs-lookup"><span data-stu-id="59d79-286">Deploys the SAP servers to the network.</span></span>             |
| <span data-ttu-id="59d79-287">tudo</span><span class="sxs-lookup"><span data-stu-id="59d79-287">all</span></span>            | <span data-ttu-id="59d79-288">Implanta todas as implantações anteriores.</span><span class="sxs-lookup"><span data-stu-id="59d79-288">Deploys all the preceding deployments.</span></span>              |

<span data-ttu-id="59d79-289">Para implantar a solução, execute as etapas a seguir:</span><span class="sxs-lookup"><span data-stu-id="59d79-289">To deploy the solution, perform the following steps:</span></span>

1. <span data-ttu-id="59d79-290">Baixe ou clone o [repositório GitHub][github] no computador local.</span><span class="sxs-lookup"><span data-stu-id="59d79-290">Download or clone the [GitHub repo][github] to your local computer.</span></span>

2. <span data-ttu-id="59d79-291">Abra uma janela do PowerShell e navegue até a pasta `/sap/sap-hana/`.</span><span class="sxs-lookup"><span data-stu-id="59d79-291">Open a PowerShell window and navigate to the `/sap/sap-hana/` folder.</span></span>

3. <span data-ttu-id="59d79-292">Execute o seguinte cmdlet do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="59d79-292">Run the following PowerShell cmdlet.</span></span> <span data-ttu-id="59d79-293">Para `<subscription id>`, insira sua ID da assinatura do Azure.</span><span class="sxs-lookup"><span data-stu-id="59d79-293">For `<subscription id>`, use your Azure subscription ID.</span></span> <span data-ttu-id="59d79-294">Para `<location>`, especifique uma região do Azure, tal como `eastus` ou `westus`.</span><span class="sxs-lookup"><span data-stu-id="59d79-294">For `<location>`, specify an Azure region, such as `eastus` or `westus`.</span></span> <span data-ttu-id="59d79-295">Para `<mode>`, especifique um dos modos listados acima.</span><span class="sxs-lookup"><span data-stu-id="59d79-295">For `<mode>`, specify one of the modes listed above.</span></span>

    ```powershell
     .\Deploy-ReferenceArchitecture -SubscriptionId <subscription id> -Location <location> -ResourceGroupName <resource group> <mode>
    ```

4.  <span data-ttu-id="59d79-296">Quando solicitado, entre em sua conta do Azure.</span><span class="sxs-lookup"><span data-stu-id="59d79-296">When prompted, log on to your Azure account.</span></span> 

<span data-ttu-id="59d79-297">Os scripts de implantação podem demorar várias horas para serem concluídos, dependendo do modo selecionado.</span><span class="sxs-lookup"><span data-stu-id="59d79-297">The deployment scripts can take up to several hours to complete, depending on the mode you selected.</span></span>

> [!WARNING]
> <span data-ttu-id="59d79-298">Os arquivos de parâmetro incluem uma senha embutida (`AweS0me@PW`) em vários locais.</span><span class="sxs-lookup"><span data-stu-id="59d79-298">The parameter files include a hard-coded password (`AweS0me@PW`) in various places.</span></span> <span data-ttu-id="59d79-299">Altere esses valores antes de fazer a implantação.</span><span class="sxs-lookup"><span data-stu-id="59d79-299">Change these values before you deploy.</span></span>
 
### <a name="configure-sap-applications-and-database"></a><span data-ttu-id="59d79-300">Configurar o banco de dados e aplicativos SAP</span><span class="sxs-lookup"><span data-stu-id="59d79-300">Configure SAP applications and database</span></span>

<span data-ttu-id="59d79-301">Depois de implantar a infraestrutura do SAP, instale e configure seus aplicativos do SAP e o banco de dados do HANA nas máquinas virtuais, conforme a seguir.</span><span class="sxs-lookup"><span data-stu-id="59d79-301">After deploying the SAP infrastructure, install and configure your SAP applications and HANA database on the virtual machines as follows.</span></span>

> [!NOTE]
> <span data-ttu-id="59d79-302">Para obter instruções de instalação do SAP, você deve ter um nome de usuário do Portal de suporte do SAP e uma senha para baixar o [guias de instalação do SAP][sap-guide].</span><span class="sxs-lookup"><span data-stu-id="59d79-302">For SAP installation instructions, you must have a SAP Support Portal username and password to download the [SAP installation guides][sap-guide].</span></span>

1. <span data-ttu-id="59d79-303">Faça logon na jumpbox (`ra-sap-jumpbox-vm1`).</span><span class="sxs-lookup"><span data-stu-id="59d79-303">Log into the jumpbox (`ra-sap-jumpbox-vm1`).</span></span> <span data-ttu-id="59d79-304">Você usará o jumpbox para fazer logon em outras VMs.</span><span class="sxs-lookup"><span data-stu-id="59d79-304">You will use the jumpbox to log into the other VMs.</span></span> 

2.  <span data-ttu-id="59d79-305">Para cada VM denominada `ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`, faça logon na VM e instale e configure a instância do SAP Web Dispatcher usando as etapas descritas no wiki [Instalação do Web Dispatcher][sap-dispatcher-install].</span><span class="sxs-lookup"><span data-stu-id="59d79-305">For each VM named `ra-sap-wdp-vm1` ... `ra-sap-wdp-vmN`, log into the VM, and install and configure the SAP Web Dispatcher instance using the steps described in the [Web Dispatcher Installation][sap-dispatcher-install] wiki.</span></span>

3.  <span data-ttu-id="59d79-306">Faça logon na VM denominada `ra-sap-data-vm1`.</span><span class="sxs-lookup"><span data-stu-id="59d79-306">Log into the VM named `ra-sap-data-vm1`.</span></span> <span data-ttu-id="59d79-307">Instalar e configurar a instância de banco de dados do SAP HANA usando o [Guia de atualização e instalação do servidor do SAP HANA][hana-guide].</span><span class="sxs-lookup"><span data-stu-id="59d79-307">Install and configure the SAP Hana Database instance using the [SAP HANA Server Installation and Update Guide][hana-guide].</span></span>

4. <span data-ttu-id="59d79-308">Para cada VM denominada `ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`, faça logon na VM e instale e configure o SAP Central Services (SCS) usando os [guias de instalação do SAP][sap-guide].</span><span class="sxs-lookup"><span data-stu-id="59d79-308">For each VM named `ra-sapApps-scs-vm1` ... `ra-sapApps-scs-vmN`, log into the VM, and install and configure the SAP Central Services (SCS) using the [SAP installation guides][sap-guide].</span></span>

5.  <span data-ttu-id="59d79-309">Para cada VM denominada `ra-sapApps-vm1` ... `ra-sapApps-vmN`, faça logon na VM e instale e configure o aplicativo SAP NetWeaver usando os [guias de instalação do SAP][sap-guide].</span><span class="sxs-lookup"><span data-stu-id="59d79-309">For each VM named `ra-sapApps-vm1` ... `ra-sapApps-vmN`, log into the VM, and install and configure the SAP NetWeaver application using the [SAP installation guides][sap-guide].</span></span>

<span data-ttu-id="59d79-310">**_Colbaoradores desta arquitetura de referência_**&mdash; Rick Rainey Ross Sponholtz, Ben Trinh</span><span class="sxs-lookup"><span data-stu-id="59d79-310">**_Contributors to this reference architecture_** &mdash; Rick Rainey, Ross Sponholtz, Ben Trinh</span></span>

[azure-large-instances]: /azure/virtual-machines/workloads/sap/hana-overview-architecture
[azure-lb]: /azure/load-balancer/load-balancer-overview
[azure-pricing]: https://azure.microsoft.com/pricing/calculator/
[azure-ps]: /powershell/azure/overview
[backup-faq]: /azure/backup/backup-azure-backup-faq
[clustering]: https://blogs.msdn.microsoft.com/saponsqlserver/2015/05/20/clustering-sap-ascs-instance-using-windows-server-failover-cluster-on-microsoft-azure-with-sios-datakeeper-and-azure-internal-load-balancer/
[cool-blob-storage]: /azure/storage/storage-blob-storage-tiers
[disk-encryption]: /azure/security/azure-security-disk-encryption
[github]: https://github.com/mspnp/reference-architectures/tree/master/sap/sap-hana
[hana-backup]: /azure/virtual-machines/workloads/sap/sap-hana-backup-guide
[hana-guide]: https://help.sap.com/viewer/2c1988d620e04368aa4103bf26f17727/2.0.01/en-US/7eb0167eb35e4e2885415205b8383584.html
[hybrid-networking]: ../hybrid-networking/index.md
[logon-groups]: https://wiki.scn.sap.com/wiki/display/SI/ABAP+Logon+Group+based+Load+Balancing
[managed-disks]: /azure/storage/storage-managed-disks-overview
[monitoring]: /azure/architecture/best-practices/monitoring
[multiple-vm-nics]: /azure/virtual-machines/windows/multiple-nics
[netweaver-on-azure]: /azure/virtual-machines/workloads/sap/planning-guide
[nsg]: /azure/virtual-network/virtual-networks-nsg
[region-availability]: https://azure.microsoft.com/regions/services/
[running-SAP]: https://blogs.msdn.microsoft.com/saponsqlserver/2016/06/07/sap-on-sql-general-update-for-customers-partners-june-2016/
[sap-1943937]: https://launchpad.support.sap.com/#/notes/1943937
[sap-1928533]: https://launchpad.support.sap.com/#/notes/1928533
[sap-dispatcher]: https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/8fe37933114e6fe10000000a421937/frameset.htm
[sap-dispatcher-ha]: https://help.sap.com/doc/saphelp_nw73ehp1/7.31.19/en-US/48/9a9a6b48c673e8e10000000a42189b/frameset.htm
[sap-dispatcher-install]: https://wiki.scn.sap.com/wiki/display/SI/Web+Dispatcher+Installation
[sap-guide]: https://service.sap.com/instguides
[sap-ha]: https://support.sap.com/content/dam/SAAP/SAP_Activate/AGS_70.pdf
[sap-hana-on-azure]: https://azure.microsoft.com/services/virtual-machines/sap-hana/
[sap-netweaver-dr]: http://download.microsoft.com/download/9/5/6/956FEDC3-702D-4EFB-A7D3-2DB7505566B6/SAP%20NetWeaver%20-%20Building%20an%20Azure%20based%20Disaster%20Recovery%20Solution%20V1_5%20.docx
[sap-security]: https://archive.sap.com/documents/docs/DOC-62943
[visio-download]: https://archcenter.azureedge.net/cdn/SAP-HANA-architecture.vsdx
[vm-sizes-mem]: /azure/virtual-machines/windows/sizes-memory
[swd]: https://help.sap.com/doc/saphelp_nw70ehp2/7.02.16/en-us/48/8fe37933114e6fe10000000a421937/frameset.htm
[0]: ./images/sap-hana.png "Arquitetura SAP HANA usando Microsoft Azure"
