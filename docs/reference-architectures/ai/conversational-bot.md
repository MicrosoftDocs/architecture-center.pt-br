---
title: Criar um bot conversacional de nível empresarial
description: Como criar um bot conversacional (chatbot) de nível empresarial usando o Azure Bot Framework.
author: roalexan
ms.date: 01/24/2019
ms.topic: reference-architecture
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: azcat-ai
ms.openlocfilehash: 0f5de0eca6fbd35cca1a0e8443f363df09ffc6aa
ms.sourcegitcommit: 287344b6c220bdbd8076aed7a281eb02253e15be
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/04/2019
ms.locfileid: "55712143"
---
# <a name="enterprise-grade-conversational-bot"></a><span data-ttu-id="e794e-103">Bot conversacional de nível empresarial</span><span class="sxs-lookup"><span data-stu-id="e794e-103">Enterprise-grade conversational bot</span></span>

<span data-ttu-id="e794e-104">Esta arquitetura de referência descreve como criar um bot conversacional (chatbot) de nível empresarial usando o [Azure Bot Framework][bot-framework].</span><span class="sxs-lookup"><span data-stu-id="e794e-104">This reference architecture describes how to build an enterprise-grade conversational bot (chatbot) using the [Azure Bot Framework][bot-framework].</span></span> <span data-ttu-id="e794e-105">Cada bot é diferente, mas há alguns padrões, fluxos de trabalho e tecnologias comuns a se considerar.</span><span class="sxs-lookup"><span data-stu-id="e794e-105">Each bot is different, but there are some common patterns, workflows, and technologies to be aware of.</span></span> <span data-ttu-id="e794e-106">Especialmente no que diz respeito a um bot que serve para cargas de trabalho corporativas, existem muitas considerações de design além da funcionalidade básica.</span><span class="sxs-lookup"><span data-stu-id="e794e-106">Especially for a bot to serve enterprise workloads, there are many design considerations beyond just the core functionality.</span></span> <span data-ttu-id="e794e-107">Este artigo aborda os aspectos de design mais essenciais e introduz as ferramentas necessárias para a criação de um bot robusto, seguro e que aprende ativamente.</span><span class="sxs-lookup"><span data-stu-id="e794e-107">This article covers the most essential design aspects, and introduces the tools needed to build a robust, secure, and actively learning bot.</span></span>

<span data-ttu-id="e794e-108">[![Diagrama da arquitetura][0]][0]</span><span class="sxs-lookup"><span data-stu-id="e794e-108">[![Diagram of the architecture][0]][0]</span></span>

<span data-ttu-id="e794e-109">Os exemplos de utilitário de práticas recomendadas usados nesta arquitetura são de software livre e estão disponíveis no [GitHub][git-repo-base].</span><span class="sxs-lookup"><span data-stu-id="e794e-109">The best practice utility samples used in this architecture are fully open-sourced and available on [GitHub][git-repo-base].</span></span> 

## <a name="architecture"></a><span data-ttu-id="e794e-110">Arquitetura</span><span class="sxs-lookup"><span data-stu-id="e794e-110">Architecture</span></span>

<span data-ttu-id="e794e-111">A arquitetura mostrada aqui usa os serviços do Azure a seguir.</span><span class="sxs-lookup"><span data-stu-id="e794e-111">The architecture shown here uses the following Azure services.</span></span> <span data-ttu-id="e794e-112">Seu próprio bot pode não usar todos esses serviços, ou pode incorporar serviços adicionais.</span><span class="sxs-lookup"><span data-stu-id="e794e-112">Your own bot may not use all of these services, or may incorporate additional services.</span></span>

### <a name="bot-logic-and-user-experience"></a><span data-ttu-id="e794e-113">Lógica do bot e experiência do usuário</span><span class="sxs-lookup"><span data-stu-id="e794e-113">Bot logic and user experience</span></span>

- <span data-ttu-id="e794e-114">**[BFS] [ bot-framework-service]**  (Bot Framework Service).</span><span class="sxs-lookup"><span data-stu-id="e794e-114">**[Bot Framework Service][bot-framework-service]** (BFS).</span></span> <span data-ttu-id="e794e-115">Esse serviço conecta o bot a um aplicativo de comunicação, como Cortana, Facebook Messenger ou Slack.</span><span class="sxs-lookup"><span data-stu-id="e794e-115">This service connects your bot to a communication app such as Cortana, Facebook Messenger, or Slack.</span></span> <span data-ttu-id="e794e-116">Ele facilita a comunicação entre o bot e o usuário.</span><span class="sxs-lookup"><span data-stu-id="e794e-116">It facilitates communication between your bot and the user.</span></span>
- <span data-ttu-id="e794e-117">**[Serviço de Aplicativo do Azure][app-service]**.</span><span class="sxs-lookup"><span data-stu-id="e794e-117">**[Azure App Service][app-service]**.</span></span> <span data-ttu-id="e794e-118">A lógica de aplicativo do bot fica hospedada no Serviço de Aplicativo do Azure.</span><span class="sxs-lookup"><span data-stu-id="e794e-118">The bot application logic is hosted in Azure App Service.</span></span>

### <a name="bot-cognition-and-intelligence"></a><span data-ttu-id="e794e-119">Inteligência e cognição do bot</span><span class="sxs-lookup"><span data-stu-id="e794e-119">Bot cognition and intelligence</span></span>

- <span data-ttu-id="e794e-120">**[Reconhecimento Vocal][luis]** (LUIS).</span><span class="sxs-lookup"><span data-stu-id="e794e-120">**[Language Understanding][luis]** (LUIS).</span></span> <span data-ttu-id="e794e-121">O LUIS, parte dos [Serviços Cognitivos do Azure][cognitive-services], permite que o bot compreenda linguagem natural e identifique entidades e intenções do usuário.</span><span class="sxs-lookup"><span data-stu-id="e794e-121">Part of [Azure Cognitive Services][cognitive-services], LUIS enables your bot to understand natural language by identifying user intents and entities.</span></span>
- <span data-ttu-id="e794e-122">**[Azure Search][search]**.</span><span class="sxs-lookup"><span data-stu-id="e794e-122">**[Azure Search][search]**.</span></span> <span data-ttu-id="e794e-123">O Search é um serviço gerenciado que fornece um índice de documento com pesquisa rápida.</span><span class="sxs-lookup"><span data-stu-id="e794e-123">Search is a managed service that provides a quick searchable document index.</span></span>
- <span data-ttu-id="e794e-124">**[QnA Maker][qna-maker]**.</span><span class="sxs-lookup"><span data-stu-id="e794e-124">**[QnA Maker][qna-maker]**.</span></span> <span data-ttu-id="e794e-125">O QnA Maker é um serviço de API baseado em nuvem que cria uma camada de perguntas e respostas em formato de conversação sobre seus dados.</span><span class="sxs-lookup"><span data-stu-id="e794e-125">QnA Maker is a cloud-based API service that creates a conversational, question-and-answer layer over your data.</span></span> <span data-ttu-id="e794e-126">Normalmente, ele é carregado com conteúdo semiestruturado, por exemplo, perguntas frequentes.</span><span class="sxs-lookup"><span data-stu-id="e794e-126">Typically, it's loaded with semi-structured content such as FAQs.</span></span> <span data-ttu-id="e794e-127">Use-o para criar uma base de dados de conhecimento e responder a perguntas em linguagem natural.</span><span class="sxs-lookup"><span data-stu-id="e794e-127">Use it to create a knowledge base for answering natural-language questions.</span></span>
- <span data-ttu-id="e794e-128">**[Aplicativo Web][webapp]**.</span><span class="sxs-lookup"><span data-stu-id="e794e-128">**[Web app][webapp]**.</span></span> <span data-ttu-id="e794e-129">Se o bot precisar de soluções de IA que não sejam fornecidas por um serviço existente, você poderá implementar sua própria IA personalizada e hospedá-la como um aplicativo Web.</span><span class="sxs-lookup"><span data-stu-id="e794e-129">If your bot needs AI solutions not provided by an existing service, you can implement your own custom AI and host it as a web app.</span></span> <span data-ttu-id="e794e-130">Isso fornece um ponto de extremidade da Web que o bot pode chamar.</span><span class="sxs-lookup"><span data-stu-id="e794e-130">This provides a web endpoint for your bot to call.</span></span>

### <a name="data-ingestion"></a><span data-ttu-id="e794e-131">Ingestão de dados</span><span class="sxs-lookup"><span data-stu-id="e794e-131">Data ingestion</span></span>

<span data-ttu-id="e794e-132">O bot se baseará em dados brutos que precisam ser ingeridos e preparados.</span><span class="sxs-lookup"><span data-stu-id="e794e-132">The bot will rely on raw data that must be ingested and prepared.</span></span> <span data-ttu-id="e794e-133">Considere uma das seguintes opções para orquestrar o processo:</span><span class="sxs-lookup"><span data-stu-id="e794e-133">Consider any of the following options to orchestrate this process:</span></span>

- <span data-ttu-id="e794e-134">**[Azure Data Factory][data-factory]**.</span><span class="sxs-lookup"><span data-stu-id="e794e-134">**[Azure Data Factory][data-factory]**.</span></span> <span data-ttu-id="e794e-135">O Data Factory orquestra e automatiza a movimentação de dados e a transformação de dados.</span><span class="sxs-lookup"><span data-stu-id="e794e-135">Data Factory orchestrates and automates data movement and data transformation.</span></span>
- <span data-ttu-id="e794e-136">**[Aplicativos Lógicos][logic-apps]**.</span><span class="sxs-lookup"><span data-stu-id="e794e-136">**[Logic Apps][logic-apps]**.</span></span> <span data-ttu-id="e794e-137">Os Aplicativos Lógicos são uma plataforma sem servidor para compilar fluxos de trabalho que integram aplicativos, dados e serviços.</span><span class="sxs-lookup"><span data-stu-id="e794e-137">Logic Apps is a serverless platform for building workflows that integrate applications, data, and services.</span></span> <span data-ttu-id="e794e-138">Os Aplicativos Lógicos fornecem conectores de dados para muitos aplicativos, incluindo o Office 365.</span><span class="sxs-lookup"><span data-stu-id="e794e-138">Logic Apps provides data connectors for many applications, including Office 365.</span></span>
- <span data-ttu-id="e794e-139">**[Azure Functions][functions]**.</span><span class="sxs-lookup"><span data-stu-id="e794e-139">**[Azure Functions][functions]**.</span></span> <span data-ttu-id="e794e-140">Você pode usar o Azure Functions para escrever um código sem servidor personalizado que é invocado por um [gatilho] [ functions-triggers] &mdash;, por exemplo, sempre que um documento é adicionado ao Armazenamento de Blobs ou ao Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="e794e-140">You can use Azure Functions to write custom serverless code that is invoked by a [trigger][functions-triggers] &mdash; for example, whenever a document is added to blob storage or Cosmos DB.</span></span>

### <a name="logging-and-monitoring"></a><span data-ttu-id="e794e-141">Log e monitoramento</span><span class="sxs-lookup"><span data-stu-id="e794e-141">Logging and monitoring</span></span>

- <span data-ttu-id="e794e-142">**[Application Insights][app-insights]**.</span><span class="sxs-lookup"><span data-stu-id="e794e-142">**[Application Insights][app-insights]**.</span></span> <span data-ttu-id="e794e-143">Use o Application Insights a fim de registrar a métrica de aplicativo do bot em log para fins de monitoramento, diagnóstico e análise.</span><span class="sxs-lookup"><span data-stu-id="e794e-143">Use Application Insights to log the bot's application metrics for monitoring, diagnostic, and analytical purposes.</span></span>
- <span data-ttu-id="e794e-144">**[Armazenamento de Blobs do Azure][blob]**.</span><span class="sxs-lookup"><span data-stu-id="e794e-144">**[Azure Blob Storage][blob]**.</span></span> <span data-ttu-id="e794e-145">O Armazenamento de Blobs é otimizado para armazenar grandes quantidades de dados não estruturados.</span><span class="sxs-lookup"><span data-stu-id="e794e-145">Blob storage is optimized for storing massive amounts of unstructured data.</span></span>
- <span data-ttu-id="e794e-146">**[Cosmos DB][cosmosdb]**.</span><span class="sxs-lookup"><span data-stu-id="e794e-146">**[Cosmos DB][cosmosdb]**.</span></span> <span data-ttu-id="e794e-147">O Cosmos DB é adequado para armazenar dados de log semiestruturados, como conversas.</span><span class="sxs-lookup"><span data-stu-id="e794e-147">Cosmos DB is well-suited for storing semi-structured log data such as conversations.</span></span>
- <span data-ttu-id="e794e-148">**[Power BI][power-bi]**.</span><span class="sxs-lookup"><span data-stu-id="e794e-148">**[Power BI][power-bi]**.</span></span> <span data-ttu-id="e794e-149">Use o Power BI a fim de criar painéis de monitoramento para o bot.</span><span class="sxs-lookup"><span data-stu-id="e794e-149">Use Power BI to create monitoring dashboards for your bot.</span></span>

### <a name="security-and-governance"></a><span data-ttu-id="e794e-150">Governança e segurança</span><span class="sxs-lookup"><span data-stu-id="e794e-150">Security and governance</span></span>

- <span data-ttu-id="e794e-151">**[Azure AD][aad]** (Azure Active Directory).</span><span class="sxs-lookup"><span data-stu-id="e794e-151">**[Azure Active Directory][aad]** (Azure AD).</span></span> <span data-ttu-id="e794e-152">Os usuários serão autenticados por meio de um provedor de identidade, como o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="e794e-152">Users will authenticate through an identity provider such as Azure AD.</span></span> <span data-ttu-id="e794e-153">O Serviço de Bot controla o fluxo de autenticação e o gerenciamento de token OAuth.</span><span class="sxs-lookup"><span data-stu-id="e794e-153">The Bot Service handles the authentication flow and OAuth token management.</span></span> <span data-ttu-id="e794e-154">Consulte [Adicionar autenticação ao bot por meio do Serviço de Bot do Azure][bot-authentication].</span><span class="sxs-lookup"><span data-stu-id="e794e-154">See [Add authentication to your bot via Azure Bot Service][bot-authentication].</span></span>
- <span data-ttu-id="e794e-155">**[Azure Key Vault][key-vault]**.</span><span class="sxs-lookup"><span data-stu-id="e794e-155">**[Azure Key Vault][key-vault]**.</span></span> <span data-ttu-id="e794e-156">Armazene credenciais e outros segredos usando o Key Vault.</span><span class="sxs-lookup"><span data-stu-id="e794e-156">Store credentials and other secrets using Key Vault.</span></span>

### <a name="quality-assurance-and-enhancements"></a><span data-ttu-id="e794e-157">Aprimoramentos e garantia de qualidade</span><span class="sxs-lookup"><span data-stu-id="e794e-157">Quality assurance and enhancements</span></span>

- <span data-ttu-id="e794e-158">**[Azure DevOps][devops]**.</span><span class="sxs-lookup"><span data-stu-id="e794e-158">**[Azure DevOps][devops]**.</span></span> <span data-ttu-id="e794e-159">Fornece muitos serviços para gerenciamento de aplicativo, incluindo controle do código-fonte, criação, teste, implantação e acompanhamento de projetos.</span><span class="sxs-lookup"><span data-stu-id="e794e-159">Provides many services for app management, including source control, building, testing, deployment, and project tracking.</span></span>
- <span data-ttu-id="e794e-160">**[VS Code] [ vscode]** Um editor de código leve para desenvolvimento de aplicativos.</span><span class="sxs-lookup"><span data-stu-id="e794e-160">**[VS Code][vscode]** A lightweight code editor for app development.</span></span> <span data-ttu-id="e794e-161">Você pode usar qualquer outro IDE com recursos semelhantes.</span><span class="sxs-lookup"><span data-stu-id="e794e-161">You can use any other IDE with similar features.</span></span>

## <a name="design-considerations"></a><span data-ttu-id="e794e-162">Considerações sobre o design</span><span class="sxs-lookup"><span data-stu-id="e794e-162">Design considerations</span></span>

<span data-ttu-id="e794e-163">Em um alto nível, um bot conversacional pode ser dividido entre a funcionalidade de bot (o “cérebro”) e um conjunto de requisitos periféricos (o “corpo”).</span><span class="sxs-lookup"><span data-stu-id="e794e-163">At a high level, a conversational bot can be divided into the bot functionality (the "brain") and a set of surrounding requirements (the "body").</span></span> <span data-ttu-id="e794e-164">O cérebro inclui os componentes com reconhecimento de domínio, incluindo a lógica de bot e os recursos de ML.</span><span class="sxs-lookup"><span data-stu-id="e794e-164">The brain includes the domain-aware components, including the bot logic and ML capabilities.</span></span> <span data-ttu-id="e794e-165">Outros componentes independem do domínio e lidam com requisitos não funcionais, como CI/CD, garantia de qualidade e segurança.</span><span class="sxs-lookup"><span data-stu-id="e794e-165">Other components are domain agnostic and address non-functional requirements such as CI/CD, quality assurance, and security.</span></span>

![Diagrama lógico da funcionalidade de bot](./_images/conversational-bot-logical.png)

<span data-ttu-id="e794e-167">Antes de abordarmos as especificidades da arquitetura, vamos começar com o fluxo de dados por cada subcomponente do design.</span><span class="sxs-lookup"><span data-stu-id="e794e-167">Before getting into the specifics of this architecture, let's start with the data flow through each subcomponent of the design.</span></span> <span data-ttu-id="e794e-168">O fluxo de dados inclui fluxos de dados iniciados pelo usuário e pelo sistema.</span><span class="sxs-lookup"><span data-stu-id="e794e-168">The data flow includes user-initiated and system-initiated data flows.</span></span>

### <a name="user-message-flow"></a><span data-ttu-id="e794e-169">Fluxo de mensagens do usuário</span><span class="sxs-lookup"><span data-stu-id="e794e-169">User message flow</span></span>

<span data-ttu-id="e794e-170">**Autenticação**.</span><span class="sxs-lookup"><span data-stu-id="e794e-170">**Authentication**.</span></span> <span data-ttu-id="e794e-171">Os usuários começam se autenticando por meio do mecanismo fornecido pelo canal de comunicação com o bot.</span><span class="sxs-lookup"><span data-stu-id="e794e-171">Users start by authenticating themselves using whatever mechanism is provided by their channel of communication with the bot.</span></span> <span data-ttu-id="e794e-172">O Bot Framework dá suporte a vários canais de comunicação, incluindo Cortana, Microsoft Teams, Facebook Messenger, Kik e Slack.</span><span class="sxs-lookup"><span data-stu-id="e794e-172">The bot framework supports many communication channels, including Cortana, Microsoft Teams, Facebook Messenger, Kik, and Slack.</span></span> <span data-ttu-id="e794e-173">Para obter uma lista de canais, confira [Conectar um bot aos canais](/azure/bot-service/bot-service-manage-channels).</span><span class="sxs-lookup"><span data-stu-id="e794e-173">For a list of channels, see [Connect a bot to channels](/azure/bot-service/bot-service-manage-channels).</span></span> <span data-ttu-id="e794e-174">Quando você cria um bot com o Serviço de Bot do Azure, o canal [Webchat][webchat] é configurado automaticamente.</span><span class="sxs-lookup"><span data-stu-id="e794e-174">When you create a bot with Azure Bot Service, the [Web Chat][webchat] channel is automatically configured.</span></span> <span data-ttu-id="e794e-175">Esse canal permite que os usuários interajam com o bot diretamente em uma página da Web.</span><span class="sxs-lookup"><span data-stu-id="e794e-175">This channel allows users to interact with your bot directly in a web page.</span></span> <span data-ttu-id="e794e-176">Você também pode conectar o bot a um aplicativo personalizado usando o canal [Direct Line](/azure/bot-service/bot-service-channel-connect-directline).</span><span class="sxs-lookup"><span data-stu-id="e794e-176">You can also connect the bot to a custom app by using the [Direct Line](/azure/bot-service/bot-service-channel-connect-directline) channel.</span></span> <span data-ttu-id="e794e-177">A identidade do usuário é usada para permitir controle de acesso baseado em função e para fornecer conteúdo personalizado.</span><span class="sxs-lookup"><span data-stu-id="e794e-177">The user's identity is used to provide role-based access control, as well as to serve personalized content.</span></span>

<span data-ttu-id="e794e-178">**Mensagem do usuário**.</span><span class="sxs-lookup"><span data-stu-id="e794e-178">**User message**.</span></span> <span data-ttu-id="e794e-179">Uma vez autenticado, o usuário envia uma mensagem ao bot.</span><span class="sxs-lookup"><span data-stu-id="e794e-179">Once authenticated, the user sends a message to the bot.</span></span> <span data-ttu-id="e794e-180">O bot lê a mensagem e a encaminha a um serviço de reconhecimento de linguagem natural, como o [LUIS](/azure/cognitive-services/luis/).</span><span class="sxs-lookup"><span data-stu-id="e794e-180">The bot reads the message and routes it to a natural language understanding service such as [LUIS](/azure/cognitive-services/luis/).</span></span> <span data-ttu-id="e794e-181">Esta etapa obtém as **intenções** (o que o usuário deseja fazer) e as **entidades** (as coisas em que o usuário está interessado).</span><span class="sxs-lookup"><span data-stu-id="e794e-181">This step gets the **intents** (what the user wants to do) and **entities** (what things the user is interested in).</span></span> <span data-ttu-id="e794e-182">Em seguida, o bot cria uma consulta e a repassa a um serviço que fornece informações, como o [Azure Search] [ search] para recuperação de documentos, o [QnA Maker](https://www.qnamaker.ai/) para perguntas frequentes, ou uma base de conhecimento personalizada.</span><span class="sxs-lookup"><span data-stu-id="e794e-182">The bot then builds a query that it passes to a service that serves information, such as [Azure Search][search] for document retrieval, [QnA Maker](https://www.qnamaker.ai/) for FAQs, or a custom knowledge base.</span></span> <span data-ttu-id="e794e-183">O bot usa esses resultados para construir uma resposta.</span><span class="sxs-lookup"><span data-stu-id="e794e-183">The bot uses these results to construct a response.</span></span> <span data-ttu-id="e794e-184">A fim de conseguir o melhor resultado para determinada consulta, o bot pode fazer várias chamadas bidirecionais para esses serviços remotos.</span><span class="sxs-lookup"><span data-stu-id="e794e-184">To give the best result for a  given query, the bot might make several back-and-forth calls to these remote services.</span></span>

<span data-ttu-id="e794e-185">**Resposta**.</span><span class="sxs-lookup"><span data-stu-id="e794e-185">**Response**.</span></span> <span data-ttu-id="e794e-186">Neste ponto, o bot determinou a melhor resposta e a envia para o usuário.</span><span class="sxs-lookup"><span data-stu-id="e794e-186">At this point, the bot has determined the best response and sends it to the user.</span></span> <span data-ttu-id="e794e-187">Se a pontuação de confiança da melhor resposta correspondente for baixa, a resposta poderá ser uma pergunta pedindo esclarecimentos ou uma confirmação de que o bot não pôde responder adequadamente.</span><span class="sxs-lookup"><span data-stu-id="e794e-187">If the confidence score of the best-matched answer is low, the response might be a disambiguation question or an acknowledgement that the bot could not reply adequately.</span></span>

<span data-ttu-id="e794e-188">**Registro em log**.</span><span class="sxs-lookup"><span data-stu-id="e794e-188">**Logging**.</span></span> <span data-ttu-id="e794e-189">Quando uma solicitação de usuário é recebida ou uma resposta é enviada, todas as ações de conversa devem ser registradas em um repositório de log, juntamente com métricas de desempenho e erros gerais de serviços externos.</span><span class="sxs-lookup"><span data-stu-id="e794e-189">When a user request is received or a response is sent, all conversation actions should be logged to a logging store, along with performance metrics and general errors from external services.</span></span> <span data-ttu-id="e794e-190">Esses logs serão úteis mais tarde para diagnosticar problemas e melhorar o sistema.</span><span class="sxs-lookup"><span data-stu-id="e794e-190">These logs will be useful later when diagnosing issues and improving the system.</span></span>

<span data-ttu-id="e794e-191">**Comentários**.</span><span class="sxs-lookup"><span data-stu-id="e794e-191">**Feedback**.</span></span> <span data-ttu-id="e794e-192">Outra prática recomendada é coletar as pontuações de satisfação e os comentários dos usuários.</span><span class="sxs-lookup"><span data-stu-id="e794e-192">Another good practice is to collect user feedback and satisfaction scores.</span></span> <span data-ttu-id="e794e-193">Como um acompanhamento da resposta final do bot, este deve pedir ao usuário que classifique sua satisfação com a resposta dada.</span><span class="sxs-lookup"><span data-stu-id="e794e-193">As a follow up to the bot's final response, the bot should ask the user to rate their satisfaction with the reply.</span></span> <span data-ttu-id="e794e-194">Os comentários podem ajudá-lo a resolver o problema inicial de reconhecimento de linguagem natural e a melhorar continuamente a precisão das respostas.</span><span class="sxs-lookup"><span data-stu-id="e794e-194">Feedback can help you to solve the cold start problem of natural language understanding, and continually improve the accuracy of responses.</span></span>

### <a name="system-data-flow"></a><span data-ttu-id="e794e-195">Fluxo de dados do sistema</span><span class="sxs-lookup"><span data-stu-id="e794e-195">System Data Flow</span></span>

<span data-ttu-id="e794e-196">**ETL**.</span><span class="sxs-lookup"><span data-stu-id="e794e-196">**ETL**.</span></span> <span data-ttu-id="e794e-197">O bot se baseia em informações e conhecimento extraídos dos dados brutos por um processo de ETL no back-end.</span><span class="sxs-lookup"><span data-stu-id="e794e-197">The bot relies on information and knowledge extracted from the raw data by an ETL process in the backend.</span></span> <span data-ttu-id="e794e-198">Esses dados podem ser estruturados (banco de dados SQL), semiestruturados (sistema de CRM, perguntas frequentes) ou não estruturados (documentos do Word, PDFs, blogs).</span><span class="sxs-lookup"><span data-stu-id="e794e-198">This data might be structured (SQL database), semi-structured (CRM system, FAQs), or unstructured (Word documents, PDFs, web logs).</span></span> <span data-ttu-id="e794e-199">Um subsistema de ETL extrai os dados em um cronograma fixo.</span><span class="sxs-lookup"><span data-stu-id="e794e-199">An ETL subsystem extracts the data on a fixed schedule.</span></span> <span data-ttu-id="e794e-200">O conteúdo é transformado, aprimorado e carregado em um armazenamento de dados intermediários, como o Cosmos DB ou o Armazenamento de Blobs do Azure.</span><span class="sxs-lookup"><span data-stu-id="e794e-200">The content is transformed and enriched, then loaded into an intermediary data store, such as Cosmos DB or Azure Blob Storage.</span></span>

<span data-ttu-id="e794e-201">Os dados no repositório intermediário são indexados no Azure Search para recuperação de documentos, carregados no QnA Maker para criar pares de pergunta e resposta ou carregados em um aplicativo Web personalizado para processamento de texto não estruturado.</span><span class="sxs-lookup"><span data-stu-id="e794e-201">Data in the intermediary store is then indexed into Azure Search for document retrieval, loaded into QnA Maker to create question and answer pairs, or loaded into a custom web app for unstructured text processing.</span></span> <span data-ttu-id="e794e-202">Os dados também são usados para treinar o modelo LUIS na extração de entidade e de intenção.</span><span class="sxs-lookup"><span data-stu-id="e794e-202">The data is also used to train a LUIS model for intent and entity extraction.</span></span>

<span data-ttu-id="e794e-203">**Garantia de qualidade**.</span><span class="sxs-lookup"><span data-stu-id="e794e-203">**Quality assurance**.</span></span> <span data-ttu-id="e794e-204">Os logs de conversa são usados para diagnosticar e corrigir bugs, fornecer informações sobre como o bot está sendo usado e acompanhar o desempenho geral.</span><span class="sxs-lookup"><span data-stu-id="e794e-204">The conversation logs are used to diagnose and fix bugs, provide insight into how the bot is being used, and track overall performance.</span></span> <span data-ttu-id="e794e-205">Os dados de comentários são úteis para readaptar modelos de IA e melhorar o desempenho do bot.</span><span class="sxs-lookup"><span data-stu-id="e794e-205">Feedback data is useful for retraining the AI models to improve bot performance.</span></span>

## <a name="building-a-bot"></a><span data-ttu-id="e794e-206">Criação de um bot</span><span class="sxs-lookup"><span data-stu-id="e794e-206">Building a bot</span></span>

<span data-ttu-id="e794e-207">Antes de você escrever uma única linha de código, é importante escrever uma especificação funcional para que a equipe de desenvolvimento tenha uma ideia clara do objetivo do bot.</span><span class="sxs-lookup"><span data-stu-id="e794e-207">Before you even write a single line of code, it's important to write a functional specification so the development team has a clear idea of what the bot is expected to do.</span></span> <span data-ttu-id="e794e-208">A especificação deve incluir uma lista razoavelmente abrangente de entradas do usuário e de respostas esperadas do bot em vários domínios de conhecimento.</span><span class="sxs-lookup"><span data-stu-id="e794e-208">The specification should include a reasonably comprehensive list of user inputs and expected bot responses in various knowledge domains.</span></span> <span data-ttu-id="e794e-209">Esse documento dinâmico será um guia inestimável para desenvolver e testar seu bot.</span><span class="sxs-lookup"><span data-stu-id="e794e-209">This living document will be an invaluable guide for developing and testing your bot.</span></span>

### <a name="ingest-data"></a><span data-ttu-id="e794e-210">Ingestão de dados</span><span class="sxs-lookup"><span data-stu-id="e794e-210">Ingest data</span></span>

<span data-ttu-id="e794e-211">Em seguida, identifique as fontes de dados que permitirão que o bot interaja de forma inteligente com usuários.</span><span class="sxs-lookup"><span data-stu-id="e794e-211">Next, identify the data sources that will enable the bot to interact intelligently with users.</span></span> <span data-ttu-id="e794e-212">Como mencionado anteriormente, essas fontes de dados podem conter conjuntos de dados estruturados, semiestruturados ou não estruturados.</span><span class="sxs-lookup"><span data-stu-id="e794e-212">As mentioned earlier, these data sources could contain structured, semi-structured, or unstructured data sets.</span></span> <span data-ttu-id="e794e-213">Quando você está começando, uma boa abordagem é fazer uma cópia única dos dados em um armazenamento central, como o Cosmos DB ou o Armazenamento do Azure.</span><span class="sxs-lookup"><span data-stu-id="e794e-213">When you're getting started, a good approach is to make a one-off copy of the data to a central store, such as Cosmos DB or Azure Storage.</span></span> <span data-ttu-id="e794e-214">Conforme você vai progredindo, deverá criar um pipeline de ingestão de dados automatizado para manter esses dados atualizados.</span><span class="sxs-lookup"><span data-stu-id="e794e-214">As you progress, you should create an automated data ingestion pipeline to keep this data current.</span></span> <span data-ttu-id="e794e-215">Opções para um pipeline de ingestão automatizado incluem o Data Factory, o Functions e os Aplicativos Lógicos.</span><span class="sxs-lookup"><span data-stu-id="e794e-215">Options for an automated ingestion pipeline include Data Factory, Functions, and Logic Apps.</span></span> <span data-ttu-id="e794e-216">Dependendo dos armazenamentos de dados e dos esquemas, você pode usar uma combinação dessas abordagens.</span><span class="sxs-lookup"><span data-stu-id="e794e-216">Depending on the data stores and the schemas, you might use a combination of these approaches.</span></span>

<span data-ttu-id="e794e-217">Enquanto você está começando, é sensato usar o portal do Azure para criar recursos do Azure manualmente.</span><span class="sxs-lookup"><span data-stu-id="e794e-217">As you get started, it's reasonable to use the Azure portal to manually create Azure resources.</span></span> <span data-ttu-id="e794e-218">Mais tarde, convém pensar em automatizar a implantação desses recursos.</span><span class="sxs-lookup"><span data-stu-id="e794e-218">Later on, you should put more thought into automating the deployment of these resources.</span></span>

### <a name="core-bot-logic-and-ux"></a><span data-ttu-id="e794e-219">Lógica principal do bot e experiência do usuário</span><span class="sxs-lookup"><span data-stu-id="e794e-219">Core bot logic and UX</span></span>

<span data-ttu-id="e794e-220">Quando você já tiver uma especificação e alguns dados, é hora de começar a tornar seu bot realidade.</span><span class="sxs-lookup"><span data-stu-id="e794e-220">Once you have a specification and some data, it's time to start making your bot into reality.</span></span> <span data-ttu-id="e794e-221">Vamos nos concentrar na lógica principal do bot.</span><span class="sxs-lookup"><span data-stu-id="e794e-221">Let's focus on the core bot logic.</span></span> <span data-ttu-id="e794e-222">Ela é o código que manipula a conversa com o usuário, incluindo a lógica de roteamento, a lógica de desambiguação e o registro em log.</span><span class="sxs-lookup"><span data-stu-id="e794e-222">This is the code that handles the conversation with the user, including the routing logic, disambiguation logic, and logging.</span></span> <span data-ttu-id="e794e-223">Comece a familiarizar-se com o [Bot Framework][bot-framework], incluindo:</span><span class="sxs-lookup"><span data-stu-id="e794e-223">Start by familiarizing yourself with the [Bot Framework][bot-framework], including:</span></span>

- <span data-ttu-id="e794e-224">Conceitos básicos e terminologia usada na estrutura, especialmente [conversations], [turns] e [activities].</span><span class="sxs-lookup"><span data-stu-id="e794e-224">Basic concepts and terminology used in the framework, especially [conversations], [turns], and [activities].</span></span>
- <span data-ttu-id="e794e-225">O [serviço do Bot Connector](/azure/bot-service/rest-api/bot-framework-rest-connector-quickstart), que trata da rede entre o bot e seus canais.</span><span class="sxs-lookup"><span data-stu-id="e794e-225">The [Bot Connector service](/azure/bot-service/rest-api/bot-framework-rest-connector-quickstart), which handles the networking between the bot and your channels.</span></span>
- <span data-ttu-id="e794e-226">Como o [estado](/azure/bot-service/bot-builder-concept-state) da conversa é mantido, seja na memória ou, melhor ainda, em um armazenamento, como o Armazenamento de Blobs do Azure ou o Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="e794e-226">How conversation [state](/azure/bot-service/bot-builder-concept-state) is maintained, either in memory or better yet in a store such as Azure Blob Storage or Azure Cosmos DB.</span></span>
- <span data-ttu-id="e794e-227">[Middleware](/azure/bot-service/bot-builder-basics#middleware) e como ele pode ser usado para conectar o bot a serviços externos, como os Serviços Cognitivos.</span><span class="sxs-lookup"><span data-stu-id="e794e-227">[Middleware](/azure/bot-service/bot-builder-basics#middleware), and how it can be used to hook up your bot with external services, such as Cognitive Services.</span></span>

<span data-ttu-id="e794e-228">Para uma [experiência do usuário](/azure/bot-service/bot-service-design-user-experience) avançada, há muitas opções.</span><span class="sxs-lookup"><span data-stu-id="e794e-228">For a rich [user experience](/azure/bot-service/bot-service-design-user-experience), there are many options.</span></span>

- <span data-ttu-id="e794e-229">Você pode usar [cartões](/azure/bot-service/bot-service-design-user-experience#cards) para incluir imagens, botões, carrosséis e menus.</span><span class="sxs-lookup"><span data-stu-id="e794e-229">You can use [cards](/azure/bot-service/bot-service-design-user-experience#cards) to include buttons, images, carousels, and menus.</span></span>
- <span data-ttu-id="e794e-230">Um bot pode dar suporte a fala.</span><span class="sxs-lookup"><span data-stu-id="e794e-230">A bot can support speech.</span></span>
- <span data-ttu-id="e794e-231">Você pode até mesmo incorporar o bot a um aplicativo ou site e usar os recursos do aplicativo que o está hospedando.</span><span class="sxs-lookup"><span data-stu-id="e794e-231">You can even embed your bot in an app or website and use the capabilities of the app hosting it.</span></span>

<span data-ttu-id="e794e-232">Para começar, você pode criar o bot online usando o [Serviço de Bot do Azure](/azure/bot-service/bot-service-quickstart), escolhendo entre os modelos de C# e Node.js disponíveis.</span><span class="sxs-lookup"><span data-stu-id="e794e-232">To get started, you can build your bot online using the [Azure Bot Service](/azure/bot-service/bot-service-quickstart), selecting from the available C# and Node.js templates.</span></span> <span data-ttu-id="e794e-233">No entanto, à medida que seu bot ficar mais sofisticado, você precisará criar o bot localmente e implantá-lo na Web.</span><span class="sxs-lookup"><span data-stu-id="e794e-233">As your bot gets more sophisticated, however, you will need to create your bot locally then deploy it to the web.</span></span> <span data-ttu-id="e794e-234">Escolha um IDE, como o Visual Studio ou o Visual Studio Code, e uma linguagem de programação.</span><span class="sxs-lookup"><span data-stu-id="e794e-234">Choose an IDE, such as Visual Studio or Visual Studio Code, and a programming language.</span></span> <span data-ttu-id="e794e-235">Há SDKs disponíveis para as seguintes linguagens:</span><span class="sxs-lookup"><span data-stu-id="e794e-235">SDKs are available for the following languages:</span></span>

- [<span data-ttu-id="e794e-236">C#</span><span class="sxs-lookup"><span data-stu-id="e794e-236">C#</span></span>](https://github.com/microsoft/botbuilder-dotnet)
- [<span data-ttu-id="e794e-237">JavaScript</span><span class="sxs-lookup"><span data-stu-id="e794e-237">JavaScript</span></span>](https://github.com/microsoft/botbuilder-js)
- <span data-ttu-id="e794e-238">[Java](https://github.com/microsoft/botbuilder-java) (versão prévia)</span><span class="sxs-lookup"><span data-stu-id="e794e-238">[Java](https://github.com/microsoft/botbuilder-java) (preview)</span></span>
- <span data-ttu-id="e794e-239">[Python](https://github.com/microsoft/botbuilder-python) (versão prévia)</span><span class="sxs-lookup"><span data-stu-id="e794e-239">[Python](https://github.com/microsoft/botbuilder-python) (preview)</span></span>

<span data-ttu-id="e794e-240">Como ponto de partida, você pode fazer o download do código-fonte para o bot que foi criado com o Serviço de Bot do Azure.</span><span class="sxs-lookup"><span data-stu-id="e794e-240">As a starting point, you can download the source code for the bot you created using the Azure Bot Service.</span></span> <span data-ttu-id="e794e-241">Você também pode encontrar [código de exemplo](https://github.com/Microsoft/BotBuilder-Samples/blob/master/README.md), desde bots de eco simples a bots mais sofisticados que se integram a vários serviços de IA.</span><span class="sxs-lookup"><span data-stu-id="e794e-241">You can also find [sample code](https://github.com/Microsoft/BotBuilder-Samples/blob/master/README.md), from simple echo bots to more sophisticated bots that integrate with various AI services.</span></span>

### <a name="add-smarts-to-your-bot"></a><span data-ttu-id="e794e-242">Adicionar experiência ao bot</span><span class="sxs-lookup"><span data-stu-id="e794e-242">Add smarts to your bot</span></span>

<span data-ttu-id="e794e-243">Para um bot simples com uma lista bem definida de comandos, você pode usar uma abordagem baseada em regras para analisar a entrada do usuário por meio de regex.</span><span class="sxs-lookup"><span data-stu-id="e794e-243">For a simple bot with a well-defined list of commands, you might be able to use a rules-based approach to parse the user input via regex.</span></span> <span data-ttu-id="e794e-244">Isso tem a vantagem de ser determinístico e compreensível.</span><span class="sxs-lookup"><span data-stu-id="e794e-244">This has the advantage of being deterministic and understandable.</span></span> <span data-ttu-id="e794e-245">No entanto, quando o bot precisa entender as intenções e entidades de uma mensagem de linguagem mais natural, há serviços de IA que podem ajudar.</span><span class="sxs-lookup"><span data-stu-id="e794e-245">However, when your bot needs to understand the intents and entities of a more natural-language message, there are AI services that can help.</span></span>

- <span data-ttu-id="e794e-246">O LUIS foi projetado especificamente para entender as entidades e intenções do usuário.</span><span class="sxs-lookup"><span data-stu-id="e794e-246">LUIS is specifically designed to understand user intents and entities.</span></span> <span data-ttu-id="e794e-247">Treine-o com uma coleção de tamanho moderado de [entradas do usuário](/azure/cognitive-services/luis/luis-concept-utterance) relevantes e respostas desejadas, e ele retornará as intenções e entidades de determinada mensagem de um usuário.</span><span class="sxs-lookup"><span data-stu-id="e794e-247">You train it with a moderately sized collection of relevant [user input](/azure/cognitive-services/luis/luis-concept-utterance) and desired responses, and it returns the intents and entities for a user's given message.</span></span>

- <span data-ttu-id="e794e-248">O Azure Search pode trabalhar junto com o LUIS.</span><span class="sxs-lookup"><span data-stu-id="e794e-248">Azure Search can work alongside LUIS.</span></span> <span data-ttu-id="e794e-249">Usando o Search, você cria índices pesquisáveis de todos os dados relevantes.</span><span class="sxs-lookup"><span data-stu-id="e794e-249">Using Search, you create searchable indexes over all relevant data.</span></span> <span data-ttu-id="e794e-250">O bot consulta esses índices em relação às entidades extraídas pelo LUIS.</span><span class="sxs-lookup"><span data-stu-id="e794e-250">The bot queries these indexes for the entities extracted by LUIS.</span></span> <span data-ttu-id="e794e-251">O Azure Search também dá suporte a [sinônimos][synonyms], o que pode ampliar a rede de mapeamentos de palavra correta.</span><span class="sxs-lookup"><span data-stu-id="e794e-251">Azure Search also supports [synonyms][synonyms], which can widen the net of correct word mappings.</span></span>

- <span data-ttu-id="e794e-252">O QnA Maker é outro serviço projetado para retornar respostas a determinadas perguntas.</span><span class="sxs-lookup"><span data-stu-id="e794e-252">QnA Maker is another service that is designed to return answers for given questions.</span></span> <span data-ttu-id="e794e-253">Normalmente, ele é treinado com dados semiestruturados, como as perguntas frequentes.</span><span class="sxs-lookup"><span data-stu-id="e794e-253">It's typically trained over semi-structured data such as FAQs.</span></span>

<span data-ttu-id="e794e-254">Seu bot pode usar outros serviços de IA para aprimorar ainda mais a experiência do usuário.</span><span class="sxs-lookup"><span data-stu-id="e794e-254">Your bot can use other AI services to further enrich the user experience.</span></span> <span data-ttu-id="e794e-255">O [conjunto dos Serviços Cognitivos de serviços de IA pré-criados](https://azure.microsoft.com/en-us/services/cognitive-services/?v=18.44a) (que inclui o LUIS e o QnA Maker) tem serviços para visão, fala, idioma, pesquisa e localização.</span><span class="sxs-lookup"><span data-stu-id="e794e-255">The [Cognitive Services suite of pre-built AI](https://azure.microsoft.com/en-us/services/cognitive-services/?v=18.44a) services (which includes LUIS and QnA Maker) has services for vision, speech, language, search, and location.</span></span> <span data-ttu-id="e794e-256">Você pode adicionar rapidamente funcionalidades como tradução de idiomas, verificação ortográfica, análise de sentimento, OCR, reconhecimento de local e moderação de conteúdo.</span><span class="sxs-lookup"><span data-stu-id="e794e-256">You can quickly add functionality such as language translation, spell checking, sentiment analysis, OCR, location awareness, and content moderation.</span></span> <span data-ttu-id="e794e-257">Esses serviços podem ser conectados como módulos de middleware no bot para ele interagir de forma mais natural e inteligente com o usuário.</span><span class="sxs-lookup"><span data-stu-id="e794e-257">These services can be wired up as middleware modules in your bot to interact more naturally and intelligently with the user.</span></span>

<span data-ttu-id="e794e-258">Outra opção é integrar seu próprio serviço de IA personalizado.</span><span class="sxs-lookup"><span data-stu-id="e794e-258">Another option is to integrate your own custom AI service.</span></span> <span data-ttu-id="e794e-259">Essa abordagem é mais complexa, mas dá total flexibilidade em termos de algoritmo, treinamento e modelo de aprendizado de máquina.</span><span class="sxs-lookup"><span data-stu-id="e794e-259">This approach is more complex, but gives you complete flexibility in terms of the machine learning algorithm, training, and model.</span></span> <span data-ttu-id="e794e-260">Por exemplo, você poderia implementar sua própria modelagem de tópico e usar algoritmo como [LDA] [ lda] para localizar documentos semelhantes ou relevantes.</span><span class="sxs-lookup"><span data-stu-id="e794e-260">For example, you could implement your own topic modeling and use algorithm such as [LDA][lda] to find similar or relevant documents.</span></span> <span data-ttu-id="e794e-261">Uma boa abordagem é expor sua solução de IA personalizada como um ponto de extremidade de serviço Web e, em seguida, chamar o ponto de extremidade de lógica principal do bot.</span><span class="sxs-lookup"><span data-stu-id="e794e-261">A good approach is to expose your custom AI solution as a web service endpoint, and call the endpoint from the core bot logic.</span></span> <span data-ttu-id="e794e-262">O serviço Web pode estar hospedado no Serviço de Aplicativo ou em um cluster de VMs.</span><span class="sxs-lookup"><span data-stu-id="e794e-262">The web service could be hosted in App Service or in a cluster of VMs.</span></span> <span data-ttu-id="e794e-263">[O Azure Machine Learning][aml] oferece vários serviços e bibliotecas para ajudá-lo a [treinar](https://github.com/Azure/MachineLearningNotebooks/tree/master/how-to-use-azureml/training) e [implantar](https://github.com/Azure/MachineLearningNotebooks/tree/master/how-to-use-azureml/deployment) seus modelos.</span><span class="sxs-lookup"><span data-stu-id="e794e-263">[Azure Machine Learning][aml] provides a number of services and libraries to assist you in [training](https://github.com/Azure/MachineLearningNotebooks/tree/master/how-to-use-azureml/training) and [deploying](https://github.com/Azure/MachineLearningNotebooks/tree/master/how-to-use-azureml/deployment) your models.</span></span>

## <a name="quality-assurance-and-enhancement"></a><span data-ttu-id="e794e-264">Aprimoramento e garantia de qualidade</span><span class="sxs-lookup"><span data-stu-id="e794e-264">Quality assurance and enhancement</span></span>

<span data-ttu-id="e794e-265">**Registro em log**.</span><span class="sxs-lookup"><span data-stu-id="e794e-265">**Logging**.</span></span> <span data-ttu-id="e794e-266">Registre as conversas de usuário com o bot em log, incluindo as métricas de desempenho subjacentes e eventuais erros.</span><span class="sxs-lookup"><span data-stu-id="e794e-266">Log user conversations with the bot, including the underlying performance metrics and any errors.</span></span> <span data-ttu-id="e794e-267">Esses logs serão de grande valia para depurar problemas, entender as interações do usuário e aprimorar o sistema.</span><span class="sxs-lookup"><span data-stu-id="e794e-267">These logs will prove invaluable for debugging issues, understanding user interactions, and improving the system.</span></span> <span data-ttu-id="e794e-268">Diferentes armazenamentos de dados servem para diferentes tipos de logs.</span><span class="sxs-lookup"><span data-stu-id="e794e-268">Different data stores might be appropriate for different types of logs.</span></span> <span data-ttu-id="e794e-269">Por exemplo, pense em usar o Application Insights para blobs, o Cosmos DB para conversas e o Armazenamento do Azure para grandes cargas.</span><span class="sxs-lookup"><span data-stu-id="e794e-269">For example, consider Application Insights for web logs, Cosmos DB for conversations, and Azure Storage for large payloads.</span></span> <span data-ttu-id="e794e-270">Confira [Gravar diretamente no Armazenamento do Azure][transcript-storage].</span><span class="sxs-lookup"><span data-stu-id="e794e-270">See [Write directly to Azure Storage][transcript-storage].</span></span>

<span data-ttu-id="e794e-271">**Comentários**.</span><span class="sxs-lookup"><span data-stu-id="e794e-271">**Feedback**.</span></span> <span data-ttu-id="e794e-272">Também é importante entender o grau de satisfação dos usuários com suas interações de bot.</span><span class="sxs-lookup"><span data-stu-id="e794e-272">It's also important to understand how satisfied users are with their bot interactions.</span></span> <span data-ttu-id="e794e-273">Se você tiver um registro de comentários do usuário, poderá usar esses dados para concentrar seus esforços em aprimorar determinadas interações e readaptar os modelos de IA para melhorar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="e794e-273">If you have a record of user feedback, you can use this data to focus your efforts on improving certain interactions and retraining the AI models for improved performance.</span></span> <span data-ttu-id="e794e-274">Use os comentários para readaptar os modelos, como o LUIS, em seu sistema.</span><span class="sxs-lookup"><span data-stu-id="e794e-274">Use the feedback to retrain the models, such as LUIS, in your system.</span></span>

<span data-ttu-id="e794e-275">**Testando**.</span><span class="sxs-lookup"><span data-stu-id="e794e-275">**Testing**.</span></span> <span data-ttu-id="e794e-276">Testar um bot envolve testes de unidade, testes de integração, testes de regressão e testes funcionais.</span><span class="sxs-lookup"><span data-stu-id="e794e-276">Testing a bot involves unit tests, integration tests, regression tests, and functional tests.</span></span> <span data-ttu-id="e794e-277">Para fazer os testes, é recomendável registrar respostas HTTP reais de serviços externos, como o Azure Search ou o QnA Maker, para que eles possam ser reproduzidos durante o teste de unidade sem precisar fazer chamadas de rede reais aos serviços externos.</span><span class="sxs-lookup"><span data-stu-id="e794e-277">For testing, we recommend recording real HTTP responses from external services, such as Azure Search or QnA Maker, so they can be played back during unit testing without needing to make real network calls to external services.</span></span>

>[!NOTE]
> <span data-ttu-id="e794e-278">Para impulsionar o desenvolvimento nessas áreas, examine os [Utilitários de Bot Builder para JavaScript][git-repo-base].</span><span class="sxs-lookup"><span data-stu-id="e794e-278">To jump-start your development in these areas, look at the [Botbuilder Utils for JavaScript][git-repo-base].</span></span> <span data-ttu-id="e794e-279">Esse repositório contém um exemplo de código de utilitário para bots criados com o [Microsoft Bot Framework v4] [ bot-framework] que executam Node.js.</span><span class="sxs-lookup"><span data-stu-id="e794e-279">This repo contains sample utility code for bots built with [Microsoft Bot Framework v4][bot-framework] and running Node.js.</span></span> <span data-ttu-id="e794e-280">Ele inclui os seguintes pacotes:</span><span class="sxs-lookup"><span data-stu-id="e794e-280">It includes the following packages:</span></span>
>
> - <span data-ttu-id="e794e-281">[Armazenamento de registro em log do Cosmos DB][cosmosdb-logger].</span><span class="sxs-lookup"><span data-stu-id="e794e-281">[Cosmos DB Logging Store][cosmosdb-logger].</span></span> <span data-ttu-id="e794e-282">Mostra como armazenar e consultar logs de bot no Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="e794e-282">Shows how to store and query bot logs in Cosmos DB.</span></span>
> - <span data-ttu-id="e794e-283">[Armazenamento de registro em log do Application Insights][appinsights-logger].</span><span class="sxs-lookup"><span data-stu-id="e794e-283">[Application Insights Logging Store][appinsights-logger].</span></span> <span data-ttu-id="e794e-284">Mostra como armazenar e consultar os logs de bot no Application Insights.</span><span class="sxs-lookup"><span data-stu-id="e794e-284">Shows how to store and query bot logs in Application Insights.</span></span>
> - <span data-ttu-id="e794e-285">[Middleware de coleta de comentários][feedback-util].</span><span class="sxs-lookup"><span data-stu-id="e794e-285">[Feedback Collection Middleware][feedback-util].</span></span> <span data-ttu-id="e794e-286">Middleware de exemplo que fornece um mecanismo de solicitação de comentários do usuário do bot.</span><span class="sxs-lookup"><span data-stu-id="e794e-286">Sample middleware that provides a bot user feedback-request mechanism.</span></span>
> - <span data-ttu-id="e794e-287">[Gravador de Teste HTTP][testing util].</span><span class="sxs-lookup"><span data-stu-id="e794e-287">[Http Test Recorder][testing util].</span></span> <span data-ttu-id="e794e-288">Grava tráfego HTTP de serviços externos ao bot.</span><span class="sxs-lookup"><span data-stu-id="e794e-288">Records HTTP traffic from services external to the bot.</span></span> <span data-ttu-id="e794e-289">Ele vem criado previamente com suporte para o LUIS, o Azure Search e o QnAMaker, mas há extensões disponíveis para dar suporte a qualquer serviço.</span><span class="sxs-lookup"><span data-stu-id="e794e-289">It comes pre-built with support for LUIS, Azure Search, and QnAMaker, but extensions are available to support any service.</span></span> <span data-ttu-id="e794e-290">Isso ajuda você a automatizar o teste do bot.</span><span class="sxs-lookup"><span data-stu-id="e794e-290">This helps you automate bot testing.</span></span>
>
> <span data-ttu-id="e794e-291">Esses pacotes são fornecidos como código de exemplo do utilitário e vêm sem garantia de suporte ou atualizações.</span><span class="sxs-lookup"><span data-stu-id="e794e-291">These packages are provided as utility sample code, and come with no guarantee of support or updates.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="e794e-292">Considerações sobre disponibilidade</span><span class="sxs-lookup"><span data-stu-id="e794e-292">Availability considerations</span></span>

<span data-ttu-id="e794e-293">Ao distribuir novos recursos ou correções de bugs para o bot, é melhor usar vários ambientes de implantação, como preparo e produção.</span><span class="sxs-lookup"><span data-stu-id="e794e-293">As you roll out new features or bug fixes to your bot, it's best to use multiple deployment environments, such as staging and production.</span></span> <span data-ttu-id="e794e-294">O uso de [slots][ slots] de implantação do [Azure DevOps ][devops] permite que você faça isso sem incorrer em tempo de inatividade.</span><span class="sxs-lookup"><span data-stu-id="e794e-294">Using deployment [slots][slots] from [Azure DevOps][devops] allows you to do this with zero downtime.</span></span> <span data-ttu-id="e794e-295">Você pode testar suas atualizações mais recentes no ambiente de preparo antes de passá-las para o ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="e794e-295">You can test your latest upgrades in the staging environment before swapping them to the production environment.</span></span> <span data-ttu-id="e794e-296">Em termos de tratamento de carga, o Serviço de Aplicativo foi projetado para escalar vertical ou horizontalmente, de forma manual ou automática.</span><span class="sxs-lookup"><span data-stu-id="e794e-296">In terms of handling load, App Service is designed to scale up or out manually or automatically.</span></span> <span data-ttu-id="e794e-297">Como seu bot fica hospedado na infraestrutura de datacenter global da Microsoft, o SLA do Serviço de Aplicativo promete alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="e794e-297">Because your bot is hosted in Microsoft's global datacenter infrastructure, the App Service SLA promises high availability.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="e794e-298">Considerações de segurança</span><span class="sxs-lookup"><span data-stu-id="e794e-298">Security considerations</span></span>

<span data-ttu-id="e794e-299">Assim como acontece com qualquer outro aplicativo, o bot pode ser projetado para lidar com dados confidenciais.</span><span class="sxs-lookup"><span data-stu-id="e794e-299">As with any other application, the bot can be designed to handle sensitive data.</span></span> <span data-ttu-id="e794e-300">Ou seja: restringir quem pode entrar e usar o bot.</span><span class="sxs-lookup"><span data-stu-id="e794e-300">Therefore, restrict who can sign in and use the bot.</span></span> <span data-ttu-id="e794e-301">Também limitar quais dados podem ser acessados com base na identidade ou na função do usuário.</span><span class="sxs-lookup"><span data-stu-id="e794e-301">Also limit which data can be accessed, based on the user's identity or role.</span></span> <span data-ttu-id="e794e-302">Use o Azure AD para o controle de acesso e identidade e o Key Vault para gerenciar chaves e segredos.</span><span class="sxs-lookup"><span data-stu-id="e794e-302">Use Azure AD for identity and access control and Key Vault to manage keys and secrets.</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="e794e-303">Considerações sobre capacidade de gerenciamento</span><span class="sxs-lookup"><span data-stu-id="e794e-303">Manageability considerations</span></span>

### <a name="monitoring-and-reporting"></a><span data-ttu-id="e794e-304">Monitoramento e emissão de relatórios</span><span class="sxs-lookup"><span data-stu-id="e794e-304">Monitoring and reporting</span></span>

<span data-ttu-id="e794e-305">Depois que o bot é executado na produção, você precisará de uma equipe de DevOps para mantê-lo em funcionamento.</span><span class="sxs-lookup"><span data-stu-id="e794e-305">Once your bot is running in production, you will need a DevOps team to keep it that way.</span></span> <span data-ttu-id="e794e-306">Monitore o sistema continuamente para fazer com que o bot tenha desempenho máximo.</span><span class="sxs-lookup"><span data-stu-id="e794e-306">Continually monitor the system to ensure the bot operates at peak performance.</span></span> <span data-ttu-id="e794e-307">Use os logs enviados ao Application Insights ou ao Cosmos DB para criar painéis de monitoramento, seja usando o próprio Application Insights, o Power BI ou um painel de aplicativo Web personalizado.</span><span class="sxs-lookup"><span data-stu-id="e794e-307">Use the logs sent to Application Insights or Cosmos DB to create monitoring dashboards, either using Application Insights itself, Power BI, or a custom web app dashboard.</span></span> <span data-ttu-id="e794e-308">Envie alertas para a equipe de DevOps em caso de erros críticos ou desempenho abaixo do limite aceitável.</span><span class="sxs-lookup"><span data-stu-id="e794e-308">Send alerts to the DevOps team if critical errors occur or performance falls below an acceptable threshold.</span></span>

### <a name="automated-resource-deployment"></a><span data-ttu-id="e794e-309">Implantação automática de recursos</span><span class="sxs-lookup"><span data-stu-id="e794e-309">Automated resource deployment</span></span>

<span data-ttu-id="e794e-310">O bot em si é apenas parte de um sistema maior que fornece a ele os dados mais recentes e garante seu devido funcionamento.</span><span class="sxs-lookup"><span data-stu-id="e794e-310">The bot itself is only part of a larger system that provides it with the latest data and ensures its proper operation.</span></span> <span data-ttu-id="e794e-311">Todos esses outros serviços de orquestração &mdash; de dados dos recursos do Azure, como o Data Factory, serviços de armazenamento, como o Cosmos DB, e assim por diante &mdash; devem ser implantados.</span><span class="sxs-lookup"><span data-stu-id="e794e-311">All of these other Azure resources &mdash; data orchestration services such as Data Factory, storage services such as Cosmos DB, and so forth &mdash; must be deployed.</span></span> <span data-ttu-id="e794e-312">O Azure Resource Manager fornece uma camada de gerenciamento consistente que você pode acessar pelo portal do Azure, pelo PowerShell ou pela CLI do Azure.</span><span class="sxs-lookup"><span data-stu-id="e794e-312">Azure Resource Manager provides a consistent management layer that you can access through the Azure portal, PowerShell, or the Azure CLI.</span></span> <span data-ttu-id="e794e-313">Para fins de velocidade e consistência, é melhor automatizar a implantação usando uma das abordagens apresentadas.</span><span class="sxs-lookup"><span data-stu-id="e794e-313">For speed and consistency, it's best to automate your deployment using one of these approaches.</span></span>

### <a name="continuous-bot-deployment"></a><span data-ttu-id="e794e-314">Implantação contínua do bot</span><span class="sxs-lookup"><span data-stu-id="e794e-314">Continuous bot deployment</span></span>

<span data-ttu-id="e794e-315">Você pode implantar a lógica do bot diretamente de seu IDE ou de uma linha de comando, como a CLI do Azure.</span><span class="sxs-lookup"><span data-stu-id="e794e-315">You can deploy the bot logic directly from your IDE or from a command line, such as the Azure CLI.</span></span> <span data-ttu-id="e794e-316">No entanto, à medida que seu bot amadurece, é melhor usar um processo de implantação contínua com uma solução de CI/CD como o Azure DevOps, conforme descrito no artigo [Configurar implantação contínua](/azure/bot-service/bot-service-build-continuous-deployment).</span><span class="sxs-lookup"><span data-stu-id="e794e-316">As your bot matures, however, it's best to use a continual deployment process using a CI/CD solution such as Azure DevOps, as described in the article [Set up continuous deployment](/azure/bot-service/bot-service-build-continuous-deployment).</span></span> <span data-ttu-id="e794e-317">Essa é uma boa maneira de reduzir o atrito ao testar novos recursos e correções no bot em um ambiente quase igual ao de produção.</span><span class="sxs-lookup"><span data-stu-id="e794e-317">This is a good way to ease the friction in testing new features and fixes in your bot in a near-production environment.</span></span> <span data-ttu-id="e794e-318">Também é uma boa ideia ter vários ambientes de implantação; no mínimo, um de preparo e um de produção.</span><span class="sxs-lookup"><span data-stu-id="e794e-318">It's also a good idea to have multiple deployment environments, typically at least staging and production.</span></span> <span data-ttu-id="e794e-319">O Azure DevOps dá suporte a essa abordagem.</span><span class="sxs-lookup"><span data-stu-id="e794e-319">Azure DevOps supports this approach.</span></span>

<!-- links -->

[0]: ./_images/conversational-bot.png
[aad]: /azure/active-directory/
[activities]: /azure/bot-service/rest-api/bot-framework-rest-connector-activities
[aml]: /azure/machine-learning/service/
[app-insights]: /azure/azure-monitor/app/app-insights-overview
[app-service]: /azure/app-service/
[blob]: /azure/storage/blobs/storage-blobs-introduction
[bot-authentication]: /azure/bot-service/bot-builder-authentication
[bot-framework]: https://dev.botframework.com/
[bot-framework-service]: /azure/bot-service/bot-builder-basics
[cognitive-services]: /azure/cognitive-services/welcome
[conversations]: /azure/bot-service/bot-service-design-conversation-flow
[cosmosdb]: /azure/cosmos-db/
[data-factory]: /azure/data-factory/
[data-factory-ref-arch]: ../data/enterprise-bi-adf.md
[devops]: https://azure.microsoft.com/solutions/devops/
[functions]: /azure/azure-functions/
[functions-triggers]: /azure/azure-functions/functions-triggers-bindings
[git-repo-appinsights-logger]: https://github.com/Microsoft/botbuilder-utils-js/tree/master/packages/botbuilder-transcript-app-insights
[git-repo-base]: https://github.com/Microsoft/botbuilder-utils-js
[git-repo-cosmosdb-logger]: https://github.com/Microsoft/botbuilder-utils-js/tree/master/packages/botbuilder-transcript-cosmosdb
[git-repo-feedback-util]: https://github.com/Microsoft/botbuilder-utils-js/tree/master/packages/botbuilder-feedback
[git-repo-testing-util]: https://github.com/Microsoft/botbuilder-utils-js/tree/master/packages/botbuilder-http-test-recorder
[testing-util]: https://github.com/Microsoft/botbuilder-utils-js/tree/master/packages/botbuilder-http-test-recorder
[key-vault]: /azure/key-vault/
[lda]: https://wikipedia.org/wiki/Latent_Dirichlet_allocation/
[logic-apps]: /azure/logic-apps/logic-apps-overview
[luis]: /azure/cognitive-services/luis/
[power-bi]: /power-bi/
[qna-maker]: /azure/cognitive-services/QnAMaker/
[search]: /azure/search/
[slots]: /azure/app-service/deploy-staging-slots/
[synonyms]: /azure/search/search-synonyms
[transcript-storage]: /azure/bot-service/bot-builder-howto-v4-storage
[turns]: /azure/bot-service/bot-builder-basics#defining-a-turn
[vscode]: https://azure.microsoft.com/products/visual-studio-code/
[webapp]: /azure/app-service/overview
[webchat]: /azure/bot-service/bot-service-channel-connect-webchat?view=azure-bot-service-4.0/

[cosmosdb-logger]: https://github.com/Microsoft/botbuilder-utils-js/tree/master/packages/botbuilder-transcript-cosmosdb
[appinsights-logger]: https://github.com/Microsoft/botbuilder-utils-js/tree/master/packages/botbuilder-transcript-app-insights
[feedback-util]: https://github.com/Microsoft/botbuilder-utils-js/tree/master/packages/botbuilder-feedback
[testing util]: https://github.com/Microsoft/botbuilder-utils-js/tree/master/packages/botbuilder-http-test-recorder

