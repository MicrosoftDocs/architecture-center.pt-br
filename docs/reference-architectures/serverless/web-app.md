---
title: Aplicativo web sem servidor
titleSuffix: Azure Reference Architectures
description: Arquitetura recomendada para um aplicativo Web sem servidor e a API Web.
author: MikeWasson
ms.date: 10/16/2018
ms.custom: seodec18
ms.openlocfilehash: 71c6bcdb35ba19435566086386ba7260581fec19
ms.sourcegitcommit: 680c9cef945dff6fee5e66b38e24f07804510fa9
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/04/2019
ms.locfileid: "54011388"
---
# <a name="serverless-web-application-on-azure"></a><span data-ttu-id="eb7b2-103">Aplicativo Web sem servidor no Azure</span><span class="sxs-lookup"><span data-stu-id="eb7b2-103">Serverless web application on Azure</span></span>

<span data-ttu-id="eb7b2-104">Esta arquitetura de referência mostra um aplicativo Web [sem servidor](https://azure.microsoft.com/solutions/serverless/).</span><span class="sxs-lookup"><span data-stu-id="eb7b2-104">This reference architecture shows a [serverless](https://azure.microsoft.com/solutions/serverless/) web application.</span></span> <span data-ttu-id="eb7b2-105">O aplicativo fornece conteúdo estático do Armazenamento de Blobs do Azure e implementa uma API usando o Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-105">The application serves static content from Azure Blob Storage, and implements an API using Azure Functions.</span></span> <span data-ttu-id="eb7b2-106">A API lê dados do Cosmos DB e retorna os resultados para o aplicativo Web.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-106">The API reads data from Cosmos DB and returns the results to the web app.</span></span> <span data-ttu-id="eb7b2-107">Há uma implantação de referência para essa arquitetura de referência disponível no [GitHub][github].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-107">A reference implementation for this architecture is available on [GitHub][github].</span></span>

![Arquitetura de referência para um aplicativo Web sem servidor](./_images/serverless-web-app.png)

<span data-ttu-id="eb7b2-109">O termo "sem servidor" tem dois significados diferentes, porém relacionados:</span><span class="sxs-lookup"><span data-stu-id="eb7b2-109">The term serverless has two distinct but related meanings:</span></span>

- <span data-ttu-id="eb7b2-110">**Back-end como serviço** (BaaS).</span><span class="sxs-lookup"><span data-stu-id="eb7b2-110">**Backend as a service** (BaaS).</span></span> <span data-ttu-id="eb7b2-111">Os serviços de nuvem de back-end, como bancos de dados e armazenamento, fornecem APIs que permitem aos aplicativos cliente se conectarem diretamente a esses serviços.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-111">Backend cloud services, such as databases and storage, provide APIs that enable client applications to connect directly to these services.</span></span>
- <span data-ttu-id="eb7b2-112">**Funções como serviço** (FaaS).</span><span class="sxs-lookup"><span data-stu-id="eb7b2-112">**Functions as a service** (FaaS).</span></span> <span data-ttu-id="eb7b2-113">Nesse modelo, uma "função" é um trecho de código implantado na nuvem e executado dentro de um ambiente de hospedagem que abstrai completamente os servidores que executam o código.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-113">In this model, a "function" is a piece of code that is deployed to the cloud and runs inside a hosting environment that completely abstracts the servers that run the code.</span></span>

<span data-ttu-id="eb7b2-114">As duas definições têm em comum a ideia de que os desenvolvedores e a equipe de DevOps não precisam implantar, configurar ou gerenciar servidores.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-114">Both definitions have in common the idea that developers and DevOps personnel don't need to deploy, configure, or manage servers.</span></span> <span data-ttu-id="eb7b2-115">Esta arquitetura de referência foca no FaaS usando o Azure Functions, embora o fornecimento de conteúdo da Web do Armazenamento de Blobs do Azure seja um exemplo de BaaS.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-115">This reference architecture focuses on FaaS using Azure Functions, although serving web content from Azure Blob Storage is an example of BaaS.</span></span> <span data-ttu-id="eb7b2-116">Veja algumas características importantes do FaaS:</span><span class="sxs-lookup"><span data-stu-id="eb7b2-116">Some important characteristics of FaaS are:</span></span>

1. <span data-ttu-id="eb7b2-117">Os recursos de computação são alocados dinamicamente conforme exigido pela plataforma.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-117">Compute resources are allocated dynamically as needed by the platform.</span></span>
1. <span data-ttu-id="eb7b2-118">Preço com base no consumo: Você recebe uma cobrança apenas pelos recursos de computação usados para execução do seu código.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-118">Consumption-based pricing: You are charged only for the compute resources used to execute your code.</span></span>
1. <span data-ttu-id="eb7b2-119">Os recursos de computação aumentam sob demanda com base no tráfego, sem que o desenvolvedor precise realizar qualquer configuração.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-119">The compute resources scale on demand based on traffic, without the developer needing to do any configuration.</span></span>

<span data-ttu-id="eb7b2-120">As funções são executadas quando um gatilho externo ocorre, como uma solicitação HTTP ou uma mensagem que chega a uma fila.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-120">Functions are executed when an external trigger occurs, such as an HTTP request or a message arriving on a queue.</span></span> <span data-ttu-id="eb7b2-121">Isso faz com que um [estilo de arquitetura orientada a eventos][event-driven] seja natural para arquiteturas sem servidor.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-121">This makes an [event-driven architecture style][event-driven] natural for serverless architectures.</span></span> <span data-ttu-id="eb7b2-122">Para coordenar o trabalho entre os componentes da arquitetura, considere o uso de agentes de mensagens ou padrões de pub/sub.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-122">To coordinate work between components in the architecture, consider using message brokers or pub/sub patterns.</span></span> <span data-ttu-id="eb7b2-123">Para obter ajuda com a escolha entre as tecnologias de mensagens no Azure, confira [Escolher entre os serviços do Azure que entregam mensagens][azure-messaging].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-123">For help choosing between messaging technologies in Azure, see [Choose between Azure services that deliver messages][azure-messaging].</span></span>

## <a name="architecture"></a><span data-ttu-id="eb7b2-124">Arquitetura</span><span class="sxs-lookup"><span data-stu-id="eb7b2-124">Architecture</span></span>

<span data-ttu-id="eb7b2-125">Essa arquitetura consiste nos seguintes componentes:</span><span class="sxs-lookup"><span data-stu-id="eb7b2-125">The architecture consists of the following components:</span></span>

<span data-ttu-id="eb7b2-126">**Armazenamento de Blobs**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-126">**Blob Storage**.</span></span> <span data-ttu-id="eb7b2-127">O conteúdo Web estático, como arquivos HTML, CSS e JavaScript, é armazenado no Armazenamento de Blobs do Azure e fornecido aos clientes usando a [hospedagem de site estático][static-hosting].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-127">Static web content, such as HTML, CSS, and JavaScript files, are stored in Azure Blob Storage and served to clients by using [static website hosting][static-hosting].</span></span> <span data-ttu-id="eb7b2-128">Toda a interação dinâmica ocorre através das chamadas do código JavaScript para as APIs de back-end.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-128">All dynamic interaction happens through JavaScript code making calls to the backend APIs.</span></span> <span data-ttu-id="eb7b2-129">Não há código do lado do servidor para renderizar a página da Web.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-129">There is no server-side code to render the web page.</span></span> <span data-ttu-id="eb7b2-130">A hospedagem do site estático oferece suporte à indexação de documentos e páginas de erro 404 personalizadas.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-130">Static website hosting supports index documents and custom 404 error pages.</span></span>

> [!NOTE]
> <span data-ttu-id="eb7b2-131">A hospedagem do site estático está em [versão prévia][static-hosting-preview] no momento.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-131">Static website hosting is currently in [preview][static-hosting-preview].</span></span>

<span data-ttu-id="eb7b2-132">**CDN**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-132">**CDN**.</span></span> <span data-ttu-id="eb7b2-133">Use a CDN ([Rede de Distribuição de Conteúdo do Azure][cdn]) para armazenar em cache o conteúdo para latência mais baixa e distribuição mais rápida do conteúdo, além de fornecer um ponto de extremidade HTTPS.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-133">Use [Azure Content Delivery Network][cdn] (CDN) to cache content for lower latency and faster delivery of content, as well as providing an HTTPS endpoint.</span></span>

<span data-ttu-id="eb7b2-134">**Aplicativos de Funções**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-134">**Function Apps**.</span></span> <span data-ttu-id="eb7b2-135">O [Azure Functions][functions] é uma opção de computação sem servidor.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-135">[Azure Functions][functions] is a serverless compute option.</span></span> <span data-ttu-id="eb7b2-136">Ele usa um modelo controlado por eventos, em que um trecho de código (uma "função") é invocado por um gatilho.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-136">It uses an event-driven model, where a piece of code (a "function") is invoked by a trigger.</span></span> <span data-ttu-id="eb7b2-137">Nessa arquitetura, a função é invocada quando um cliente faz uma solicitação HTTP.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-137">In this architecture, the function is invoked when a client makes an HTTP request.</span></span> <span data-ttu-id="eb7b2-138">A solicitação é sempre roteada por meio de um gateway de API, descrito abaixo.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-138">The request is always routed through an API gateway, described below.</span></span>

<span data-ttu-id="eb7b2-139">**Gerenciamento de API**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-139">**API Management**.</span></span> <span data-ttu-id="eb7b2-140">O [Gerenciamento de API][apim] fornece um gateway de API localizado à frente da função HTTP.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-140">[API Management][apim] provides a API gateway that sits in front of the HTTP function.</span></span> <span data-ttu-id="eb7b2-141">Use o Gerenciamento de API para publicar e gerenciar APIs usadas por aplicativos cliente.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-141">You can use API Management to publish and manage APIs used by client applications.</span></span> <span data-ttu-id="eb7b2-142">O uso de um gateway ajuda a desacoplar o aplicativo de front-end das APIs de back-end.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-142">Using a gateway helps to decouple the front-end application from the back-end APIs.</span></span> <span data-ttu-id="eb7b2-143">Por exemplo, o Gerenciamento de API pode reescrever URLs, transformar solicitações antes que elas atinjam o back-end, definir cabeçalhos de solicitação ou resposta e assim por diante.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-143">For example, API Management can rewrite URLs, transform requests before they reach the backend, set request or response headers, and so forth.</span></span>

<span data-ttu-id="eb7b2-144">O Gerenciamento de API também pode ser usado para implementar características transversais, como:</span><span class="sxs-lookup"><span data-stu-id="eb7b2-144">API Management can also be used to implement cross-cutting concerns such as:</span></span>

- <span data-ttu-id="eb7b2-145">Imposição do uso de cotas e limites de taxa</span><span class="sxs-lookup"><span data-stu-id="eb7b2-145">Enforcing usage quotas and rate limits</span></span>
- <span data-ttu-id="eb7b2-146">Validação de tokens OAuth para autenticação</span><span class="sxs-lookup"><span data-stu-id="eb7b2-146">Validating OAuth tokens for authentication</span></span>
- <span data-ttu-id="eb7b2-147">Habilitação de CORS (solicitações entre origens)</span><span class="sxs-lookup"><span data-stu-id="eb7b2-147">Enabling cross-origin requests (CORS)</span></span>
- <span data-ttu-id="eb7b2-148">Armazenamento de respostas em cache</span><span class="sxs-lookup"><span data-stu-id="eb7b2-148">Caching responses</span></span>
- <span data-ttu-id="eb7b2-149">Monitoramento e registro em log de solicitações</span><span class="sxs-lookup"><span data-stu-id="eb7b2-149">Monitoring and logging requests</span></span>

<span data-ttu-id="eb7b2-150">Se você não precisar de toda a funcionalidade fornecida pelo Gerenciamento de API, outra opção será usar [Proxies do Functions][functions-proxy].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-150">If you don't need all of the functionality provided by API Management, another option is to use [Functions Proxies][functions-proxy].</span></span> <span data-ttu-id="eb7b2-151">Esse recurso do Azure Functions permite a definição de uma única superfície de API para vários aplicativos de funções por meio da criação de rotas para funções de back-end.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-151">This feature of Azure Functions lets you define a single API surface for multiple function apps, by creating routes to back-end functions.</span></span> <span data-ttu-id="eb7b2-152">Os proxies de função também podem executar transformações limitadas na solicitação e resposta HTTP.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-152">Function proxies can also perform limited transformations on the HTTP request and response.</span></span> <span data-ttu-id="eb7b2-153">No entanto, eles não fornecem os mesmos recursos avançados baseados em política do Gerenciamento de API.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-153">However, they don't provide the same rich policy-based capabilities of API Management.</span></span>

<span data-ttu-id="eb7b2-154">**Cosmos DB**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-154">**Cosmos DB**.</span></span> <span data-ttu-id="eb7b2-155">O [Cosmos DB][cosmosdb] é um serviço de banco de dados multimodelo.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-155">[Cosmos DB][cosmosdb] is a multi-model database service.</span></span> <span data-ttu-id="eb7b2-156">Para esse cenário, o aplicativo de função busca documentos do Cosmos DB em resposta a solicitações HTTP GET do cliente.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-156">For this scenario, the function application fetches documents from Cosmos DB in response to HTTP GET requests from the client.</span></span>

<span data-ttu-id="eb7b2-157">**Azure Active Directory** (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="eb7b2-157">**Azure Active Directory** (Azure AD).</span></span> <span data-ttu-id="eb7b2-158">Os usuários fazem logon no aplicativo Web usando suas credenciais do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-158">Users sign into the web application by using their Azure AD credentials.</span></span> <span data-ttu-id="eb7b2-159">O Azure AD retorna um token de acesso para a API, que o aplicativo Web usa para autenticar solicitações de API (confira [Autenticação](#authentication)).</span><span class="sxs-lookup"><span data-stu-id="eb7b2-159">Azure AD returns an access token for the API, which the web application uses to authenticate API requests (see [Authentication](#authentication)).</span></span>

<span data-ttu-id="eb7b2-160">**Azure Monitor**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-160">**Azure Monitor**.</span></span> <span data-ttu-id="eb7b2-161">O [Monitor][monitor] coleta métricas de desempenho sobre os serviços do Azure implantados na solução.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-161">[Monitor][monitor] collects performance metrics about the Azure services deployed in the solution.</span></span> <span data-ttu-id="eb7b2-162">Ao visualizá-las em um painel, você obtém informações sobre a integridade da solução.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-162">By visualizing these in a dashboard, you can get visibility into the health of the solution.</span></span> <span data-ttu-id="eb7b2-163">O Monitor também coletou logs de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-163">It also collected application logs.</span></span>

<span data-ttu-id="eb7b2-164">**Azure Pipelines**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-164">**Azure Pipelines**.</span></span> <span data-ttu-id="eb7b2-165">O [Pipelines][pipelines] é um serviço de CI (integração contínua) e CD (entrega contínua) que compila, testa e implanta o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-165">[Pipelines][pipelines] is a continuous integration (CI) and continuous delivery (CD) service that builds, tests, and deploys the application.</span></span>

## <a name="recommendations"></a><span data-ttu-id="eb7b2-166">Recomendações</span><span class="sxs-lookup"><span data-stu-id="eb7b2-166">Recommendations</span></span>

### <a name="function-app-plans"></a><span data-ttu-id="eb7b2-167">Planos do Aplicativo de funções</span><span class="sxs-lookup"><span data-stu-id="eb7b2-167">Function App plans</span></span>

<span data-ttu-id="eb7b2-168">O Azure Functions dá suporte a dois modelos de hospedagem.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-168">Azure Functions supports two hosting models.</span></span> <span data-ttu-id="eb7b2-169">O **plano de consumo** aloca automaticamente a potência de computação quando o código estiver em execução.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-169">With the **consumption plan**, compute power is automatically allocated when your code is running.</span></span>  <span data-ttu-id="eb7b2-170">Com o plano de **Serviço de Aplicativo**, um conjunto de VMs é alocado para seu código.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-170">With the **App Service** plan, a set of VMs are allocated for your code.</span></span> <span data-ttu-id="eb7b2-171">O plano de Serviço de Aplicativo define o número de VMs e o tamanho da VM.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-171">The App Service plan defines the number of VMs and the VM size.</span></span>

<span data-ttu-id="eb7b2-172">Observe que o plano de Serviço de Aplicativo não é estritamente *sem servidor*, de acordo com a definição fornecida acima.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-172">Note that the App Service plan is not strictly *serverless*, according to the definition given above.</span></span> <span data-ttu-id="eb7b2-173">O modelo de programação é o mesmo, porém &mdash; o mesmo código de função pode ser executado em um plano de consumo e em um plano de Serviço de Aplicativo.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-173">The programming model is the same, however &mdash; the same function code can run in both a consumption plan and an App Service plan.</span></span>

<span data-ttu-id="eb7b2-174">Veja alguns fatores a serem considerados ao escolher qual tipo de plano usar:</span><span class="sxs-lookup"><span data-stu-id="eb7b2-174">Here are some factors to consider when choosing which type of plan to use:</span></span>

- <span data-ttu-id="eb7b2-175">**Inicialização a frio**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-175">**Cold start**.</span></span> <span data-ttu-id="eb7b2-176">Com o plano de consumo, uma função que não foi invocada recentemente incorre em alguma latência adicional na próxima vez que for executada.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-176">With the consumption plan, a function that hasn't been invoked recently will incur some additional latency the next time it runs.</span></span> <span data-ttu-id="eb7b2-177">A latência adicional ocorre devido à alocação e à preparação do ambiente de tempo de execução.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-177">This additional latency is due to allocating and preparing the runtime environment.</span></span> <span data-ttu-id="eb7b2-178">Normalmente, demora segundos, mas depende de vários fatores, incluindo o número de dependências que precisam ser carregadas.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-178">It is usually on the order of seconds but depends on several factors, including the number of dependencies that need to be loaded.</span></span> <span data-ttu-id="eb7b2-179">Para saber mais, confira [Noções básicas sobre a inicialização a frio sem servidor][functions-cold-start].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-179">For more information, see [Understanding Serverless Cold Start][functions-cold-start].</span></span> <span data-ttu-id="eb7b2-180">Normalmente, a inicialização a frio é uma preocupação para cargas de trabalho interativas (gatilhos HTTP) do que para cargas de trabalho assíncronas orientadas a mensagem (gatilhos de fila ou hubs de evento), pois a latência adicional é observada diretamente pelos usuários.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-180">Cold start is usually more of a concern for interactive workloads (HTTP triggers) than asynchronous message-driven workloads (queue or event hubs triggers), because the additional latency is directly observed by users.</span></span>
- <span data-ttu-id="eb7b2-181">**Tempo limite**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-181">**Timeout period**.</span></span>  <span data-ttu-id="eb7b2-182">Em um plano de consumo, o tempo de execução de uma função expira após um período [configurável][functions-timeout] (até 10 minutos, no máximo)</span><span class="sxs-lookup"><span data-stu-id="eb7b2-182">In the consumption plan, a function execution times out after a [configurable][functions-timeout] period of time (to a maximum of 10 minutes)</span></span>
- <span data-ttu-id="eb7b2-183">**Isolamento da rede virtual**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-183">**Virtual network isolation**.</span></span> <span data-ttu-id="eb7b2-184">O uso de um plano de Serviço de Aplicativo permite a execução das funções dentro de um [Ambiente de Serviço de Aplicativo][ase], que é um ambiente de hospedagem dedicado e isolado.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-184">Using an App Service plan allows functions to run inside of an [App Service Environment][ase], which is a dedicated and isolated hosting environment.</span></span>
- <span data-ttu-id="eb7b2-185">**Modelo de preços**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-185">**Pricing model**.</span></span> <span data-ttu-id="eb7b2-186">O plano de consumo é cobrado pelo número de execuções e pelo consumo de recursos (tempo de execução da memória &times;).</span><span class="sxs-lookup"><span data-stu-id="eb7b2-186">The consumption plan is billed by the number of executions and resource consumption (memory &times; execution time).</span></span> <span data-ttu-id="eb7b2-187">O plano de Serviço de Aplicativo é cobrado por hora com base no SKU da instância da VM.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-187">The App Service plan is billed hourly based on VM instance SKU.</span></span> <span data-ttu-id="eb7b2-188">Geralmente, o plano de consumo é mais barato que um plano de Serviço de Aplicativo, pois você paga apenas pelos recursos de computação que usar.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-188">Often, the consumption plan can be cheaper than an App Service plan, because you pay only for the compute resources that you use.</span></span> <span data-ttu-id="eb7b2-189">Principalmente se o tráfego apresentar picos e ciclos.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-189">This is especially true if your traffic experiences peaks and troughs.</span></span> <span data-ttu-id="eb7b2-190">No entanto, se um aplicativo apresentar uma taxa de transferência de alto volume constante, um plano de Serviço de Aplicativo poderá custar menos do que o plano de consumo.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-190">However, if an application experiences constant high-volume throughput, an App Service plan may cost less than the consumption plan.</span></span>
- <span data-ttu-id="eb7b2-191">**Dimensionamento**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-191">**Scaling**.</span></span> <span data-ttu-id="eb7b2-192">Uma grande vantagem do modelo de consumo é que ele se ajusta dinamicamente conforme o necessário, com base no tráfego de entrada.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-192">A big advantage of the consumption model is that it scales dynamically as needed, based on the incoming traffic.</span></span> <span data-ttu-id="eb7b2-193">Embora esse dimensionamento ocorra rapidamente, ainda há um período de crescimento.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-193">While this scaling occurs quickly, there is still a ramp-up period.</span></span> <span data-ttu-id="eb7b2-194">Para algumas cargas de trabalho, convém sobreprovisionar deliberadamente as VMs, para que você possa lidar com picos de tráfego com um tempo de crescimento nulo.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-194">For some workloads, you might want to deliberately overprovision the VMs, so that you can handle bursts of traffic with zero ramp-up time.</span></span> <span data-ttu-id="eb7b2-195">Nesse caso, considere um plano de Serviço de Aplicativo.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-195">In that case, consider an App Service plan.</span></span>

### <a name="function-app-boundaries"></a><span data-ttu-id="eb7b2-196">Limites do Aplicativo de funções</span><span class="sxs-lookup"><span data-stu-id="eb7b2-196">Function App boundaries</span></span>

<span data-ttu-id="eb7b2-197">Um *aplicativo de funções* hospeda a execução de uma ou mais *funções*.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-197">A *function app* hosts the execution of one or more *functions*.</span></span> <span data-ttu-id="eb7b2-198">Use um aplicativo de funções para agrupar várias funções como uma unidade lógica.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-198">You can use a function app to group several functions together as a logical unit.</span></span> <span data-ttu-id="eb7b2-199">Dentro de um aplicativo de funções, as funções compartilham as mesmas configurações de aplicativo, plano de hospedagem e ciclo de vida de implantação.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-199">Within a function app, the functions share the same application settings, hosting plan, and deployment lifecycle.</span></span> <span data-ttu-id="eb7b2-200">Cada aplicativo de funções tem seu próprio nome de host.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-200">Each function app has its own hostname.</span></span>

<span data-ttu-id="eb7b2-201">Use os aplicativos de função para agrupar funções que compartilham o mesmo ciclo de vida e configurações.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-201">Use function apps to group functions that share the same lifecycle and settings.</span></span> <span data-ttu-id="eb7b2-202">Funções que não compartilham o mesmo ciclo de vida devem ser hospedadas em aplicativos de funções diferentes.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-202">Functions that don't share the same lifecycle should be hosted in different function apps.</span></span>

<span data-ttu-id="eb7b2-203">Analise o uso de uma abordagem de microsserviços, em que cada aplicativo de funções representa um microsserviço, possivelmente composto por várias funções relacionadas.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-203">Consider taking a microservices approach, where each function app represents one microservice, possibly consisting of several related functions.</span></span> <span data-ttu-id="eb7b2-204">Em uma arquitetura de microsserviços, os serviços devem ter um acoplamento flexível e alta coesão funcional.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-204">In a microservices architecture, services should have loose coupling and high functional cohesion.</span></span> <span data-ttu-id="eb7b2-205">O acoplamento *flexível* significa que você pode alterar um serviço sem a necessidade de atualizar simultaneamente outros serviços.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-205">*Loosely* coupled means you can change one service without requiring other services to be updated at the same time.</span></span> <span data-ttu-id="eb7b2-206">*Coesão* significa que um serviço tem uma finalidade única e bem definida.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-206">*Cohesive* means a service has a single, well-defined purpose.</span></span> <span data-ttu-id="eb7b2-207">Para saber mais sobre essas ideias, confira [Criação de microsserviços: Análise de domínio][microservices-domain-analysis].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-207">For more discussion of these ideas, see [Designing microservices: Domain analysis][microservices-domain-analysis].</span></span>

### <a name="function-bindings"></a><span data-ttu-id="eb7b2-208">Associações de função</span><span class="sxs-lookup"><span data-stu-id="eb7b2-208">Function bindings</span></span>

<span data-ttu-id="eb7b2-209">Use as [associações][functions-bindings] do Functions quando possível.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-209">Use Functions [bindings][functions-bindings] when possible.</span></span> <span data-ttu-id="eb7b2-210">As associações fornecem uma maneira declarativa de conectar seu código aos dados e integrá-los a outros serviços do Azure.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-210">Bindings provide a declarative way to connect your code to data and integrate with other Azure services.</span></span> <span data-ttu-id="eb7b2-211">Uma associação de entrada preenche um parâmetro de entrada de uma fonte de dados externa.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-211">An input binding populates an input parameter from an external data source.</span></span> <span data-ttu-id="eb7b2-212">Uma associação de saída envia o valor de retorno da função para um coletor de dados, como uma fila ou um banco de dados.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-212">An output binding sends the function's return value to a data sink, such as a queue or database.</span></span>

<span data-ttu-id="eb7b2-213">Por exemplo, a função `GetStatus` na implementação de referência usa a [associação de entrada][cosmosdb-input-binding] do Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-213">For example, the `GetStatus` function in the reference implementation uses the Cosmos DB [input binding][cosmosdb-input-binding].</span></span> <span data-ttu-id="eb7b2-214">Essa associação é configurada para pesquisar um documento no Cosmos DB usando os parâmetros de consulta obtidos da cadeia de consulta da solicitação HTTP.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-214">This binding is configured to look up a document in Cosmos DB, using query parameters that are taken from the query string in the HTTP request.</span></span> <span data-ttu-id="eb7b2-215">Se o documento for encontrado, ele será passado para a função como um parâmetro.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-215">If the document is found, it is passed to the function as a parameter.</span></span>

```csharp
[FunctionName("GetStatusFunction")]
public static Task<IActionResult> Run(
    [HttpTrigger(AuthorizationLevel.Function, "get", Route = null)] HttpRequest req,
    [CosmosDB(
        databaseName: "%COSMOSDB_DATABASE_NAME%",
        collectionName: "%COSMOSDB_DATABASE_COL%",
        ConnectionStringSetting = "COSMOSDB_CONNECTION_STRING",
        Id = "{Query.deviceId}",
        PartitionKey = "{Query.deviceId}")] dynamic deviceStatus,
    ILogger log)
{
    ...
}
```

<span data-ttu-id="eb7b2-216">Ao usar associações, você não precisa escrever um código para se comunicar diretamente com o serviço, o que simplifica o código de função e também abstrai os detalhes da fonte de dados ou do coletor.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-216">By using bindings, you don't need to write code that talks directly to the service, which makes the function code simpler and also abstracts the details of the data source or sink.</span></span> <span data-ttu-id="eb7b2-217">Porém, em alguns casos, talvez você precise de uma lógica mais complexa do que a fornecida pela associação.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-217">In some cases, however, you may need more complex logic than the binding provides.</span></span> <span data-ttu-id="eb7b2-218">Nesse caso, use os SDKs do cliente do Azure diretamente.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-218">In that case, use the Azure client SDKs directly.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="eb7b2-219">Considerações sobre escalabilidade</span><span class="sxs-lookup"><span data-stu-id="eb7b2-219">Scalability considerations</span></span>

<span data-ttu-id="eb7b2-220">**Functions**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-220">**Functions**.</span></span> <span data-ttu-id="eb7b2-221">Para o plano de consumo, o gatilho HTTP é dimensionado com base no tráfego.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-221">For the consumption plan, the HTTP trigger scales based on the traffic.</span></span> <span data-ttu-id="eb7b2-222">Há um limite para o número de instâncias simultâneas de função, mas cada instância pode processar mais de uma solicitação por vez.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-222">There is a limit to the number of concurrent function instances, but each instance can process more than one request at a time.</span></span> <span data-ttu-id="eb7b2-223">No caso de um plano de Serviço de Aplicativo, o gatilho HTTP é dimensionado de acordo com o número de instâncias de VM, que pode ser um valor fixo ou dimensionado automaticamente com base em um conjunto de regras de dimensionamento automático.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-223">For an App Service plan, the HTTP trigger scales according to the number of VM instances, which can be a fixed value or can autoscale based on a set of autoscaling rules.</span></span> <span data-ttu-id="eb7b2-224">Para saber mais, confira [Escala e hospedagem do Azure Functions][functions-scale].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-224">For information, see [Azure Functions scale and hosting][functions-scale].</span></span>

<span data-ttu-id="eb7b2-225">**Cosmos DB**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-225">**Cosmos DB**.</span></span> <span data-ttu-id="eb7b2-226">A capacidade da taxa de transferência para o Cosmos DB é medida em [Unidades de Solicitação][ru] (RU).</span><span class="sxs-lookup"><span data-stu-id="eb7b2-226">Throughput capacity for Cosmos DB is measured in [Request Units][ru] (RU).</span></span> <span data-ttu-id="eb7b2-227">Uma taxa de transferência de 1-RU corresponde à taxa de transferência exigida para obter (GET) um documento de 1 KB.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-227">A 1-RU throughput corresponds to the throughput need to GET a 1KB document.</span></span> <span data-ttu-id="eb7b2-228">Para dimensionar um contêiner do Cosmos DB acima de 10.000 RU, é preciso especificar uma [chave de partição][partition-key] ao criar o contêiner e incluir a chave de partição em todos os documentos criados por você.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-228">In order to scale a Cosmos DB container past 10,000 RU, you must specify a [partition key][partition-key] when you create the container and include the partition key in every document that you create.</span></span> <span data-ttu-id="eb7b2-229">Para saber mais sobre chaves de particionamento, confira [Particionar e dimensionar no Azure Cosmos DB][cosmosdb-scale].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-229">For more information about partition keys, see [Partition and scale in Azure Cosmos DB][cosmosdb-scale].</span></span>

<span data-ttu-id="eb7b2-230">**Gerenciamento de API**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-230">**API Management**.</span></span> <span data-ttu-id="eb7b2-231">O Gerenciamento de API permite escalar horizontalmente e dá suporte ao dimensionamento automático baseado em regra.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-231">API Management can scale out and supports rule-based autoscaling.</span></span> <span data-ttu-id="eb7b2-232">Observe que o processo de dimensionamento demora pelo menos 20 minutos.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-232">Note that the scaling process takes at least 20 minutes.</span></span> <span data-ttu-id="eb7b2-233">Se o tráfego for intermitente, provisione para o tráfego intermitente máximo esperado.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-233">If your traffic is bursty, you should provision for the maximum burst traffic that you expect.</span></span> <span data-ttu-id="eb7b2-234">No entanto, o dimensionamento automático é útil para lidar com variações por hora ou dia no tráfego.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-234">However, autoscaling is useful for handling hourly or daily variations in traffic.</span></span> <span data-ttu-id="eb7b2-235">Para saber mais, confira [Escalar automaticamente uma instância do Gerenciamento de API do Azure][apim-scale].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-235">For more information, see [Automatically scale an Azure API Management instance][apim-scale].</span></span>

## <a name="disaster-recovery-considerations"></a><span data-ttu-id="eb7b2-236">Considerações de recuperação de desastres</span><span class="sxs-lookup"><span data-stu-id="eb7b2-236">Disaster recovery considerations</span></span>

<span data-ttu-id="eb7b2-237">A implantação exibida aqui reside em uma única região do Azure.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-237">The deployment shown here resides in a single Azure region.</span></span> <span data-ttu-id="eb7b2-238">Para uma abordagem mais resiliente à recuperação de desastres, aproveite os recursos de distribuição geográfica de vários serviços:</span><span class="sxs-lookup"><span data-stu-id="eb7b2-238">For a more resilient approach to disaster-recovery, take advantage of the geo-distribution features in the various services:</span></span>

- <span data-ttu-id="eb7b2-239">O Gerenciamento de API oferece suporte à implantação multirregião, que pode ser usada para distribuir uma única instância de Gerenciamento de API por qualquer quantidade de regiões do Azure.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-239">API Management supports multi-region deployment, which can be used to distribute a single API Management instance across any number of Azure regions.</span></span> <span data-ttu-id="eb7b2-240">Para saber mais, confira [Como implantar uma instância do serviço de Gerenciamento de API do Azure em várias regiões do Azure][api-geo].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-240">For more information, see [How to deploy an Azure API Management service instance to multiple Azure regions][api-geo].</span></span>

- <span data-ttu-id="eb7b2-241">Use o [Gerenciador de Tráfego][tm] para rotear as solicitações HTTP para a região primária.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-241">Use [Traffic Manager][tm] to route HTTP requests to the primary region.</span></span> <span data-ttu-id="eb7b2-242">Se o Aplicativo de Funções nessa região ficar indisponível, o Gerenciador de Tráfego realizará o failover para a região secundária.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-242">If the Function App running in that region becomes unavailable, Traffic Manager can fail over to a secondary region.</span></span>

- <span data-ttu-id="eb7b2-243">O Cosmos DB dá suporte a [várias regiões mestres][cosmosdb-geo], o que permite a gravação em qualquer região adicionada à sua conta do Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-243">Cosmos DB supports [multiple master regions][cosmosdb-geo], which enables writes to any region that you add to your Cosmos DB account.</span></span> <span data-ttu-id="eb7b2-244">Se você não habilitar vários mestres, ainda poderá fazer o failover da região de gravação primária.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-244">If you don't enable multi-master, you can still fail over the primary write region.</span></span> <span data-ttu-id="eb7b2-245">Os SDKs de cliente do Cosmos DB e as associações do Azure Functions tratam automaticamente do failover. Dessa forma, você não precisa atualizar as definições de configuração do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-245">The Cosmos DB client SDKs and the Azure Function bindings automatically handle the failover, so you don't need to update any application configuration settings.</span></span>

## <a name="security-considerations"></a><span data-ttu-id="eb7b2-246">Considerações de segurança</span><span class="sxs-lookup"><span data-stu-id="eb7b2-246">Security considerations</span></span>

### <a name="authentication"></a><span data-ttu-id="eb7b2-247">Autenticação</span><span class="sxs-lookup"><span data-stu-id="eb7b2-247">Authentication</span></span>

<span data-ttu-id="eb7b2-248">A API `GetStatus` na implementação de referência usa o Azure AD para autenticar solicitações.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-248">The `GetStatus` API in the reference implementation uses Azure AD to authenticate requests.</span></span> <span data-ttu-id="eb7b2-249">O AD do Azure oferece suporte ao protocolo Open ID Connect, que é um protocolo de autenticação criado sobre o protocolo OAuth 2.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-249">Azure AD supports the Open ID Connect protocol, which is an authentication protocol built on top of the OAuth 2 protocol.</span></span>

<span data-ttu-id="eb7b2-250">Nessa arquitetura, o aplicativo cliente é um aplicativo de página única (SPA) executado no navegador.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-250">In this architecture, the client application is a single-page application (SPA) that runs in the browser.</span></span> <span data-ttu-id="eb7b2-251">Esse tipo de aplicativo cliente não consegue ocultar o segredo de um cliente ou um código de autorização, por isso o fluxo de concessão implícita é apropriado.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-251">This type of client application cannot keep a client secret or an authorization code hidden, so the implicit grant flow is appropriate.</span></span> <span data-ttu-id="eb7b2-252">(Confira [Qual fluxo de OAuth 2.0 devo usar?] [oauth-flow]).</span><span class="sxs-lookup"><span data-stu-id="eb7b2-252">(See [Which OAuth 2.0 flow should I use?][oauth-flow]).</span></span> <span data-ttu-id="eb7b2-253">Veja o fluxo geral:</span><span class="sxs-lookup"><span data-stu-id="eb7b2-253">Here's the overall flow:</span></span>

1. <span data-ttu-id="eb7b2-254">O usuário clica no link "Entrar" no aplicativo Web.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-254">The user clicks the "Sign in" link in the web application.</span></span>
1. <span data-ttu-id="eb7b2-255">O navegador é redirecionado para a página de entrada do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-255">The browser is redirected the Azure AD sign in page.</span></span>
1. <span data-ttu-id="eb7b2-256">O usuário entra.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-256">The user signs in.</span></span>
1. <span data-ttu-id="eb7b2-257">O Azure AD redireciona de volta para o aplicativo cliente, incluindo um token de acesso no fragmento de URL.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-257">Azure AD redirects back to the client application, including an access token in the URL fragment.</span></span>
1. <span data-ttu-id="eb7b2-258">Quando o aplicativo Web chama a API, ele inclui o token de acesso no cabeçalho de Autenticação.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-258">When the web application calls the API, it includes the access token in the Authentication header.</span></span> <span data-ttu-id="eb7b2-259">A ID do aplicativo é enviada como a declaração "aud" (público) no token de acesso.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-259">The application ID is sent as the audience ('aud') claim in the access token.</span></span>
1. <span data-ttu-id="eb7b2-260">A API de back-end valida o token de acesso.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-260">The backend API validates the access token.</span></span>

<span data-ttu-id="eb7b2-261">Para configurar a autenticação:</span><span class="sxs-lookup"><span data-stu-id="eb7b2-261">To configure authentication:</span></span>

- <span data-ttu-id="eb7b2-262">Registre um aplicativo no locatário do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-262">Register an application in your Azure AD tenant.</span></span> <span data-ttu-id="eb7b2-263">Isso gera uma ID de aplicativo, que é incluída pelo cliente com a URL de logon.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-263">This generates an application ID, which the client includes with the login URL.</span></span>

- <span data-ttu-id="eb7b2-264">Habilite a autenticação do Azure AD dentro do Aplicativo de Funções.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-264">Enable Azure AD authentication inside the Function App.</span></span> <span data-ttu-id="eb7b2-265">Para saber mais, confira [Autenticação e autorização no Serviço de Aplicativo do Azure][app-service-auth].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-265">For more information, see [Authentication and authorization in Azure App Service][app-service-auth].</span></span>

- <span data-ttu-id="eb7b2-266">Adicione [validate-jwt policy][apim-validate-jwt] ao Gerenciamento de API para pré-autorizar a solicitação validando o token de acesso.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-266">Add the [validate-jwt policy][apim-validate-jwt] to API Management to pre-authorize the request by validating the access token.</span></span>

<span data-ttu-id="eb7b2-267">Para saber mais, confira o [Leiame do GitHub][readme].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-267">For more details, see the [GitHub readme][readme].</span></span>

<span data-ttu-id="eb7b2-268">É recomendável criar registros de aplicativo separados no Azure AD para o aplicativo cliente e a API de back-end.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-268">It's recommended to create separate app registrations in Azure AD for the client application and the backend API.</span></span> <span data-ttu-id="eb7b2-269">Conceda permissão ao aplicativo cliente para chamar a API.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-269">Grant the client application permission to call the API.</span></span> <span data-ttu-id="eb7b2-270">Essa abordagem lhe dá a flexibilidade para definir várias APIs e clientes e controlar as permissões de cada um.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-270">This approach gives you the flexibility to define multiple APIs and clients and control the permissions for each.</span></span>

<span data-ttu-id="eb7b2-271">Na API, use [escopos][scopes] para fornecer aos aplicativos um controle refinado sobre quais permissões eles solicitam de um usuário.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-271">Within an API, use [scopes][scopes] to give applications fine-grained control over what permissions they request from a user.</span></span> <span data-ttu-id="eb7b2-272">Por exemplo, uma API pode ter os escopos `Read` e `Write`, e um aplicativo cliente específico pode solicitar que o usuário autorize apenas as permissões `Read`.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-272">For example, an API might have `Read` and `Write` scopes, and a particular client app might ask the user to authorize `Read` permissions only.</span></span>

### <a name="authorization"></a><span data-ttu-id="eb7b2-273">Autorização</span><span class="sxs-lookup"><span data-stu-id="eb7b2-273">Authorization</span></span>

<span data-ttu-id="eb7b2-274">Em muitos aplicativos, a API de back-end deve verificar se um usuário tem permissão para executar uma determinada ação.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-274">In many applications, the backend API must check whether a user has permission to perform a given action.</span></span> <span data-ttu-id="eb7b2-275">Recomendamos o uso da [autorização baseada em declarações][claims], nas quais as informações sobre o usuário são transmitidas pelo provedor de identidade (nesse caso, o Azure AD) e usadas para tomar decisões de autorização.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-275">It's recommended to use [claims-based authorization][claims], where information about the user is conveyed by the identity provider (in this case, Azure AD) and used to make authorization decisions.</span></span>

<span data-ttu-id="eb7b2-276">Algumas declarações são fornecidas dentro do token de ID retornado pelo Azure AD para o cliente.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-276">Some claims are provided inside the ID token that Azure AD returns to the client.</span></span> <span data-ttu-id="eb7b2-277">Você pode obter essas declarações de dentro do aplicativo de funções examinando o cabeçalho X-MS-CLIENT-PRINCIPAL na solicitação.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-277">You can get these claims from within the function app by examining the X-MS-CLIENT-PRINCIPAL header in the request.</span></span> <span data-ttu-id="eb7b2-278">Para outras declarações, use o [Microsoft Graph][graph] para consultar o Azure AD (exige o consentimento do usuário durante a entrada).</span><span class="sxs-lookup"><span data-stu-id="eb7b2-278">For other claims, use [Microsoft Graph][graph] to query Azure AD (requires user consent during sign-in).</span></span>

<span data-ttu-id="eb7b2-279">Por exemplo, ao registrar um aplicativo no Azure AD, é possível definir um conjunto de funções de aplicativo no manifesto de registro do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-279">For example, when you register an application in Azure AD, you can define a set of application roles in the application's registration manifest.</span></span> <span data-ttu-id="eb7b2-280">Quando um usuário entra no aplicativo, o Azure AD inclui uma declaração de "funções" para cada função que o usuário recebeu (incluindo funções herdadas pela associação a um grupo).</span><span class="sxs-lookup"><span data-stu-id="eb7b2-280">When a user signs into the application, Azure AD includes a "roles" claim for each role that the user has been granted (including roles that are inherited through group membership).</span></span>

<span data-ttu-id="eb7b2-281">Na implementação de referência, a função verifica se o usuário autenticado é membro da função de aplicativo `GetStatus`.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-281">In the reference implementation, the function checks whether the authenticated user is a member of the `GetStatus` application role.</span></span> <span data-ttu-id="eb7b2-282">Caso contrário, a função retornará uma resposta HTTP Não Autorizado (401).</span><span class="sxs-lookup"><span data-stu-id="eb7b2-282">If not, the function returns an HTTP Unauthorized (401) response.</span></span>

```csharp
[FunctionName("GetStatusFunction")]
public static Task<IActionResult> Run(
    [HttpTrigger(AuthorizationLevel.Function, "get", "post", Route = null)] HttpRequest req,
    [CosmosDB(
        databaseName: "%COSMOSDB_DATABASE_NAME%",
        collectionName: "%COSMOSDB_DATABASE_COL%",
        ConnectionStringSetting = "COSMOSDB_CONNECTION_STRING",
        Id = "{Query.deviceId}",
        PartitionKey = "{Query.deviceId}")] dynamic deviceStatus,
    ILogger log)
{
    log.LogInformation("Processing GetStatus request.");

    return req.HandleIfAuthorizedForRoles(new[] { GetDeviceStatusRoleName },
        async () =>
        {
            string deviceId = req.Query["deviceId"];
            if (deviceId == null)
            {
                return new BadRequestObjectResult("Missing DeviceId");
            }

            return await Task.FromResult<IActionResult>(deviceStatus != null
                    ? (ActionResult)new OkObjectResult(deviceStatus)
                    : new NotFoundResult());
        },
        log);
}
```

<span data-ttu-id="eb7b2-283">Neste exemplo de código, `HandleIfAuthorizedForRoles` é um método de extensão que verifica a declaração de função e retorna HTTP 401, se a declaração não for encontrada.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-283">In this code example, `HandleIfAuthorizedForRoles` is an extension method that checks for the role claim and returns HTTP 401 if the claim isn't found.</span></span> <span data-ttu-id="eb7b2-284">Encontre o código de origem [aqui][HttpRequestAuthorizationExtensions].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-284">You can find the source code [here][HttpRequestAuthorizationExtensions].</span></span> <span data-ttu-id="eb7b2-285">Observe que `HandleIfAuthorizedForRoles` aceita um parâmetro `ILogger`.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-285">Notice that `HandleIfAuthorizedForRoles` takes an `ILogger` parameter.</span></span> <span data-ttu-id="eb7b2-286">Registre solicitações não autorizadas para que você tenha uma trilha de auditoria e possa diagnosticar problemas, se for necessário.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-286">You should log unauthorized requests so that you have an audit trail and can diagnose issues if needed.</span></span> <span data-ttu-id="eb7b2-287">Ao mesmo tempo, evite o vazamento de informações detalhadas na resposta HTTP 401.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-287">At the same time, avoid leaking any detailed information inside the HTTP 401 response.</span></span>

### <a name="cors"></a><span data-ttu-id="eb7b2-288">CORS</span><span class="sxs-lookup"><span data-stu-id="eb7b2-288">CORS</span></span>

<span data-ttu-id="eb7b2-289">Nessa arquitetura de referência, o aplicativo Web e a API não compartilham a mesma origem.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-289">In this reference architecture, the web application and the API do not share the same origin.</span></span> <span data-ttu-id="eb7b2-290">Isso significa que, quando o aplicativo chama a API, essa solicitação ocorre entre origens.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-290">That means when the application calls the API, it is a cross-origin request.</span></span> <span data-ttu-id="eb7b2-291">A segurança do navegador impede que uma página da Web envie solicitações do AJAX para outro domínio.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-291">Browser security prevents a web page from making AJAX requests to another domain.</span></span> <span data-ttu-id="eb7b2-292">Essa restrição se chama *política da mesma origem* e impede que um site mal-intencionado leia dados confidenciais de outro site.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-292">This restriction is called the *same-origin policy* and prevents a malicious site from reading sensitive data from another site.</span></span> <span data-ttu-id="eb7b2-293">Para habilitar uma solicitação entre origens, adicione uma [política][cors-policy] CORS (Compartilhamento de recursos entre origens) para o gateway de Gerenciamento de API:</span><span class="sxs-lookup"><span data-stu-id="eb7b2-293">To enable a cross-origin request, add a Cross-Origin Resource Sharing (CORS) [policy][cors-policy] to the API Management gateway:</span></span>

```xml
<cors allow-credentials="true">
    <allowed-origins>
        <origin>[Website URL]</origin>
    </allowed-origins>
    <allowed-methods>
        <method>GET</method>
    </allowed-methods>
    <allowed-headers>
        <header>*</header>
    </allowed-headers>
</cors>
```

<span data-ttu-id="eb7b2-294">Neste exemplo, o atributo **allow-credentials** é **true**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-294">In this example, the **allow-credentials** attribute is **true**.</span></span> <span data-ttu-id="eb7b2-295">Isso autoriza o navegador a enviar credenciais (incluindo cookies) com a solicitação.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-295">This authorizes the browser to send credentials (including cookies) with the request.</span></span> <span data-ttu-id="eb7b2-296">Caso contrário, o navegador envia, por padrão, as credenciais com uma solicitação entre origens.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-296">Otherwise, by default the browser does not send credentials with a cross-origin request.</span></span>

> [!NOTE]
> <span data-ttu-id="eb7b2-297">Tenha muito cuidado ao configurar **allow-credentials** como **true**, pois isso significa que um site pode enviar as credenciais do usuário para sua API em nome do usuário, sem que o usuário fique ciente.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-297">Be very careful about setting **allow-credentials** to **true**, because it means a website can send the user's credentials to your API on the user's behalf, without the user being aware.</span></span> <span data-ttu-id="eb7b2-298">Você deve confiar na origem permitida.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-298">You must trust the allowed origin.</span></span>

### <a name="enforce-https"></a><span data-ttu-id="eb7b2-299">Impor HTTPS</span><span class="sxs-lookup"><span data-stu-id="eb7b2-299">Enforce HTTPS</span></span>

<span data-ttu-id="eb7b2-300">Para obter o máximo de segurança, exija HTTPS em todo o pipeline de solicitações:</span><span class="sxs-lookup"><span data-stu-id="eb7b2-300">For maximum security, require HTTPS throughout the request pipeline:</span></span>

- <span data-ttu-id="eb7b2-301">**CDN**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-301">**CDN**.</span></span> <span data-ttu-id="eb7b2-302">A CDN do Azure oferece suporte a HTTPS em um subdomínio `*.azureedge.net` por padrão.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-302">Azure CDN supports HTTPS on the `*.azureedge.net` subdomain by default.</span></span> <span data-ttu-id="eb7b2-303">Para habilitar o HTTPS no CDN para nomes de domínio personalizados, consulte [Tutorial: Configure HTTPS em um domínio personalizado da CDN do Azure][cdn-https].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-303">To enable HTTPS in the CDN for custom domain names, see [Tutorial: Configure HTTPS on an Azure CDN custom domain][cdn-https].</span></span>

- <span data-ttu-id="eb7b2-304">**Hospedagem de sites estáticos**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-304">**Static website hosting**.</span></span> <span data-ttu-id="eb7b2-305">Habilite a opção "[Transferência segura obrigatória][storage-https]" na conta de armazenamento.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-305">Enable the "[Secure transfer required][storage-https]" option on the Storage account.</span></span> <span data-ttu-id="eb7b2-306">Quando essa opção estiver habilitada, a conta de armazenamento permitirá apenas solicitações de conexões HTTPS seguras.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-306">When this option is enabled, the storage account only allows requests from secure HTTPS connections.</span></span>

- <span data-ttu-id="eb7b2-307">**Gerenciamento de API**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-307">**API Management**.</span></span> <span data-ttu-id="eb7b2-308">Configure as APIs para usar somente o protocolo HTTPS.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-308">Configure the APIs to use HTTPS protocol only.</span></span> <span data-ttu-id="eb7b2-309">Configure isso no portal do Azure ou usando o modelo do Resource Manager:</span><span class="sxs-lookup"><span data-stu-id="eb7b2-309">You can configure this in the Azure portal or through a Resource Manager template:</span></span>

    ```json
    {
        "apiVersion": "2018-01-01",
        "type": "apis",
        "name": "dronedeliveryapi",
        "dependsOn": [
            "[concat('Microsoft.ApiManagement/service/', variables('apiManagementServiceName'))]"
        ],
        "properties": {
            "displayName": "Drone Delivery API",
            "description": "Drone Delivery API",
            "path": "api",
            "protocols": [ "HTTPS" ]
        },
        ...
    }
    ```

- <span data-ttu-id="eb7b2-310">**Azure Functions**.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-310">**Azure Functions**.</span></span> <span data-ttu-id="eb7b2-311">Habilite a configuração "[Somente HTTPS][functions-https]".</span><span class="sxs-lookup"><span data-stu-id="eb7b2-311">Enable the "[HTTPS Only][functions-https]" setting.</span></span>

### <a name="lock-down-the-function-app"></a><span data-ttu-id="eb7b2-312">Bloquear o aplicativo de funções</span><span class="sxs-lookup"><span data-stu-id="eb7b2-312">Lock down the function app</span></span>

<span data-ttu-id="eb7b2-313">Todas as chamadas para a função devem passar pelo gateway de API.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-313">All calls to the function should go through the API gateway.</span></span> <span data-ttu-id="eb7b2-314">Faça isso da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="eb7b2-314">You can achieve this as follows:</span></span>

- <span data-ttu-id="eb7b2-315">Configure o aplicativo de funções para exigir uma chave de função.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-315">Configure the function app to require a function key.</span></span> <span data-ttu-id="eb7b2-316">O gateway de Gerenciamento de API inclui a tecla de função quando ela chamar o aplicativo de funções.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-316">The API Management gateway will include the function key when it calls the function app.</span></span> <span data-ttu-id="eb7b2-317">Isso impede que os clientes chamem a função diretamente, ignorando o gateway.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-317">This prevents clients from calling the function directly, bypassing the gateway.</span></span>

- <span data-ttu-id="eb7b2-318">O gateway do Gerenciamento de API tem um [endereço IP estático][apim-ip].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-318">The API Management gateway has a [static IP address][apim-ip].</span></span> <span data-ttu-id="eb7b2-319">Restrinja o Azure Functions para permitir apenas chamadas desse endereço IP estático.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-319">Restrict the Azure Function to allow only calls from that static IP address.</span></span> <span data-ttu-id="eb7b2-320">Para saber mais, confira [Restrições de IP estático do Serviço de Aplicativo do Azure][app-service-ip-restrictions].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-320">For more information, see [Azure App Service Static IP Restrictions][app-service-ip-restrictions].</span></span> <span data-ttu-id="eb7b2-321">(Esse recurso está disponível apenas para serviços do tipo Standard.)</span><span class="sxs-lookup"><span data-stu-id="eb7b2-321">(This feature is available for Standard tier services only.)</span></span>

### <a name="protect-application-secrets"></a><span data-ttu-id="eb7b2-322">Proteger segredos do aplicativo</span><span class="sxs-lookup"><span data-stu-id="eb7b2-322">Protect application secrets</span></span>

<span data-ttu-id="eb7b2-323">Não armazene segredos do aplicativo, como credenciais de banco de dados, nos arquivos de configuração ou código.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-323">Don't store application secrets, such as database credentials, in your code or configuration files.</span></span> <span data-ttu-id="eb7b2-324">Em vez disso, use as Configurações do Aplicativo, que estão armazenadas criptografadas no Azure.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-324">Instead, use App settings, which are stored encrypted in Azure.</span></span> <span data-ttu-id="eb7b2-325">Para saber mais, confira [Segurança no Serviço de Aplicativo do Azure e no Azure Functions][app-service-security].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-325">For more information, see [Security in Azure App Service and Azure Functions][app-service-security].</span></span>

<span data-ttu-id="eb7b2-326">Como alternativa, armazene segredos do aplicativo no Key Vault.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-326">Alternatively, you can store application secrets in Key Vault.</span></span> <span data-ttu-id="eb7b2-327">Isso permite que você centralize o armazenamento de segredos, controle sua distribuição e monitore como e quando os segredos são acessados.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-327">This allows you to centralize the storage of secrets, control their distribution, and monitor how and when secrets are being accessed.</span></span> <span data-ttu-id="eb7b2-328">Para saber mais, confira [Configurar um aplicativo Web do Azure para ler um segredo do Key Vault][key-vault-web-app].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-328">For more information, see [Configure an Azure web application to read a secret from Key Vault][key-vault-web-app].</span></span> <span data-ttu-id="eb7b2-329">No entanto, observe que os gatilhos e associações do Functions carregam suas definições de configuração das configurações do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-329">However, note that Functions triggers and bindings load their configuration settings from app settings.</span></span> <span data-ttu-id="eb7b2-330">Não há modos internos para configurar os gatilhos e associações para usar segredos do Key Vault.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-330">There is no built-in way to configure the triggers and bindings to use Key Vault secrets.</span></span>

## <a name="devops-considerations"></a><span data-ttu-id="eb7b2-331">Considerações de DevOps</span><span class="sxs-lookup"><span data-stu-id="eb7b2-331">DevOps considerations</span></span>

### <a name="deployment"></a><span data-ttu-id="eb7b2-332">Implantação</span><span class="sxs-lookup"><span data-stu-id="eb7b2-332">Deployment</span></span>

<span data-ttu-id="eb7b2-333">Para implantar o aplicativo de funções, é recomendável usar [arquivos de pacote][functions-run-from-package] (“Execução a partir do pacote”).</span><span class="sxs-lookup"><span data-stu-id="eb7b2-333">To deploy the function app, we recommend using [package files][functions-run-from-package] ("Run from package").</span></span> <span data-ttu-id="eb7b2-334">Usando essa abordagem, você carrega um arquivo zip em um contêiner de Armazenamento de Blobs e o tempo de execução das Funções monta o arquivo zip como um sistema de arquivos somente leitura.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-334">Using this approach, you upload a zip file to a Blob Storage container and the Functions runtime mounts the zip file as a read-only file system.</span></span> <span data-ttu-id="eb7b2-335">Essa é uma operação atômica, o que reduz a chance de uma implantação com falhas deixar o aplicativo em um estado inconsistente.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-335">This is an atomic operation, which reduces the chance that a failed deployment will leave the application in an inconsistent state.</span></span> <span data-ttu-id="eb7b2-336">Também é possível melhorar os tempos de inicialização a frio, especialmente para aplicativos Node.js, já que todos os arquivos são trocados ao mesmo tempo.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-336">It can also improve cold start times, especially for Node.js apps, because all of the files are swapped at once.</span></span>

### <a name="api-versioning"></a><span data-ttu-id="eb7b2-337">Controle de versão de API</span><span class="sxs-lookup"><span data-stu-id="eb7b2-337">API versioning</span></span>

<span data-ttu-id="eb7b2-338">Uma API é um contrato entre um serviço e os clientes.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-338">An API is a contract between a service and clients.</span></span> <span data-ttu-id="eb7b2-339">Nessa arquitetura, o contrato de API é definido na camada de Gerenciamento de API.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-339">In this architecture, the API contract is defined at the API Management layer.</span></span> <span data-ttu-id="eb7b2-340">O Gerenciamento de API oferece suporte a dois [conceitos de controle de versão][apim-versioning] distintos, mas complementares:</span><span class="sxs-lookup"><span data-stu-id="eb7b2-340">API Management supports two distinct but complementary [versioning concepts][apim-versioning]:</span></span>

- <span data-ttu-id="eb7b2-341">As *versões* permitem que os consumidores escolham uma versão de API com base nas necessidades, como v1 vs. v2.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-341">*Versions* allow API consumers to choose an API version based on their needs, such as v1 versus v2.</span></span>

- <span data-ttu-id="eb7b2-342">*Revisões* permitem que os administradores de API façam alterações sem interrupções em uma API e implantem essas alterações, juntamente com um log de alterações para informar aos consumidores da API sobre as alterações.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-342">*Revisions* allow API administrators to make non-breaking changes in an API and deploy those changes, along with a change log to inform API consumers about the changes.</span></span>

<span data-ttu-id="eb7b2-343">Se você fizer uma alteração significativa em uma API, publique uma nova versão no Gerenciamento de API.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-343">If you make a breaking change in an API, publish a new version in API Management.</span></span> <span data-ttu-id="eb7b2-344">Implante a nova versão lado a lado da versão original em um Aplicativo de funções separado.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-344">Deploy the new version side-by-side with the original version, in a separate Function App.</span></span> <span data-ttu-id="eb7b2-345">Isso permite que você migre clientes existentes para a nova API sem invalidar os aplicativos cliente.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-345">This lets you migrate existing clients to the new API without breaking client applications.</span></span> <span data-ttu-id="eb7b2-346">Por fim, substitua a versão anterior.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-346">Eventually, you can deprecate the previous version.</span></span> <span data-ttu-id="eb7b2-347">O Gerenciamento de API dá suporte a vários [esquemas de controle de versão][apim-versioning-schemes]: Caminho da URL, cabeçalho HTTP ou cadeia de consulta.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-347">API Management supports several [versioning schemes][apim-versioning-schemes]: URL path, HTTP header, or query string.</span></span> <span data-ttu-id="eb7b2-348">Para obter mais informações sobre o controle de versão de API, confira [Controle de versão de uma API da Web RESTful][api-versioning].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-348">For more information about API versioning in general, see [Versioning a RESTful web API][api-versioning].</span></span>

<span data-ttu-id="eb7b2-349">Para atualizações que não são alterações da falha na API, implante a nova versão em um slot de preparo no mesmo Aplicativo de funções.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-349">For updates that are not breaking API changes, deploy the new version to a staging slot in the same Function App.</span></span> <span data-ttu-id="eb7b2-350">Verifique se a implantação foi bem-sucedida e, em seguida, troque a versão de preparo pela versão de produção.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-350">Verify the deployment succeeded and then swap the staged version with the production version.</span></span> <span data-ttu-id="eb7b2-351">Publique uma revisão no Gerenciamento de API.</span><span class="sxs-lookup"><span data-stu-id="eb7b2-351">Publish a revision in API Management.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="eb7b2-352">Implantar a solução</span><span class="sxs-lookup"><span data-stu-id="eb7b2-352">Deploy the solution</span></span>

<span data-ttu-id="eb7b2-353">Para implantar essa arquitetura de referência, confira o [Leiame do GitHub][readme].</span><span class="sxs-lookup"><span data-stu-id="eb7b2-353">To deploy this reference architecture, view the [GitHub readme][readme].</span></span>

<!-- links -->

[api-versioning]: ../../best-practices/api-design.md#versioning-a-restful-web-api
[apim]: /azure/api-management/api-management-key-concepts
[apim-ip]: /azure/api-management/api-management-faq#is-the-api-management-gateway-ip-address-constant-can-i-use-it-in-firewall-rules
[api-geo]: /azure/api-management/api-management-howto-deploy-multi-region
[apim-scale]: /azure/api-management/api-management-howto-autoscale
[apim-validate-jwt]: /azure/api-management/api-management-access-restriction-policies#ValidateJWT
[apim-versioning]: /azure/api-management/api-management-get-started-publish-versions
[apim-versioning-schemes]: /azure/api-management/api-management-get-started-publish-versions#choose-a-versioning-scheme
[app-service-auth]: /azure/app-service/app-service-authentication-overview
[app-service-ip-restrictions]: /azure/app-service/app-service-ip-restrictions
[app-service-security]: /azure/app-service/app-service-security
[ase]: /azure/app-service/environment/intro
[azure-messaging]: /azure/event-grid/compare-messaging-services
[claims]: https://en.wikipedia.org/wiki/Claims-based_identity
[cdn]: https://azure.microsoft.com/services/cdn/
[cdn-https]: /azure/cdn/cdn-custom-ssl
[cors-policy]: /azure/api-management/api-management-cross-domain-policies
[cosmosdb]: /azure/cosmos-db/introduction
[cosmosdb-geo]: /azure/cosmos-db/distribute-data-globally
[cosmosdb-input-binding]: /azure/azure-functions/functions-bindings-cosmosdb-v2#input
[cosmosdb-scale]: /azure/cosmos-db/partition-data
[event-driven]: ../../guide/architecture-styles/event-driven.md
[functions]: /azure/azure-functions/functions-overview
[functions-bindings]: /azure/azure-functions/functions-triggers-bindings
[functions-cold-start]: https://blogs.msdn.microsoft.com/appserviceteam/2018/02/07/understanding-serverless-cold-start/
[functions-https]: /azure/app-service/app-service-web-tutorial-custom-ssl#enforce-https
[functions-proxy]: /azure/azure-functions/functions-proxies
[functions-run-from-package]: /azure/azure-functions/run-functions-from-deployment-package
[functions-scale]: /azure/azure-functions/functions-scale
[functions-timeout]: /azure/azure-functions/functions-scale#consumption-plan
[functions-zip-deploy]: /azure/azure-functions/deployment-zip-push
[graph]: https://developer.microsoft.com/graph/docs/concepts/overview
[key-vault-web-app]: /azure/key-vault/tutorial-web-application-keyvault
[microservices-domain-analysis]: ../../microservices/domain-analysis.md
[monitor]: /azure/azure-monitor/overview
[oauth-flow]: https://auth0.com/docs/api-auth/which-oauth-flow-to-use
[partition-key]: /azure/cosmos-db/partition-data
[pipelines]: /azure/devops/pipelines/index
[ru]: /azure/cosmos-db/request-units
[scopes]: /azure/active-directory/develop/v2-permissions-and-consent
[static-hosting]: /azure/storage/blobs/storage-blob-static-website
[static-hosting-preview]: https://azure.microsoft.com/blog/azure-storage-static-web-hosting-public-preview/
[storage-https]: /azure/storage/common/storage-require-secure-transfer
[tm]: /azure/traffic-manager/traffic-manager-overview

[github]: https://github.com/mspnp/serverless-reference-implementation
[HttpRequestAuthorizationExtensions]: https://github.com/mspnp/serverless-reference-implementation/blob/master/src/DroneStatus/dotnet/DroneStatusFunctionApp/HttpRequestAuthorizationExtensions.cs
[readme]: https://github.com/mspnp/serverless-reference-implementation/blob/master/README.md
