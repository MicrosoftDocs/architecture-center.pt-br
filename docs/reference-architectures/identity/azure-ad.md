---
title: Integrar domínios do AD local ao Azure Active Directory
description: Como implementar uma arquitetura de rede híbrida segura usando o Azure Active Directory.
author: telmosampaio
pnp.series.title: Identity management
ms.date: 11/28/2016
pnp.series.next: adds-extend-domain
pnp.series.prev: ./index
cardTitle: Integrate on-premises AD with Azure AD
ms.openlocfilehash: 431de4b2e08c79f70cc9830fda8315e07bf22c64
ms.sourcegitcommit: c441fd165e6bebbbbbc19854ec6f3676be9c3b25
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/30/2018
---
# <a name="integrate-on-premises-active-directory-domains-with-azure-active-directory"></a><span data-ttu-id="58f1b-103">Integrar domínios do Active Directory local ao Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="58f1b-103">Integrate on-premises Active Directory domains with Azure Active Directory</span></span>

<span data-ttu-id="58f1b-104">O Azure Active Directory (Azure AD) é um serviço de identidade e de diretório multilocatário baseado em nuvem.</span><span class="sxs-lookup"><span data-stu-id="58f1b-104">Azure Active Directory (Azure AD) is a cloud based multi-tenant directory and identity service.</span></span> <span data-ttu-id="58f1b-105">Esta arquitetura de referência mostra as práticas recomendadas para a integração de domínios do Active Directory local com o Azure AD para fornecer autenticação de identidade baseada em nuvem.</span><span class="sxs-lookup"><span data-stu-id="58f1b-105">This reference architecture shows best practices for integrating on-premises Active Directory domains with Azure AD to provide cloud-based identity authentication.</span></span> [<span data-ttu-id="58f1b-106">**Implante essa solução**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-106">**Deploy this solution**.</span></span>](#deploy-the-solution)

<span data-ttu-id="58f1b-107">[![0]][0]</span><span class="sxs-lookup"><span data-stu-id="58f1b-107">[![0]][0]</span></span> 

<span data-ttu-id="58f1b-108">*Baixe um [Arquivo Visio][visio-download] dessa arquitetura.*</span><span class="sxs-lookup"><span data-stu-id="58f1b-108">*Download a [Visio file][visio-download] of this architecture.*</span></span>

> [!NOTE]
> <span data-ttu-id="58f1b-109">Para simplificar, este mostra apenas as conexões relacionadas diretamente ao Azure AD e não o tráfego relacionado a protocolo que pode ocorrer como parte da federação de identidade e da autenticação.</span><span class="sxs-lookup"><span data-stu-id="58f1b-109">For simplicity, this diagram only shows the connections directly related to Azure AD, and not protocol-related traffic that may occur as part of authentication and identity federation.</span></span> <span data-ttu-id="58f1b-110">Por exemplo, um aplicativo Web pode redirecionar o navegador da Web para autenticar a solicitação por meio do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-110">For example, a web application may redirect the web browser to authenticate the request through Azure AD.</span></span> <span data-ttu-id="58f1b-111">Uma vez autenticada, a solicitação pode ser retornada ao aplicativo Web, com as informações de identidade apropriadas.</span><span class="sxs-lookup"><span data-stu-id="58f1b-111">Once authenticated, the request can be passed back to the web application, with the appropriate identity information.</span></span>
> 

<span data-ttu-id="58f1b-112">Alguns usos típicos dessa arquitetura de referência:</span><span class="sxs-lookup"><span data-stu-id="58f1b-112">Typical uses for this reference architecture include:</span></span>

* <span data-ttu-id="58f1b-113">Aplicativos Web implantados no Azure que fornecem acesso a usuários remotos que pertencem à sua organização.</span><span class="sxs-lookup"><span data-stu-id="58f1b-113">Web applications deployed in Azure that provide access to remote users who belong to your organization.</span></span>
* <span data-ttu-id="58f1b-114">Implementação de recursos de autoatendimento para usuários finais, como redefinir senhas e delegar gerenciamento de grupo.</span><span class="sxs-lookup"><span data-stu-id="58f1b-114">Implementing self-service capabilities for end-users, such as resetting their passwords, and delegating group management.</span></span> <span data-ttu-id="58f1b-115">Observe que isso exige o Azure AD Premium Edition.</span><span class="sxs-lookup"><span data-stu-id="58f1b-115">Note that this requires Azure AD Premium edition.</span></span>
* <span data-ttu-id="58f1b-116">Arquiteturas em que a rede local e a VNet do Azure do aplicativo não estão conectadas usando um túnel de VPN ou um circuito ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="58f1b-116">Architectures in which the on-premises network and the application's Azure VNet are not connected using a VPN tunnel or ExpressRoute circuit.</span></span>

> [!NOTE]
> <span data-ttu-id="58f1b-117">No momento, o Azure AD dá suporte somente para autenticação do usuário.</span><span class="sxs-lookup"><span data-stu-id="58f1b-117">Azure AD currently supports user authentication only.</span></span> <span data-ttu-id="58f1b-118">Alguns aplicativos e serviços, como o SQL Server, podem exigir a autenticação do computador e, nesse caso, essa solução não é apropriada.</span><span class="sxs-lookup"><span data-stu-id="58f1b-118">Some applications and services, such as SQL Server, may require computer authentication, in which case this solution is not appropriate.</span></span>
> 

<span data-ttu-id="58f1b-119">Para obter considerações adicionais, consulte [Escolher uma solução para a integração do Active Directory local ao Azure][considerations].</span><span class="sxs-lookup"><span data-stu-id="58f1b-119">For additional considerations, see [Choose a solution for integrating on-premises Active Directory with Azure][considerations].</span></span> 

## <a name="architecture"></a><span data-ttu-id="58f1b-120">Arquitetura</span><span class="sxs-lookup"><span data-stu-id="58f1b-120">Architecture</span></span>

<span data-ttu-id="58f1b-121">A arquitetura tem os seguintes componentes.</span><span class="sxs-lookup"><span data-stu-id="58f1b-121">The architecture has the following components.</span></span>

* <span data-ttu-id="58f1b-122">**Locatário do Azure AD**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-122">**Azure AD tenant**.</span></span> <span data-ttu-id="58f1b-123">Uma instância do [Azure AD][azure-active-directory] criada pela sua organização.</span><span class="sxs-lookup"><span data-stu-id="58f1b-123">An instance of [Azure AD][azure-active-directory] created by your organization.</span></span> <span data-ttu-id="58f1b-124">Ela atua como um serviço de diretório para aplicativos de nuvem armazenando objetos copiados do Active Directory local e fornece serviços de identidade.</span><span class="sxs-lookup"><span data-stu-id="58f1b-124">It acts as a directory service for cloud applications by storing objects copied from the on-premises Active Directory and provides identity services.</span></span>
* <span data-ttu-id="58f1b-125">**Sub-rede da camada da Web**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-125">**Web tier subnet**.</span></span> <span data-ttu-id="58f1b-126">Essa sub-rede contém as VMs que executam um aplicativo Web.</span><span class="sxs-lookup"><span data-stu-id="58f1b-126">This subnet holds VMs that run a web application.</span></span> <span data-ttu-id="58f1b-127">O Azure AD pode agir como um agente de identidade para este aplicativo.</span><span class="sxs-lookup"><span data-stu-id="58f1b-127">Azure AD can act as an identity broker for this application.</span></span>
* <span data-ttu-id="58f1b-128">**Servidor do AD DS local**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-128">**On-premises AD DS server**.</span></span> <span data-ttu-id="58f1b-129">Um serviço de identidade e diretório local.</span><span class="sxs-lookup"><span data-stu-id="58f1b-129">An on-premise directory and identity service.</span></span> <span data-ttu-id="58f1b-130">O diretório do AD DS pode ser sincronizado com o Azure AD para habilitá-lo a autenticar usuários locais.</span><span class="sxs-lookup"><span data-stu-id="58f1b-130">The AD DS directory can be synchronized with Azure AD to enable it to authenticate on-premise users.</span></span>
* <span data-ttu-id="58f1b-131">**Servidor de sincronização do Azure AD Connect**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-131">**Azure AD Connect sync server**.</span></span> <span data-ttu-id="58f1b-132">Um computador local que executa o serviço de sincronização do [Azure AD Connect][azure-ad-connect].</span><span class="sxs-lookup"><span data-stu-id="58f1b-132">An on-premises computer that runs the [Azure AD Connect][azure-ad-connect] sync service.</span></span> <span data-ttu-id="58f1b-133">Este serviço sincroniza as informações mantidas no Active Directory local com o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-133">This service synchronizes information held in the on-premises Active Directory to Azure AD.</span></span> <span data-ttu-id="58f1b-134">Por exemplo, se você provisionar ou desprovisionar usuários e grupos locais, essas alterações serão propagadas para o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-134">For example, if you provision or deprovision groups and users on-premises, these changes propagate to Azure AD.</span></span> 
  
  > [!NOTE]
  > <span data-ttu-id="58f1b-135">Por motivos de segurança, o Azure AD armazena as senhas de usuário como um hash.</span><span class="sxs-lookup"><span data-stu-id="58f1b-135">For security reasons, Azure AD stores user's passwords as a hash.</span></span> <span data-ttu-id="58f1b-136">Se algum usuário precisar de uma redefinição de senha, isso deverá ser realizado localmente e o novo hash deverá ser enviado ao Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-136">If a user requires a password reset, this must be performed on-premises and the new hash must be sent to Azure AD.</span></span> <span data-ttu-id="58f1b-137">As edições Azure AD Premium incluem recursos que podem automatizar essa tarefa para permitir que os usuários redefinam suas próprias senhas.</span><span class="sxs-lookup"><span data-stu-id="58f1b-137">Azure AD Premium editions include features that can automate this task to enable users to reset their own passwords.</span></span>
  > 

* <span data-ttu-id="58f1b-138">**VMs para aplicativos de N camadas**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-138">**VMs for N-tier application**.</span></span> <span data-ttu-id="58f1b-139">A implantação inclui a infraestrutura para um aplicativo de N camadas.</span><span class="sxs-lookup"><span data-stu-id="58f1b-139">The deployment includes infrastructure for an N-tier application.</span></span> <span data-ttu-id="58f1b-140">Para obter mais informações sobre esses recursos, consulte [Executar VMs do Windows para um aplicativo de N camadas][implementing-a-multi-tier-architecture-on-Azure].</span><span class="sxs-lookup"><span data-stu-id="58f1b-140">For more information about these resources, see [Run VMs for an N-tier architecture][implementing-a-multi-tier-architecture-on-Azure].</span></span>

## <a name="recommendations"></a><span data-ttu-id="58f1b-141">Recomendações</span><span class="sxs-lookup"><span data-stu-id="58f1b-141">Recommendations</span></span>

<span data-ttu-id="58f1b-142">As seguintes recomendações aplicam-se à maioria dos cenários.</span><span class="sxs-lookup"><span data-stu-id="58f1b-142">The following recommendations apply for most scenarios.</span></span> <span data-ttu-id="58f1b-143">Siga estas recomendações, a menos que você tenha um requisito específico que as substitua.</span><span class="sxs-lookup"><span data-stu-id="58f1b-143">Follow these recommendations unless you have a specific requirement that overrides them.</span></span> 

### <a name="azure-ad-connect-sync-service"></a><span data-ttu-id="58f1b-144">Serviço de sincronização Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="58f1b-144">Azure AD Connect sync service</span></span>

<span data-ttu-id="58f1b-145">O serviço de sincronização do Azure AD Connect garante que essas informações de identidade armazenadas na nuvem fiquem consistentes com as mantidas localmente.</span><span class="sxs-lookup"><span data-stu-id="58f1b-145">The Azure AD Connect sync service ensures that identity information stored in the cloud is consistent with that held on-premises.</span></span> <span data-ttu-id="58f1b-146">Instale esse serviço usando o software do Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="58f1b-146">You install this service using the Azure AD Connect software.</span></span> 

<span data-ttu-id="58f1b-147">Antes de implementar a sincronização do Azure AD Connect, determine os requisitos de sincronização da sua organização.</span><span class="sxs-lookup"><span data-stu-id="58f1b-147">Before implementing Azure AD Connect sync, determine the synchronization requirements of your organization.</span></span> <span data-ttu-id="58f1b-148">Por exemplo, o que deve ser sincronizado, de quais domínios e com que frequência.</span><span class="sxs-lookup"><span data-stu-id="58f1b-148">For example, what to synchronize, from which domains, and how frequently.</span></span> <span data-ttu-id="58f1b-149">Para obter mais informações, consulte [Determinar os requisitos de sincronização de diretório][aad-sync-requirements].</span><span class="sxs-lookup"><span data-stu-id="58f1b-149">For more information, see [Determine directory synchronization requirements][aad-sync-requirements].</span></span>

<span data-ttu-id="58f1b-150">Você pode executar o serviço de sincronização do Azure AD Connect em uma VM ou em um computador hospedado localmente.</span><span class="sxs-lookup"><span data-stu-id="58f1b-150">You can run the Azure AD Connect sync service on a VM or a computer hosted on-premises.</span></span> <span data-ttu-id="58f1b-151">Dependendo da volatilidade das informações no seu diretório do Active Directory, a carga no serviço de sincronização do Azure AD Connect provavelmente não será alta após a sincronização inicial com o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-151">Depending on the volatility of the information in your Active Directory directory, the load on the Azure AD Connect sync service is unlikely to be high after the initial synchronization with Azure AD.</span></span> <span data-ttu-id="58f1b-152">Executar o serviço em uma VM torna mais fácil expandir o servidor, se necessário.</span><span class="sxs-lookup"><span data-stu-id="58f1b-152">Running the service on a VM makes it easier to scale the server if needed.</span></span> <span data-ttu-id="58f1b-153">Monitore a atividade na VM conforme descrito na seção Considerações de monitoramento para determinar se o dimensionamento é necessário.</span><span class="sxs-lookup"><span data-stu-id="58f1b-153">Monitor the activity on the VM as described in the Monitoring considerations section to determine whether scaling is necessary.</span></span>

<span data-ttu-id="58f1b-154">Se você tiver vários domínios locais em uma floresta, será recomendável armazenar e sincronizar as informações em toda a floresta para um único locatário do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-154">If you have multiple on-premises domains in a forest, we recommend storing and synchronizing information for the entire forest to a single Azure AD tenant.</span></span> <span data-ttu-id="58f1b-155">Filtre as informações por identidades que ocorrem em mais de um domínio, para que cada identidade apareça apenas uma vez no Azure AD e não seja duplicada.</span><span class="sxs-lookup"><span data-stu-id="58f1b-155">Filter information for identities that occur in more than one domain, so that each identity appears only once in Azure AD, rather than being duplicated.</span></span> <span data-ttu-id="58f1b-156">A duplicação poderá levar a inconsistências quando os dados forem sincronizados.</span><span class="sxs-lookup"><span data-stu-id="58f1b-156">Duplication can lead to inconsistencies when data is synchronized.</span></span> <span data-ttu-id="58f1b-157">Para obter mais informações, consulte a seção Topologia abaixo.</span><span class="sxs-lookup"><span data-stu-id="58f1b-157">For more information, see the Topology section below.</span></span> 

<span data-ttu-id="58f1b-158">Use a filtragem para que apenas os dados necessários sejam armazenados no Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-158">Use filtering so that only necessary data is stored in Azure AD.</span></span> <span data-ttu-id="58f1b-159">Por exemplo, talvez sua organização não queira armazenar informações sobre contas inativas no Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-159">For example, your organization might not want to store information about inactive accounts in Azure AD.</span></span> <span data-ttu-id="58f1b-160">A filtragem pode ser baseada em grupo, baseada em domínio, baseada em UO (unidade organizacional) ou baseada em atributo.</span><span class="sxs-lookup"><span data-stu-id="58f1b-160">Filtering can be group-based, domain-based, organization unit (OU)-based, or attribute-based.</span></span> <span data-ttu-id="58f1b-161">É possível combinar filtros para gerar regras mais complexas.</span><span class="sxs-lookup"><span data-stu-id="58f1b-161">You can combine filters to generate more complex rules.</span></span> <span data-ttu-id="58f1b-162">Por exemplo, você pode sincronizar objetos mantidos em um domínio que tenham um valor específico em um atributo selecionado.</span><span class="sxs-lookup"><span data-stu-id="58f1b-162">For example, you could synchronize objects held in a domain that have a specific value in a selected attribute.</span></span> <span data-ttu-id="58f1b-163">Para obter informações detalhadas, consulte [Sincronização do Azure AD Connect: configurar a filtragem][aad-filtering].</span><span class="sxs-lookup"><span data-stu-id="58f1b-163">For detailed information, see [Azure AD Connect sync: Configure Filtering][aad-filtering].</span></span>

<span data-ttu-id="58f1b-164">Para implementar a alta disponibilidade para o serviço de sincronização do AD Connect, execute um servidor de preparo secundário.</span><span class="sxs-lookup"><span data-stu-id="58f1b-164">To implement high availability for the AD Connect sync service, run a secondary staging server.</span></span> <span data-ttu-id="58f1b-165">Para obter mais informações, consulte a seção Recomendações de topologia.</span><span class="sxs-lookup"><span data-stu-id="58f1b-165">For more information, see the Topology recommendations section.</span></span>

### <a name="security-recommendations"></a><span data-ttu-id="58f1b-166">Recomendações de segurança</span><span class="sxs-lookup"><span data-stu-id="58f1b-166">Security recommendations</span></span>

<span data-ttu-id="58f1b-167">**Gerenciamento de senha do usuário.**</span><span class="sxs-lookup"><span data-stu-id="58f1b-167">**User password management.**</span></span> <span data-ttu-id="58f1b-168">As edições Azure AD Premium dão suporte para write-back de senha, permitindo que os usuários locais executem redefinições de senha de autoatendimento por meio do portal do Azure.</span><span class="sxs-lookup"><span data-stu-id="58f1b-168">The Azure AD Premium editions support password writeback, enabling your on-premises users to perform self-service password resets from within the Azure portal.</span></span> <span data-ttu-id="58f1b-169">Esse recurso somente deverá ser habilitado depois que você examinar a política de segurança de senha da organização.</span><span class="sxs-lookup"><span data-stu-id="58f1b-169">This feature should only be enabled after reviewing your organization's password security policy.</span></span> <span data-ttu-id="58f1b-170">Por exemplo, você pode restringir quais usuários podem alterar senhas e pode personalizar a experiência de gerenciamento de senha.</span><span class="sxs-lookup"><span data-stu-id="58f1b-170">For example, you can restrict which users can change their passwords, and you can tailor the password management experience.</span></span> <span data-ttu-id="58f1b-171">Para obter mais informações, consulte [Personalizar o gerenciamento de senha para de adequar às necessidades da sua organização][aad-password-management].</span><span class="sxs-lookup"><span data-stu-id="58f1b-171">For more information, see [Customizing Password Management to fit your organization's needs][aad-password-management].</span></span> 

<span data-ttu-id="58f1b-172">**Proteja aplicativos locais que podem ser acessados externamente.**</span><span class="sxs-lookup"><span data-stu-id="58f1b-172">**Protect on-premises applications that can be accessed externally.**</span></span> <span data-ttu-id="58f1b-173">Use o proxy de aplicativo do Azure AD para fornecer acesso controlado a aplicativos Web locais para usuários externos por meio do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-173">Use the Azure AD Application Proxy to provide controlled access to on-premises web applications for external users through Azure AD.</span></span> <span data-ttu-id="58f1b-174">Somente os usuários com credenciais válidas no diretório do Azure terão permissão para usar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="58f1b-174">Only users that have valid credentials in your Azure directory have permission to use the application.</span></span> <span data-ttu-id="58f1b-175">Para obter mais informações, consulte o artigo [Habilitar o proxy de aplicativo no portal do Azure][aad-application-proxy].</span><span class="sxs-lookup"><span data-stu-id="58f1b-175">For more information, see the article [Enable Application Proxy in the Azure portal][aad-application-proxy].</span></span>

<span data-ttu-id="58f1b-176">**Monitore o Azure AD ativamente em busca de sinais de atividade suspeita.**</span><span class="sxs-lookup"><span data-stu-id="58f1b-176">**Actively monitor Azure AD for signs of suspicious activity.**</span></span>    <span data-ttu-id="58f1b-177">Considere o uso da edição Azure AD Premium P2, que inclui o Azure AD Identity Protection.</span><span class="sxs-lookup"><span data-stu-id="58f1b-177">Consider using Azure AD Premium P2 edition, which includes Azure AD Identity Protection.</span></span> <span data-ttu-id="58f1b-178">O Identity Protection usa algoritmos de aprendizado de máquina adaptáveis e heurística para detectar anomalias e eventos de risco que podem indicar que uma identidade foi comprometida.</span><span class="sxs-lookup"><span data-stu-id="58f1b-178">Identity Protection uses adaptive machine learning algorithms and heuristics to detect anomalies and risk events that may indicate that an identity has been compromised.</span></span> <span data-ttu-id="58f1b-179">Por exemplo, ele pode detectar uma atividade possivelmente incomum como atividades de entrada irregulares, entradas de fontes desconhecidas ou de endereços IP com atividade suspeita ou entradas de dispositivos que possam estar infectados.</span><span class="sxs-lookup"><span data-stu-id="58f1b-179">For example, it can detect potentially unusual activity such as irregular sign-in activities, sign-ins from unknown sources or from IP addresses with suspicious activity, or sign-ins from devices that may be infected.</span></span> <span data-ttu-id="58f1b-180">Usando esses dados, o Identity Protection gera relatórios e alertas que permitem investigar esses eventos de risco e executar ações apropriadas.</span><span class="sxs-lookup"><span data-stu-id="58f1b-180">Using this data, Identity Protection generates reports and alerts that enables you to investigate these risk events and take appropriate action.</span></span> <span data-ttu-id="58f1b-181">Para obter mais informações, consulte [Azure Active Directory Identity Protection][aad-identity-protection].</span><span class="sxs-lookup"><span data-stu-id="58f1b-181">For more information, see [Azure Active Directory Identity Protection][aad-identity-protection].</span></span>
  
<span data-ttu-id="58f1b-182">Você pode usar o recurso de relatório do Azure AD no portal do Azure para monitorar atividades relacionadas à segurança que ocorrem no sistema.</span><span class="sxs-lookup"><span data-stu-id="58f1b-182">You can use the reporting feature of Azure AD in the Azure portal to monitor security-related activities occurring in your system.</span></span> <span data-ttu-id="58f1b-183">Para obter mais informações de como usar esses relatórios, consulte [Guia de relatórios do Azure Active Directory][aad-reporting-guide].</span><span class="sxs-lookup"><span data-stu-id="58f1b-183">For more information about using these reports, see [Azure Active Directory Reporting Guide][aad-reporting-guide].</span></span>

### <a name="topology-recommendations"></a><span data-ttu-id="58f1b-184">Recomendações de topologia</span><span class="sxs-lookup"><span data-stu-id="58f1b-184">Topology recommendations</span></span>

<span data-ttu-id="58f1b-185">Configure o Azure AD Connect para implementar uma topologia que mais se aproxime dos requisitos da sua organização.</span><span class="sxs-lookup"><span data-stu-id="58f1b-185">Configure Azure AD Connect to implement a topology that most closely matches the requirements of your organization.</span></span> <span data-ttu-id="58f1b-186">Algumas topologias com suporte do Azure AD Connect:</span><span class="sxs-lookup"><span data-stu-id="58f1b-186">Topologies that Azure AD Connect supports include the following:</span></span>

* <span data-ttu-id="58f1b-187">**Uma única floresta e um único diretório do Azure AD**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-187">**Single forest, single Azure AD directory**.</span></span> <span data-ttu-id="58f1b-188">Nessa topologia, o Azure AD Connect sincroniza objetos e informações de identidade de um ou mais domínios em uma única floresta local em um único locatário do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-188">In this topology, Azure AD Connect synchronizes objects and identity information from one or more domains in a single on-premises forest into a single Azure AD tenant.</span></span> <span data-ttu-id="58f1b-189">Essa é a topologia padrão implementada pela instalação expressa do Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="58f1b-189">This is the default topology implemented by the express installation of Azure AD Connect.</span></span>
  
  > [!NOTE]
  > <span data-ttu-id="58f1b-190">Não use vários servidores de sincronização do Azure AD Connect para conectar diferentes domínios na mesma floresta local ao locatário do Azure AD, a menos que você esteja executando um servidor no modo de preparo descrito abaixo.</span><span class="sxs-lookup"><span data-stu-id="58f1b-190">Don't use multiple Azure AD Connect sync servers to connect different domains in the same on-premises forest to the same Azure AD tenant, unless you are running a server in staging mode, described below.</span></span>
  > 
  > 

* <span data-ttu-id="58f1b-191">**Várias florestas e um único diretório do Azure AD**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-191">**Multiple forests, single Azure AD directory**.</span></span> <span data-ttu-id="58f1b-192">Nessa topologia, o Azure AD Connect sincroniza objetos e informações de identidade de várias florestas em um único locatário do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-192">In this topology, Azure AD Connect synchronizes objects and identity information from multiple forests into a single Azure AD tenant.</span></span> <span data-ttu-id="58f1b-193">Use essa topologia se sua organização tiver mais de uma floresta local.</span><span class="sxs-lookup"><span data-stu-id="58f1b-193">Use this topology if your organization has more than one on-premises forest.</span></span> <span data-ttu-id="58f1b-194">Você pode consolidar informações de identidade para que cada usuário único seja representado uma única vez no diretório do Azure AD, ainda que o mesmo usuário exista em mais de uma floresta.</span><span class="sxs-lookup"><span data-stu-id="58f1b-194">You can consolidate identity information so that each unique user is represented once in the Azure AD directory, even if the same user exists in more than one forest.</span></span> <span data-ttu-id="58f1b-195">Todas as florestas usam o mesmo servidor de sincronização do Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="58f1b-195">All forests use the same Azure AD Connect sync server.</span></span> <span data-ttu-id="58f1b-196">O servidor de sincronização do Azure AD Connect não precisa fazer parte de nenhum domínio, mas ele deve ser acessível para todas as florestas.</span><span class="sxs-lookup"><span data-stu-id="58f1b-196">The Azure AD Connect sync server does not have to be part of any domain, but it must be reachable from all forests.</span></span>
  
  > [!NOTE]
  > <span data-ttu-id="58f1b-197">Nessa topologia, não use servidores de sincronização do Azure AD Connect separados para conectar cada floresta local a um único locatário do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-197">In this topology, don't use separate Azure AD Connect sync servers to connect each on-premises forest to a single Azure AD tenant.</span></span> <span data-ttu-id="58f1b-198">Isso poderá resultar na duplicação de informações de identidade no Azure AD se os usuários estiverem presentes em mais de uma floresta.</span><span class="sxs-lookup"><span data-stu-id="58f1b-198">This can result in duplicated identity information in Azure AD if users are present in more than one forest.</span></span>
  > 
  > 

* <span data-ttu-id="58f1b-199">**Várias florestas e topologias separadas**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-199">**Multiple forests, separate topologies**.</span></span> <span data-ttu-id="58f1b-200">Essa topologia mescla as informações de identidade de florestas separadas em um único locatário do Azure AD, tratando todas as florestas como entidades separadas.</span><span class="sxs-lookup"><span data-stu-id="58f1b-200">This topology merges identity information from separate forests into a single Azure AD tenant, treating all forests as separate entities.</span></span> <span data-ttu-id="58f1b-201">Essa topologia será útil se você estiver combinando florestas de diferentes organizações e as informações de identidade de cada usuário forem mantidas em uma única floresta.</span><span class="sxs-lookup"><span data-stu-id="58f1b-201">This topology is useful if you are combining forests from different organizations and the identity information for each user is held in only one forest.</span></span>
  
  > [!NOTE]
  > <span data-ttu-id="58f1b-202">Se as GALs (listas de endereços global) em cada floresta estiverem sincronizadas, um usuário em uma floresta poderá estar presente em outra como um contato.</span><span class="sxs-lookup"><span data-stu-id="58f1b-202">If the global address lists (GAL) in each forest are synchronized, a user in one forest may be present in another as a contact.</span></span> <span data-ttu-id="58f1b-203">Isso poderá ocorrer se sua organização tiver implementado o GALSync com o Forefront Identity Manager 2010 ou o Microsoft Identity Manager 2016.</span><span class="sxs-lookup"><span data-stu-id="58f1b-203">This can occur if your organization has implemented GALSync with Forefront Identity manager 2010 or Microsoft Identity Manager 2016.</span></span> <span data-ttu-id="58f1b-204">Nesse cenário, você pode especificar que os usuários devem ser identificados pelo atributo *Mail*.</span><span class="sxs-lookup"><span data-stu-id="58f1b-204">In this scenario, you can specify that users should be identified by their *Mail* attribute.</span></span> <span data-ttu-id="58f1b-205">Você também pode corresponder identidades usando os atributos *ObjectSID* e *msExchMasterAccountSID*.</span><span class="sxs-lookup"><span data-stu-id="58f1b-205">You can also match identities using the *ObjectSID* and *msExchMasterAccountSID* attributes.</span></span> <span data-ttu-id="58f1b-206">Isso será útil se você tiver uma ou mais florestas de recursos com contas desabilitadas.</span><span class="sxs-lookup"><span data-stu-id="58f1b-206">This is useful if you have one or more resource forests with disabled accounts.</span></span>
  > 
  > 

* <span data-ttu-id="58f1b-207">**Servidor de preparo**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-207">**Staging server**.</span></span> <span data-ttu-id="58f1b-208">Nessa configuração, você pode executar uma segunda instância do servidor de sincronização do Azure AD Connect em paralelo com a primeira.</span><span class="sxs-lookup"><span data-stu-id="58f1b-208">In this configuration, you run a second instance of the Azure AD Connect sync server in parallel with the first.</span></span> <span data-ttu-id="58f1b-209">Essa estrutura dá suporte a cenários, como:</span><span class="sxs-lookup"><span data-stu-id="58f1b-209">This structure supports scenarios such as:</span></span>
  
  * <span data-ttu-id="58f1b-210">Alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="58f1b-210">High availability.</span></span>
  * <span data-ttu-id="58f1b-211">Testar e implantar uma nova configuração do servidor de sincronização do Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="58f1b-211">Testing and deploying a new configuration of the Azure AD Connect sync server.</span></span>
  * <span data-ttu-id="58f1b-212">Apresentando um novo servidor e desativando uma configuração antiga.</span><span class="sxs-lookup"><span data-stu-id="58f1b-212">Introducing a new server and decommissioning an old configuration.</span></span> 
    
    <span data-ttu-id="58f1b-213">Nesses cenários, a segunda instância é executada no *modo de preparo*.</span><span class="sxs-lookup"><span data-stu-id="58f1b-213">In these scenarios, the second instance runs in *staging mode*.</span></span> <span data-ttu-id="58f1b-214">O servidor registra os dados de sincronização e os objetos importados no banco de dados, mas não passa os dados para o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-214">The server records imported objects and synchronization data in its database, but does not pass the data to Azure AD.</span></span> <span data-ttu-id="58f1b-215">Se você desabilitar o modo de preparo, o servidor começará a gravar dados no Azure AD e também começará a executar write-backs de senha nos diretórios locais, quando apropriado.</span><span class="sxs-lookup"><span data-stu-id="58f1b-215">If you disable staging mode, the server starts writing data to Azure AD, and also starts performing password write-backs into the on-premises directories where appropriate.</span></span> <span data-ttu-id="58f1b-216">Para obter mais informações, consulte [Sincronização do Azure AD Connect: considerações e tarefas operacionais][aad-connect-sync-operational-tasks].</span><span class="sxs-lookup"><span data-stu-id="58f1b-216">For more information, see [Azure AD Connect sync: Operational tasks and considerations][aad-connect-sync-operational-tasks].</span></span>

* <span data-ttu-id="58f1b-217">**Vários diretórios do Azure AD**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-217">**Multiple Azure AD directories**.</span></span> <span data-ttu-id="58f1b-218">É recomendável criar um único diretório do Azure AD para uma organização, mas pode haver situações em que você precise particionar informações em diretórios do Azure AD separados.</span><span class="sxs-lookup"><span data-stu-id="58f1b-218">It is recommended that you create a single Azure AD directory for an organization, but there may be situations where you need to partition information across separate Azure AD directories.</span></span> <span data-ttu-id="58f1b-219">Nesse caso, evite problemas de sincronização e de write-back de senha garantindo que cada objeto da floresta local apareça apenas em um único diretório do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-219">In this case, avoid synchronization and password write-back issues by ensuring that each object from the on-premises forest appears in only one Azure AD directory.</span></span> <span data-ttu-id="58f1b-220">Para implementar este cenário, configure servidores de sincronização do Azure AD Connect separados para cada diretório do Azure AD e use a filtragem de forma que cada servidor de sincronização do Azure AD Connect opere em um conjunto de objetos mutuamente exclusivo.</span><span class="sxs-lookup"><span data-stu-id="58f1b-220">To implement this scenario, configure separate Azure AD Connect sync servers for each Azure AD directory, and use filtering so that each Azure AD Connect sync server operates on a mutually exclusive set of objects.</span></span> 

<span data-ttu-id="58f1b-221">Para obter mais informações sobre essas topologias, consulte [Topologias para o Azure AD Connect][aad-topologies].</span><span class="sxs-lookup"><span data-stu-id="58f1b-221">For more information about these topologies, see [Topologies for Azure AD Connect][aad-topologies].</span></span>

### <a name="user-authentication"></a><span data-ttu-id="58f1b-222">Autenticação de usuário</span><span class="sxs-lookup"><span data-stu-id="58f1b-222">User authentication</span></span>

<span data-ttu-id="58f1b-223">Por padrão, o servidor de sincronização do Azure AD Connect configura a sincronização de senha entre o domínio local e o Azure AD, e o serviço do Azure AD pressupõe que os usuários se autenticam fornecendo a mesma senha que usam localmente.</span><span class="sxs-lookup"><span data-stu-id="58f1b-223">By default, the Azure AD Connect sync server configures password synchronization between the on-premises domain and Azure AD, and the Azure AD service assumes that users authenticate by providing the same password that they use on-premises.</span></span> <span data-ttu-id="58f1b-224">Para muitas organizações, isso é apropriado, mas você deve considerar as políticas e a infraestrutura existentes da sua organização.</span><span class="sxs-lookup"><span data-stu-id="58f1b-224">For many organizations, this is appropriate, but you should consider your organization's existing policies and infrastructure.</span></span> <span data-ttu-id="58f1b-225">Por exemplo: </span><span class="sxs-lookup"><span data-stu-id="58f1b-225">For example:</span></span>

* <span data-ttu-id="58f1b-226">A política de segurança da sua organização pode proibir a sincronização de hashes de senha para a nuvem.</span><span class="sxs-lookup"><span data-stu-id="58f1b-226">The security policy of your organization might prohibit synchronizing password hashes to the cloud.</span></span>
* <span data-ttu-id="58f1b-227">Você pode exigir que os usuários usem um SSO (logon único) perfeito ao acessar os recursos em nuvem por meio de computadores ingressados no domínio na rede corporativa.</span><span class="sxs-lookup"><span data-stu-id="58f1b-227">You might require that users experience seamless single sign-on (SSO) when accessing cloud resources from domain-joined machines on the corporate network.</span></span>
* <span data-ttu-id="58f1b-228">Talvez sua organização já tenha o Serviços de Federação do Active Directory (AD FS) ou uma implantação de provedor de federação de terceiros.</span><span class="sxs-lookup"><span data-stu-id="58f1b-228">Your organization might already have Active Directory Federation Services (AD FS) or a third party federation provider deployed.</span></span> <span data-ttu-id="58f1b-229">Você pode configurar o Azure AD para usar essa infraestrutura para implementar a autenticação e SSO, em vez de usar informações de senha mantidas na nuvem.</span><span class="sxs-lookup"><span data-stu-id="58f1b-229">You can configure Azure AD to use this infrastructure to implement authentication and SSO rather than by using password information held in the cloud.</span></span>

<span data-ttu-id="58f1b-230">Para obter mais informações, consulte [Opções de entrada de usuário do Azure AD Connect][aad-user-sign-in].</span><span class="sxs-lookup"><span data-stu-id="58f1b-230">For more information, see [Azure AD Connect User Sign on options][aad-user-sign-in].</span></span>

### <a name="azure-ad-application-proxy"></a><span data-ttu-id="58f1b-231">Proxy de aplicativo do Azure AD</span><span class="sxs-lookup"><span data-stu-id="58f1b-231">Azure AD application proxy</span></span> 

<span data-ttu-id="58f1b-232">Use o Azure AD para fornecer acesso a aplicativos locais.</span><span class="sxs-lookup"><span data-stu-id="58f1b-232">Use Azure AD to provide access to on-premises applications.</span></span>

<span data-ttu-id="58f1b-233">Exponha seus aplicativos Web locais usando conectores de proxy de aplicativo gerenciados pelo componente de proxy de aplicativo do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-233">Expose your on-premises web applications using application proxy connectors managed by the Azure AD application proxy component.</span></span> <span data-ttu-id="58f1b-234">O conector de proxy de aplicativo abre uma conexão de rede de saída com o proxy de aplicativo do Azure AD e as solicitações de usuários remotos são roteadas do Azure AD por essa conexão para os aplicativos Web.</span><span class="sxs-lookup"><span data-stu-id="58f1b-234">The application proxy connector opens an outbound network connection to the Azure AD application proxy, and remote users' requests are routed back from Azure AD through this connection to the web apps.</span></span> <span data-ttu-id="58f1b-235">Isso elimina a necessidade de abrir portas de entrada no firewall local e reduz a superfície de ataque exposta pela sua organização.</span><span class="sxs-lookup"><span data-stu-id="58f1b-235">This removes the need to open inbound ports in the on-premises firewall and reduces the attack surface exposed by your organization.</span></span>

<span data-ttu-id="58f1b-236">Para obter mais informações, consulte [Publicar aplicativos usando o proxy de aplicativo do Azure AD][aad-application-proxy].</span><span class="sxs-lookup"><span data-stu-id="58f1b-236">For more information, see [Publish applications using Azure AD Application proxy][aad-application-proxy].</span></span>

### <a name="object-synchronization"></a><span data-ttu-id="58f1b-237">Sincronização de objeto</span><span class="sxs-lookup"><span data-stu-id="58f1b-237">Object synchronization</span></span> 

<span data-ttu-id="58f1b-238">A configuração de padrão do Azure AD Connect sincroniza objetos do diretório do Active Directory local com base nas regras especificadas no artigo [Sincronização do Azure AD Connect: noções básicas sobre a configuração padrão][aad-connect-sync-default-rules].</span><span class="sxs-lookup"><span data-stu-id="58f1b-238">Azure AD Connect's default configuration synchronizes objects from your local Active Directory directory based on the rules specified in the article [Azure AD Connect sync: Understanding the default configuration][aad-connect-sync-default-rules].</span></span> <span data-ttu-id="58f1b-239">Os objetos que atendem a essas regras são sincronizados enquanto todos os outros objetos são ignorados.</span><span class="sxs-lookup"><span data-stu-id="58f1b-239">Objects that satisfy these rules are synchronized while all other objects are ignored.</span></span> <span data-ttu-id="58f1b-240">Algumas regras de exemplo:</span><span class="sxs-lookup"><span data-stu-id="58f1b-240">Some example rules:</span></span>

* <span data-ttu-id="58f1b-241">Os objetos de usuário devem ter um único atributo *sourceAnchor* e o atributo *accountEnabled* deve estar populado.</span><span class="sxs-lookup"><span data-stu-id="58f1b-241">User objects must have a unique *sourceAnchor* attribute and the *accountEnabled* attribute must be populated.</span></span>
* <span data-ttu-id="58f1b-242">Os objetos de usuário devem ter um atributo *sAMAccountName* e não podem começar com o texto *Azure AD_* ou *MSOL_*.</span><span class="sxs-lookup"><span data-stu-id="58f1b-242">User objects must have a *sAMAccountName* attribute and cannot start with the text *Azure AD_* or *MSOL_*.</span></span>

<span data-ttu-id="58f1b-243">O Azure AD Connect aplica várias regras a objetos de usuário, contato, grupo, ForeignSecurityPrincipal e computador.</span><span class="sxs-lookup"><span data-stu-id="58f1b-243">Azure AD Connect applies several rules to User, Contact, Group, ForeignSecurityPrincipal, and Computer objects.</span></span> <span data-ttu-id="58f1b-244">Use o Editor de Regras de Sincronização instalado com o Azure AD Connect, se você precisar modificar o conjunto de regras padrão.</span><span class="sxs-lookup"><span data-stu-id="58f1b-244">Use the Synchronization Rules Editor installed with Azure AD Connect if you need to modify the default set of rules.</span></span> <span data-ttu-id="58f1b-245">Para obter mais informações, consulte [Sincronização do Azure AD Connect: noções básicas sobre a configuração padrão][aad-connect-sync-default-rules]).</span><span class="sxs-lookup"><span data-stu-id="58f1b-245">For more information, see [Azure AD Connect sync: Understanding the default configuration][aad-connect-sync-default-rules]).</span></span>

<span data-ttu-id="58f1b-246">Você também pode definir seus próprios filtros para limitar os objetos a serem sincronizados por domínio ou OU (unidade organizacional).</span><span class="sxs-lookup"><span data-stu-id="58f1b-246">You can also define your own filters to limit the objects to be synchronized by domain or OU.</span></span> <span data-ttu-id="58f1b-247">Como alternativa, você pode implementar uma filtragem personalizada mais complexa, como é descrito em [Sincronização do Azure AD Connect: configurar a filtragem][aad-filtering].</span><span class="sxs-lookup"><span data-stu-id="58f1b-247">Alternatively, you can implement more complex custom filtering such as that described in [Azure AD Connect sync: Configure Filtering][aad-filtering].</span></span>

### <a name="monitoring"></a><span data-ttu-id="58f1b-248">Monitoramento</span><span class="sxs-lookup"><span data-stu-id="58f1b-248">Monitoring</span></span> 

<span data-ttu-id="58f1b-249">O monitoramento de integridade é executado pelos seguintes agentes instalados localmente:</span><span class="sxs-lookup"><span data-stu-id="58f1b-249">Health monitoring is performed by the following agents installed on-premises:</span></span>

* <span data-ttu-id="58f1b-250">O Azure AD Connect instala um agente que captura informações sobre operações de sincronização.</span><span class="sxs-lookup"><span data-stu-id="58f1b-250">Azure AD Connect installs an agent that captures information about synchronization operations.</span></span> <span data-ttu-id="58f1b-251">Use a folha Azure AD Connect Health no portal do Azure para monitorar sua integridade e seu desempenho.</span><span class="sxs-lookup"><span data-stu-id="58f1b-251">Use the Azure AD Connect Health blade in the Azure portal to monitor its health and performance.</span></span> <span data-ttu-id="58f1b-252">Para obter mais informações, consulte [Usando o Azure AD Connect Health para sincronização][aad-health].</span><span class="sxs-lookup"><span data-stu-id="58f1b-252">For more information, see [Using Azure AD Connect Health for sync][aad-health].</span></span>
* <span data-ttu-id="58f1b-253">Para monitorar a integridade dos domínios do AD DS e dos diretórios do Azure, instale o Azure AD Connect Health para agente do AD DS em um computador no domínio local.</span><span class="sxs-lookup"><span data-stu-id="58f1b-253">To monitor the health of the AD DS domains and directories from Azure, install the Azure AD Connect Health for AD DS agent on a machine within the on-premises domain.</span></span> <span data-ttu-id="58f1b-254">Use a folha do Azure Active Directory Connect Health no portal do Azure para monitoramento de integridade.</span><span class="sxs-lookup"><span data-stu-id="58f1b-254">Use the Azure Active Directory Connect Health blade in the Azure portal for health monitoring.</span></span> <span data-ttu-id="58f1b-255">Para obter mais informações, consulte [Usando o Azure AD Connect Health com o AD DS][aad-health-adds]</span><span class="sxs-lookup"><span data-stu-id="58f1b-255">For more information, see [Using Azure AD Connect Health with AD DS][aad-health-adds]</span></span> 
* <span data-ttu-id="58f1b-256">Instale o Azure AD Connect Health para agente do AD FS para monitorar a integridade dos serviços em execução local e use a folha Azure Active Directory Connect Health no portal do Azure para monitorar o AD FS.</span><span class="sxs-lookup"><span data-stu-id="58f1b-256">Install the Azure AD Connect Health for AD FS agent to monitor the health of services running on on-premises, and use the Azure Active Directory Connect Health blade in the Azure portal to monitor AD FS.</span></span> <span data-ttu-id="58f1b-257">Para obter mais informações, consulte [Usando o Azure AD Connect Health com o AD FS][aad-health-adfs]</span><span class="sxs-lookup"><span data-stu-id="58f1b-257">For more information, see [Using Azure AD Connect Health with AD FS][aad-health-adfs]</span></span>

<span data-ttu-id="58f1b-258">Para obter mais informações de como instalar os agentes do AD Connect Health e seus requisitos, consulte [Instalação do Agente do Azure AD Connect Health][aad-agent-installation].</span><span class="sxs-lookup"><span data-stu-id="58f1b-258">For more information on installing the AD Connect Health agents and their requirements, see [Azure AD Connect Health Agent Installation][aad-agent-installation].</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="58f1b-259">Considerações sobre escalabilidade</span><span class="sxs-lookup"><span data-stu-id="58f1b-259">Scalability considerations</span></span>

<span data-ttu-id="58f1b-260">O serviço do Azure AD dá suporte à escalabilidade baseada em réplicas, com uma única réplica primária que manipula operações de gravação e várias réplicas secundárias somente leitura.</span><span class="sxs-lookup"><span data-stu-id="58f1b-260">The Azure AD service supports scalability based on replicas, with a single primary replica that handles write operations plus multiple read-only secondary replicas.</span></span> <span data-ttu-id="58f1b-261">O Azure AD redireciona de forma transparente as tentativas de gravação feitas nas réplicas secundárias para a réplica primária e fornece consistência eventual.</span><span class="sxs-lookup"><span data-stu-id="58f1b-261">Azure AD transparently redirects attempted writes made against secondary replicas to the primary replica and provides eventual consistency.</span></span> <span data-ttu-id="58f1b-262">Todas as alterações feitas na réplica primária são propagadas para as réplicas secundárias.</span><span class="sxs-lookup"><span data-stu-id="58f1b-262">All changes made to the primary replica are propagated to the secondary replicas.</span></span> <span data-ttu-id="58f1b-263">Essa arquitetura pode ser bem dimensionada porque a maioria das operações no Azure AD são leituras em vez de gravações.</span><span class="sxs-lookup"><span data-stu-id="58f1b-263">This architecture scales well because most operations against Azure AD are reads rather than writes.</span></span> <span data-ttu-id="58f1b-264">Para obter mais informações, consulte [Azure AD: Under the hood of our geo-redundant, highly available, distributed cloud directory][aad-scalability] (Azure AD: nos bastidores do nosso diretório na nuvem com redundância geográfica, distribuído e altamente disponível).</span><span class="sxs-lookup"><span data-stu-id="58f1b-264">For more information, see [Azure AD: Under the hood of our geo-redundant, highly available, distributed cloud directory][aad-scalability].</span></span>

<span data-ttu-id="58f1b-265">Para o servidor de sincronização do Azure AD Connect, determine quantos objetos você provavelmente vai sincronizar de seu diretório local.</span><span class="sxs-lookup"><span data-stu-id="58f1b-265">For the Azure AD Connect sync server, determine how many objects you are likely to synchronize from your local directory.</span></span> <span data-ttu-id="58f1b-266">Se você tiver menos de 100 mil objetos, será possível usar o software do SQL Server Express LocalDB padrão fornecido com o Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="58f1b-266">If you have less than 100,000 objects, you can use the default SQL Server Express LocalDB software provided with Azure AD Connect.</span></span> <span data-ttu-id="58f1b-267">Se você tiver um número maior de objetos, será necessário instalar uma versão de produção do SQL Server e executar uma instalação personalizada do Azure AD Connect, especificando que ele deve usar uma instância existente do SQL Server.</span><span class="sxs-lookup"><span data-stu-id="58f1b-267">If you have a larger number of objects, you should install a production version of SQL Server and perform a custom installation of Azure AD Connect, specifying that it should use an existing instance of SQL Server.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="58f1b-268">Considerações sobre disponibilidade</span><span class="sxs-lookup"><span data-stu-id="58f1b-268">Availability considerations</span></span>

<span data-ttu-id="58f1b-269">O serviço do Azure AD é distribuído geograficamente e é executado em vários data centers espalhados pelo mundo com failover automático.</span><span class="sxs-lookup"><span data-stu-id="58f1b-269">The Azure AD service is geo-distributed and runs in multiple data centers spread around the world with automated failover.</span></span> <span data-ttu-id="58f1b-270">Se um data center fica indisponível, o Azure AD garante que seus dados de diretório estejam disponíveis para acesso de instância em pelo menos dois data centers dispersos mais regionalmente.</span><span class="sxs-lookup"><span data-stu-id="58f1b-270">If a data center becomes unavailable, Azure AD ensures that your directory data is available for instance access in at least two more regionally dispersed data centers.</span></span>

> [!NOTE]
> <span data-ttu-id="58f1b-271">O SLA (Contrato de Nível de Serviço) dos serviços Azure AD Basic e Premium garante pelo menos 99,9% de disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="58f1b-271">The service level agreement (SLA) for Azure AD Basic and Premium services guarantees at least 99.9% availability.</span></span> <span data-ttu-id="58f1b-272">Não há um SLA para a Camada gratuita do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-272">There is no SLA for the Free tier of Azure AD.</span></span> <span data-ttu-id="58f1b-273">Para obter mais informações, consulte [SLA para Azure Active Directory][sla-aad].</span><span class="sxs-lookup"><span data-stu-id="58f1b-273">For more information, see [SLA for Azure Active Directory][sla-aad].</span></span>
> 
> 

<span data-ttu-id="58f1b-274">Considere provisionar uma segunda instância do servidor de sincronização do Azure AD Connect no modo de preparo para aumentar a disponibilidade, conforme foi discutido na seção de recomendações de topologia.</span><span class="sxs-lookup"><span data-stu-id="58f1b-274">Consider provisioning a second instance of Azure AD Connect sync server in staging mode to increase availability, as discussed in the topology recommendations section.</span></span> 

<span data-ttu-id="58f1b-275">Se você não estiver usando a instância do SQL Server Express LocalDB que vem com o Azure AD Connect, considere usar o clustering do SQL para obter alta disponibilidade.</span><span class="sxs-lookup"><span data-stu-id="58f1b-275">If you are not using the SQL Server Express LocalDB instance that comes with Azure AD Connect, consider using SQL clustering to achieve high availability.</span></span> <span data-ttu-id="58f1b-276">Soluções como espelhamento e Always On não têm suporte no Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="58f1b-276">Solutions such as mirroring and Always On are not supported by Azure AD Connect.</span></span>

<span data-ttu-id="58f1b-277">Para obter considerações adicionais de como obter alta disponibilidade do servidor de sincronização do Azure AD Connect e também como se recuperar após uma falha, consulte [Sincronização do Azure AD Connect: considerações e tarefas operacionais][aad-sync-disaster-recovery].</span><span class="sxs-lookup"><span data-stu-id="58f1b-277">For additional considerations about achieving high availability of the Azure AD Connect sync server and also how to recover after a failure, see [Azure AD Connect sync: Operational tasks and considerations - Disaster Recovery][aad-sync-disaster-recovery].</span></span>

## <a name="manageability-considerations"></a><span data-ttu-id="58f1b-278">Considerações sobre capacidade de gerenciamento</span><span class="sxs-lookup"><span data-stu-id="58f1b-278">Manageability considerations</span></span>

<span data-ttu-id="58f1b-279">Há dois aspectos para gerenciar o Azure AD:</span><span class="sxs-lookup"><span data-stu-id="58f1b-279">There are two aspects to managing Azure AD:</span></span>

* <span data-ttu-id="58f1b-280">Administrando o Azure AD na nuvem.</span><span class="sxs-lookup"><span data-stu-id="58f1b-280">Administering Azure AD in the cloud.</span></span>
* <span data-ttu-id="58f1b-281">Mantendo os servidores de sincronização do Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="58f1b-281">Maintaining the Azure AD Connect sync servers.</span></span>

<span data-ttu-id="58f1b-282">O Azure AD fornece as seguintes opções para o gerenciamento de domínios e diretórios na nuvem:</span><span class="sxs-lookup"><span data-stu-id="58f1b-282">Azure AD provides the following options for managing domains and directories in the cloud:</span></span> 

* <span data-ttu-id="58f1b-283">**Módulo PowerShell do Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-283">**Azure Active Directory PowerShell Module**.</span></span> <span data-ttu-id="58f1b-284">Use este [módulo][aad-powershell] se precisar gerar script de tarefas administrativas comuns do Azure AD, como gerenciamento de usuários, gerenciamento de domínio e configuração de logon único.</span><span class="sxs-lookup"><span data-stu-id="58f1b-284">Use this [module][aad-powershell] if you need to script common Azure AD administrative tasks such as user management, domain management, and configuring single sign-on.</span></span>
* <span data-ttu-id="58f1b-285">**Folha Gerenciamento do Azure AD no portal do Azure**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-285">**Azure AD management blade in the Azure portal**.</span></span> <span data-ttu-id="58f1b-286">Essa folha fornece uma exibição de gerenciamento interativo do diretório e permite que você controle e configure a maioria dos aspectos do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-286">This blade provides an interactive management view of the directory, and enables you to control and configure most aspects of Azure AD.</span></span> 

<span data-ttu-id="58f1b-287">O Azure AD Connect instala as seguintes ferramentas para manter os serviços de sincronização do Azure AD Connect de suas máquinas locais:</span><span class="sxs-lookup"><span data-stu-id="58f1b-287">Azure AD Connect installs the following tools to maintain Azure AD Connect sync services from your on-premises machines:</span></span>
  
* <span data-ttu-id="58f1b-288">**Console do Microsoft Azure Active Directory Connect**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-288">**Microsoft Azure Active Directory Connect console**.</span></span> <span data-ttu-id="58f1b-289">Essa ferramenta permite modificar a configuração do servidor do Azure AD Sync, personalizar como a sincronização ocorre, habilitar ou desabilitar o modo de preparo e alternar o modo de conexão do usuário.</span><span class="sxs-lookup"><span data-stu-id="58f1b-289">This tool enables you to modify the configuration of the Azure AD Sync server, customize how synchronization occurs, enable or disable staging mode, and switch the user sign-in mode.</span></span> <span data-ttu-id="58f1b-290">Observe que você pode habilitar a conexão do Serviço de Federação no Active Directory usando sua infraestrutura local.</span><span class="sxs-lookup"><span data-stu-id="58f1b-290">Note that you can enable Active Directory FS sign-in using your on-premises infrastructure.</span></span>
* <span data-ttu-id="58f1b-291">**Synchronization Service Manager**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-291">**Synchronization Service Manager**.</span></span> <span data-ttu-id="58f1b-292">Use a guia *Operações* nessa ferramenta para gerenciar o processo de sincronização e detectar se houve falha em alguma parte do processo.</span><span class="sxs-lookup"><span data-stu-id="58f1b-292">Use the *Operations* tab in this tool to manage the synchronization process and detect whether any parts of the process have failed.</span></span> <span data-ttu-id="58f1b-293">Você pode disparar sincronizações manualmente usando essa ferramenta.</span><span class="sxs-lookup"><span data-stu-id="58f1b-293">You can trigger synchronizations manually using this tool.</span></span> <span data-ttu-id="58f1b-294">A guia *Conectores* permite que você controle as conexões dos domínios aos quais o mecanismo de sincronização está associado.</span><span class="sxs-lookup"><span data-stu-id="58f1b-294">The *Connectors* tab enables you to control the connections for the domains that the synchronization engine is attached to.</span></span>
* <span data-ttu-id="58f1b-295">**Editor de regras de sincronização**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-295">**Synchronization Rules Editor**.</span></span> <span data-ttu-id="58f1b-296">Use essa ferramenta para personalizar a maneira como os objetos são transformados quando são copiados entre um diretório local e o Azure AD.</span><span class="sxs-lookup"><span data-stu-id="58f1b-296">Use this tool to customize the way objects are transformed when they are copied between an on-premises directory and Azure AD.</span></span> <span data-ttu-id="58f1b-297">Essa ferramenta permite que você especifique atributos e objetos adicionais para sincronização e, em seguida, executa filtros para determinar quais objetos devem ou não devem ser sincronizados.</span><span class="sxs-lookup"><span data-stu-id="58f1b-297">This tool enables you to specify additional attributes and objects for synchronization, then executes filters to determine which objects should or should not be synchronized.</span></span> <span data-ttu-id="58f1b-298">Para obter mais informações, consulte a seção Editor de regra de sincronização do documento [Sincronização do Azure AD Connect: noções básicas sobre a configuração padrão][aad-connect-sync-default-rules].</span><span class="sxs-lookup"><span data-stu-id="58f1b-298">For more information, see the Synchronization Rule Editor section in the document [Azure AD Connect sync: Understanding the default configuration][aad-connect-sync-default-rules].</span></span>

<span data-ttu-id="58f1b-299">Para obter mais informações e dicas para o gerenciamento do Azure AD Connect, consulte [Sincronização do Azure AD Connect: práticas recomendadas para alterar a configuração padrão][aad-sync-best-practices].</span><span class="sxs-lookup"><span data-stu-id="58f1b-299">For more information and tips for managing Azure AD Connect, see [Azure AD Connect sync: Best practices for changing the default configuration][aad-sync-best-practices].</span></span>

## <a name="security-considerations"></a><span data-ttu-id="58f1b-300">Considerações de segurança</span><span class="sxs-lookup"><span data-stu-id="58f1b-300">Security considerations</span></span>

<span data-ttu-id="58f1b-301">Use o controle de acesso condicional para negar solicitações de autenticação de fontes inesperadas:</span><span class="sxs-lookup"><span data-stu-id="58f1b-301">Use conditional access control to deny authentication requests from unexpected sources:</span></span>

- <span data-ttu-id="58f1b-302">Dispare a [MFA (Autenticação Multifator) do Azure][azure-multifactor-authentication] se um usuário tentar se conectar de um local não confiável, como pela Internet, em vez de por uma rede confiável.</span><span class="sxs-lookup"><span data-stu-id="58f1b-302">Trigger [Azure Multi-Factor Authentication (MFA)][azure-multifactor-authentication] if a user attempts to connect from a nontrusted location such as across the Internet instead of a trusted network.</span></span>

- <span data-ttu-id="58f1b-303">Use o tipo de plataforma de dispositivo do usuário (iOS, Android, Windows Mobile, Windows) para determinar a política de acesso a aplicativos e recursos.</span><span class="sxs-lookup"><span data-stu-id="58f1b-303">Use the device platform type of the user (iOS, Android, Windows Mobile, Windows) to determine access policy to applications and features.</span></span>

- <span data-ttu-id="58f1b-304">Registre o estado de habilitação/desabilitação dos dispositivos dos usuários e incorpore essas informações nas verificações de política de acesso.</span><span class="sxs-lookup"><span data-stu-id="58f1b-304">Record the enabled/disabled state of users' devices, and incorporate this information into the access policy checks.</span></span> <span data-ttu-id="58f1b-305">Por exemplo, se o telefone de um usuário for perdido ou roubado, ele deverá ser gravado como desabilitado para impedir que seja usado para obter acesso.</span><span class="sxs-lookup"><span data-stu-id="58f1b-305">For example, if a user's phone is lost or stolen it should be recorded as disabled to prevent it from being used to gain access.</span></span>

- <span data-ttu-id="58f1b-306">Controle o acesso de usuário a recursos com base na associação ao grupo.</span><span class="sxs-lookup"><span data-stu-id="58f1b-306">Control user access to resources based on group membership.</span></span> <span data-ttu-id="58f1b-307">Use as [Regras de associação dinâmica do Azure AD][aad-dynamic-membership-rules] para simplificar a administração de grupo.</span><span class="sxs-lookup"><span data-stu-id="58f1b-307">Use [Azure AD dynamic membership rules][aad-dynamic-membership-rules] to simplify group administration.</span></span> <span data-ttu-id="58f1b-308">Para obter uma visão geral de como isso funciona, consulte [Introduction to Dynamic Memberships for Groups][aad-dynamic-memberships] (Introdução às associações dinâmicas a grupos).</span><span class="sxs-lookup"><span data-stu-id="58f1b-308">For a brief overview of how this works, see [Introduction to Dynamic Memberships for Groups][aad-dynamic-memberships].</span></span>

- <span data-ttu-id="58f1b-309">Use políticas de risco de acesso condicional com o Azure AD Identity Protection para fornecer proteção avançada com base em atividades de conexão incomuns ou em outros eventos.</span><span class="sxs-lookup"><span data-stu-id="58f1b-309">Use conditional access risk policies with Azure AD Identity Protection to provide advanced protection based on unusual sign-in activities or other events.</span></span>

<span data-ttu-id="58f1b-310">Para obter mais informações, consulte [Acesso condicional no Azure Active Directory][aad-conditional-access].</span><span class="sxs-lookup"><span data-stu-id="58f1b-310">For more information, see [Azure Active Directory conditional access][aad-conditional-access].</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="58f1b-311">Implantar a solução</span><span class="sxs-lookup"><span data-stu-id="58f1b-311">Deploy the solution</span></span>

<span data-ttu-id="58f1b-312">Uma implantação de uma arquitetura de referência que implementa essas considerações e recomendações está disponível no GitHub.</span><span class="sxs-lookup"><span data-stu-id="58f1b-312">A deployment for a reference architecture that implements these recommendations and considerations is available on GitHub.</span></span> <span data-ttu-id="58f1b-313">Essa arquitetura de referência implanta uma rede local simulada no Azure que você pode usar para testar e experimentar.</span><span class="sxs-lookup"><span data-stu-id="58f1b-313">This reference architecture deploys a simulated on-premise network in Azure that you can use to test and experiment.</span></span> <span data-ttu-id="58f1b-314">A arquitetura de referência pode ser implantada com VMs Windows ou Linux seguindo as instruções abaixo:</span><span class="sxs-lookup"><span data-stu-id="58f1b-314">The reference architecture can be deployed with either with Windows or Linux VMs by following the directions below:</span></span> 

1. <span data-ttu-id="58f1b-315">Clique no botão abaixo:</span><span class="sxs-lookup"><span data-stu-id="58f1b-315">Click the button below:</span></span><br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Freference-architectures%2Fmaster%2Fidentity%2Fazure-ad%2Fazuredeploy.json" target="_blank"><img src="http://azuredeploy.net/deploybutton.png"/></a>
2. <span data-ttu-id="58f1b-316">Depois que o link for aberto no portal do Azure, você deve inserir valores para algumas das configurações:</span><span class="sxs-lookup"><span data-stu-id="58f1b-316">Once the link has opened in the Azure portal, you must enter values for some of the settings:</span></span> 
   * <span data-ttu-id="58f1b-317">O nome do **Grupo de recursos** já está definido no arquivo de parâmetros, portanto, selecione **Criar novo** e digite `ra-aad-onpremise-rg` na caixa de texto.</span><span class="sxs-lookup"><span data-stu-id="58f1b-317">The **Resource group** name is already defined in the parameter file, so select **Create New** and enter `ra-aad-onpremise-rg` in the text box.</span></span>
   * <span data-ttu-id="58f1b-318">Selecione a região na caixa suspensa **Local**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-318">Select the region from the **Location** drop down box.</span></span>
   * <span data-ttu-id="58f1b-319">Não edite as caixas de texto **URI da raiz do modelo** ou **URI da raiz do parâmetro**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-319">Do not edit the **Template Root Uri** or the **Parameter Root Uri** text boxes.</span></span>
   * <span data-ttu-id="58f1b-320">Selecione **Windows** ou **Linux** na caixa suspensa **Tipo de SO**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-320">Select **windows** or **linux** in the **Os Type** the drop down box.</span></span>
   * <span data-ttu-id="58f1b-321">Analise os termos e condições e clique na caixa de seleção **Concordo com os termos e condições declarados acima**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-321">Review the terms and conditions, then click the **I agree to the terms and conditions stated above** checkbox.</span></span>
   * <span data-ttu-id="58f1b-322">Clique no botão **Comprar**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-322">Click the **Purchase** button.</span></span>
3. <span data-ttu-id="58f1b-323">Aguarde até que a implantação seja concluída.</span><span class="sxs-lookup"><span data-stu-id="58f1b-323">Wait for the deployment to complete.</span></span>
4. <span data-ttu-id="58f1b-324">Os arquivos de parâmetro incluem nomes e senhas de usuário administrador embutidos em código e é altamente recomendável alterá-los imediatamente em todas as VMs.</span><span class="sxs-lookup"><span data-stu-id="58f1b-324">The parameter files include a hard-coded administrator user names and passwords, and it is strongly recommended that you immediately change both on all the VMs.</span></span> <span data-ttu-id="58f1b-325">Clique em cada VM no Portal do Azure e, em seguida, clique em **Redefinir senha** na folha **Suporte + solução de problemas**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-325">Click each VM in the Azure Portal then click on **Reset password** in the **Support + troubleshooting** blade.</span></span> <span data-ttu-id="58f1b-326">Selecione **Redefinir senha** na caixa suspensa **Modo** e escolha um novo **Nome de usuário** e uma nova **Senha**.</span><span class="sxs-lookup"><span data-stu-id="58f1b-326">Select **Reset password** in the **Mode** drop down box, then select a new **User name** and **Password**.</span></span> <span data-ttu-id="58f1b-327">Clique no botão **Atualizar** para manter o novo nome de usuário e senha.</span><span class="sxs-lookup"><span data-stu-id="58f1b-327">Click the **Update** button to persist the new user name and password.</span></span>

<!-- links -->

[implementing-a-multi-tier-architecture-on-Azure]: ../virtual-machines-windows/n-tier.md

[aad-agent-installation]: /azure/active-directory/active-directory-aadconnect-health-agent-install
[aad-application-proxy]: /azure/active-directory/active-directory-application-proxy-enable
[aad-conditional-access]: /azure/active-directory//active-directory-conditional-access
[aad-connect-sync-default-rules]: /azure/active-directory/active-directory-aadconnectsync-understanding-default-configuration
[aad-connect-sync-operational-tasks]: /azure/active-directory/active-directory-aadconnectsync-operations#staging-mode
[aad-dynamic-memberships]: https://youtu.be/Tdiz2JqCl9Q
[aad-dynamic-membership-rules]: /azure/active-directory/active-directory-accessmanagement-groups-with-advanced-rules
[aad-editions]: /azure/active-directory/active-directory-editions
[aad-filtering]: /azure/active-directory/active-directory-aadconnectsync-configure-filtering
[aad-health]: /azure/active-directory/active-directory-aadconnect-health-sync
[aad-health-adds]: /azure/active-directory/active-directory-aadconnect-health-adds
[aad-health-adfs]: /azure/active-directory/active-directory-aadconnect-health-adfs
[aad-identity-protection]: /azure/active-directory/active-directory-identityprotection
[aad-password-management]: /azure/active-directory/active-directory-passwords-customize
[aad-powershell]: https://msdn.microsoft.com/library/azure/mt757189.aspx
[aad-reporting-guide]: /azure/active-directory/active-directory-reporting-guide
[aad-scalability]: https://blogs.technet.microsoft.com/enterprisemobility/2014/09/02/azure-ad-under-the-hood-of-our-geo-redundant-highly-available-distributed-cloud-directory/
[aad-sync-best-practices]: /azure/active-directory/active-directory-aadconnectsync-best-practices-changing-default-configuration
[aad-sync-disaster-recovery]: /azure/active-directory/active-directory-aadconnectsync-operations#disaster-recovery
[aad-sync-requirements]: /azure/active-directory/active-directory-hybrid-identity-design-considerations-directory-sync-requirements
[aad-topologies]: /azure/active-directory/active-directory-aadconnect-topologies
[aad-user-sign-in]: /azure/active-directory/active-directory-aadconnect-user-signin
[azure-active-directory]: /azure/active-directory-domain-services/active-directory-ds-overview
[azure-ad-connect]: /azure/active-directory/active-directory-aadconnect
[azure-multifactor-authentication]: /azure/multi-factor-authentication/multi-factor-authentication
[considerations]: ./considerations.md
[resource-manager-overview]: /azure/azure-resource-manager/resource-group-overview
[sla-aad]: https://azure.microsoft.com/support/legal/sla/active-directory/v1_0/
[visio-download]: https://archcenter.blob.core.windows.net/cdn/identity-architectures.vsdx


[0]: ./images/azure-ad.png "Arquitetura de identidade de nuvem usando o Azure Active Directory"