---
title: Implantando aplicativos do Azure para resiliência e disponibilidade
description: Uma visão geral das técnicas para criar implantações confiáveis no Azure
author: MikeWasson
ms.date: 04/10/2019
ms.topic: article
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.openlocfilehash: d8df3fe1c3353c60462959a625ba13ae47b96cf8
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59646479"
---
# <a name="deploying-azure-applications-for-resiliency-and-availability"></a><span data-ttu-id="0535e-103">Implantando aplicativos do Azure para resiliência e disponibilidade</span><span class="sxs-lookup"><span data-stu-id="0535e-103">Deploying Azure applications for resiliency and availability</span></span>

<span data-ttu-id="0535e-104">Como provisionar e atualizar recursos do Azure, o código do aplicativo e as definições de configuração, um processo repetível e previsível o ajudará a evitar erros e tempo de inatividade.</span><span class="sxs-lookup"><span data-stu-id="0535e-104">As you provision and update Azure resources, application code, and configuration settings, a repeatable and predictable process will help you avoid errors and downtime.</span></span> <span data-ttu-id="0535e-105">Recomendamos que os processos automatizados de implantação que você pode executar sob demanda e executar novamente se algo falhar.</span><span class="sxs-lookup"><span data-stu-id="0535e-105">We recommend automated processes for deployment that you can run on demand and rerun if something fails.</span></span> <span data-ttu-id="0535e-106">Depois que seus processos de implantação estão funcionando sem problemas, documentação do processo pode mantê-los dessa forma.</span><span class="sxs-lookup"><span data-stu-id="0535e-106">After your deployment processes are running smoothly, process documentation can keep them that way.</span></span>

## <a name="automate-processes"></a><span data-ttu-id="0535e-107">Automatizar processos</span><span class="sxs-lookup"><span data-stu-id="0535e-107">Automate processes</span></span>

<span data-ttu-id="0535e-108">Para ativar recursos sob demanda, implantar soluções rapidamente, minimizar o erro humano e produzir resultados consistentes e reproduzíveis, certifique-se de automatizar implantações e atualizações.</span><span class="sxs-lookup"><span data-stu-id="0535e-108">To activate resources on demand, deploy solutions rapidly, minimize human error, and produce consistent and repeatable results, be sure to automate deployments and updates.</span></span>

### <a name="automate-as-many-processes-as-possible"></a><span data-ttu-id="0535e-109">Automatizar processos de tantos quanto possível</span><span class="sxs-lookup"><span data-stu-id="0535e-109">Automate as many processes as possible</span></span>

<span data-ttu-id="0535e-110">Os processos de implantação mais confiáveis são automatizados e *idempotente* &mdash; ou seja, repetíveis para produzir os mesmos resultados.</span><span class="sxs-lookup"><span data-stu-id="0535e-110">The most reliable deployment processes are automated and *idempotent* &mdash; that is, repeatable to produce the same results.</span></span>

- <span data-ttu-id="0535e-111">Para automatizar o provisionamento de recursos do Azure, você pode usar [Terraform](/azure/virtual-machines/windows/infrastructure-automation#terraform), [Ansible](/azure/virtual-machines/windows/infrastructure-automation#ansible), [Chef](/azure/virtual-machines/windows/infrastructure-automation#chef), [Puppet](/azure/virtual-machines/windows/infrastructure-automation#puppet), [Azure PowerShell](/powershell/azure/overview), [interface de linha de comando (CLI) do Azure](/cli/azure), ou [modelos do Azure Resource Manager](/azure/azure-resource-manager/resource-group-overview#template-deployment).</span><span class="sxs-lookup"><span data-stu-id="0535e-111">To automate provisioning of Azure resources, you can use [Terraform](/azure/virtual-machines/windows/infrastructure-automation#terraform),   [Ansible](/azure/virtual-machines/windows/infrastructure-automation#ansible), [Chef](/azure/virtual-machines/windows/infrastructure-automation#chef), [Puppet](/azure/virtual-machines/windows/infrastructure-automation#puppet),   [Azure PowerShell](/powershell/azure/overview), [Azure command-line interface (CLI)](/cli/azure), or [Azure Resource Manager templates](/azure/azure-resource-manager/resource-group-overview#template-deployment).</span></span>
- <span data-ttu-id="0535e-112">Para configurar as VMs, você pode usar [cloud_init](/azure/virtual-machines/windows/infrastructure-automation#cloud-init) (para VMs do Linux) ou [configuração de estado de automação do Azure](/azure/automation/automation-dsc-overview) (DSC).</span><span class="sxs-lookup"><span data-stu-id="0535e-112">To configure VMs, you can use [cloud-init](/azure/virtual-machines/windows/infrastructure-automation#cloud-init) (for Linux VMs) or [Azure Automation State Configuration](/azure/automation/automation-dsc-overview) (DSC).</span></span>
- <span data-ttu-id="0535e-113">Para automatizar a implantação do aplicativo, você pode usar [serviços do Azure DevOps](/azure/virtual-machines/windows/infrastructure-automation#azure-devops-services), [Jenkins](/azure/virtual-machines/windows/infrastructure-automation#jenkins), ou outras soluções de CI/CD.</span><span class="sxs-lookup"><span data-stu-id="0535e-113">To automate application deployment, you can use [Azure DevOps Services](/azure/virtual-machines/windows/infrastructure-automation#azure-devops-services), [Jenkins](/azure/virtual-machines/windows/infrastructure-automation#jenkins), or other CI/CD solutions.</span></span>

<span data-ttu-id="0535e-114">Como prática recomendada, crie um repositório de scripts de automação categorizados para acesso rápido, documentada com explicações de parâmetros e exemplos de uso de script.</span><span class="sxs-lookup"><span data-stu-id="0535e-114">As a best practice, create a repository of categorized automation scripts for quick access, documented with explanations of parameters and examples of script use.</span></span> <span data-ttu-id="0535e-115">Mantenha esta documentação em sincronia com suas implantações do Azure e designe uma pessoa primária para gerenciar o repositório.</span><span class="sxs-lookup"><span data-stu-id="0535e-115">Keep this documentation in sync with your Azure deployments, and designate a primary person to manage the repository.</span></span>

<span data-ttu-id="0535e-116">Scripts de automação também podem ativar recursos sob demanda para recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="0535e-116">Automation scripts can also activate resources on demand for disaster recovery.</span></span>

### <a name="use-code-to-provision-and-configure-infrastructure"></a><span data-ttu-id="0535e-117">Use o código para provisionar e configurar a infraestrutura</span><span class="sxs-lookup"><span data-stu-id="0535e-117">Use code to provision and configure infrastructure</span></span>

<span data-ttu-id="0535e-118">Essa prática, chamada *infraestrutura como código,* pode usar uma abordagem declarativa ou imperativa (ou uma combinação de ambos).</span><span class="sxs-lookup"><span data-stu-id="0535e-118">This practice, called *infrastructure as code,* may use a declarative approach or an imperative approach (or a combination of both).</span></span>

- <span data-ttu-id="0535e-119">[Modelos do Resource Manager](/azure/azure-resource-manager/resource-group-overview#template-deployment) são um exemplo de uma abordagem declarativa.</span><span class="sxs-lookup"><span data-stu-id="0535e-119">[Resource Manager templates](/azure/azure-resource-manager/resource-group-overview#template-deployment) are an example of a declarative approach.</span></span>
- <span data-ttu-id="0535e-120">[PowerShell](/powershell/azure/overview) scripts são um exemplo de abordagem imperativa.</span><span class="sxs-lookup"><span data-stu-id="0535e-120">[PowerShell](/powershell/azure/overview) scripts are an example of an imperative approach.</span></span>

### <a name="practice-immutable-infrastructure"></a><span data-ttu-id="0535e-121">Infraestrutura imutável de prática</span><span class="sxs-lookup"><span data-stu-id="0535e-121">Practice immutable infrastructure</span></span>

<span data-ttu-id="0535e-122">Em outras palavras, não modifique infraestrutura após sua implantação para produção.</span><span class="sxs-lookup"><span data-stu-id="0535e-122">In other words, don't modify infrastructure after it's deployed to production.</span></span> <span data-ttu-id="0535e-123">Depois que tiverem sido aplicadas alterações ad hoc, você pode não saber exatamente o que mudou, portanto, pode ser difícil de solucionar problemas do sistema.</span><span class="sxs-lookup"><span data-stu-id="0535e-123">After ad hoc changes have been applied, you might not know exactly what has changed, so it can be difficult to troubleshoot the system.</span></span>

### <a name="automate-and-test-deployment-and-maintenance-tasks"></a><span data-ttu-id="0535e-124">Automatizar e testar tarefas de implantação e manutenção</span><span class="sxs-lookup"><span data-stu-id="0535e-124">Automate and test deployment and maintenance tasks</span></span>

<span data-ttu-id="0535e-125"> Aplicativos distribuídos consistem em várias partes que devem trabalhar em conjunto.</span><span class="sxs-lookup"><span data-stu-id="0535e-125">Distributed applications consist of multiple parts that must work together.</span></span> <span data-ttu-id="0535e-126">Implantação deve tirar vantagem dos mecanismos comprovados, como scripts, que podem atualizar e validar a configuração e automatizar o processo de implantação.</span><span class="sxs-lookup"><span data-stu-id="0535e-126">Deployment should take advantage of proven mechanisms, such as scripts, that can update and validate configuration and automate the deployment process.</span></span> <span data-ttu-id="0535e-127">Teste todos os processos totalmente para garantir que os erros não causam tempo de inatividade adicional.</span><span class="sxs-lookup"><span data-stu-id="0535e-127">Test all processes fully to ensure that errors don't cause additional downtime.</span></span>

### <a name="implement-deployment-security-measures"></a><span data-ttu-id="0535e-128">Implementar medidas de segurança de implantação</span><span class="sxs-lookup"><span data-stu-id="0535e-128">Implement deployment security measures</span></span>

<span data-ttu-id="0535e-129">Todas as ferramentas de implantação devem incorporar as restrições de segurança para proteger o aplicativo implantado.</span><span class="sxs-lookup"><span data-stu-id="0535e-129">All deployment tools must incorporate security restrictions to protect the deployed application.</span></span> <span data-ttu-id="0535e-130">Definir e impor políticas de implantação com cuidado e minimizar a necessidade de intervenção humana.</span><span class="sxs-lookup"><span data-stu-id="0535e-130">Define and enforce deployment policies carefully, and minimize the need for human intervention.</span></span>

## <a name="deploy-to-multiple-regions-and-instances"></a><span data-ttu-id="0535e-131">Implantar em várias regiões e instâncias</span><span class="sxs-lookup"><span data-stu-id="0535e-131">Deploy to multiple regions and instances</span></span>

<span data-ttu-id="0535e-132">Um aplicativo que depende de uma única instância de um serviço cria um ponto único de falha.</span><span class="sxs-lookup"><span data-stu-id="0535e-132">An application that depends on a single instance of a service creates a single point of failure.</span></span> <span data-ttu-id="0535e-133">Para melhorar a resiliência e escalabilidade, provisione várias instâncias.</span><span class="sxs-lookup"><span data-stu-id="0535e-133">To improve resiliency and scalability, provision multiple instances.</span></span>

- <span data-ttu-id="0535e-134">Para o [Serviço de Aplicativo do Azure](/azure/app-service/app-service-value-prop-what-is/), selecione um [Plano do Serviço de Aplicativo](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/) que ofereça várias instâncias.</span><span class="sxs-lookup"><span data-stu-id="0535e-134">For [Azure App Service](/azure/app-service/app-service-value-prop-what-is/), select an [App Service plan](/azure/app-service/azure-web-sites-web-hosting-plans-in-depth-overview/) that offers multiple instances.</span></span>
- <span data-ttu-id="0535e-135">Para [serviços de nuvem do Azure](/azure/cloud-services/cloud-services-choose-me), configure cada uma das suas funções para usar [várias instâncias](/azure/cloud-services/cloud-services-choose-me/#scaling-and-management).</span><span class="sxs-lookup"><span data-stu-id="0535e-135">For [Azure Cloud Services](/azure/cloud-services/cloud-services-choose-me), configure each of your roles to use [multiple instances](/azure/cloud-services/cloud-services-choose-me/#scaling-and-management).</span></span>
- <span data-ttu-id="0535e-136">Para [máquinas virtuais do Azure](/azure/virtual-machines/virtual-machines-windows-about/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), certifique-se de que sua arquitetura inclui mais de uma VM e que cada VM está incluída em uma [conjunto de disponibilidade](/azure/virtual-machines/virtual-machines-windows-manage-availability/).</span><span class="sxs-lookup"><span data-stu-id="0535e-136">For [Azure Virtual Machines](/azure/virtual-machines/virtual-machines-windows-about/?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), ensure that your architecture includes more than one VM and that each VM is included in an [availability set](/azure/virtual-machines/virtual-machines-windows-manage-availability/).</span></span>

### <a name="consider-deploying-across-multiple-regions"></a><span data-ttu-id="0535e-137">Considere a implantação em várias regiões</span><span class="sxs-lookup"><span data-stu-id="0535e-137">Consider deploying across multiple regions</span></span>

<span data-ttu-id="0535e-138">É recomendável implantar tudo, mas os aplicativos menos críticos e os serviços de aplicativo em várias regiões.</span><span class="sxs-lookup"><span data-stu-id="0535e-138">We recommend deploying all but the least critical applications and application services across multiple regions.</span></span> <span data-ttu-id="0535e-139">Se seu aplicativo for implantado em uma única região, no caso raro que toda a região fica indisponível, o aplicativo também estará indisponível.</span><span class="sxs-lookup"><span data-stu-id="0535e-139">If your application is deployed to a single region, in the rare event that the entire region becomes unavailable, the application will also be unavailable.</span></span>

<span data-ttu-id="0535e-140">Se você optar por implantar em uma única região, considere se preparando para reimplantar para uma região secundária, como uma resposta a uma falha inesperada.</span><span class="sxs-lookup"><span data-stu-id="0535e-140">If you choose to deploy to a single region, consider preparing to redeploy to a secondary region as a response to an unexpected failure.</span></span>

### <a name="redeploy-to-a-secondary-region"></a><span data-ttu-id="0535e-141">Reimplantar para uma região secundária</span><span class="sxs-lookup"><span data-stu-id="0535e-141">Redeploy to a secondary region</span></span>

<span data-ttu-id="0535e-142">Se você executar aplicativos e bancos de dados em uma única região primária com nenhuma replicação, sua estratégia de recuperação pode ser reimplantar em outra região.</span><span class="sxs-lookup"><span data-stu-id="0535e-142">If you run applications and databases in a single, primary region with no replication, your recovery strategy might be to redeploy to another region.</span></span> <span data-ttu-id="0535e-143">Essa solução é acessível, mas mais apropriado para aplicativos não críticos que podem tolerar tempos de recuperação.</span><span class="sxs-lookup"><span data-stu-id="0535e-143">This solution is affordable but most appropriate for non-critical applications that can tolerate longer recovery times.</span></span>

<span data-ttu-id="0535e-144">Se você escolher essa estratégia, automatizar o processo de reimplantação tanto quanto possível e incluem cenários de reimplantação em seu teste de resposta de desastres.</span><span class="sxs-lookup"><span data-stu-id="0535e-144">If you choose this strategy, automate the redeployment process as much as possible and include redeployment scenarios in your disaster response testing.</span></span>

<span data-ttu-id="0535e-145">Para automatizar o processo de reimplantação, considere o uso de [Azure Site Recovery](/azure/site-recovery/).</span><span class="sxs-lookup"><span data-stu-id="0535e-145">To automate your redeployment process, consider using [Azure Site Recovery](/azure/site-recovery/).</span></span>

## <a name="use-staging-and-production-environments"></a><span data-ttu-id="0535e-146">Usar ambientes de preparo e produção</span><span class="sxs-lookup"><span data-stu-id="0535e-146">Use staging and production environments</span></span>

<span data-ttu-id="0535e-147">Com bom uso de ambientes de preparo e produção, você pode enviar atualizações para o ambiente de produção de uma forma altamente controlada e minimizar as interrupções de problemas de implantação não previstos.</span><span class="sxs-lookup"><span data-stu-id="0535e-147">With good use of staging and production environments, you can push updates to the production environment in a highly controlled way and minimize disruption from unanticipated deployment issues.</span></span>

- <span data-ttu-id="0535e-148">[*Implantação "Blue-green"*](https://martinfowler.com/bliki/BlueGreenDeployment.html) envolve a implantação de uma atualização em um ambiente de produção que é separado do aplicativo ao vivo.</span><span class="sxs-lookup"><span data-stu-id="0535e-148">[*Blue-green deployment*](https://martinfowler.com/bliki/BlueGreenDeployment.html) involves deploying an update into a production environment that's separate from the live application.</span></span> <span data-ttu-id="0535e-149">Após validar a implantação, alterne o roteamento de tráfego para a versão atualizada.</span><span class="sxs-lookup"><span data-stu-id="0535e-149">After you validate the deployment, switch the traffic routing to the updated version.</span></span> <span data-ttu-id="0535e-150">Uma forma de fazer isso é usar o [slots de preparo](/azure/app-service/web-sites-staged-publishing) disponíveis no serviço de aplicativo do Azure para preparar uma implantação antes de movê-lo para produção.</span><span class="sxs-lookup"><span data-stu-id="0535e-150">One way to do this is to use the [staging slots](/azure/app-service/web-sites-staged-publishing) available in Azure App Service to stage a deployment before moving it to production.</span></span>
- <span data-ttu-id="0535e-151">[*Versões canário*](https://martinfowler.com/bliki/CanaryRelease.html) são semelhantes às implantações "blue-green".</span><span class="sxs-lookup"><span data-stu-id="0535e-151">[*Canary releases*](https://martinfowler.com/bliki/CanaryRelease.html) are similar to blue-green deployments.</span></span> <span data-ttu-id="0535e-152">Em vez de alternar todo o tráfego para o aplicativo atualizado, você pode rotear apenas uma pequena parte do tráfego para a nova implantação.</span><span class="sxs-lookup"><span data-stu-id="0535e-152">Instead of switching all traffic to the updated application, you route only a small portion of the traffic to the new deployment.</span></span> <span data-ttu-id="0535e-153">Se houver um problema, reverta para a implantação antiga.</span><span class="sxs-lookup"><span data-stu-id="0535e-153">If there's a problem, revert to the old deployment.</span></span> <span data-ttu-id="0535e-154">Caso contrário, gradualmente mais tráfego de rota para a nova versão.</span><span class="sxs-lookup"><span data-stu-id="0535e-154">If not, gradually route more traffic to the new version.</span></span> <span data-ttu-id="0535e-155">Se você estiver usando o serviço de aplicativo do Azure, você pode usar o teste no recurso de produção para gerenciar uma versão canário.</span><span class="sxs-lookup"><span data-stu-id="0535e-155">If you're using Azure App Service, you can use the Testing in production feature to manage a canary release.</span></span>

## <a name="create-a-rollback-plan-for-deployment-and-updates"></a><span data-ttu-id="0535e-156">Criar um plano de reversão para a implantação e atualizações</span><span class="sxs-lookup"><span data-stu-id="0535e-156">Create a rollback plan for deployment and updates</span></span>

<span data-ttu-id="0535e-157">Se uma implantação falhar, seu aplicativo pode se tornar indisponível.</span><span class="sxs-lookup"><span data-stu-id="0535e-157">If a deployment fails, your application could become unavailable.</span></span> <span data-ttu-id="0535e-158">Para minimizar o tempo de inatividade, projete um processo de reversão para voltar para uma versão válida do último.</span><span class="sxs-lookup"><span data-stu-id="0535e-158">To minimize downtime, design a rollback process to go back to a last-known good version.</span></span> <span data-ttu-id="0535e-159">Inclua uma estratégia para reverter as alterações em bancos de dados e quaisquer outros serviços que seu aplicativo depende.</span><span class="sxs-lookup"><span data-stu-id="0535e-159">Include a strategy to roll back changes to databases and any other services your app depends on.</span></span>

<span data-ttu-id="0535e-160">Se você estiver usando o serviço de aplicativo do Azure, você pode configurar um slot de sites de último BOM e usá-lo para fazer a reversão de uma implantação de aplicativo de API ou web.</span><span class="sxs-lookup"><span data-stu-id="0535e-160">If you're using Azure App Service, you can set up a last-known good site slot and use it to roll back from a web or API app deployment.</span></span>

## <a name="log-and-audit-deployments"></a><span data-ttu-id="0535e-161">Implantações de log e auditoria</span><span class="sxs-lookup"><span data-stu-id="0535e-161">Log and audit deployments</span></span>

<span data-ttu-id="0535e-162">Para capturar como possível de informações muito específicos da versão, implemente uma estratégia de registro em log robusta.</span><span class="sxs-lookup"><span data-stu-id="0535e-162">To capture as much version-specific information as possible, implement a robust logging strategy.</span></span> <span data-ttu-id="0535e-163">Se você usar técnicas de implantação de preparo, mais de uma versão do seu aplicativo será executado na produção.</span><span class="sxs-lookup"><span data-stu-id="0535e-163">If you use staged deployment techniques, more than one version of your application will be running in production.</span></span> <span data-ttu-id="0535e-164">Se ocorrer um problema, determine qual versão está causando a ele.</span><span class="sxs-lookup"><span data-stu-id="0535e-164">If a problem occurs, determine which version is causing it.</span></span>

## <a name="document-release-processes"></a><span data-ttu-id="0535e-165">Processos de lançamento do documento</span><span class="sxs-lookup"><span data-stu-id="0535e-165">Document release processes</span></span>

<span data-ttu-id="0535e-166">Sem a documentação do processo de versão detalhadas, um operador pode implantar uma atualização inválida ou pode definir configurações incorretamente para seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="0535e-166">Without detailed release process documentation, an operator might deploy a bad update or might improperly configure settings for your application.</span></span> <span data-ttu-id="0535e-167">Defina e documente claramente seu processo de lançamento e verifique se ele está disponível para toda a equipe de operações.</span><span class="sxs-lookup"><span data-stu-id="0535e-167">Clearly define and document your release process, and ensure that it's available to the entire operations team.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0535e-168">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="0535e-168">Next steps</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="0535e-169">Monitorar a integridade de aplicativo para confiabilidade</span><span class="sxs-lookup"><span data-stu-id="0535e-169">Monitor application health for reliability</span></span>](./monitoring.md)
