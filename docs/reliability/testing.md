---
title: Testando aplicativos do Azure para resiliência e disponibilidade
description: Abordagens para testar a confiabilidade de aplicativos no Azure
author: MikeWasson
ms.date: 04/10/2019
ms.topic: article
ms.service: architecture-center
ms.subservice: cloud-design-principles
ms.openlocfilehash: cf33a859540810279b1cb85be5a6fb2ebe4500dc
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 04/17/2019
ms.locfileid: "59646478"
---
# <a name="testing-azure-applications-for-resiliency-and-availability"></a><span data-ttu-id="ffcfd-103">Testando aplicativos do Azure para resiliência e disponibilidade</span><span class="sxs-lookup"><span data-stu-id="ffcfd-103">Testing Azure applications for resiliency and availability</span></span>

<span data-ttu-id="ffcfd-104">Para testar a resiliência, você deve verificar o desempenho da carga de trabalho de ponta a ponta sob condições de falha de intermitente.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-104">To test resiliency, you should verify how the end-to-end workload performs under intermittent failure conditions.</span></span>

<span data-ttu-id="ffcfd-105">Execute testes em produção usando tanto os dados de usuário sintéticos quanto reais.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-105">Run tests in production using both synthetic and real user data.</span></span> <span data-ttu-id="ffcfd-106">Teste e produção são raramente idênticos, portanto, é importante validar seu aplicativo em produção usando um [azul-verde](https://martinfowler.com/bliki/BlueGreenDeployment.html) ou [implantação canário](https://martinfowler.com/bliki/CanaryRelease.html).</span><span class="sxs-lookup"><span data-stu-id="ffcfd-106">Test and production are rarely identical, so it's important to validate your application in production using a [blue-green](https://martinfowler.com/bliki/BlueGreenDeployment.html) or [canary deployment](https://martinfowler.com/bliki/CanaryRelease.html).</span></span> <span data-ttu-id="ffcfd-107">Dessa forma, você está testando o aplicativo em condições reais, portanto, você pode ter certeza de que ele funcionará conforme o esperado quando totalmente implantado.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-107">This way, you're testing the application under real conditions, so you can be sure that it will function as expected when fully deployed.</span></span>

<span data-ttu-id="ffcfd-108">Como parte do seu plano de teste, incluem:</span><span class="sxs-lookup"><span data-stu-id="ffcfd-108">As part of your test plan, include:</span></span>

- <span data-ttu-id="ffcfd-109">Pré-implantação de teste automatizado</span><span class="sxs-lookup"><span data-stu-id="ffcfd-109">Automated predeployment testing</span></span>
- <span data-ttu-id="ffcfd-110">Teste de injeção de falha</span><span class="sxs-lookup"><span data-stu-id="ffcfd-110">Fault injection testing</span></span>
- <span data-ttu-id="ffcfd-111">Teste de carga de pico</span><span class="sxs-lookup"><span data-stu-id="ffcfd-111">Peak load testing</span></span>
- <span data-ttu-id="ffcfd-112">Testes de recuperação de desastre</span><span class="sxs-lookup"><span data-stu-id="ffcfd-112">Disaster recovery testing</span></span>
- <span data-ttu-id="ffcfd-113">Teste do serviço de terceiros</span><span class="sxs-lookup"><span data-stu-id="ffcfd-113">Third-party service testing</span></span>

<span data-ttu-id="ffcfd-114">O teste é um processo iterativo.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-114">Testing is an iterative process.</span></span> <span data-ttu-id="ffcfd-115">Teste o aplicativo, avalie o resultado, analise e resolva as falhas resultantes, e repita o processo.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-115">Test the application, measure the outcome, analyze and address any failures that result, and repeat the process.</span></span>

## <a name="perform-fault-injection-testing"></a><span data-ttu-id="ffcfd-116">Executar o teste de injeção de falha</span><span class="sxs-lookup"><span data-stu-id="ffcfd-116">Perform fault injection testing</span></span>

<span data-ttu-id="ffcfd-117">Para teste de injeção de falha, verifique a resiliência do sistema durante falhas, disparando falhas reais ou simulando-as.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-117">For fault injection testing, check the resiliency of the system during failures, either by triggering actual failures or by simulating them.</span></span> <span data-ttu-id="ffcfd-118">Aqui estão algumas estratégias para induzir falhas:</span><span class="sxs-lookup"><span data-stu-id="ffcfd-118">Here are some strategies to induce failures:</span></span>

- <span data-ttu-id="ffcfd-119">Desligue as instâncias de máquina virtual (VM).</span><span class="sxs-lookup"><span data-stu-id="ffcfd-119">Shut down virtual machine (VM) instances.</span></span>
- <span data-ttu-id="ffcfd-120">Falha de processos.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-120">Crash processes.</span></span>
- <span data-ttu-id="ffcfd-121">expiração de certificados</span><span class="sxs-lookup"><span data-stu-id="ffcfd-121">Expire certificates.</span></span>
- <span data-ttu-id="ffcfd-122">mudança de chaves de acesso</span><span class="sxs-lookup"><span data-stu-id="ffcfd-122">Change access keys.</span></span>
- <span data-ttu-id="ffcfd-123">desligamento do serviço DNS em controladores de domínio</span><span class="sxs-lookup"><span data-stu-id="ffcfd-123">Shut down the DNS service on domain controllers.</span></span>
- <span data-ttu-id="ffcfd-124">limitação de recursos do sistema disponíveis, como RAM ou número de threads</span><span class="sxs-lookup"><span data-stu-id="ffcfd-124">Limit available system resources, such as RAM or number of threads.</span></span>
- <span data-ttu-id="ffcfd-125">desmontagem de discos</span><span class="sxs-lookup"><span data-stu-id="ffcfd-125">Unmount disks.</span></span>
- <span data-ttu-id="ffcfd-126">reimplantação de uma VM</span><span class="sxs-lookup"><span data-stu-id="ffcfd-126">Redeploy a VM.</span></span>

<span data-ttu-id="ffcfd-127">Seu plano de teste deve incorporar possíveis pontos de falha identificados durante a fase de design, além de cenários comuns de falha:</span><span class="sxs-lookup"><span data-stu-id="ffcfd-127">Your test plan should incorporate possible failure points identified during the design phase, in addition to common failure scenarios:</span></span>

- <span data-ttu-id="ffcfd-128">Teste seu aplicativo em um ambiente mais próximo da produção possível.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-128">Test your application in an environment as close to production as possible.</span></span>
- <span data-ttu-id="ffcfd-129">Falhas de teste na combinação.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-129">Test failures in combination.</span></span>
- <span data-ttu-id="ffcfd-130">Meça o tempo de recuperação e certifique-se de que seus requisitos de negócios sejam atendidos.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-130">Measure the recovery times, and be sure that your business requirements are met.</span></span>
- <span data-ttu-id="ffcfd-131">Verifique se que falhas não colocar em cascata e são tratadas de maneira isolada.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-131">Verify that failures don't cascade and are handled in an isolated way.</span></span>

<span data-ttu-id="ffcfd-132">Para obter mais informações sobre cenários de falha, consulte [falha e recuperação de desastres para aplicativos do Azure](./disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="ffcfd-132">For more information about failure scenarios, see [Failure and disaster recovery for Azure applications](./disaster-recovery.md).</span></span>

## <a name="test-under-peak-loads"></a><span data-ttu-id="ffcfd-133">Testar sob cargas de pico</span><span class="sxs-lookup"><span data-stu-id="ffcfd-133">Test under peak loads</span></span>

<span data-ttu-id="ffcfd-134">Teste de carga é crucial para identificar falhas que acontecem somente sob carga, como o banco de dados de back-end que está sendo sobrecarregado ou limitações de serviço.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-134">Load testing is crucial for identifying failures that only happen under load, such as the back-end database being overwhelmed or service throttling.</span></span> <span data-ttu-id="ffcfd-135">Teste de carga de pico e aumento previsto no pico de carga, usando dados de produção ou sintéticos, que é o mais próximo possível de dados produção.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-135">Test for peak load and anticipated increase in peak load, using production data or synthetic data that is as close to production data as possible.</span></span> <span data-ttu-id="ffcfd-136">Sua meta é verificar como o aplicativo se comporta sob condições do mundo real.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-136">Your goal is to see how the application behaves under real-world conditions.</span></span>

## <a name="conduct-disaster-recovery-drills"></a><span data-ttu-id="ffcfd-137">Realizar a recuperação de desastre</span><span class="sxs-lookup"><span data-stu-id="ffcfd-137">Conduct disaster recovery drills</span></span>

<span data-ttu-id="ffcfd-138">Começar com um plano de recuperação de desastres boa e testá-lo periodicamente para verificar se que ele funciona.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-138">Start with a good disaster recovery plan, and test it periodically to make sure it works.</span></span>

<span data-ttu-id="ffcfd-139">Máquinas virtuais do Azure, você pode usar [Azure Site Recovery](/azure/site-recovery/azure-to-azure-quickstart/) replicar e executar [recuperação de desastre](/azure/site-recovery/azure-to-azure-tutorial-dr-drill/) sem afetar a replicação em andamento ou aplicativos de produção.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-139">For Azure Virtual Machines, you can use [Azure Site Recovery](/azure/site-recovery/azure-to-azure-quickstart/) to replicate and perform [disaster recovery drills](/azure/site-recovery/azure-to-azure-tutorial-dr-drill/) without impacting production applications or ongoing replication.</span></span>

### <a name="failover-and-failback-testing"></a><span data-ttu-id="ffcfd-140">Teste de failover e failback</span><span class="sxs-lookup"><span data-stu-id="ffcfd-140">Failover and failback testing</span></span>

<span data-ttu-id="ffcfd-141">Testar o failover e failback para verificar que os serviços dependentes do seu aplicativo voltam ao funcionamento de forma sincronizada durante a recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-141">Test failover and failback to verify that your application's dependent services come back up in a synchronized manner during disaster recovery.</span></span> <span data-ttu-id="ffcfd-142">As alterações aos sistemas e operações podem afetar as funções de failover e failback, mas o impacto pode não ser detectado até que o sistema principal falhe ou fique sobrecarregado.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-142">Changes to systems and operations may affect failover and failback functions, but the impact may not be detected until the main system fails or becomes overloaded.</span></span> <span data-ttu-id="ffcfd-143">Recursos de failover de teste *antes de* são necessárias para compensar um problema ao vivo.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-143">Test failover capabilities *before* they are required to compensate for a live problem.</span></span> <span data-ttu-id="ffcfd-144">Também Certifique-se que os serviços dependentes executar failover e failback na ordem correta.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-144">Also be sure that dependent services fail over and fail back in the correct order.</span></span>

<span data-ttu-id="ffcfd-145">Se você estiver usando [Azure Site Recovery](/azure/site-recovery/) para replicar máquinas virtuais, execute desastres exercícios de recuperação periodicamente fazendo failovers de teste para validar sua estratégia de replicação.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-145">If you are using [Azure Site Recovery](/azure/site-recovery/) to replicate VMs, run disaster recovery drills periodically by doing test failovers to validate your replication strategy.</span></span> <span data-ttu-id="ffcfd-146">Um failover de teste não afeta a replicação contínua de VM ou seu ambiente de produção.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-146">A test failover does not affect the ongoing VM replication or your production environment.</span></span> <span data-ttu-id="ffcfd-147">Para obter mais informações, consulte [executar uma simulação de recuperação de desastres para o Azure](/azure/site-recovery/site-recovery-test-failover-to-azure).</span><span class="sxs-lookup"><span data-stu-id="ffcfd-147">For more information, see [Run a disaster recovery drill to Azure](/azure/site-recovery/site-recovery-test-failover-to-azure).</span></span>

### <a name="simulation-testing"></a><span data-ttu-id="ffcfd-148">Os testes de simulação</span><span class="sxs-lookup"><span data-stu-id="ffcfd-148">Simulation testing</span></span>

<span data-ttu-id="ffcfd-149">Os testes de simulação envolvem a criação de situações de pequeno e reais.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-149">Simulation testing involves creating small, real-life situations.</span></span> <span data-ttu-id="ffcfd-150">Simulações de demonstram a eficácia das soluções no plano de recuperação e realçam quaisquer problemas que não foram satisfeitos adequadamente.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-150">Simulations demonstrate the effectiveness of the solutions in the recovery plan and highlight any issues that weren't adequately addressed.</span></span>

<span data-ttu-id="ffcfd-151">Conforme você realiza testes de simulação, siga as práticas recomendadas:</span><span class="sxs-lookup"><span data-stu-id="ffcfd-151">As you perform simulation testing, follow best practices:</span></span>

- <span data-ttu-id="ffcfd-152">Conduza a simulações de forma que não afetem negócios reais, mas parece uma situação real.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-152">Conduct simulations in a manner that doesn't disrupt actual business but feels like a real situation.</span></span>
- <span data-ttu-id="ffcfd-153">Certifique-se de que os cenários simulados são completamente controláveis.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-153">Make sure that simulated scenarios are completely controllable.</span></span> <span data-ttu-id="ffcfd-154">Se o plano de recuperação parecer estar falhando, você pode restaurar a situação voltar ao normal sem causar danos.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-154">If the recovery plan seems to be failing, you can restore the situation back to normal without causing damage.</span></span>
- <span data-ttu-id="ffcfd-155">Informe à gerência sobre quando e como os exercícios de simulação serão realizados.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-155">Inform management about when and how the simulation exercises will be conducted.</span></span> <span data-ttu-id="ffcfd-156">Seu plano deve detalhar o período de tempo e os recursos afetados durante a simulação.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-156">Your plan should detail the time frame and the resources affected during the simulation.</span></span>

## <a name="test-health-probes-for-load-balancers-and-traffic-managers"></a><span data-ttu-id="ffcfd-157">Testar a investigações de integridade para balanceadores de carga e gerenciadores de tráfego</span><span class="sxs-lookup"><span data-stu-id="ffcfd-157">Test health probes for load balancers and traffic managers</span></span>

<span data-ttu-id="ffcfd-158">Configurar e testar a investigações de integridade para balanceadores de carga e gerenciadores de tráfego.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-158">Configure and test health probes for your load balancers and traffic managers.</span></span> <span data-ttu-id="ffcfd-159">Certifique-se de que seu ponto de extremidade de integridade verifica as partes críticas do sistema e responde apropriadamente.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-159">Ensure that your health endpoint checks the critical parts of the system and responds appropriately.</span></span>

- <span data-ttu-id="ffcfd-160">Para [Azure Traffic Manager](/azure/traffic-manager/traffic-manager-overview/), a investigação de integridade determina se é necessário fazer failover para outra região.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-160">For [Azure Traffic Manager](/azure/traffic-manager/traffic-manager-overview/), the health probe determines whether to fail over to another region.</span></span> <span data-ttu-id="ffcfd-161">O ponto de extremidade de integridade deve verificar todas as dependências críticas que são implantadas na mesma região.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-161">Your health endpoint should check any critical dependencies that are deployed within the same region.</span></span>
- <span data-ttu-id="ffcfd-162">Para [balanceador de carga do Azure](/azure/load-balancer/load-balancer-overview/), a investigação de integridade determina se é necessário remover uma VM da rotação.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-162">For [Azure Load Balancer](/azure/load-balancer/load-balancer-overview/), the health probe determines whether to remove a VM from rotation.</span></span> <span data-ttu-id="ffcfd-163">O ponto de extremidade de integridade deve relatar a integridade da VM.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-163">The health endpoint should report the health of the VM.</span></span> <span data-ttu-id="ffcfd-164">Não inclua outras camadas ou serviços externos.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-164">Don't include other tiers or external services.</span></span> <span data-ttu-id="ffcfd-165">Caso contrário, uma falha que ocorra fora da VM fará com que o balanceador de carga remova a VM da rotação.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-165">Otherwise, a failure that occurs outside the VM will cause the load balancer to remove the VM from rotation.</span></span>

<span data-ttu-id="ffcfd-166">Para diretrizes sobre como implementar a integridade de monitoramento em seu aplicativo, confira [Padrão de monitoramento de ponto de extremidade de integridade](../patterns/health-endpoint-monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="ffcfd-166">For guidance on implementing health monitoring in your application, see [Health Endpoint Monitoring pattern](../patterns/health-endpoint-monitoring.md).</span></span>

## <a name="test-monitoring-systems"></a><span data-ttu-id="ffcfd-167">Testar sistemas de monitoramento</span><span class="sxs-lookup"><span data-stu-id="ffcfd-167">Test monitoring systems</span></span>

<span data-ttu-id="ffcfd-168">Inclua sistemas de monitoramento no plano de teste.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-168">Include monitoring systems in your test plan.</span></span> <span data-ttu-id="ffcfd-169">Sistemas automatizados de failover e failback dependem do funcionamento correto da instrumentação e monitoramento.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-169">Automated failover and failback systems depend on the correct functioning of monitoring and instrumentation.</span></span> <span data-ttu-id="ffcfd-170">Painéis para visualizar os alertas de integridade e o operador do sistema também dependem de instrumentação e monitoramento precisos.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-170">Dashboards to visualize system health and operator alerts also depend on having accurate monitoring and instrumentation.</span></span> <span data-ttu-id="ffcfd-171">Se esses elementos falharem, perderem informações essenciais ou relatarem dados imprecisos, um operador poderá deixar de perceber que o sistema não está íntegro ou que está falhando.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-171">If these elements fail, miss critical information, or report inaccurate data, an operator might not realize that the system is unhealthy or failing.</span></span>

## <a name="include-third-party-services-in-test-scenarios"></a><span data-ttu-id="ffcfd-172">Incluir serviços de terceiros em cenários de teste</span><span class="sxs-lookup"><span data-stu-id="ffcfd-172">Include third-party services in test scenarios</span></span>

<span data-ttu-id="ffcfd-173">Se seu aplicativo tiver dependências de serviços de terceiros, identifique onde e como esses serviços podem falhar e o efeito que essas falhas terá no seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-173">If your application has dependencies on third-party services, identify where and how these services can fail and what effect those failures will have on your application.</span></span> <span data-ttu-id="ffcfd-174">Tenha em mente o contrato de nível de serviço (SLA) para o serviço de terceiros e o efeito que isso teria em seu plano de recuperação de desastres.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-174">Keep in mind the service-level agreement (SLA) for the third-party service and the effect it might have on your disaster recovery plan.</span></span>

<span data-ttu-id="ffcfd-175">Um serviço de terceiros pode não fornecer recursos de monitoramento e diagnóstico, portanto, é importante para fazer logon sua invocações deles e correlacioná-los com a integridade do aplicativo e usando um identificador exclusivo de log de diagnóstico.</span><span class="sxs-lookup"><span data-stu-id="ffcfd-175">A third-party service might not provide monitoring and diagnostics capabilities, so it's important to log your invocations of them and to correlate them with your application's health and diagnostic logging using a unique identifier.</span></span> <span data-ttu-id="ffcfd-176">Para obter mais informações sobre práticas comprovadas de monitoramento e diagnóstico, consulte [diretrizes de monitoramento e diagnóstico](../best-practices/monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="ffcfd-176">For more information on proven practices for monitoring and diagnostics, see [Monitoring and diagnostics guidance](../best-practices/monitoring.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="ffcfd-177">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="ffcfd-177">Next steps</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="ffcfd-178">Implantar para resiliência e disponibilidade</span><span class="sxs-lookup"><span data-stu-id="ffcfd-178">Deploy for resiliency and availability</span></span>](./deploy.md)
